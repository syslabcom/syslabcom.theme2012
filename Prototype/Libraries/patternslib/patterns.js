/*!
 * Modernizr v2.0.6
 * http://www.modernizr.com
 *
 * Copyright (c) 2009-2011 Faruk Ates, Paul Irish, Alex Sexton
 * Dual-licensed under the BSD or MIT licenses: www.modernizr.com/license/
 */
/*!
 * jQuery Form Plugin
 * version: 3.03 (08-MAR-2012)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
/*!
 * jCarousel - Riding carousels with jQuery
 *   http://sorgalla.com/jcarousel/
 *
 * Copyright (c) 2006 Jan Sorgalla (http://sorgalla.com)
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 *
 * Built on top of the jQuery library
 *   http://jquery.com
 *
 * Inspired by the "Carousel Component" by Bill Scott
 *   http://billwscott.com/carousel/
 */
/**
 * @license
 * Patterns @VERSION@ jquery-ext - various jQuery extensions
 *
 * Copyright 2011 Humberto Sermeño
 */
/**
 * @license
 * Patterns @VERSION@ parser - argument parser
 *
 * Copyright 2012 Simplon B.V.
 * Copyright 2012 Florian Friesdorf
 */
/**
 * @license
 * Patterns @VERSION@ store - store pattern state locally in the browser
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ core - library infrastructure
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/*! http://mths.be/placeholder v2.0.7 by @mathias */
/**
 * @license
 * Patterns @VERSION@ fancybox - automatic fancybox setup
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ floatingPanel - easily create floating panels
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ floatingPanel - easily create floating panels
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ selfhealing - self healing messages (like growl)
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ setclass - update class on click
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ tooltip - tooltips
 *
 * Copyright 2008-2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
/**
 * @license
 * Patterns @VERSION@ focus - Manage focus class on fieldsets
 *
 * Copyright 2012 Simplon B.V.
 */
/**
 * @license
 * Patterns @VERSION@ checkedflag - Add checked flag to checkbox labels
 *
 * Copyright 2012 Simplon B.V.
 */
/**
 * @license
 * Patterns @VERSION@ toggle - toggle class on click
 *
 * Copyright 2012 Simplon B.V.
 * Copyright 2011 Humberto Sermeño
 * Copyright 2011 SYSLAB.COM GmbH
 */
window.Modernizr=function(a,b,c){function B(a){k.cssText=a}function C(a,b){return B(o.join(a+";")+(b||""))}function D(a,b){return typeof a===b}function E(a,b){return!!~(""+a).indexOf(b)}function F(a,b){for(var d in a)if(k[a[d]]!==c)return b=="pfx"?a[d]:!0;return!1}function G(a,b){var c=a.charAt(0).toUpperCase()+a.substr(1),d=(a+" "+p.join(c+" ")+c).split(" ");return F(d,b)}function I(){e.input=function(a){for(var b=0,c=a.length;b<c;b++)t[a[b]]=a[b]in l;return t}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)l.setAttribute("type",f=a[d]),e=l.type!=="text",e&&(l.value=m,l.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&l.style.WebkitAppearance!==c?(g.appendChild(l),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(l,null).WebkitAppearance!=="textfield"&&l.offsetHeight!==0,g.removeChild(l)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=l.checkValidity&&l.checkValidity()===!1:/^color$/.test(f)?(g.appendChild(l),g.offsetWidth,e=l.value!=m,g.removeChild(l)):e=l.value!=m)),s[a[d]]=!!e;return s}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d="2.0.6",e={},f=!0,g=b.documentElement,h=b.head||b.getElementsByTagName("head")[0],i="modernizr",j=b.createElement(i),k=j.style,l=b.createElement("input"),m=":)",n=Object.prototype.toString,o=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),p="Webkit Moz O ms Khtml".split(" "),q={svg:"http://www.w3.org/2000/svg"},r={},s={},t={},u=[],v,w=function(a,c,d,e){var f,h,j,k=b.createElement("div");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:i+(d+1),k.appendChild(j);return f=["&shy;","<style>",a,"</style>"].join(""),k.id=i,k.innerHTML+=f,g.appendChild(k),h=c(k,a),k.parentNode.removeChild(k),!!h},x=function(b){if(a.matchMedia)return matchMedia(b).matches;var c;return w("@media "+b+" { #"+i+" { position: absolute; } }",function(b){c=(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle)["position"]=="absolute"}),c},y=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=D(e[d],"function"),D(e[d],c)||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),z={}.hasOwnProperty,A;!D(z,c)&&!D(z.call,c)?A=function(a,b){return z.call(a,b)}:A=function(a,b){return b in a&&D(a.constructor.prototype[b],c)};var H=function(c,d){var f=c.join(""),g=d.length;w(f,function(c,d){var f=b.styleSheets[b.styleSheets.length-1],h=f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"",i=c.childNodes,j={};while(g--)j[i[g].id]=i[g];e.touch="ontouchstart"in a||j.touch.offsetTop===9,e.csstransforms3d=j.csstransforms3d.offsetLeft===9,e.generatedcontent=j.generatedcontent.offsetHeight>=1,e.fontface=/src/i.test(h)&&h.indexOf(d.split(" ")[0])===0},g,d)}(['@font-face {font-family:"font";src:url("https://")}',["@media (",o.join("touch-enabled),("),i,")","{#touch{top:9px;position:absolute}}"].join(""),["@media (",o.join("transform-3d),("),i,")","{#csstransforms3d{left:9px;position:absolute}}"].join(""),['#generatedcontent:after{content:"',m,'";visibility:hidden}'].join("")],["fontface","touch","csstransforms3d","generatedcontent"]);r.flexbox=function(){function a(a,b,c,d){b+=":",a.style.cssText=(b+o.join(c+";"+b)).slice(0,-b.length)+(d||"")}function c(a,b,c,d){a.style.cssText=o.join(b+":"+c+";")+(d||"")}var d=b.createElement("div"),e=b.createElement("div");a(d,"display","box","width:42px;padding:0;"),c(e,"box-flex","1","width:10px;"),d.appendChild(e),g.appendChild(d);var f=e.offsetWidth===42;return d.removeChild(e),g.removeChild(d),f},r.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},r.canvastext=function(){return!!e.canvas&&!!D(b.createElement("canvas").getContext("2d").fillText,"function")},r.webgl=function(){return!!a.WebGLRenderingContext},r.touch=function(){return e.touch},r.geolocation=function(){return!!navigator.geolocation},r.postmessage=function(){return!!a.postMessage},r.websqldatabase=function(){var b=!!a.openDatabase;return b},r.indexedDB=function(){for(var b=-1,c=p.length;++b<c;)if(a[p[b].toLowerCase()+"IndexedDB"])return!0;return!!a.indexedDB},r.hashchange=function(){return y("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},r.history=function(){return!!a.history&&!!history.pushState},r.draganddrop=function(){return y("dragstart")&&y("drop")},r.websockets=function(){for(var b=-1,c=p.length;++b<c;)if(a[p[b]+"WebSocket"])return!0;return"WebSocket"in a},r.rgba=function(){return B("background-color:rgba(150,255,150,.5)"),E(k.backgroundColor,"rgba")},r.hsla=function(){return B("background-color:hsla(120,40%,100%,.5)"),E(k.backgroundColor,"rgba")||E(k.backgroundColor,"hsla")},r.multiplebgs=function(){return B("background:url(https://),url(https://),red url(https://)"),/(url\s*\(.*?){3}/.test(k.background)},r.backgroundsize=function(){return G("backgroundSize")},r.borderimage=function(){return G("borderImage")},r.borderradius=function(){return G("borderRadius")},r.boxshadow=function(){return G("boxShadow")},r.textshadow=function(){return b.createElement("div").style.textShadow===""},r.opacity=function(){return C("opacity:.55"),/^0.55$/.test(k.opacity)},r.cssanimations=function(){return G("animationName")},r.csscolumns=function(){return G("columnCount")},r.cssgradients=function(){var a="background-image:",b="gradient(linear,left top,right bottom,from(#9f9),to(white));",c="linear-gradient(left top,#9f9, white);";return B((a+o.join(b+a)+o.join(c+a)).slice(0,-a.length)),E(k.backgroundImage,"gradient")},r.cssreflections=function(){return G("boxReflect")},r.csstransforms=function(){return!!F(["transformProperty","WebkitTransform","MozTransform","OTransform","msTransform"])},r.csstransforms3d=function(){var a=!!F(["perspectiveProperty","WebkitPerspective","MozPerspective","OPerspective","msPerspective"]);return a&&"webkitPerspective"in g.style&&(a=e.csstransforms3d),a},r.csstransitions=function(){return G("transitionProperty")},r.fontface=function(){return e.fontface},r.generatedcontent=function(){return e.generatedcontent},r.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType){c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"');var d='video/mp4; codecs="avc1.42E01E';c.h264=a.canPlayType(d+'"')||a.canPlayType(d+', mp4a.40.2"'),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"')}}catch(e){}return c},r.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"'),c.mp3=a.canPlayType("audio/mpeg;"),c.wav=a.canPlayType('audio/wav; codecs="1"'),c.m4a=a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")}catch(d){}return c},r.localstorage=function(){try{return!!localStorage.getItem}catch(a){return!1}},r.sessionstorage=function(){try{return!!sessionStorage.getItem}catch(a){return!1}},r.webworkers=function(){return!!a.Worker},r.applicationcache=function(){return!!a.applicationCache},r.svg=function(){return!!b.createElementNS&&!!b.createElementNS(q.svg,"svg").createSVGRect},r.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==q.svg},r.smil=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"animate")))},r.svgclippaths=function(){return!!b.createElementNS&&/SVG/.test(n.call(b.createElementNS(q.svg,"clipPath")))};for(var J in r)A(r,J)&&(v=J.toLowerCase(),e[v]=r[J](),u.push((e[v]?"":"no-")+v));return e.input||I(),e.addTest=function(a,b){if(typeof a=="object")for(var d in a)A(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return;b=typeof b=="boolean"?b:!!b(),g.className+=" "+(b?"":"no-")+a,e[a]=b}return e},B(""),j=l=null,a.attachEvent&&function(){var a=b.createElement("div");return a.innerHTML="<elem></elem>",a.childNodes.length!==1}()&&function(a,b){function s(a){var b=-1;while(++b<g)a.createElement(f[b])}a.iepp=a.iepp||{};var d=a.iepp,e=d.html5elements||"abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",f=e.split("|"),g=f.length,h=new RegExp("(^|\\s)("+e+")","gi"),i=new RegExp("<(/*)("+e+")","gi"),j=/^\s*[\{\}]\s*$/,k=new RegExp("(^|[^\\n]*?\\s)("+e+")([^\\n]*)({[\\n\\w\\W]*?})","gi"),l=b.createDocumentFragment(),m=b.documentElement,n=m.firstChild,o=b.createElement("body"),p=b.createElement("style"),q=/print|all/,r;d.getCSS=function(a,b){if(a+""===c)return"";var e=-1,f=a.length,g,h=[];while(++e<f){g=a[e];if(g.disabled)continue;b=g.media||b,q.test(b)&&h.push(d.getCSS(g.imports,b),g.cssText),b="all"}return h.join("")},d.parseCSS=function(a){var b=[],c;while((c=k.exec(a))!=null)b.push(((j.exec(c[1])?"\n":c[1])+c[2]+c[3]).replace(h,"$1.iepp_$2")+c[4]);return b.join("\n")},d.writeHTML=function(){var a=-1;r=r||b.body;while(++a<g){var c=b.getElementsByTagName(f[a]),d=c.length,e=-1;while(++e<d)c[e].className.indexOf("iepp_")<0&&(c[e].className+=" iepp_"+f[a])}l.appendChild(r),m.appendChild(o),o.className=r.className,o.id=r.id,o.innerHTML=r.innerHTML.replace(i,"<$1font")},d._beforePrint=function(){p.styleSheet.cssText=d.parseCSS(d.getCSS(b.styleSheets,"all")),d.writeHTML()},d.restoreHTML=function(){o.innerHTML="",m.removeChild(o),m.appendChild(r)},d._afterPrint=function(){d.restoreHTML(),p.styleSheet.cssText=""},s(b),s(l);if(d.disablePP)return;n.insertBefore(p,n.firstChild),p.media="print",p.className="iepp-printshim",a.attachEvent("onbeforeprint",d._beforePrint),a.attachEvent("onafterprint",d._afterPrint)}(a,b),e._version=d,e._prefixes=o,e._domPrefixes=p,e.mq=x,e.hasEvent=y,e.testProp=function(a){return F([a])},e.testAllProps=G,e.testStyles=w,e.prefixed=function(a){return G(a,"pfx")},g.className=g.className.replace(/\bno-js\b/,"")+(f?" js "+u.join(" "):""),e}(this,this.document),define("../lib/modernizr-2.0.6",function(){}),function(a){var b,c,d,e,f,g,h,i,j,k,l=0,m={},n=[],o=0,p={},q=[],r=null,s=new Image,t=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,u=/[^\.]\.(swf)\s*$/i,v,w=1,x=0,y="",z,A,B=!1,C=a.extend(a("<div/>")[0],{prop:0}),D=a.browser.msie&&a.browser.version<7&&!window.XMLHttpRequest,E=function(){c.hide(),s.onerror=s.onload=null,r&&r.abort(),b.empty()},F=function(){if(!1===m.onError(n,l,m)){c.hide(),B=!1;return}m.titleShow=!1,m.width="auto",m.height="auto",b.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>'),H()},G=function(){var d=n[l],e,f,h,i,j,k;E(),m=a.extend({},a.fn.fancybox.defaults,typeof a(d).data("fancybox")=="undefined"?m:a(d).data("fancybox")),k=m.onStart(n,l,m);if(k===!1){B=!1;return}typeof k=="object"&&(m=a.extend(m,k)),h=m.title||(d.nodeName?a(d).attr("title"):d.title)||"",d.nodeName&&!m.orig&&(m.orig=a(d).children("img:first").length?a(d).children("img:first"):a(d)),h===""&&m.orig&&m.titleFromAlt&&(h=m.orig.attr("alt")),e=m.href||(d.nodeName?a(d).attr("href"):d.href)||null;if(/^(?:javascript)/i.test(e)||e=="#")e=null;m.type?(f=m.type,e||(e=m.content)):m.content?f="html":e&&(e.match(t)?f="image":e.match(u)?f="swf":a(d).hasClass("iframe")?f="iframe":e.indexOf("#")===0?f="inline":f="ajax");if(!f){F();return}f=="inline"&&(d=e.substr(e.indexOf("#")),f=a(d).length>0?"inline":"ajax"),m.type=f,m.href=e,m.title=h,m.autoDimensions&&(m.type=="html"||m.type=="inline"||m.type=="ajax"?(m.width="auto",m.height="auto"):m.autoDimensions=!1),m.modal&&(m.overlayShow=!0,m.hideOnOverlayClick=!1,m.hideOnContentClick=!1,m.enableEscapeButton=!1,m.showCloseButton=!1),m.padding=parseInt(m.padding,10),m.margin=parseInt(m.margin,10),b.css("padding",m.padding+m.margin),a(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){a(this).replaceWith(g.children())});switch(f){case"html":b.html(m.content),H();break;case"inline":if(a(d).parent().is("#fancybox-content")===!0){B=!1;return}a('<div class="fancybox-inline-tmp" />').hide().insertBefore(a(d)).bind("fancybox-cleanup",function(){a(this).replaceWith(g.children())}).bind("fancybox-cancel",function(){a(this).replaceWith(b.children())}),a(d).appendTo(b),H();break;case"image":B=!1,a.fancybox.showActivity(),s=new Image,s.onerror=function(){F()},s.onload=function(){B=!0,s.onerror=s.onload=null,I()},s.src=e;break;case"swf":m.scrolling="no",i='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+m.width+'" height="'+m.height+'"><param name="movie" value="'+e+'"></param>',j="",a.each(m.swf,function(a,b){i+='<param name="'+a+'" value="'+b+'"></param>',j+=" "+a+'="'+b+'"'}),i+='<embed src="'+e+'" type="application/x-shockwave-flash" width="'+m.width+'" height="'+m.height+'"'+j+"></embed></object>",b.html(i),H();break;case"ajax":B=!1,a.fancybox.showActivity(),m.ajax.win=m.ajax.success,r=a.ajax(a.extend({},m.ajax,{url:e,data:m.ajax.data||{},error:function(a,b,c){a.status>0&&F()},success:function(d,f,g){var h=typeof g=="object"?g:r;if(h.status==200){if(typeof m.ajax.win=="function"){k=m.ajax.win(e,d,f,g);if(k===!1){c.hide();return}if(typeof k=="string"||typeof k=="object")d=k}var i=!1;e.indexOf("#")>0&&(i=/#[a-zA-Z\-_0-9]+/.exec(e),i.length>0&&(i=i[0]));if(!i)b.html(d);else{var j=a("<div>").append(d.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));b.html(a(j).find(i))}H()}}}));break;case"iframe":J()}},H=function(){var c=m.width,d=m.height;c.toString().indexOf("%")>-1?c=parseInt((a(window).width()-m.margin*2)*parseFloat(c)/100,10)+"px":c=c=="auto"?"auto":c+"px",d.toString().indexOf("%")>-1?d=parseInt((a(window).height()-m.margin*2)*parseFloat(d)/100,10)+"px":d=d=="auto"?"auto":d+"px",b.wrapInner('<div style="width:'+c+";height:"+d+";overflow: "+(m.scrolling=="auto"?"auto":m.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>'),m.width=b.width(),m.height=b.height(),J()},I=function(){m.width=s.width,m.height=s.height,a("<img />").attr({id:"fancybox-img",src:s.src,alt:m.title}).appendTo(b),J()},J=function(){var f,r;c.hide();if(e.is(":visible")&&!1===p.onCleanup(q,o,p)){a.event.trigger("fancybox-cancel"),B=!1;return}B=!0,a(g.add(d)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),e.is(":visible")&&p.titlePosition!=="outside"&&e.css("height",e.height()),q=n,o=l,p=m,p.overlayShow?(d.css({"background-color":p.overlayColor,opacity:p.overlayOpacity,cursor:p.hideOnOverlayClick?"pointer":"auto",height:a(document).height()}),d.is(":visible")||(D&&a("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"}),d.show())):d.hide(),A=R(),L();if(e.is(":visible")){a(h.add(j).add(k)).hide(),f=e.position(),z={top:f.top,left:f.left,width:e.width(),height:e.height()},r=z.width==A.width&&z.height==A.height,g.fadeTo(p.changeFade,.3,function(){var c=function(){g.html(b.contents()).fadeTo(p.changeFade,1,N)};a.event.trigger("fancybox-change"),g.empty().removeAttr("filter").css({"border-width":p.padding,width:A.width-p.padding*2,height:m.autoDimensions?"auto":A.height-x-p.padding*2}),r?c():(C.prop=0,a(C).animate({prop:1},{duration:p.changeSpeed,easing:p.easingChange,step:P,complete:c}))});return}e.removeAttr("style"),g.css("border-width",p.padding);if(p.transitionIn=="elastic"){z=T(),g.html(b.contents()),e.show(),p.opacity&&(A.opacity=0),C.prop=0,a(C).animate({prop:1},{duration:p.speedIn,easing:p.easingIn,step:P,complete:N});return}p.titlePosition=="inside"&&x>0&&i.show(),g.css({width:A.width-p.padding*2,height:m.autoDimensions?"auto":A.height-x-p.padding*2}).html(b.contents()),e.css(A).fadeIn(p.transitionIn=="none"?0:p.speedIn,N)},K=function(a){return a&&a.length?p.titlePosition=="float"?'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+a+'</td><td id="fancybox-title-float-right"></td></tr></table>':'<div id="fancybox-title-'+p.titlePosition+'">'+a+"</div>":!1},L=function(){y=p.title||"",x=0,i.empty().removeAttr("style").removeClass();if(p.titleShow===!1){i.hide();return}y=a.isFunction(p.titleFormat)?p.titleFormat(y,q,o,p):K(y);if(!y||y===""){i.hide();return}i.addClass("fancybox-title-"+p.titlePosition).html(y).appendTo("body").show();switch(p.titlePosition){case"inside":i.css({width:A.width-p.padding*2,marginLeft:p.padding,marginRight:p.padding}),x=i.outerHeight(!0),i.appendTo(f),A.height+=x;break;case"over":i.css({marginLeft:p.padding,width:A.width-p.padding*2,bottom:p.padding}).appendTo(f);break;case"float":i.css("left",parseInt((i.width()-A.width-40)/2,10)*-1).appendTo(e);break;default:i.css({width:A.width-p.padding*2,paddingLeft:p.padding,paddingRight:p.padding}).appendTo(e)}i.hide()},M=function(){(p.enableEscapeButton||p.enableKeyboardNav)&&a(document).bind("keydown.fb",function(b){b.keyCode==27&&p.enableEscapeButton?(b.preventDefault(),a.fancybox.close()):(b.keyCode==37||b.keyCode==39)&&p.enableKeyboardNav&&b.target.tagName!=="INPUT"&&b.target.tagName!=="TEXTAREA"&&b.target.tagName!=="SELECT"&&(b.preventDefault(),a.fancybox[b.keyCode==37?"prev":"next"]())});if(!p.showNavArrows){j.hide(),k.hide();return}(p.cyclic&&q.length>1||o!==0)&&j.show(),(p.cyclic&&q.length>1||o!=q.length-1)&&k.show()},N=function(){a.support.opacity||(g.get(0).style.removeAttribute("filter"),e.get(0).style.removeAttribute("filter")),m.autoDimensions&&g.css("height","auto"),e.css("height","auto"),y&&y.length&&i.show(),p.showCloseButton&&h.show(),M(),p.hideOnContentClick&&g.bind("click",a.fancybox.close),p.hideOnOverlayClick&&d.bind("click",a.fancybox.close),a(window).bind("resize.fb",a.fancybox.resize),p.centerOnScroll&&a(window).bind("scroll.fb",a.fancybox.center),p.type=="iframe"&&a('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(a.browser.msie?'allowtransparency="true""':"")+' scrolling="'+m.scrolling+'" src="'+p.href+'"></iframe>').appendTo(g),e.show(),B=!1,a.fancybox.center(),p.onComplete(q,o,p),O()},O=function(){var a,b;q.length-1>o&&(a=q[o+1].href,typeof a!="undefined"&&a.match(t)&&(b=new Image,b.src=a)),o>0&&(a=q[o-1].href,typeof a!="undefined"&&a.match(t)&&(b=new Image,b.src=a))},P=function(a){var b={width:parseInt(z.width+(A.width-z.width)*a,10),height:parseInt(z.height+(A.height-z.height)*a,10),top:parseInt(z.top+(A.top-z.top)*a,10),left:parseInt(z.left+(A.left-z.left)*a,10)};typeof A.opacity!="undefined"&&(b.opacity=a<.5?.5:a),e.css(b),g.css({width:b.width-p.padding*2,height:b.height-x*a-p.padding*2})},Q=function(){return[a(window).width()-p.margin*2,a(window).height()-p.margin*2,a(document).scrollLeft()+p.margin,a(document).scrollTop()+p.margin]},R=function(){var a=Q(),b={},c=p.autoScale,d=p.padding*2,e;return p.width.toString().indexOf("%")>-1?b.width=parseInt(a[0]*parseFloat(p.width)/100,10):b.width=p.width+d,p.height.toString().indexOf("%")>-1?b.height=parseInt(a[1]*parseFloat(p.height)/100,10):b.height=p.height+d,c&&(b.width>a[0]||b.height>a[1])&&(m.type=="image"||m.type=="swf"?(e=p.width/p.height,b.width>a[0]&&(b.width=a[0],b.height=parseInt((b.width-d)/e+d,10)),b.height>a[1]&&(b.height=a[1],b.width=parseInt((b.height-d)*e+d,10))):(b.width=Math.min(b.width,a[0]),b.height=Math.min(b.height,a[1]))),b.top=parseInt(Math.max(a[3]-20,a[3]+(a[1]-b.height-40)*.5),10),b.left=parseInt(Math.max(a[2]-20,a[2]+(a[0]-b.width-40)*.5),10),b},S=function(a){var b=a.offset();return b.top+=parseInt(a.css("paddingTop"),10)||0,b.left+=parseInt(a.css("paddingLeft"),10)||0,b.top+=parseInt(a.css("border-top-width"),10)||0,b.left+=parseInt(a.css("border-left-width"),10)||0,b.width=a.width(),b.height=a.height(),b},T=function(){var b=m.orig?a(m.orig):!1,c={},d,e;return b&&b.length?(d=S(b),c={width:d.width+p.padding*2,height:d.height+p.padding*2,top:d.top-p.padding-20,left:d.left-p.padding-20}):(e=Q(),c={width:p.padding*2,height:p.padding*2,top:parseInt(e[3]+e[1]*.5,10),left:parseInt(e[2]+e[0]*.5,10)}),c},U=function(){if(!c.is(":visible")){clearInterval(v);return}a("div",c).css("top",w*-40+"px"),w=(w+1)%12};a.fn.fancybox=function(b){return a(this).length?(a(this).data("fancybox",a.extend({},b,a.metadata?a(this).metadata():{})).unbind("click.fb").bind("click.fb",function(b){b.preventDefault();if(B)return;B=!0,a(this).blur(),n=[],l=0;var c=a(this).attr("rel")||"";!c||c==""||c==="nofollow"?n.push(this):(n=a("a[rel="+c+"], area[rel="+c+"]"),l=n.index(this)),G();return}),this):this},a.fancybox=function(b){var c;if(B)return;B=!0,c=typeof arguments[1]!="undefined"?arguments[1]:{},n=[],l=parseInt(c.index,10)||0;if(a.isArray(b)){for(var d=0,e=b.length;d<e;d++)typeof b[d]=="object"?a(b[d]).data("fancybox",a.extend({},c,b[d])):b[d]=a({}).data("fancybox",a.extend({content:b[d]},c));n=jQuery.merge(n,b)}else typeof b=="object"?a(b).data("fancybox",a.extend({},c,b)):b=a({}).data("fancybox",a.extend({content:b},c)),n.push(b);if(l>n.length||l<0)l=0;G()},a.fancybox.showActivity=function(){clearInterval(v),c.show(),v=setInterval(U,66)},a.fancybox.hideActivity=function(){c.hide()},a.fancybox.next=function(){return a.fancybox.pos(o+1)},a.fancybox.prev=function(){return a.fancybox.pos(o-1)},a.fancybox.pos=function(a){if(B)return;a=parseInt(a),n=q,a>-1&&a<q.length?(l=a,G()):p.cyclic&&q.length>1&&(l=a>=q.length?0:q.length-1,G());return},a.fancybox.cancel=function(){if(B)return;B=!0,a.event.trigger("fancybox-cancel"),E(),m.onCancel(n,l,m),B=!1},a.fancybox.close=function(){function b(){d.fadeOut("fast"),i.empty().hide(),e.hide(),a.event.trigger("fancybox-cleanup"),g.empty(),p.onClosed(q,o,p),q=m=[],o=l=0,p=m={},B=!1}if(B||e.is(":hidden"))return;B=!0;if(p&&!1===p.onCleanup(q,o,p)){B=!1;return}E(),a(h.add(j).add(k)).hide(),a(g.add(d)).unbind(),a(window).unbind("resize.fb scroll.fb"),a(document).unbind("keydown.fb"),g.find("iframe").attr("src",D&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank"),p.titlePosition!=="inside"&&i.empty(),e.stop();if(p.transitionOut=="elastic"){z=T();var c=e.position();A={top:c.top,left:c.left,width:e.width(),height:e.height()},p.opacity&&(A.opacity=1),i.empty().hide(),C.prop=1,a(C).animate({prop:0},{duration:p.speedOut,easing:p.easingOut,step:P,complete:b})}else e.fadeOut(p.transitionOut=="none"?0:p.speedOut,b)},a.fancybox.resize=function(){d.is(":visible")&&d.css("height",a(document).height()),a.fancybox.center(!0)},a.fancybox.center=function(){var a,b;if(B)return;b=arguments[0]===!0?1:0,a=Q();if(!b&&(e.width()>a[0]||e.height()>a[1]))return;e.stop().animate({top:parseInt(Math.max(a[3]-20,a[3]+(a[1]-g.height()-40)*.5-p.padding)),left:parseInt(Math.max(a[2]-20,a[2]+(a[0]-g.width()-40)*.5-p.padding))},typeof arguments[0]=="number"?arguments[0]:200)},a.fancybox.init=function(){if(a("#fancybox-wrap").length)return;a("body").append(b=a('<div id="fancybox-tmp"></div>'),c=a('<div id="fancybox-loading"><div></div></div>'),d=a('<div id="fancybox-overlay"></div>'),e=a('<div id="fancybox-wrap"></div>')),f=a('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(e),f.append(g=a('<div id="fancybox-content"></div>'),h=a('<a id="fancybox-close"></a>'),i=a('<div id="fancybox-title"></div>'),j=a('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),k=a('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>')),h.click(a.fancybox.close),c.click(a.fancybox.cancel),j.click(function(b){b.preventDefault(),a.fancybox.prev()}),k.click(function(b){b.preventDefault(),a.fancybox.next()}),a.fn.mousewheel&&e.bind("mousewheel.fb",function(b,c){if(B)b.preventDefault();else if(a(b.target).get(0).clientHeight==0||a(b.target).get(0).scrollHeight===a(b.target).get(0).clientHeight)b.preventDefault(),a.fancybox[c>0?"prev":"next"]()}),a.support.opacity||e.addClass("fancybox-ie"),D&&(c.addClass("fancybox-ie6"),e.addClass("fancybox-ie6"),a('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(f))},a.fn.fancybox.defaults={padding:10,margin:40,opacity:!1,modal:!1,cyclic:!1,scrolling:"auto",width:560,height:340,autoScale:!0,autoDimensions:!0,centerOnScroll:!1,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:!0,hideOnContentClick:!1,overlayShow:!0,overlayOpacity:.7,overlayColor:"#777",titleShow:!0,titlePosition:"float",titleFormat:null,titleFromAlt:!1,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:!0,showNavArrows:!0,enableEscapeButton:!0,enableKeyboardNav:!0,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}},a(document).ready(function(){a.fancybox.init()})}(jQuery),define("lib/dist/jquery.fancybox-1.3.4",function(){}),function(a){function c(b){var c=b.data;b.isDefaultPrevented()||(b.preventDefault(),a(this).ajaxSubmit(c))}function d(b){var c=b.target,d=a(c);if(!d.is(":submit,input:image")){var e=d.closest(":submit");if(e.length===0)return;c=e[0]}var f=this;f.clk=c;if(c.type=="image")if(b.offsetX!==undefined)f.clk_x=b.offsetX,f.clk_y=b.offsetY;else if(typeof a.fn.offset=="function"){var g=d.offset();f.clk_x=b.pageX-g.left,f.clk_y=b.pageY-g.top}else f.clk_x=b.pageX-c.offsetLeft,f.clk_y=b.pageY-c.offsetTop;setTimeout(function(){f.clk=f.clk_x=f.clk_y=null},100)}function e(){if(!a.fn.ajaxSubmit.debug)return;var b="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(b):window.opera&&window.opera.postError&&window.opera.postError(b)}var b={};b.fileapi=a("<input type='file'/>").get(0).files!==undefined,b.formdata=window.FormData!==undefined,a.fn.ajaxSubmit=function(c){function v(b){var d=new FormData;for(var e=0;e<b.length;e++)d.append(b[e].name,b[e].value);if(c.extraData)for(var f in c.extraData)c.extraData.hasOwnProperty(f)&&d.append(f,c.extraData[f]);c.data=null;var g=a.extend(!0,{},a.ajaxSettings,c,{contentType:!1,processData:!1,cache:!1,type:"POST"});c.uploadProgress&&(g.xhr=function(){var a=jQuery.ajaxSettings.xhr();return a.upload&&(a.upload.onprogress=function(a){var b=0;a.lengthComputable&&(b=parseInt(a.position/a.total*100,10)),c.uploadProgress(a,a.position,a.total,b)}),a}),g.data=null;var h=g.beforeSend;g.beforeSend=function(a,b){b.data=d,h&&h.call(b,a,c)},a.ajax(g)}function w(b){function z(a){var b=a.contentWindow?a.contentWindow.document:a.contentDocument?a.contentDocument:a.document;return b}function C(){function g(){try{var a=z(n).readyState;e("state = "+a),a&&a.toLowerCase()=="uninitialized"&&setTimeout(g,50)}catch(b){e("Server abort: ",b," (",b.name,")"),H(y),s&&clearTimeout(s),s=undefined}}var b=h.attr("target"),c=h.attr("action");f.setAttribute("target",l),d||f.setAttribute("method","POST"),c!=j.url&&f.setAttribute("action",j.url),!j.skipEncodingOverride&&(!d||/post/i.test(d))&&h.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),j.timeout&&(s=setTimeout(function(){r=!0,H(x)},j.timeout));var i=[];try{if(j.extraData)for(var k in j.extraData)j.extraData.hasOwnProperty(k)&&i.push(a('<input type="hidden" name="'+k+'">').attr("value",j.extraData[k]).appendTo(f)[0]);j.iframeTarget||(m.appendTo("body"),n.attachEvent?n.attachEvent("onload",H):n.addEventListener("load",H,!1)),setTimeout(g,15),u.call(f)}finally{f.setAttribute("action",c),b?f.setAttribute("target",b):h.removeAttr("target"),a(i).remove()}}function H(b){if(o.aborted||G)return;try{E=z(n)}catch(c){e("cannot access response document: ",c),b=y}if(b===x&&o){o.abort("timeout");return}if(b==y&&o){o.abort("server abort");return}if(!E||E.location.href==j.iframeSrc)if(!r)return;n.detachEvent?n.detachEvent("onload",H):n.removeEventListener("load",H,!1);var d="success",f;try{if(r)throw"timeout";var g=j.dataType=="xml"||E.XMLDocument||a.isXMLDoc(E);e("isXml="+g);if(!g&&window.opera&&(E.body===null||!E.body.innerHTML)&&--F){e("requeing onLoad callback, DOM not available"),setTimeout(H,250);return}var i=E.body?E.body:E.documentElement;o.responseText=i?i.innerHTML:null,o.responseXML=E.XMLDocument?E.XMLDocument:E,g&&(j.dataType="xml"),o.getResponseHeader=function(a){var b={"content-type":j.dataType};return b[a]},i&&(o.status=Number(i.getAttribute("status"))||o.status,o.statusText=i.getAttribute("statusText")||o.statusText);var l=(j.dataType||"").toLowerCase(),p=/(json|script|text)/.test(l);if(p||j.textarea){var q=E.getElementsByTagName("textarea")[0];if(q)o.responseText=q.value,o.status=Number(q.getAttribute("status"))||o.status,o.statusText=q.getAttribute("statusText")||o.statusText;else if(p){var t=E.getElementsByTagName("pre")[0],u=E.getElementsByTagName("body")[0];t?o.responseText=t.textContent?t.textContent:t.innerText:u&&(o.responseText=u.textContent?u.textContent:u.innerText)}}else l=="xml"&&!o.responseXML&&o.responseText&&(o.responseXML=I(o.responseText));try{D=K(o,l,j)}catch(b){d="parsererror",o.error=f=b||d}}catch(b){e("error caught: ",b),d="error",o.error=f=b||d}o.aborted&&(e("upload aborted"),d=null),o.status&&(d=o.status>=200&&o.status<300||o.status===304?"success":"error"),d==="success"?(j.success&&j.success.call(j.context,D,"success",o),k&&h.trigger("ajaxSuccess",[o,j,D])):d&&(f===undefined&&(f=o.statusText),j.error&&j.error.call(j.context,o,d,f),k&&h.trigger("ajaxError",[o,j,f])),k&&h.trigger("ajaxComplete",[o,j]),k&&!--a.active&&h.trigger("ajaxStop"),j.complete&&j.complete.call(j.context,o,d),G=!0,j.timeout&&clearTimeout(s),setTimeout(function(){j.iframeTarget||m.remove(),o.responseXML=null},100)}var f=h[0],g,i,j,k,l,m,n,o,p,q,r,s,t=!!a.fn.prop;if(b)if(t)for(i=0;i<b.length;i++)g=a(f[b[i].name]),g.prop("disabled",!1);else for(i=0;i<b.length;i++)g=a(f[b[i].name]),g.removeAttr("disabled");var u;if(a(":input[name=submit],:input[id=submit]",f).length){var v=a(":input[id=submit]",f),w=a(":input[name=submit]",f);v.length&&v.attr({id:"submit_temporarily_renamed"}),w.length&&w.attr({name:"submit_temporarily_renamed"}),u=f.submit,v.length&&v.attr({id:"submit"}),w.length&&w.attr({name:"submit"})}else u=f.submit;j=a.extend(!0,{},a.ajaxSettings,c),j.context=j.context||j,l="jqFormIO"+(new Date).getTime(),j.iframeTarget?(m=a(j.iframeTarget),q=m.attr("name"),q?l=q:m.attr("name",l)):(m=a('<iframe name="'+l+'" src="'+j.iframeSrc+'" />'),m.css({position:"absolute",top:"-1000px",left:"-1000px"})),n=m[0],o={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(b){var c=b==="timeout"?"timeout":"aborted";e("aborting upload... "+c),this.aborted=1,m.attr("src",j.iframeSrc),o.error=c,j.error&&j.error.call(j.context,o,c,b),k&&a.event.trigger("ajaxError",[o,j,c]),j.complete&&j.complete.call(j.context,o,c)}},k=j.global,k&&0===a.active++&&h.trigger("ajaxStart"),k&&h.trigger("ajaxSend",[o,j]);if(j.beforeSend&&j.beforeSend.call(j.context,o,j)===!1){j.global&&a.active--;return}if(o.aborted)return;p=f.clk,p&&(q=p.name,q&&!p.disabled&&(j.extraData=j.extraData||{},j.extraData[q]=p.value,p.type=="image"&&(j.extraData[q+".x"]=f.clk_x,j.extraData[q+".y"]=f.clk_y)));var x=1,y=2,A=a("meta[name=csrf-token]").attr("content"),B=a("meta[name=csrf-param]").attr("content");B&&A&&(j.extraData=j.extraData||{},j.extraData[B]=A),j.forceSync?C():setTimeout(C,10);var D,E,F=50,G,I=a.parseXML||function(a,b){return window.ActiveXObject?(b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a)):b=(new DOMParser).parseFromString(a,"text/xml"),b&&b.documentElement&&b.documentElement.nodeName!="parsererror"?b:null},J=a.parseJSON||function(a){return window.eval("("+a+")")},K=function(b,c,d){var e=b.getResponseHeader("content-type")||"",f=c==="xml"||!c&&e.indexOf("xml")>=0,g=f?b.responseXML:b.responseText;return f&&g.documentElement.nodeName==="parsererror"&&a.error&&a.error("parsererror"),d&&d.dataFilter&&(g=d.dataFilter(g,c)),typeof g=="string"&&(c==="json"||!c&&e.indexOf("json")>=0?g=J(g):(c==="script"||!c&&e.indexOf("javascript")>=0)&&a.globalEval(g)),g}}if(!this.length)return e("ajaxSubmit: skipping submit process - no element selected"),this;var d,f,g,h=this;typeof c=="function"&&(c={success:c}),d=this.attr("method"),f=this.attr("action"),g=typeof f=="string"?a.trim(f):"",g=g||window.location.href||"",g&&(g=(g.match(/^([^#]+)/)||[])[1]),c=a.extend(!0,{url:g,success:a.ajaxSettings.success,type:d||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},c);var i={};this.trigger("form-pre-serialize",[this,c,i]);if(i.veto)return e("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(c.beforeSerialize&&c.beforeSerialize(this,c)===!1)return e("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var j=c.traditional;j===undefined&&(j=a.ajaxSettings.traditional);var k,l=this.formToArray(c.semantic);c.data&&(c.extraData=c.data,k=a.param(c.data,j));if(c.beforeSubmit&&c.beforeSubmit(l,this,c)===!1)return e("ajaxSubmit: submit aborted via beforeSubmit callback"),this;this.trigger("form-submit-validate",[l,this,c,i]);if(i.veto)return e("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var m=a.param(l,j);k&&(m=m?m+"&"+k:k),c.type.toUpperCase()=="GET"?(c.url+=(c.url.indexOf("?")>=0?"&":"?")+m,c.data=null):c.data=m;var n=[];c.resetForm&&n.push(function(){h.resetForm()}),c.clearForm&&n.push(function(){h.clearForm(c.includeHidden)});if(!c.dataType&&c.target){var o=c.success||function(){};n.push(function(b){var d=c.replaceTarget?"replaceWith":"html";a(c.target)[d](b).each(o,arguments)})}else c.success&&n.push(c.success);c.success=function(a,b,d){var e=c.context||c;for(var f=0,g=n.length;f<g;f++)n[f].apply(e,[a,b,d||h,h])};var p=a("input:file:enabled[value]",this),q=p.length>0,r="multipart/form-data",s=h.attr("enctype")==r||h.attr("encoding")==r,t=b.fileapi&&b.formdata;e("fileAPI :"+t);var u=(q||s)&&!t;return c.iframe!==!1&&(c.iframe||u)?c.closeKeepAlive?a.get(c.closeKeepAlive,function(){w(l)}):w(l):(q||s)&&t?v(l):a.ajax(c),this.trigger("form-submit-notify",[this,c]),this},a.fn.ajaxForm=function(b){b=b||{},b.delegation=b.delegation&&a.isFunction(a.fn.on);if(!b.delegation&&this.length===0){var f={s:this.selector,c:this.context};return!a.isReady&&f.s?(e("DOM not ready, queuing ajaxForm"),a(function(){a(f.s,f.c).ajaxForm(b)}),this):(e("terminating; zero elements found by selector"+(a.isReady?"":" (DOM not ready)")),this)}return b.delegation?(a(document).off("submit.form-plugin",this.selector,c).off("click.form-plugin",this.selector,d).on("submit.form-plugin",this.selector,b,c).on("click.form-plugin",this.selector,b,d),this):this.ajaxFormUnbind().bind("submit.form-plugin",b,c).bind("click.form-plugin",b,d)},a.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},a.fn.formToArray=function(c){var d=[];if(this.length===0)return d;var e=this[0],f=c?e.getElementsByTagName("*"):e.elements;if(!f)return d;var g,h,i,j,k,l,m;for(g=0,l=f.length;g<l;g++){k=f[g],i=k.name;if(!i)continue;if(c&&e.clk&&k.type=="image"){!k.disabled&&e.clk==k&&(d.push({name:i,value:a(k).val(),type:k.type}),d.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y}));continue}j=a.fieldValue(k,!0);if(j&&j.constructor==Array)for(h=0,m=j.length;h<m;h++)d.push({name:i,value:j[h]});else if(b.fileapi&&k.type=="file"&&!k.disabled){var n=k.files;for(h=0;h<n.length;h++)d.push({name:i,value:n[h],type:k.type})}else j!==null&&typeof j!="undefined"&&d.push({name:i,value:j,type:k.type})}if(!c&&e.clk){var o=a(e.clk),p=o[0];i=p.name,i&&!p.disabled&&p.type=="image"&&(d.push({name:i,value:o.val()}),d.push({name:i+".x",value:e.clk_x},{name:i+".y",value:e.clk_y}))}return d},a.fn.formSerialize=function(b){return a.param(this.formToArray(b))},a.fn.fieldSerialize=function(b){var c=[];return this.each(function(){var d=this.name;if(!d)return;var e=a.fieldValue(this,b);if(e&&e.constructor==Array)for(var f=0,g=e.length;f<g;f++)c.push({name:d,value:e[f]});else e!==null&&typeof e!="undefined"&&c.push({name:this.name,value:e})}),a.param(c)},a.fn.fieldValue=function(b){for(var c=[],d=0,e=this.length;d<e;d++){var f=this[d],g=a.fieldValue(f,b);if(g===null||typeof g=="undefined"||g.constructor==Array&&!g.length)continue;g.constructor==Array?a.merge(c,g):c.push(g)}return c},a.fieldValue=function(b,c){var d=b.name,e=b.type,f=b.tagName.toLowerCase();c===undefined&&(c=!0);if(c&&(!d||b.disabled||e=="reset"||e=="button"||(e=="checkbox"||e=="radio")&&!b.checked||(e=="submit"||e=="image")&&b.form&&b.form.clk!=b||f=="select"&&b.selectedIndex==-1))return null;if(f=="select"){var g=b.selectedIndex;if(g<0)return null;var h=[],i=b.options,j=e=="select-one",k=j?g+1:i.length;for(var l=j?g:0;l<k;l++){var m=i[l];if(m.selected){var n=m.value;n||(n=m.attributes&&m.attributes.value&&!m.attributes.value.specified?m.text:m.value);if(j)return n;h.push(n)}}return h}return a(b).val()},a.fn.clearForm=function(b){return this.each(function(){a("input,select,textarea",this).clearFields(b)})},a.fn.clearFields=a.fn.clearInputs=function(a){var b=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var c=this.type,d=this.tagName.toLowerCase();b.test(c)||d=="textarea"||a&&/hidden/.test(c)?this.value="":c=="checkbox"||c=="radio"?this.checked=!1:d=="select"&&(this.selectedIndex=-1)})},a.fn.resetForm=function(){return this.each(function(){(typeof this.reset=="function"||typeof this.reset=="object"&&!this.reset.nodeType)&&this.reset()})},a.fn.enable=function(a){return a===undefined&&(a=!0),this.each(function(){this.disabled=!a})},a.fn.selected=function(b){return b===undefined&&(b=!0),this.each(function(){var c=this.type;if(c=="checkbox"||c=="radio")this.checked=b;else if(this.tagName.toLowerCase()=="option"){var d=a(this).parent("select");b&&d[0]&&d[0].type=="select-one"&&d.find("option").selected(!1),this.selected=b}})},a.fn.ajaxSubmit.debug=!1}(jQuery),define("lib/jquery.form/jquery.form",function(){}),function(a){var b={vertical:!1,rtl:!1,start:1,offset:1,size:null,scroll:3,visible:null,animation:"normal",easing:"swing",auto:0,wrap:null,initCallback:null,setupCallback:null,reloadCallback:null,itemLoadCallback:null,itemFirstInCallback:null,itemFirstOutCallback:null,itemLastInCallback:null,itemLastOutCallback:null,itemVisibleInCallback:null,itemVisibleOutCallback:null,animationStepCallback:null,buttonNextHTML:"<div></div>",buttonPrevHTML:"<div></div>",buttonNextEvent:"click",buttonPrevEvent:"click",buttonNextCallback:null,buttonPrevCallback:null,itemFallbackDimension:null},c=!1;a(window).bind("load.jcarousel",function(){c=!0}),a.jcarousel=function(d,e){this.options=a.extend({},b,e||{}),this.autoStopped=this.locked=!1,this.buttonPrevState=this.buttonNextState=this.buttonPrev=this.buttonNext=this.list=this.clip=this.container=null;if(!e||e.rtl===void 0)this.options.rtl=(a(d).attr("dir")||a("html").attr("dir")||"").toLowerCase()=="rtl";this.wh=this.options.vertical?"height":"width",this.lt=this.options.vertical?"top":this.options.rtl?"right":"left";for(var f="",h=d.className.split(" "),i=0;i<h.length;i++)if(h[i].indexOf("jcarousel-skin")!=-1){a(d).removeClass(h[i]),f=h[i];break}d.nodeName.toUpperCase()=="UL"||d.nodeName.toUpperCase()=="OL"?(this.list=a(d),this.clip=this.list.parents(".jcarousel-clip"),this.container=this.list.parents(".jcarousel-container")):(this.container=a(d),this.list=this.container.find("ul,ol").eq(0),this.clip=this.container.find(".jcarousel-clip")),this.clip.size()===0&&(this.clip=this.list.wrap("<div></div>").parent()),this.container.size()===0&&(this.container=this.clip.wrap("<div></div>").parent()),f!==""&&this.container.parent()[0].className.indexOf("jcarousel-skin")==-1&&this.container.wrap('<div class=" '+f+'"></div>'),this.buttonPrev=a(".jcarousel-prev",this.container),this.buttonPrev.size()===0&&this.options.buttonPrevHTML!==null&&(this.buttonPrev=a(this.options.buttonPrevHTML).appendTo(this.container)),this.buttonPrev.addClass(this.className("jcarousel-prev")),this.buttonNext=a(".jcarousel-next",this.container),this.buttonNext.size()===0&&this.options.buttonNextHTML!==null&&(this.buttonNext=a(this.options.buttonNextHTML).appendTo(this.container)),this.buttonNext.addClass(this.className("jcarousel-next")),this.clip.addClass(this.className("jcarousel-clip")).css({position:"relative"}),this.list.addClass(this.className("jcarousel-list")).css({overflow:"hidden",position:"relative",top:0,margin:0,padding:0}).css(this.options.rtl?"right":"left",0),this.container.addClass(this.className("jcarousel-container")).css({position:"relative"}),!this.options.vertical&&this.options.rtl&&this.container.addClass("jcarousel-direction-rtl").attr("dir","rtl");var j=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,f=this.list.children("li"),k=this;if(f.size()>0){var l=0,n=this.options.offset;f.each(function(){k.format(this,n++),l+=k.dimension(this,j)}),this.list.css(this.wh,l+100+"px");if(!e||e.size===void 0)this.options.size=f.size()}this.container.css("display","block"),this.buttonNext.css("display","block"),this.buttonPrev.css("display","block"),this.funcNext=function(){k.next()},this.funcPrev=function(){k.prev()},this.funcResize=function(){k.resizeTimer&&clearTimeout(k.resizeTimer),k.resizeTimer=setTimeout(function(){k.reload()},100)},this.options.initCallback!==null&&this.options.initCallback(this,"init"),!c&&a.browser.safari?(this.buttons(!1,!1),a(window).bind("load.jcarousel",function(){k.setup()})):this.setup()};var d=a.jcarousel;d.fn=d.prototype={jcarousel:"0.2.8"},d.fn.extend=d.extend=a.extend,d.fn.extend({setup:function(){this.prevLast=this.prevFirst=this.last=this.first=null,this.animating=!1,this.tail=this.resizeTimer=this.timer=null,this.inTail=!1;if(!this.locked){this.list.css(this.lt,this.pos(this.options.offset)+"px");var b=this.pos(this.options.start,!0);this.prevFirst=this.prevLast=null,this.animate(b,!1),a(window).unbind("resize.jcarousel",this.funcResize).bind("resize.jcarousel",this.funcResize),this.options.setupCallback!==null&&this.options.setupCallback(this)}},reset:function(){this.list.empty(),this.list.css(this.lt,"0px"),this.list.css(this.wh,"10px"),this.options.initCallback!==null&&this.options.initCallback(this,"reset"),this.setup()},reload:function(){this.tail!==null&&this.inTail&&this.list.css(this.lt,d.intval(this.list.css(this.lt))+this.tail),this.tail=null,this.inTail=!1,this.options.reloadCallback!==null&&this.options.reloadCallback(this);if(this.options.visible!==null){var a=this,b=Math.ceil(this.clipping()/this.options.visible),c=0,e=0;this.list.children("li").each(function(d){c+=a.dimension(this,b),d+1<a.first&&(e=c)}),this.list.css(this.wh,c+"px"),this.list.css(this.lt,-e+"px")}this.scroll(this.first,!1)},lock:function(){this.locked=!0,this.buttons()},unlock:function(){this.locked=!1,this.buttons()},size:function(a){return a!==void 0&&(this.options.size=a,this.locked||this.buttons()),this.options.size},has:function(a,b){if(b===void 0||!b)b=a;this.options.size!==null&&b>this.options.size&&(b=this.options.size);for(var c=a;c<=b;c++){var d=this.get(c);if(!d.length||d.hasClass("jcarousel-item-placeholder"))return!1}return!0},get:function(b){return a(">.jcarousel-item-"+b,this.list)},add:function(b,c){var e=this.get(b),h=0,i=a(c);if(e.length===0){for(var j,k=d.intval(b),e=this.create(b);;)if(j=this.get(--k),k<=0||j.length){k<=0?this.list.prepend(e):j.after(e);break}}else h=this.dimension(e);return i.get(0).nodeName.toUpperCase()=="LI"?(e.replaceWith(i),e=i):e.empty().append(c),this.format(e.removeClass(this.className("jcarousel-item-placeholder")),b),i=this.options.visible!==null?Math.ceil(this.clipping()/this.options.visible):null,h=this.dimension(e,i)-h,b>0&&b<this.first&&this.list.css(this.lt,d.intval(this.list.css(this.lt))-h+"px"),this.list.css(this.wh,d.intval(this.list.css(this.wh))+h+"px"),e},remove:function(a){var b=this.get(a);if(b.length&&!(a>=this.first&&a<=this.last)){var c=this.dimension(b);a<this.first&&this.list.css(this.lt,d.intval(this.list.css(this.lt))+c+"px"),b.remove(),this.list.css(this.wh,d.intval(this.list.css(this.wh))-c+"px")}},next:function(){this.tail!==null&&!this.inTail?this.scrollTail(!1):this.scroll(this.options.wrap!="both"&&this.options.wrap!="last"||this.options.size===null||this.last!=this.options.size?this.first+this.options.scroll:1)},prev:function(){this.tail!==null&&this.inTail?this.scrollTail(!0):this.scroll(this.options.wrap!="both"&&this.options.wrap!="first"||this.options.size===null||this.first!=1?this.first-this.options.scroll:this.options.size)},scrollTail:function(a){if(!this.locked&&!this.animating&&this.tail){this.pauseAuto();var b=d.intval(this.list.css(this.lt)),b=a?b+this.tail:b-this.tail;this.inTail=!a,this.prevFirst=this.first,this.prevLast=this.last,this.animate(b)}},scroll:function(a,b){!this.locked&&!this.animating&&(this.pauseAuto(),this.animate(this.pos(a),b))},pos:function(a,b){var c=d.intval(this.list.css(this.lt));if(this.locked||this.animating)return c;this.options.wrap!="circular"&&(a=a<1?1:this.options.size&&a>this.options.size?this.options.size:a);for(var e=this.first>a,g=this.options.wrap!="circular"&&this.first<=1?1:this.first,h=e?this.get(g):this.get(this.last),i=e?g:g-1,j=null,k=0,l=!1,m=0;e?--i>=a:++i<a;)j=this.get(i),l=!j.length,j.length===0&&(j=this.create(i).addClass(this.className("jcarousel-item-placeholder")),h[e?"before":"after"](j),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(i<=0||i>this.options.size))&&(h=this.get(this.index(i)),h.length&&(j=this.add(i,h.clone(!0)))),h=j,m=this.dimension(j),l&&(k+=m),this.first!==null&&(this.options.wrap=="circular"||i>=1&&(this.options.size===null||i<=this.options.size))&&(c=e?c+m:c-m);for(var g=this.clipping(),n=[],o=0,p=0,h=this.get(a-1),i=a;++o;){j=this.get(i),l=!j.length,j.length===0&&(j=this.create(i).addClass(this.className("jcarousel-item-placeholder")),h.length===0?this.list.prepend(j):h[e?"before":"after"](j),this.first!==null&&this.options.wrap=="circular"&&this.options.size!==null&&(i<=0||i>this.options.size)&&(h=this.get(this.index(i)),h.length&&(j=this.add(i,h.clone(!0))))),h=j,m=this.dimension(j);if(m===0)throw Error("jCarousel: No width/height set for items. This will cause an infinite loop. Aborting...");this.options.wrap!="circular"&&this.options.size!==null&&i>this.options.size?n.push(j):l&&(k+=m),p+=m;if(p>=g)break;i++}for(j=0;j<n.length;j++)n[j].remove();k>0&&(this.list.css(this.wh,this.dimension(this.list)+k+"px"),e&&(c-=k,this.list.css(this.lt,d.intval(this.list.css(this.lt))-k+"px"))),k=a+o-1,this.options.wrap!="circular"&&this.options.size&&k>this.options.size&&(k=this.options.size);if(i>k){o=0,i=k;for(p=0;++o;){j=this.get(i--);if(!j.length)break;p+=this.dimension(j);if(p>=g)break}}i=k-o+1,this.options.wrap!="circular"&&i<1&&(i=1),this.inTail&&e&&(c+=this.tail,this.inTail=!1),this.tail=null,this.options.wrap!="circular"&&k==this.options.size&&k-o+1>=1&&(e=d.intval(this.get(k).css(this.options.vertical?"marginBottom":"marginRight")),p-e>g)&&(this.tail=p-g-e),b&&a===this.options.size&&this.tail&&(c-=this.tail,this.inTail=!0);for(;a-->i;)c+=this.dimension(this.get(a));return this.prevFirst=this.first,this.prevLast=this.last,this.first=i,this.last=k,c},animate:function(b,c){if(!this.locked&&!this.animating){this.animating=!0;var d=this,e=function(){d.animating=!1,b===0&&d.list.css(d.lt,0),!d.autoStopped&&(d.options.wrap=="circular"||d.options.wrap=="both"||d.options.wrap=="last"||d.options.size===null||d.last<d.options.size||d.last==d.options.size&&d.tail!==null&&!d.inTail)&&d.startAuto(),d.buttons(),d.notify("onAfterAnimation");if(d.options.wrap=="circular"&&d.options.size!==null)for(var a=d.prevFirst;a<=d.prevLast;a++)a!==null&&!(a>=d.first&&a<=d.last)&&(a<1||a>d.options.size)&&d.remove(a)};this.notify("onBeforeAnimation");if(!this.options.animation||c===!1)this.list.css(this.lt,b+"px"),e();else{var f=this.options.vertical?{top:b}:this.options.rtl?{right:b}:{left:b},e={duration:this.options.animation,easing:this.options.easing,complete:e};a.isFunction(this.options.animationStepCallback)&&(e.step=this.options.animationStepCallback),this.list.animate(f,e)}}},startAuto:function(a){a!==void 0&&(this.options.auto=a);if(this.options.auto===0)return this.stopAuto();if(this.timer===null){this.autoStopped=!1;var b=this;this.timer=window.setTimeout(function(){b.next()},this.options.auto*1e3)}},stopAuto:function(){this.pauseAuto(),this.autoStopped=!0},pauseAuto:function(){this.timer!==null&&(window.clearTimeout(this.timer),this.timer=null)},buttons:function(a,b){a==null&&(a=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="first"||this.options.size===null||this.last<this.options.size),!this.locked&&(!this.options.wrap||this.options.wrap=="first")&&this.options.size!==null&&this.last>=this.options.size)&&(a=this.tail!==null&&!this.inTail),b==null&&(b=!this.locked&&this.options.size!==0&&(this.options.wrap&&this.options.wrap!="last"||this.first>1),!this.locked&&(!this.options.wrap||this.options.wrap=="last")&&this.options.size!==null&&this.first==1)&&(b=this.tail!==null&&this.inTail);var c=this;this.buttonNext.size()>0?(this.buttonNext.unbind(this.options.buttonNextEvent+".jcarousel",this.funcNext),a&&this.buttonNext.bind(this.options.buttonNextEvent+".jcarousel",this.funcNext),this.buttonNext[a?"removeClass":"addClass"](this.className("jcarousel-next-disabled")).attr("disabled",a?!1:!0),this.options.buttonNextCallback!==null&&this.buttonNext.data("jcarouselstate")!=a&&this.buttonNext.each(function(){c.options.buttonNextCallback(c,this,a)}).data("jcarouselstate",a)):this.options.buttonNextCallback!==null&&this.buttonNextState!=a&&this.options.buttonNextCallback(c,null,a),this.buttonPrev.size()>0?(this.buttonPrev.unbind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),b&&this.buttonPrev.bind(this.options.buttonPrevEvent+".jcarousel",this.funcPrev),this.buttonPrev[b?"removeClass":"addClass"](this.className("jcarousel-prev-disabled")).attr("disabled",b?!1:!0),this.options.buttonPrevCallback!==null&&this.buttonPrev.data("jcarouselstate")!=b&&this.buttonPrev.each(function(){c.options.buttonPrevCallback(c,this,b)}).data("jcarouselstate",b)):this.options.buttonPrevCallback!==null&&this.buttonPrevState!=b&&this.options.buttonPrevCallback(c,null,b),this.buttonNextState=a,this.buttonPrevState=b},notify:function(a){var b=this.prevFirst===null?"init":this.prevFirst<this.first?"next":"prev";this.callback("itemLoadCallback",a,b),this.prevFirst!==this.first&&(this.callback("itemFirstInCallback",a,b,this.first),this.callback("itemFirstOutCallback",a,b,this.prevFirst)),this.prevLast!==this.last&&(this.callback("itemLastInCallback",a,b,this.last),this.callback("itemLastOutCallback",a,b,this.prevLast)),this.callback("itemVisibleInCallback",a,b,this.first,this.last,this.prevFirst,this.prevLast),this.callback("itemVisibleOutCallback",a,b,this.prevFirst,this.prevLast,this.first,this.last)},callback:function(b,c,d,e,f,h,i){if(this.options[b]!=null&&(typeof this.options[b]=="object"||c=="onAfterAnimation")){var j=typeof this.options[b]=="object"?this.options[b][c]:this.options[b];if(a.isFunction(j)){var k=this;if(e===void 0)j(k,d,c);else if(f===void 0)this.get(e).each(function(){j(k,this,e,d,c)});else for(var b=function(a){k.get(a).each(function(){j(k,this,a,d,c)})},l=e;l<=f;l++)l!==null&&!(l>=h&&l<=i)&&b(l)}}},create:function(a){return this.format("<li></li>",a)},format:function(b,c){for(var b=a(b),d=b.get(0).className.split(" "),e=0;e<d.length;e++)d[e].indexOf("jcarousel-")!=-1&&b.removeClass(d[e]);return b.addClass(this.className("jcarousel-item")).addClass(this.className("jcarousel-item-"+c)).css({"float":this.options.rtl?"right":"left","list-style":"none"}).attr("jcarouselindex",c),b},className:function(a){return a+" "+a+(this.options.vertical?"-vertical":"-horizontal")},dimension:function(b,c){var e=a(b);if(c==null)return this.options.vertical?e.outerHeight(!0)||d.intval(this.options.itemFallbackDimension):e.outerWidth(!0)||d.intval(this.options.itemFallbackDimension);var h=this.options.vertical?c-d.intval(e.css("marginTop"))-d.intval(e.css("marginBottom")):c-d.intval(e.css("marginLeft"))-d.intval(e.css("marginRight"));return a(e).css(this.wh,h+"px"),this.dimension(e)},clipping:function(){return this.options.vertical?this.clip[0].offsetHeight-d.intval(this.clip.css("borderTopWidth"))-d.intval(this.clip.css("borderBottomWidth")):this.clip[0].offsetWidth-d.intval(this.clip.css("borderLeftWidth"))-d.intval(this.clip.css("borderRightWidth"))},index:function(a,b){return b==null&&(b=this.options.size),Math.round(((a-1)/b-Math.floor((a-1)/b))*b)+1}}),d.extend({defaults:function(c){return a.extend(b,c||{})},intval:function(a){return a=parseInt(a,10),isNaN(a)?0:a},windowLoaded:function(){c=!0}}),a.fn.jcarousel=function(b){if(typeof b=="string"){var c=a(this).data("jcarousel"),e=Array.prototype.slice.call(arguments,1);return c[b].apply(c,e)}return this.each(function(){var c=a(this).data("jcarousel");c?(b&&a.extend(c.options,b),c.reload()):a(this).data("jcarousel",new d(this,b))})}}(jQuery),define("lib/dist/jquery.jcarousel.min",function(){}),function(a,b){function c(a,b){return(new Date(a,b+1,0)).getDate()}function d(a,b){a=""+a,b=b||2;while(a.length<b)a="0"+a;return a}function e(a,b,c){var e=a.getDate(),f=a.getDay(),g=a.getMonth(),h=a.getFullYear(),i={d:e,dd:d(e),ddd:m[c].shortDays[f],dddd:m[c].days[f],m:g+1,mm:d(g+1),mmm:m[c].shortMonths[g],mmmm:m[c].months[g],yy:String(h).slice(2),yyyy:h},j=b.replace(n,function(a){return a in i?i[a]:a.slice(1,a.length-1)});return o.html(j).html()}function f(a){return parseInt(a,10)}function g(a,b){return a.getFullYear()===b.getFullYear()&&a.getMonth()==b.getMonth()&&a.getDate()==b.getDate()}function h(a){if(a===b)return;if(a.constructor==Date)return a;if(typeof a=="string"){var c=a.split("-");if(c.length==3)return new Date(f(c[0]),f(c[1])-1,f(c[2]));if(!/^-?\d+$/.test(a))return;a=f(a)}var d=new Date;return d.setDate(d.getDate()+a),d}function i(d,i){function k(b,c,f){B=b,y=b.getFullYear(),z=b.getMonth(),A=b.getDate(),f=f||a.Event("api"),f.type="beforeChange",I.trigger(f,[b]);if(f.isDefaultPrevented())return;d.val(e(b,c.format,c.lang)),f.type="change",I.trigger(f),d.data("date",b),o.hide(f)}function n(b){b.type="onShow",I.trigger(b),a(document).bind("keydown.d",function(b){if(b.ctrlKey)return!0;var c=b.keyCode;if(c==8)return d.val(""),o.hide(b);if(c==27||c==9)return o.hide(b);if(a(l).index(c)>=0){if(!E)return o.show(b),b.preventDefault();var e=a("#"+r.weeks+" a"),f=a("."+r.focus),g=e.index(f);f.removeClass(r.focus);if(c==74||c==40)g+=7;else if(c==75||c==38)g-=7;else if(c==76||c==39)g+=1;else if(c==72||c==37)g-=1;return g>41?(o.addMonth(),f=a("#"+r.weeks+" a:eq("+(g-42)+")")):g<0?(o.addMonth(-1),f=a("#"+r.weeks+" a:eq("+(g+42)+")")):f=e.eq(g),f.addClass(r.focus),b.preventDefault()}return c==34?o.addMonth():c==33?o.addMonth(-1):c==36?o.today():(c==13&&(a(b.target).is("select")||a("."+r.focus).click()),a([16,17,18,9]).index(c)>=0)}),a(document).bind("click.d",function(b){var c=b.target;!a(c).parents("#"+r.root).length&&c!=d[0]&&(!v||c!=v[0])&&o.hide(b)})}var o=this,p=new Date,q=p.getFullYear(),r=i.css,s=m[i.lang],t=a("#"+r.root),u=t.find("#"+r.title),v,w,x,y,z,A,B=d.attr("data-value")||i.value||d.val(),C=d.attr("min")||i.min,D=d.attr("max")||i.max,E,F;C===0&&(C="0"),B=h(B)||p,C=h(C||new Date(q+i.yearRange[0],1,1)),D=h(D||new Date(q+i.yearRange[1]+1,1,-1));if(!s)throw"Dateinput: invalid language: "+i.lang;if(d.attr("type")=="date"){var F=d.clone(),G=F.wrap("<div/>").parent().html(),H=a(G.replace(/type/i,"type=text data-orig-type"));i.value&&H.val(i.value),d.replaceWith(H),d=H}d.addClass(r.input);var I=d.add(o);if(!t.length){t=a("<div><div><a/><div/><a/></div><div><div/><div/></div></div>").hide().css({position:"absolute"}).attr("id",r.root),t.children().eq(0).attr("id",r.head).end().eq(1).attr("id",r.body).children().eq(0).attr("id",r.days).end().eq(1).attr("id",r.weeks).end().end().end().find("a").eq(0).attr("id",r.prev).end().eq(1).attr("id",r.next),u=t.find("#"+r.head).find("div").attr("id",r.title);if(i.selectors){var J=a("<select/>").attr("id",r.month),K=a("<select/>").attr("id",r.year);u.html(J.add(K))}var L=t.find("#"+r.days);for(var M=0;M<7;M++)L.append(a("<span/>").text(s.shortDays[(M+i.firstDay)%7]));a("body").append(t)}i.trigger&&(v=a("<a/>").attr("href","#").addClass(r.trigger).click(function(a){return i.toggle?o.toggle():o.show(),a.preventDefault()}).insertAfter(d));var N=t.find("#"+r.weeks);K=t.find("#"+r.year),J=t.find("#"+r.month),a.extend(o,{show:function(b){if(d.attr("readonly")||d.attr("disabled")||E)return;b=b||a.Event(),b.type="onBeforeShow",I.trigger(b);if(b.isDefaultPrevented())return;a.each(j,function(){this.hide()}),E=!0,J.unbind("change").change(function(){o.setValue(K.val(),a(this).val())}),K.unbind("change").change(function(){o.setValue(a(this).val(),J.val())}),w=t.find("#"+r.prev).unbind("click").click(function(a){return w.hasClass(r.disabled)||o.addMonth(-1),!1}),x=t.find("#"+r.next).unbind("click").click(function(a){return x.hasClass(r.disabled)||o.addMonth(),!1}),o.setValue(B);var c=d.offset();return/iPad/i.test(navigator.userAgent)&&(c.top-=a(window).scrollTop()),t.css({top:c.top+d.outerHeight({margins:!0})+i.offset[0],left:c.left+i.offset[1]}),i.speed?t.show(i.speed,function(){n(b)}):(t.show(),n(b)),o},setValue:function(d,e,j){var l=f(e)>=-1?new Date(f(d),f(e),f(j==b||isNaN(j)?1:j)):d||B;l<C?l=C:l>D&&(l=D),typeof d=="string"&&(l=h(d)),d=l.getFullYear(),e=l.getMonth(),j=l.getDate(),e==-1?(e=11,d--):e==12&&(e=0,d++);if(!E)return k(l,i),o;z=e,y=d,A=j;var m=new Date(d,e,1-i.firstDay),n=m.getDay(),q=c(d,e),t=c(d,e-1),v;if(i.selectors){J.empty(),a.each(s.months,function(b,c){C<new Date(d,b+1,1)&&D>new Date(d,b,0)&&J.append(a("<option/>").html(c).attr("value",b))}),K.empty();var F=p.getFullYear();for(var G=F+i.yearRange[0];G<F+i.yearRange[1];G++)C<new Date(G+1,0,1)&&D>new Date(G,0,0)&&K.append(a("<option/>").text(G));J.val(e),K.val(d)}else u.html(s.months[e]+" "+d);N.empty(),w.add(x).removeClass(r.disabled);for(var H=n?0:-7,I,L;H<(n?42:35);H++)I=a("<a/>"),H%7===0&&(v=a("<div/>").addClass(r.week),N.append(v)),H<n?(I.addClass(r.off),L=t-n+H+1,l=new Date(d,e-1,L)):H>=n+q?(I.addClass(r.off),L=H-q-n+1,l=new Date(d,e+1,L)):(L=H-n+1,l=new Date(d,e,L),g(B,l)?I.attr("id",r.current).addClass(r.focus):g(p,l)&&I.attr("id",r.today)),C&&l<C&&I.add(w).addClass(r.disabled),D&&l>D&&I.add(x).addClass(r.disabled),I.attr("href","#"+L).text(L).data("date",l),v.append(I);return N.find("a").click(function(b){var c=a(this);return c.hasClass(r.disabled)||(a("#"+r.current).removeAttr("id"),c.attr("id",r.current),k(c.data("date"),i,b)),!1}),r.sunday&&N.find(r.week).each(function(){var b=i.firstDay?7-i.firstDay:0;a(this).children().slice(b,b+1).addClass(r.sunday)}),o},setMin:function(a,b){return C=h(a),b&&B<C&&o.setValue(C),o},setMax:function(a,b){return D=h(a),b&&B>D&&o.setValue(D),o},today:function(){return o.setValue(p)},addDay:function(a){return this.setValue(y,z,A+(a||1))},addMonth:function(a){var b=z+(a||1),d=c(y,b),e=A<=d?A:d;return this.setValue(y,b,e)},addYear:function(a){return this.setValue(y+(a||1),z,A)},destroy:function(){d.add(document).unbind("click.d").unbind("keydown.d"),t.add(v).remove(),d.removeData("dateinput").removeClass(r.input),F&&d.replaceWith(F)},hide:function(b){if(E){b=a.Event(),b.type="onHide",I.trigger(b),a(document).unbind("click.d").unbind("keydown.d");if(b.isDefaultPrevented())return;t.hide(),E=!1}return o},toggle:function(){return o.isOpen()?o.hide():o.show()},getConf:function(){return i},getInput:function(){return d},getCalendar:function(){return t},getValue:function(a){return a?e(B,a,i.lang):B},isOpen:function(){return E}}),a.each(["onBeforeShow","onShow","change","onHide"],function(b,c){a.isFunction(i[c])&&a(o).bind(c,i[c]),o[c]=function(b){return b&&a(o).bind(c,b),o}}),i.editable||d.bind("focus.d click.d",o.show).keydown(function(b){var c=b.keyCode;return!E&&a(l).index(c)>=0?(o.show(b),b.preventDefault()):b.shiftKey||b.ctrlKey||b.altKey||c==9?!0:b.preventDefault()}),h(d.val())&&k(B,i)}a.tools=a.tools||{version:"1.2.6"};var j=[],k,l=[75,76,38,39,74,72,40,37],m={};k=a.tools.dateinput={conf:{format:"mm/dd/yy",selectors:!1,yearRange:[-5,5],lang:"en",offset:[0,0],speed:0,firstDay:0,min:b,max:b,trigger:0,toggle:0,editable:0,css:{prefix:"cal",input:"date",root:0,head:0,title:0,prev:0,next:0,month:0,year:0,days:0,body:0,weeks:0,today:0,current:0,week:0,off:0,sunday:0,focus:0,disabled:0,trigger:0}},localize:function(b,c){a.each(c,function(a,b){c[a]=b.split(",")}),m[b]=c}},k.localize("en",{months:"January,February,March,April,May,June,July,August,September,October,November,December",shortMonths:"Jan,Feb,Mar,Apr,May,Jun,Jul,Aug,Sep,Oct,Nov,Dec",days:"Sunday,Monday,Tuesday,Wednesday,Thursday,Friday,Saturday",shortDays:"Sun,Mon,Tue,Wed,Thu,Fri,Sat"});var n=/d{1,4}|m{1,4}|yy(?:yy)?|"[^"]*"|'[^']*'/g,o=a("<a/>");a.expr[":"].date=function(b){var c=b.getAttribute("type");return c&&c=="date"||!!a(b).data("dateinput")},a.fn.dateinput=function(b){if(this.data("dateinput"))return this;b=a.extend(!0,{},k.conf,b),a.each(b.css,function(a,c){!c&&a!="prefix"&&(b.css[a]=(b.css.prefix||"")+(c||a))});var c;return this.each(function(){var d=new i(a(this),b);j.push(d);var e=d.getInput().data("dateinput",d);c=c?c.add(e):e}),c?c:this}}(jQuery),function(a){function b(b,e){var f=this,g=b.add(f),h=a(window),i,j,k,l=a.tools.expose&&(e.mask||e.expose),m=Math.random().toString().slice(10);l&&(typeof l=="string"&&(l={color:l}),l.closeOnClick=l.closeOnEsc=!1);var n=e.target||b.attr("rel");j=n?a(n):b;if(!j.length)throw"Could not find Overlay: "+n;b&&b.index(j)==-1&&b.click(function(a){return f.load(a),a.preventDefault()}),a.extend(f,{load:function(b){if(f.isOpened())return f;var i=d[e.effect];if(!i)throw'Overlay: cannot find effect : "'+e.effect+'"';e.oneInstance&&a.each(c,function(){this.close(b)}),b=b||a.Event(),b.type="onBeforeLoad",g.trigger(b);if(b.isDefaultPrevented())return f;k=!0,l&&a(j).expose(l);var n=e.top,o=e.left,p=j.outerWidth({margin:!0}),q=j.outerHeight({margin:!0});return typeof n=="string"&&(n=n=="center"?Math.max((h.height()-q)/2,0):parseInt(n,10)/100*h.height()),o=="center"&&(o=Math.max((h.width()-p)/2,0)),i[0].call(f,{top:n,left:o},function(){k&&(b.type="onLoad",g.trigger(b))}),l&&e.closeOnClick&&a.mask.getMask().one("click",f.close),e.closeOnClick&&a(document).bind("click."+m,function(b){a(b.target).parents(j).length||f.close(b)}),e.closeOnEsc&&a(document).bind("keydown."+m,function(a){a.keyCode==27&&f.close(a)}),f},close:function(b){if(!f.isOpened())return f;b=b||a.Event(),b.type="onBeforeClose",g.trigger(b);if(b.isDefaultPrevented())return;return k=!1,d[e.effect][1].call(f,function(){b.type="onClose",g.trigger(b)}),a(document).unbind("click."+m).unbind("keydown."+m),l&&a.mask.close(),f},getOverlay:function(){return j},getTrigger:function(){return b},getClosers:function(){return i},isOpened:function(){return k},getConf:function(){return e}}),a.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){return b&&a(f).bind(c,b),f}}),i=j.find(e.close||".close"),!i.length&&!e.close&&(i=a('<a class="close"></a>'),j.prepend(i)),i.click(function(a){f.close(a)}),e.load&&f.load()}a.tools=a.tools||{version:"1.2.6"},a.tools.overlay={addEffect:function(a,b,c){d[a]=[b,c]},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!a.browser.msie||a.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var c=[],d={};a.tools.overlay.addEffect("default",function(b,c){var d=this.getConf(),e=a(window);d.fixed||(b.top+=e.scrollTop(),b.left+=e.scrollLeft()),b.position=d.fixed?"fixed":"absolute",this.getOverlay().css(b).fadeIn(d.speed,c)},function(a){this.getOverlay().fadeOut(this.getConf().closeSpeed,a)}),a.fn.overlay=function(d){var e=this.data("overlay");return e?e:(a.isFunction(d)&&(d={onBeforeLoad:d}),d=a.extend(!0,{},a.tools.overlay.conf,d),this.each(function(){e=new b(a(this),d),c.push(e),a(this).data("overlay",e)}),d.api?e:this)}}(jQuery),function(a){function b(a){var b=a.offset();return{top:b.top+a.height()/2,left:b.left+a.width()/2}}var c=a.tools.overlay,d=a(window);a.extend(c.conf,{start:{top:null,left:null},fadeInSpeed:"fast",zIndex:9999});var e=function(c,e){var f=this.getOverlay(),g=this.getConf(),h=this.getTrigger(),i=this,j=f.outerWidth({margin:!0}),k=f.data("img"),l=g.fixed?"fixed":"absolute";if(!k){var m=f.css("backgroundImage");if(!m)throw"background-image CSS property not set for overlay";m=m.slice(m.indexOf("(")+1,m.indexOf(")")).replace(/\"/g,""),f.css("backgroundImage","none"),k=a('<img src="'+m+'"/>'),k.css({border:0,display:"none"}).width(j),a("body").append(k),f.data("img",k)}var n=g.start.top||Math.round(d.height()/2),o=g.start.left||Math.round(d.width()/2);if(h){var p=b(h);n=p.top,o=p.left}g.fixed?(n-=d.scrollTop(),o-=d.scrollLeft()):(c.top+=d.scrollTop(),c.left+=d.scrollLeft()),k.css({position:"absolute",top:n,left:o,width:0,zIndex:g.zIndex}).show(),c.position=l,f.css(c),k.animate({top:f.css("top"),left:f.css("left"),width:j},g.speed,function(){f.css("zIndex",g.zIndex+1).fadeIn(g.fadeInSpeed,function(){i.isOpened()&&!a(this).index(f)?e.call():f.hide()})}).css("position",l)},f=function(c){var e=this.getOverlay().hide(),f=this.getConf(),g=this.getTrigger(),h=e.data("img"),i={top:f.start.top,left:f.start.left,width:0};g&&a.extend(i,b(g)),f.fixed&&h.css({position:"absolute"}).animate({top:"+="+d.scrollTop(),left:"+="+d.scrollLeft()},0),h.animate(i,f.closeSpeed,c)};c.addEffect("apple",e,f)}(jQuery),function(a){function b(a,b){var c=Math.pow(10,b);return Math.round(a*c)/c}function c(a,b){var c=parseInt(a.css(b),10);if(c)return c;var d=a[0].currentStyle;return d&&d.width&&parseInt(d.width,10)}function d(a){var b=a.data("events");return b&&b.onSlide}function e(e,f){function g(a,c,d,g){d===undefined?d=c/p*t:g&&(d-=f.min),u&&(d=Math.round(d/u)*u);if(c===undefined||u)c=d*p/t;if(isNaN(d))return j;c=Math.max(0,Math.min(c,p)),d=c/p*t;if(g||!m)d+=f.min;m&&(g?c=p-c:d=f.max-d),d=b(d,v);var h=a.type=="click";if(A&&n!==undefined&&!h){a.type="onSlide",z.trigger(a,[d,c]);if(a.isDefaultPrevented())return j}var i=h?f.speed:0,k=h?function(){a.type="change",z.trigger(a,[d])}:null;return m?(r.animate({top:c},i,k),f.progress&&s.animate({height:p-c+r.height()/2},i)):(r.animate({left:c},i,k),f.progress&&s.animate({width:c+r.width()/2},i)),n=d,q=c,e.val(d),j}function h(){m=f.vertical||c(l,"height")>c(l,"width"),m?(p=c(l,"height")-c(r,"height"),o=l.offset().top+p):(p=c(l,"width")-c(r,"width"),o=l.offset().left)}function i(){h(),j.setValue(f.value!==undefined?f.value:f.min)}var j=this,k=f.css,l=a("<div><div/><a href='#'/></div>").data("rangeinput",j),m,n,o,p,q;e.before(l);var r=l.addClass(k.slider).find("a").addClass(k.handle),s=l.find("div").addClass(k.progress);a.each("min,max,step,value".split(","),function(a,b){var c=e.attr(b);parseFloat(c)&&(f[b]=parseFloat(c,10))});var t=f.max-f.min,u=f.step=="any"?0:f.step,v=f.precision;if(v===undefined)try{v=u.toString().split(".")[1].length}catch(w){v=0}if(e.attr("type")=="range"){var x=e.clone().wrap("<div/>").parent().html(),y=a(x.replace(/type/i,"type=text data-orig-type"));y.val(f.value),e.replaceWith(y),e=y}e.addClass(k.input);var z=a(j).add(e),A=!0;a.extend(j,{getValue:function(){return n},setValue:function(b,c){return h(),g(c||a.Event("api"),undefined,b,!0)},getConf:function(){return f},getProgress:function(){return s},getHandle:function(){return r},getInput:function(){return e},step:function(b,c){c=c||a.Event();var d=f.step=="any"?1:f.step;j.setValue(n+d*(b||1),c)},stepUp:function(a){return j.step(a||1)},stepDown:function(a){return j.step(-a||-1)}}),a.each("onSlide,change".split(","),function(b,c){a.isFunction(f[c])&&a(j).bind(c,f[c]),j[c]=function(b){return b&&a(j).bind(c,b),j}}),r.drag({drag:!1}).bind("dragStart",function(){h(),A=d(a(j))||d(e)}).bind("drag",function(a,b,c){if(e.is(":disabled"))return!1;g(a,m?b:c)}).bind("dragEnd",function(a){a.isDefaultPrevented()||(a.type="change",z.trigger(a,[n]))}).click(function(a){return a.preventDefault()}),l.click(function(a){if(e.is(":disabled")||a.target==r[0])return a.preventDefault();h();var b=m?r.height()/2:r.width()/2;g(a,m?p-o-b+a.pageY:a.pageX-o-b)}),f.keyboard&&e.keydown(function(b){if(e.attr("readonly"))return;var c=b.keyCode,d=a([75,76,38,33,39]).index(c)!=-1,f=a([74,72,40,34,37]).index(c)!=-1;if((d||f)&&!(b.shiftKey||b.altKey||b.ctrlKey))return d?j.step(c==33?10:1,b):f&&j.step(c==34?-10:-1,b),b.preventDefault()}),e.blur(function(b){var c=a(this).val();c!==n&&j.setValue(c,b)}),a.extend(e[0],{stepUp:j.stepUp,stepDown:j.stepDown}),i(),p||a(window).load(i)}a.tools=a.tools||{version:"1.2.6"};var f;f=a.tools.rangeinput={conf:{min:0,max:100,step:"any",steps:0,value:0,precision:undefined,vertical:0,keyboard:!0,progress:!1,speed:100,css:{input:"range",slider:"slider",progress:"progress",handle:"handle"}}};var g,h;a.fn.drag=function(b){return document.ondragstart=function(){return!1},b=a.extend({x:!0,y:!0,drag:!0},b),g=g||a(document).bind("mousedown mouseup",function(c){var d=a(c.target);if(c.type=="mousedown"&&d.data("drag")){var e=d.position(),f=c.pageX-e.left,i=c.pageY-e.top,j=!0;g.bind("mousemove.drag",function(a){var c=a.pageX-f,e=a.pageY-i,g={};b.x&&(g.left=c),b.y&&(g.top=e),j&&(d.trigger("dragStart"),j=!1),b.drag&&d.css(g),d.trigger("drag",[e,c]),h=d}),c.preventDefault()}else try{h&&h.trigger("dragEnd")}finally{g.unbind("mousemove.drag"),h=null}}),this.data("drag",!0)},a.expr[":"].range=function(b){var c=b.getAttribute("type");return c&&c=="range"||!!a(b).filter("input").data("rangeinput")},a.fn.rangeinput=function(b){if(this.data("rangeinput"))return this;b=a.extend(!0,{},f.conf,b);var c;return this.each(function(){var d=new e(a(this),a.extend(!0,{},b)),f=d.getInput().data("rangeinput",d);c=c?c.add(f):f}),c?c:this}}(jQuery),function(a){function b(a,b){var c=parseInt(a.css(b),10);if(c)return c;var d=a[0].currentStyle;return d&&d.width&&parseInt(d.width,10)}function c(b,c){var d=a(c);return d.length<2?d:b.parent().find(c)}function d(b,d){var f=this,g=b.add(f),h=b.children(),i=0,j=d.vertical;e||(e=f),h.length>1&&(h=a(d.items,b)),d.size>1&&(d.circular=!1),a.extend(f,{getConf:function(){return d},getIndex:function(){return i},getSize:function(){return f.getItems().size()},getNaviButtons:function(){return n.add(o)},getRoot:function(){return b},getItemWrap:function(){return h},getItems:function(){return h.find(d.item).not("."+d.clonedClass)},move:function(a,b){return f.seekTo(i+a,b)},next:function(a){return f.move(d.size,a)},prev:function(a){return f.move(-d.size,a)},begin:function(a){return f.seekTo(0,a)},end:function(a){return f.seekTo(f.getSize()-1,a)},focus:function(){return e=f,f},addItem:function(b){return b=a(b),d.circular?(h.children().last().before(b),h.children().first().replaceWith(b.clone().addClass(d.clonedClass))):(h.append(b),o.removeClass("disabled")),g.trigger("onAddItem",[b]),f},seekTo:function(b,c,k){b.jquery||(b*=1);if(d.circular&&b===0&&i==-1&&c!==0)return f;if(!d.circular&&b<0||b>f.getSize()||b<-1)return f;var l=b;b.jquery?b=f.getItems().index(b):l=f.getItems().eq(b);var m=a.Event("onBeforeSeek");if(!k){g.trigger(m,[b,c]);if(m.isDefaultPrevented()||!l.length)return f}var n=j?{top:-l.position().top}:{left:-l.position().left};return i=b,e=f,c===undefined&&(c=d.speed),h.animate(n,c,d.easing,k||function(){g.trigger("onSeek",[b])}),f}}),a.each(["onBeforeSeek","onSeek","onAddItem"],function(b,c){a.isFunction(d[c])&&a(f).bind(c,d[c]),f[c]=function(b){return b&&a(f).bind(c,b),f}});if(d.circular){var k=f.getItems().slice(-1).clone().prependTo(h),l=f.getItems().eq(1).clone().appendTo(h);k.add(l).addClass(d.clonedClass),f.onBeforeSeek(function(a,b,c){if(a.isDefaultPrevented())return;if(b==-1)return f.seekTo(k,c,function(){f.end(0)}),a.preventDefault();b==f.getSize()&&f.seekTo(l,c,function(){f.begin(0)})});var m=b.parents().add(b).filter(function(){if(a(this).css("display")==="none")return!0});m.length?(m.show(),f.seekTo(0,0,function(){}),m.hide()):f.seekTo(0,0,function(){})}var n=c(b,d.prev).click(function(a){a.stopPropagation(),f.prev()}),o=c(b,d.next).click(function(a){a.stopPropagation(),f.next()});d.circular||(f.onBeforeSeek(function(a,b){setTimeout(function(){a.isDefaultPrevented()||(n.toggleClass(d.disabledClass,b<=0),o.toggleClass(d.disabledClass,b>=f.getSize()-1))},1)}),d.initialIndex||n.addClass(d.disabledClass)),f.getSize()<2&&n.add(o).addClass(d.disabledClass),d.mousewheel&&a.fn.mousewheel&&b.mousewheel(function(a,b){if(d.mousewheel)return f.move(b<0?1:-1,d.wheelSpeed||50),!1});if(d.touch){var p={};h[0].ontouchstart=function(a){var b=a.touches[0];p.x=b.clientX,p.y=b.clientY},h[0].ontouchmove=function(a){if(a.touches.length==1&&!h.is(":animated")){var b=a.touches[0],c=p.x-b.clientX,d=p.y-b.clientY;f[j&&d>0||!j&&c>0?"next":"prev"](),a.preventDefault()}}}d.keyboard&&a(document).bind("keydown.scrollable",function(b){if(!d.keyboard||b.altKey||b.ctrlKey||b.metaKey||a(b.target).is(":input"))return;if(d.keyboard!="static"&&e!=f)return;var c=b.keyCode;if(!(!j||c!=38&&c!=40))return f.move(c==38?-1:1),b.preventDefault();if(!j&&(c==37||c==39))return f.move(c==37?-1:1),b.preventDefault()}),d.initialIndex&&f.seekTo(d.initialIndex,0,function(){})}a.tools=a.tools||{version:"1.2.6"},a.tools.scrollable={conf:{activeClass:"active",circular:!1,clonedClass:"cloned",disabledClass:"disabled",easing:"swing",initialIndex:0,item:"> *",items:".items",keyboard:!0,mousewheel:!1,next:".next",prev:".prev",size:1,speed:400,vertical:!1,touch:!0,wheelSpeed:0}};var e;a.fn.scrollable=function(b){var c=this.data("scrollable");return c?c:(b=a.extend({},a.tools.scrollable.conf,b),this.each(function(){c=new d(a(this),b),a(this).data("scrollable",c)}),b.api?c:this)}}(jQuery),function(a){var b=a.tools.scrollable;b.autoscroll={conf:{autoplay:!0,interval:3e3,autopause:!0}},a.fn.autoscroll=function(c){typeof c=="number"&&(c={interval:c});var d=a.extend({},b.autoscroll.conf,c),e;return this.each(function(){function b(){g=setTimeout(function(){c.next()},d.interval)}var c=a(this).data("scrollable"),f=c.getRoot(),g,h=!1;c&&(e=c),c.play=function(){if(g)return;h=!1,f.bind("onSeek",b),b()},c.pause=function(){g=clearTimeout(g),f.unbind("onSeek",b)},c.resume=function(){h||c.play()},c.stop=function(){h=!0,c.pause()},d.autopause&&f.add(c.getNaviButtons()).hover(c.pause,c.resume),d.autoplay&&c.play()}),d.api?e:this}}(jQuery),function(a){function b(b,c){var d=a(c);return d.length<2?d:b.parent().find(c)}var c=a.tools.scrollable;c.navigator={conf:{navi:".navi",naviItem:null,activeClass:"active",indexed:!1,idPrefix:null,history:!1}},a.fn.navigator=function(d){typeof d=="string"&&(d={navi:d}),d=a.extend({},c.navigator.conf,d);var e;return this.each(function(){function c(a,b,c){h.seekTo(b),c.preventDefault(),l&&history.pushState({i:b})}function f(){return i.find(d.naviItem||"> *")}function g(b){var e=a("<"+(d.naviItem||"a")+"/>").click(function(d){c(a(this),b,d)});return b===0&&e.addClass(k),d.indexed&&e.text(b+1),d.idPrefix&&e.attr("id",d.idPrefix+b),e.appendTo(i)}var h=a(this).data("scrollable"),i=d.navi.jquery?d.navi:b(h.getRoot(),d.navi),j=h.getNaviButtons(),k=d.activeClass,l=d.history&&!!history.pushState,m=h.getConf().size;h&&(e=h),h.getNaviButtons=function(){return j.add(i)},l&&(history.pushState({i:0}),a(window).bind("popstate",function(a){var b=a.originalEvent.state;b&&h.seekTo(b.i)})),f().length?f().each(function(b){a(this).click(function(d){c(a(this),b,d)})}):a.each(h.getItems(),function(a){a%m==0&&g(a)}),h.onBeforeSeek(function(a,b){setTimeout(function(){if(!a.isDefaultPrevented()){var c=b/m,d=f().eq(c);d.length&&f().removeClass(k).eq(c).addClass(k)}},1)}),h.onAddItem(function(a,b){var c=h.getItems().index(b);c%m==0&&g(c)})}),d.api?e:this}}(jQuery),function(a){function b(b,d,e){var f=this,g=b.add(this),h=b.find(e.tabs),i=d.jquery?d:b.children(d),j;h.length||(h=b.children()),i.length||(i=b.parent().find(d)),i.length||(i=a(d)),a.extend(this,{click:function(b,d){var i=h.eq(b);typeof b=="string"&&b.replace("#","")&&(i=h.filter("[href*="+b.replace("#","")+"]"),b=Math.max(h.index(i),0));if(e.rotate){var k=h.length-1;if(b<0)return f.click(k,d);if(b>k)return f.click(0,d)}if(!i.length){if(j>=0)return f;b=e.initialIndex,i=h.eq(b)}if(b===j)return f;d=d||a.Event(),d.type="onBeforeClick",g.trigger(d,[b]);if(d.isDefaultPrevented())return;return c[e.effect].call(f,b,function(){j=b,d.type="onClick",g.trigger(d,[b])}),h.removeClass(e.current),i.addClass(e.current),f},getConf:function(){return e},getTabs:function(){return h},getPanes:function(){return i},getCurrentPane:function(){return i.eq(j)},getCurrentTab:function(){return h.eq(j)},getIndex:function(){return j},next:function(){return f.click(j+1)},prev:function(){return f.click(j-1)},destroy:function(){return h.unbind(e.event).removeClass(e.current),i.find("a[href^=#]").unbind("click.T"),f}}),a.each("onBeforeClick,onClick".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){return b&&a(f).bind(c,b),f}}),e.history&&a.fn.history&&(a.tools.history.init(h),e.event="history"),h.each(function(b){a(this).bind(e.event,function(a){return f.click(b,a),a.preventDefault()})}),i.find("a[href^=#]").bind("click.T",function(b){f.click(a(this).attr("href"),b)}),location.hash&&e.tabs=="a"&&b.find("[href="+location.hash+"]").length?f.click(location.hash):(e.initialIndex===0||e.initialIndex>0)&&f.click(e.initialIndex)}a.tools=a.tools||{version:"1.2.6"},a.tools.tabs={conf:{tabs:"a",current:"current",onBeforeClick:null,onClick:null,effect:"default",initialIndex:0,event:"click",rotate:!1,slideUpSpeed:400,slideDownSpeed:400,history:!1},addEffect:function(a,b){c[a]=b}};var c={"default":function(a,b){this.getPanes().hide().eq(a).show(),b.call()},fade:function(a,b){var c=this.getConf(),d=c.fadeOutSpeed,e=this.getPanes();d?e.fadeOut(d):e.hide(),e.eq(a).fadeIn(c.fadeInSpeed,b)},slide:function(a,b){var c=this.getConf();this.getPanes().slideUp(c.slideUpSpeed),this.getPanes().eq(a).slideDown(c.slideDownSpeed,b)},ajax:function(a,b){this.getPanes().eq(0).load(this.getTabs().eq(a).attr("href"),b)}},d,e;a.tools.tabs.addEffect("horizontal",function(b,c){if(d)return;var f=this.getPanes().eq(b),g=this.getCurrentPane();e||(e=this.getPanes().eq(0).width()),d=!0,f.show(),g.animate({width:0},{step:function(a){f.css("width",e-a)},complete:function(){a(this).hide(),c.call(),d=!1}}),g.length||(c.call(),d=!1)}),a.fn.tabs=function(c,d){var e=this.data("tabs");return e&&(e.destroy(),this.removeData("tabs")),a.isFunction(d)&&(d={onBeforeClick:d}),d=a.extend({},a.tools.tabs.conf,d),this.each(function(){e=new b(a(this),c,d),a(this).data("tabs",e)}),d.api?e:this}}(jQuery),function(a){function b(b,c){function d(c){var d=a(c);return d.length<2?d:b.parent().find(c)}function e(){i=setTimeout(function(){h.next()},c.interval)}var f=this,g=b.add(this),h=b.data("tabs"),i,j=!0,k=d(c.next).click(function(){h.next()}),l=d(c.prev).click(function(){h.prev()});a.extend(f,{getTabs:function(){return h},getConf:function(){return c},play:function(){if(i)return f;var b=a.Event("onBeforePlay");return g.trigger(b),b.isDefaultPrevented()?f:(j=!1,g.trigger("onPlay"),g.bind("onClick",e),e(),f)},pause:function(){if(!i)return f;var b=a.Event("onBeforePause");return g.trigger(b),b.isDefaultPrevented()?f:(i=clearTimeout(i),g.trigger("onPause"),g.unbind("onClick",e),f)},resume:function(){j||f.play()},stop:function(){f.pause(),j=!0}}),a.each("onBeforePlay,onPlay,onBeforePause,onPause".split(","),function(b,d){a.isFunction(c[d])&&a(f).bind(d,c[d]),f[d]=function(b){return a(f).bind(d,b)}}),c.autopause&&h.getTabs().add(k).add(l).add(h.getPanes()).hover(f.pause,f.resume),c.autoplay&&f.play(),c.clickable&&h.getPanes().click(function(){h.next()});if(!h.getConf().rotate){var m=c.disabledClass;h.getIndex()||l.addClass(m),h.onBeforeClick(function(a,b){l.toggleClass(m,!b),k.toggleClass(m,b==h.getTabs().length-1)})}}var c;c=a.tools.tabs.slideshow={conf:{next:".forward",prev:".backward",disabledClass:"disabled",autoplay:!1,autopause:!0,interval:3e3,clickable:!0,api:!1}},a.fn.slideshow=function(d){var e=this.data("slideshow");return e?e:(d=a.extend({},c.conf,d),this.each(function(){e=new b(a(this),d),a(this).data("slideshow",e)}),d.api?e:this)}}(jQuery),function(a){function b(){if(a.browser.msie){var b=a(document).height(),c=a(window).height();return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b-c<20?c:b]}return[a(document).width(),a(document).height()]}function c(b){if(b)return b.call(a.mask)}a.tools=a.tools||{version:"1.2.6"};var d;d=a.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",closeOnClick:!0,closeOnEsc:!0,zIndex:9998,opacity:.8,startOpacity:0,color:"#fff",onLoad:null,onClose:null}};var e,f,g,h,i;a.mask={load:function(j,k){if(g)return this;typeof j=="string"&&(j={color:j}),j=j||h,h=j=a.extend(a.extend({},d.conf),j),e=a("#"+j.maskId),e.length||(e=a("<div/>").attr("id",j.maskId),a("body").append(e));var l=b();return e.css({position:"absolute",top:0,left:0,width:l[0],height:l[1],display:"none",opacity:j.startOpacity,zIndex:j.zIndex}),j.color&&e.css("backgroundColor",j.color),c(j.onBeforeLoad)===!1?this:(j.closeOnEsc&&a(document).bind("keydown.mask",function(b){b.keyCode==27&&a.mask.close(b)}),j.closeOnClick&&e.bind("click.mask",function(b){a.mask.close(b)}),a(window).bind("resize.mask",function(){a.mask.fit()}),k&&k.length&&(i=k.eq(0).css("zIndex"),a.each(k,function(){var b=a(this);/relative|absolute|fixed/i.test(b.css("position"))||b.css("position","relative")}),f=k.css({zIndex:Math.max(j.zIndex+1,i=="auto"?0:i)})),e.css({display:"block"}).fadeTo(j.loadSpeed,j.opacity,function(){a.mask.fit(),c(j.onLoad),g="full"}),g=!0,this)},close:function(){if(g){if(c(h.onBeforeClose)===!1)return this;e.fadeOut(h.closeSpeed,function(){c(h.onClose),f&&f.css({zIndex:i}),g=!1}),a(document).unbind("keydown.mask"),e.unbind("click.mask"),a(window).unbind("resize.mask")}return this},fit:function(){if(g){var a=b();e.css({width:a[0],height:a[1]})}},getMask:function(){return e},isLoaded:function(a){return a?g=="full":g},getConf:function(){return h},getExposed:function(){return f}},a.fn.mask=function(b){return a.mask.load(b),this},a.fn.expose=function(b){return a.mask.load(b,this),this}}(jQuery),function(){function a(a,b){if(b)for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function b(a,b){var c=[];for(var d in a)a.hasOwnProperty(d)&&(c[d]=b(a[d]));return c}function c(b,c,f){if(i.isSupported(c.version))b.innerHTML=i.getHTML(c,f);else if(c.expressInstall&&i.isSupported([6,65]))b.innerHTML=i.getHTML(a(c,{src:c.expressInstall}),{MMredirectURL:location.href,MMplayerType:"PlugIn",MMdoctitle:document.title});else{b.innerHTML.replace(/\s/g,"")||(b.innerHTML="<h2>Flash version "+c.version+" or greater is required</h2>"+"<h3>"+(j[0]>0?"Your version is "+j:"You have no flash plugin installed")+"</h3>"+(b.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+e+"'>here</a></p>"),b.tagName=="A"&&(b.onclick=function(){location.href=e}));if(c.onFail){var g=c.onFail.call(this);typeof g=="string"&&(b.innerHTML=g)}}d&&(window[c.id]=document.getElementById(c.id)),a(this,{getRoot:function(){return b},getOptions:function(){return c},getConf:function(){return f},getApi:function(){return b.firstChild}})}var d=document.all,e="http://www.adobe.com/go/getflashplayer",f=typeof jQuery=="function",g=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,h={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:!0,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:!1,cachebusting:!1};window.attachEvent&&window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){},__flash_savedUnloadHandler=function(){}}),window.flashembed=function(b,d,e){typeof b=="string"&&(b=document.getElementById(b.replace("#","")));if(!b)return;return typeof d=="string"&&(d={src:d}),new c(b,a(a({},h),d),e)};var i=a(window.flashembed,{conf:h,getVersion:function(){var a,b;try{b=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(c){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7"),b=a&&a.GetVariable("$version")}catch(d){try{a=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),b=a&&a.GetVariable("$version")}catch(e){}}}return b=g.exec(b),b?[b[1],b[3]]:[0,0]},asString:function(a){if(a===null||a===undefined)return null;var c=typeof a;c=="object"&&a.push&&(c="array");switch(c){case"string":return a=a.replace(new RegExp('(["\\\\])',"g"),"\\$1"),a=a.replace(/^\s?(\d+\.?\d*)%/,"$1pct"),'"'+a+'"';case"array":return"["+b(a,function(a){return i.asString(a)}).join(",")+"]";case"function":return'"function()"';case"object":var d=[];for(var e in a)a.hasOwnProperty(e)&&d.push('"'+e+'":'+i.asString(a[e]));return"{"+d.join(",")+"}"}return String(a).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(b,c){b=a({},b);var e='<object width="'+b.width+'" height="'+b.height+'" id="'+b.id+'" name="'+b.id+'"';b.cachebusting&&(b.src+=(b.src.indexOf("?")!=-1?"&":"?")+Math.random()),b.w3c||!d?e+=' data="'+b.src+'" type="application/x-shockwave-flash"':e+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"',e+=">";if(b.w3c||d)e+='<param name="movie" value="'+b.src+'" />';b.width=b.height=b.id=b.w3c=b.src=null,b.onFail=b.version=b.expressInstall=null;for(var f in b)b[f]&&(e+='<param name="'+f+'" value="'+b[f]+'" />');var g="";if(c){for(var h in c)if(c[h]){var j=c[h];g+=h+"="+encodeURIComponent(/function|object/.test(typeof j)?i.asString(j):j)+"&"}g=g.slice(0,-1),e+='<param name="flashvars" value=\''+g+"' />"}return e+="</object>",e},isSupported:function(a){return j[0]>a[0]||j[0]==a[0]&&j[1]>=a[1]}}),j=i.getVersion();f&&(jQuery.tools=jQuery.tools||{version:"1.2.6"},jQuery.tools.flashembed={conf:h},jQuery.fn.flashembed=function(a,b){return this.each(function(){jQuery(this).data("flashembed",flashembed(this,a,b))})})}(),function(a){function b(a){if(a){var b=d.contentWindow.document;b.open().close(),b.location.hash=a}}var c,d,e,f;a.tools=a.tools||{version:"1.2.6"},a.tools.history={init:function(g){if(f)return;a.browser.msie&&a.browser.version<"8"?d||(d=a("<iframe/>").attr("src","javascript:false;").hide().get(0),a("body").prepend(d),setInterval(function(){var b=d.contentWindow.document,e=b.location.hash;c!==e&&a(window).trigger("hash",e)},100),b(location.hash||"#")):setInterval(function(){var b=location.hash;b!==c&&a(window).trigger("hash",b)},100),e=e?e.add(g):g,g.click(function(c){var e=a(this).attr("href");d&&b(e);if(e.slice(0,1)!="#")return location.href="#"+e,c.preventDefault()}),f=!0}},a(window).bind("hash",function(b,d){d?e.filter(function(){var b=a(this).attr("href");return b==d||b==d.replace("#","")}).trigger("history",[d]):e.eq(0).trigger("history",[d]),c=d}),a.fn.history=function(b){return a.tools.history.init(this),this.bind("history",b)}}(jQuery),function(a){function b(b){switch(b.type){case"mousemove":return a.extend(b.data,{clientX:b.clientX,clientY:b.clientY,pageX:b.pageX,pageY:b.pageY});case"DOMMouseScroll":a.extend(b,b.data),b.delta=-b.detail/3;break;case"mousewheel":b.delta=b.wheelDelta/120}return b.type="wheel",a.event.handle.call(this,b,b.delta)}a.fn.mousewheel=function(a){return this[a?"bind":"trigger"]("wheel",a)},a.event.special.wheel={setup:function(){a.event.add(this,c,b,{})},teardown:function(){a.event.remove(this,c,b)}};var c=a.browser.mozilla?"DOMMouseScroll"+(a.browser.version<"1.9"?" mousemove":""):"mousewheel"}(jQuery),function(a){function b(b,c,d){var e=d.relative?b.position().top:b.offset().top,f=d.relative?b.position().left:b.offset().left,g=d.position[0];e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop());var h=c.outerHeight()+b.outerHeight();g=="center"&&(e+=h/2),g=="bottom"&&(e+=h),g=d.position[1];var i=c.outerWidth()+b.outerWidth();return g=="center"&&(f-=i/2),g=="left"&&(f-=i),{top:e,left:f}}function c(c,e){var f=this,g=c.add(f),h,i=0,j=0,k=c.attr("title"),l=c.attr("data-tooltip"),m=d[e.effect],n,o=c.is(":input"),p=o&&c.is(":checkbox, :radio, select, :button, :submit"),q=c.attr("type"),r=e.events[q]||e.events[o?p?"widget":"input":"def"];if(!m)throw'Nonexistent effect "'+e.effect+'"';r=r.split(/,\s*/);if(r.length!=2)throw"Tooltip: bad events configuration for "+q;c.bind(r[0],function(a){clearTimeout(i),e.predelay?j=setTimeout(function(){f.show(a)},e.predelay):f.show(a)}).bind(r[1],function(a){clearTimeout(j),e.delay?i=setTimeout(function(){f.hide(a)},e.delay):f.hide(a)}),k&&e.cancelDefault&&(c.removeAttr("title"),c.data("title",k)),a.extend(f,{show:function(d){if(!h){l?h=a(l):e.tip?h=a(e.tip).eq(0):k?h=a(e.layout).addClass(e.tipClass).appendTo(document.body).hide().append(k):(h=c.next(),h.length||(h=c.parent().next()));if(!h.length)throw"Cannot find tooltip for "+c}if(f.isShown())return f;h.stop(!0,!0);var o=b(c,h,e);e.tip&&h.html(c.data("title")),d=a.Event(),d.type="onBeforeShow",g.trigger(d,[o]);if(d.isDefaultPrevented())return f;o=b(c,h,e),h.css({position:"absolute",top:o.top,left:o.left}),n=!0,m[0].call(f,function(){d.type="onShow",n="full",g.trigger(d)});var p=e.events.tooltip.split(/,\s*/);return h.data("__set")||(h.unbind(p[0]).bind(p[0],function(){clearTimeout(i),clearTimeout(j)}),p[1]&&!c.is("input:not(:checkbox, :radio), textarea")&&h.unbind(p[1]).bind(p[1],function(a){a.relatedTarget!=c[0]&&c.trigger(r[1].split(" ")[0])}),e.tip||h.data("__set",!0)),f},hide:function(b){if(!h||!f.isShown())return f;b=a.Event(),b.type="onBeforeHide",g.trigger(b);if(b.isDefaultPrevented())return;return n=!1,d[e.effect][1].call(f,function(){b.type="onHide",g.trigger(b)}),f},isShown:function(a){return a?n=="full":n},getConf:function(){return e},getTip:function(){return h},getTrigger:function(){return c}}),a.each("onHide,onBeforeShow,onShow,onBeforeHide".split(","),function(b,c){a.isFunction(e[c])&&a(f).bind(c,e[c]),f[c]=function(b){return b&&a(f).bind(c,b),f}})}a.tools=a.tools||{version:"1.2.6"},a.tools.tooltip={conf:{effect:"toggle",fadeOutSpeed:"fast",predelay:0,delay:30,opacity:1,tip:0,fadeIE:!1,position:["top","center"],offset:[0,0],relative:!1,cancelDefault:!0,events:{def:"mouseenter,mouseleave",input:"focus,blur",widget:"focus mouseenter,blur mouseleave",tooltip:"mouseenter,mouseleave"},layout:"<div/>",tipClass:"tooltip"},addEffect:function(a,b,c){d[a]=[b,c]}};var d={toggle:[function(a){var b=this.getConf(),c=this.getTip(),d=b.opacity;d<1&&c.css({opacity:d}),c.show(),a.call()},function(a){this.getTip().hide(),a.call()}],fade:[function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeTo(c.fadeInSpeed,c.opacity,b):(this.getTip().show(),b())},function(b){var c=this.getConf();!a.browser.msie||c.fadeIE?this.getTip().fadeOut(c.fadeOutSpeed,b):(this.getTip().hide(),b())}]};a.fn.tooltip=function(b){var d=this.data("tooltip");return d?d:(b=a.extend(!0,{},a.tools.tooltip.conf,b),typeof b.position=="string"&&(b.position=b.position.split(/,?\s/)),this.each(function(){d=new c(a(this),b),a(this).data("tooltip",d)}),b.api?d:this)}}(jQuery),function(a){function b(b){var c=a(window),d=c.width()+c.scrollLeft(),e=c.height()+c.scrollTop();return[b.offset().top<=c.scrollTop(),d<=b.offset().left+b.width(),e<=b.offset().top+b.height(),c.scrollLeft()>=b.offset().left]}function c(a){var b=a.length;while(b--)if(a[b])return!1;return!0}var d=a.tools.tooltip;d.dynamic={conf:{classNames:"top right bottom left"}},a.fn.dynamic=function(e){typeof e=="number"&&(e={speed:e}),e=a.extend({},d.dynamic.conf,e);var f=a.extend(!0,{},e),g=e.classNames.split(/\s/),h;return this.each(function(){var d=a(this).tooltip().onBeforeShow(function(d,e){var i=this.getTip(),j=this.getConf();h||(h=[j.position[0],j.position[1],j.offset[0],j.offset[1],a.extend({},j)]),a.extend(j,h[4]),j.position=[h[0],h[1]],j.offset=[h[2],h[3]],i.css({visibility:"hidden",position:"absolute",top:e.top,left:e.left}).show();var k=a.extend(!0,{},f),l=b(i);if(!c(l)){l[2]&&(a.extend(j,k.top),j.position[0]="top",i.addClass(g[0])),l[3]&&(a.extend(j,k.right),j.position[1]="right",i.addClass(g[1])),l[0]&&(a.extend(j,k.bottom),j.position[0]="bottom",i.addClass(g[2])),l[1]&&(a.extend(j,k.left),j.position[1]="left",i.addClass(g[3]));if(l[0]||l[2])j.offset[0]*=-1;if(l[1]||l[3])j.offset[1]*=-1}i.css({visibility:"visible"}).hide()});d.onBeforeShow(function(){var a=this.getConf(),b=this.getTip();setTimeout(function(){a.position=[h[0],h[1]],a.offset=[h[2],h[3]]},0)}),d.onHide(function(){var a=this.getTip();a.removeClass(e.classNames)}),ret=d}),e.api?ret:this}}(jQuery),function(a){var b=a.tools.tooltip;a.extend(b.conf,{direction:"up",bounce:!1,slideOffset:10,slideInSpeed:200,slideOutSpeed:200,slideFade:!a.browser.msie});var c={up:["-","top"],down:["+","top"],left:["-","left"],right:["+","left"]};b.addEffect("slide",function(a){var b=this.getConf(),d=this.getTip(),e=b.slideFade?{opacity:b.opacity}:{},f=c[b.direction]||c.up;e[f[1]]=f[0]+"="+b.slideOffset,b.slideFade&&d.css({opacity:0}),d.show().animate(e,b.slideInSpeed,a)},function(b){var d=this.getConf(),e=d.slideOffset,f=d.slideFade?{opacity:0}:{},g=c[d.direction]||c.up,h=""+g[0];d.bounce&&(h=h=="+"?"-":"+"),f[g[1]]=h+"="+e,this.getTip().animate(f,d.slideOutSpeed,function(){a(this).hide(),b.call()})})}(jQuery),function(a){function b(b,c,d){var e=b.offset().top,f=b.offset().left,g=d.position.split(/,?\s+/),h=g[0],i=g[1];e-=c.outerHeight()-d.offset[0],f+=b.outerWidth()+d.offset[1],/iPad/i.test(navigator.userAgent)&&(e-=a(window).scrollTop());var j=c.outerHeight()+b.outerHeight();h=="center"&&(e+=j/2),h=="bottom"&&(e+=j);var k=b.outerWidth();return i=="center"&&(f-=(k+c.outerWidth())/2),i=="left"&&(f-=k),{top:e,left:f}}function c(a){function b(){return this.getAttribute("type")==a}return b.key="[type="+a+"]",b}function d(c,d,e){function f(b,c,d){if(!e.grouped&&b.length)return;var f;if(d===!1||a.isArray(d)){f=j.messages[c.key||c]||j.messages["*"],f=f[e.lang]||j.messages["*"].en;var g=f.match(/\$\d/g);g&&a.isArray(d)&&a.each(g,function(a){f=f.replace(this,d[a])})}else f=d[e.lang]||d;b.push(f)}var h=this,i=d.add(h);c=c.not(":button, :image, :reset, :submit"),d.attr("novalidate","novalidate"),a.extend(h,{getConf:function(){return e},getForm:function(){return d},getInputs:function(){return c},reflow:function(){return c.each(function(){var c=a(this),d=c.data("msg.el");if(d){var f=b(c,d,e);d.css({top:f.top,left:f.left})}}),h},invalidate:function(b,d){if(!d){var f=[];a.each(b,function(a,b){var d=c.filter("[name='"+a+"']");d.length&&(d.trigger("OI",[b]),f.push({input:d,messages:[b]}))}),b=f,d=a.Event()}return d.type="onFail",i.trigger(d,[b]),d.isDefaultPrevented()||l[e.effect][0].call(h,b,d),h},reset:function(b){return b=b||c,b.removeClass(e.errorClass).each(function(){var b=a(this).data("msg.el");b&&(b.remove(),a(this).data("msg.el",null))}).unbind(e.errorInputEvent||""),h},destroy:function(){return d.unbind(e.formEvent+".V").unbind("reset.V"),c.unbind(e.inputEvent+".V").unbind("change.V"),h.reset()},checkValidity:function(b,d){b=b||c,b=b.not(":disabled");if(!b.length)return!0;d=d||a.Event(),d.type="onBeforeValidate",i.trigger(d,[b]);if(d.isDefaultPrevented())return d.result;var j=[];b.not(":radio:not(:checked)").each(function(){var b=[],c=a(this).data("messages",b),l=g&&c.is(":date")?"onHide.v":e.errorInputEvent+".v";c.unbind(l),a.each(k,function(){var a=this,g=a[0];if(c.filter(g).length){var j=a[1].call(h,c,c.val());if(j!==!0){d.type="onBeforeFail",i.trigger(d,[c,g]);if(d.isDefaultPrevented())return!1;var k=c.attr(e.messageAttr);if(k)return b=[k],!1;f(b,g,j)}}}),b.length&&(j.push({input:c,messages:b}),c.trigger("OI",[b]),e.errorInputEvent&&c.bind(l,function(a){h.checkValidity(c,a)}));if(e.singleError&&j.length)return!1});var m=l[e.effect];if(!m)throw'Validator: cannot find effect "'+e.effect+'"';return j.length?(h.invalidate(j,d),!1):(m[1].call(h,b,d),d.type="onSuccess",i.trigger(d,[b]),b.unbind(e.errorInputEvent+".v"),!0)}}),a.each("onBeforeValidate,onBeforeFail,onFail,onSuccess".split(","),function(b,c){a.isFunction(e[c])&&a(h).bind(c,e[c]),h[c]=function(b){return b&&a(h).bind(c,b),h}}),e.formEvent&&d.bind(e.formEvent+".V",function(a){if(!h.checkValidity(null,a))return a.preventDefault();a.target=d,a.type=e.formEvent}),d.bind("reset.V",function(){h.reset()}),c[0]&&c[0].validity&&c.each(function(){this.oninvalid=function(){return!1}}),d[0]&&(d[0].checkValidity=h.checkValidity),e.inputEvent&&c.bind(e.inputEvent+".V",function(b){h.checkValidity(a(this),b)}),c.filter(":checkbox, select").filter("[required]").bind("change.V",function(b){var c=a(this);(this.checked||c.is("select")&&a(this).val())&&l[e.effect][1].call(h,c,b)});var m=c.filter(":radio").change(function(a){h.checkValidity(m,a)});a(window).resize(function(){h.reflow()})}a.tools=a.tools||{version:"1.2.6"};var e=/\[type=([a-z]+)\]/,f=/^-?[0-9]*(\.[0-9]+)?$/,g=a.tools.dateinput,h=/^([a-z0-9_\.\-\+]+)@([\da-z\.\-]+)\.([a-z\.]{2,6})$/i,i=/^(https?:\/\/)?[\da-z\.\-]+\.[a-z\.]{2,6}[#&+_\?\/\w \.\-=]*$/i,j;j=a.tools.validator={conf:{grouped:!1,effect:"default",errorClass:"invalid",inputEvent:null,errorInputEvent:"keyup",formEvent:"submit",lang:"en",message:"<div/>",messageAttr:"data-message",messageClass:"error",offset:[0,0],position:"center right",singleError:!1,speed:"normal"},messages:{"*":{en:"Please correct this value"}},localize:function(b,c){a.each(c,function(a,c){j.messages[a]=j.messages[a]||{},j.messages[a][b]=c})},localizeFn:function(b,c){j.messages[b]=j.messages[b]||{},a.extend(j.messages[b],c)},fn:function(b,d,f){a.isFunction(d)?f=d:(typeof d=="string"&&(d={en:d}),this.messages[b.key||b]=d);var g=e.exec(b);g&&(b=c(g[1])),k.push([b,f])},addEffect:function(a,b,c){l[a]=[b,c]}};var k=[],l={"default":[function(c){var d=this.getConf();a.each(c,function(c,e){var f=e.input;f.addClass(d.errorClass);var g=f.data("msg.el");g||(g=a(d.message).addClass(d.messageClass).appendTo(document.body),f.data("msg.el",g)),g.css({visibility:"hidden"}).find("p").remove(),a.each(e.messages,function(b,c){a("<p/>").html(c).appendTo(g)}),g.outerWidth()==g.parent().width()&&g.add(g.find("p")).css({display:"inline"});var h=b(f,g,d);g.css({visibility:"visible",position:"absolute",top:h.top,left:h.left}).fadeIn(d.speed)})},function(b){var c=this.getConf();b.removeClass(c.errorClass).each(function(){var b=a(this).data("msg.el");b&&b.css({visibility:"hidden"})})}]};a.each("email,url,number".split(","),function(b,c){a.expr[":"][c]=function(a){return a.getAttribute("type")===c}}),a.fn.oninvalid=function(a){return this[a?"bind":"trigger"]("OI",a)},j.fn(":email","Please enter a valid email address",function(a,b){return!b||h.test(b)}),j.fn(":url","Please enter a valid URL",function(a,b){return!b||i.test(b)}),j.fn(":number","Please enter a numeric value.",function(a,b){return f.test(b)}),j.fn("[max]","Please enter a value no larger than $1",function(a,b){if(b===""||g&&a.is(":date"))return!0;var c=a.attr("max");return parseFloat(b)<=parseFloat(c)?!0:[c]}),j.fn("[min]","Please enter a value of at least $1",function(a,b){if(b===""||g&&a.is(":date"))return!0;var c=a.attr("min");return parseFloat(b)>=parseFloat(c)?!0:[c]}),j.fn("[required]","Please complete this mandatory field.",function(a,b){return a.is(":checkbox")?a.is(":checked"):!!b}),j.fn("[pattern]",function(a){var b=new RegExp("^"+a.attr("pattern")+"$");return b.test(a.val())}),a.fn.validator=function(b){var c=this.data("validator");return c&&(c.destroy(),this.removeData("validator")),b=a.extend(!0,{},j.conf,b),this.is("form")?this.each(function(){var e=a(this);c=new d(e.find(":input"),e,b),e.data("validator",c)}):(c=new d(this,this.eq(0).closest("form"),b),this.data("validator",c))}}(jQuery),define("lib/dist/jquery.tools.min",function(){}),function(a){var b={init:function(c){var d={time:3,initialTime:8,exceptionAreas:[]};return this.each(function(){var e=a(this),f=e.data("timeout");f||(c&&a.extend(d,c),e.data("timeout",{lastEvent:new Date,trueTime:d.time,time:d.initialTime,untouched:!0,inExceptionArea:!1}),e.bind("mouseover.timeout",b.mouseMoved),e.bind("mouseenter.timeout",b.mouseMoved),a(d.exceptionAreas).each(function(){e.find(this).live("mouseover.timeout",{parent:e},b.enteredException).live("mouseleave.timeout",{parent:e},b.leftException)}),d.initialTime>0?e.timeout("startTimer"):e.addClass("timeout"))})},enteredException:function(a){var b=a.data.parent.data("timeout");b.inExceptionArea=!0,a.data.parent.data("timeout",b),a.data.parent.trigger("mouseover")},leftException:function(a){var b=a.data.parent.data("timeout");b.inExceptionArea=!1,a.data.parent.data("timeout",b)},destroy:function(){return this.each(function(){var b=a(this),c=b.data("timeout");a(window).unbind(".timeout"),c.timeout.remove(),b.removeData("timeout")})},mouseMoved:function(b){var c=a(this),d=c.data("timeout");c.hasClass("timeout")?(c.removeClass("timeout"),c.timeout("startTimer")):d.untouched&&(d.untouched=!1,d.time=d.trueTime),d.lastEvent=new Date,c.data("timeout",d)},startTimer:function(b){var c=a(this),d=c.data("timeout"),e=function(){var a=c.data("timeout");if(a&&a.lastEvent)if(a.inExceptionArea)setTimeout(e,Math.floor(a.time*1e3));else{var b=new Date,d=Math.floor(a.time*1e3)-(b-a.lastEvent);d>0?setTimeout(e,d+100):c.addClass("timeout")}};setTimeout(e,Math.floor(d.time*1e3))}};a.fn.timeout=function(c){if(b[c])return b[c].apply(this,Array.prototype.slice.call(arguments,1));if(typeof c=="object"||!c)return b.init.apply(this,arguments);a.error("Method "+c+" does not exist on jQuery.timeout")}}(jQuery),function(a){a.extend(a.expr[":"],{scrollable:function(b){var c,d;return a(b).css("overflow")=="scroll"||a(b).css("overflowX")=="scroll"||a(b).css("overflowY")=="scroll"?!0:(c=b.clientHeight<b.scrollHeight&&(a.inArray(a(b).css("overflowY"),["scroll","auto"])!=-1||a.inArray(a(b).css("overflow"),["scroll","auto"])!=-1),c?!0:(d=b.clientWidth<b.scrollWidth&&(a.inArray(a(b).css("overflowX"),["scroll","auto"])!=-1||a.inArray(a(b).css("overflow"),["scroll","auto"])!=-1),d))}})}(jQuery),function(a){a.fn.makeVisibleInScroll=function(b){var c=null;return typeof b=="string"?c=a("#"+b):b&&(c=a(b)),this.each(function(){var b=a(this),d;c?d=c:(d=b.parents(":scrollable"),d.length>0?d=a(d[0]):d=a(window));var e=b.position().top,f=b.height()+e,g=d.scrollTop(),h=d.height()+g;e<g?d.scrollTop(e):f>h-d.height()/2&&d.scrollTop(e-(d.height()-b.height())/2)})}}(jQuery),function(a){a.fn.setPositionAbsolute=function(b,c,d){return this.each(function(){var e=a(this),f=a(this).width(),g=b.offset(),h=b.width(),i=b.height(),j=g.left+h-f+d,k=g.top+i+c;e.css({"z-index":1,position:"absolute",marginLeft:0,marginTop:0,left:j+"px",top:k+"px",width:f}),e.remove().appendTo("body").show()})}}(jQuery),function(a){a.fn.positionAncestor=function(b){var c=0,d=0;return this.each(function(e,f){var g=a(this).closest(b);if(g.length&&g.css("position")!=="static"){var h=a(this),i=h.offset().left-parseInt(h.css("marginLeft"),10),j=h.offset().top-parseInt(h.css("marginTop"),10),k=g.offset().left+parseInt(g.css("borderLeftWidth"),10),l=g.offset().top+parseInt(g.css("borderTopWidth"),10);return c=i-k,d=j-l,!1}}),{left:c,top:d}}}(jQuery),String.prototype.startsWith=function(a){return this.match("^"+a)!==null},String.prototype.endsWith=function(a){return this.match(a+"$")!==null},function(a){a.simplePlaceholder={placeholder_class:null,hide_placeholder:function(){var b=a(this);b.val()==b.attr("placeholder")&&b.val("").removeClass(a.simplePlaceholder.placeholder_class)},show_placeholder:function(){var b=a(this);b.val()===""&&b.val(b.attr("placeholder")).addClass(a.simplePlaceholder.placeholder_class)},prevent_placeholder_submit:function(){return a(this).find(".simple-placeholder").each(function(b){var c=a(this);c.val()==c.attr("placeholder")&&c.val("")}),!0}},a.fn.simplePlaceholder=function(b){if(document.createElement("input").placeholder===undefined){var c={placeholder_class:"placeholding"};b&&a.extend(c,b),a.simplePlaceholder.placeholder_class=c.placeholder_class,this.each(function(){var b=a(this);b.focus(a.simplePlaceholder.hide_placeholder),b.blur(a.simplePlaceholder.show_placeholder),b.val()===""&&(b.val(b.attr("placeholder")),b.addClass(a.simplePlaceholder.placeholder_class)),b.addClass("simple-placeholder"),a(this.form).submit(a.simplePlaceholder.prevent_placeholder_submit)})}return this}}(jQuery),function(a){a.expr[":"].Contains=function(a,b,c){return jQuery(a).text().toUpperCase().indexOf(c[3].toUpperCase())>=0}}(jQuery),define("jquery-ext",function(){}),Array.prototype.push||(Array.prototype.push=function(){for(var a=0,b=arguments.length;a<b;a++)this[this.length]=arguments[a];return this.length}),Array.prototype.shift||(Array.prototype.shift=function(){if(this.length>0){var a=this[0];for(var b=0,c=this.length-1;b<c;b++)this[b]=this[b+1];return this.length=this.length-1,a}}),Array.prototype.splice||(Array.prototype.splice=function(a,b){var c=this.slice(a+b),d=this.slice(a,a+b);this.length=a;var e=[];for(var f=0,g=arguments.length;f<g;f++)e[f]=arguments[f];var h=e.length>2?c=e.slice(2).concat(c):c;for(f=0,g=h.length;f<g;f++)this.push(h[f]);return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this==null)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Function.prototype.bind||(Function.prototype.bind=function(a){if(typeof this!="function")throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof function(){}?this:a||window,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e}),Function.prototype.bind&&window.console&&"debug info warn error log".split(" ").forEach(function(a){window.console[a]=this.bind(window.console[a],window.console)},Function.prototype.call);var log4javascript=function(){function isUndefined(a){return typeof a=="undefined"}function EventSupport(){}function Log4JavaScript(){}function toStr(a){return a&&a.toString?a.toString():String(a)}function getExceptionMessage(a){return a.message?a.message:a.description?a.description:toStr(a)}function getUrlFileName(a){var b=Math.max(a.lastIndexOf("/"),a.lastIndexOf("\\"));return a.substr(b+1)}function getExceptionStringRep(a){if(a){var b="Exception: "+getExceptionMessage(a);try{a.lineNumber&&(b+=" on line number "+a.lineNumber),a.fileName&&(b+=" in file "+getUrlFileName(a.fileName))}catch(c){logLog.warn("Unable to obtain file and line information for error")}return showStackTraces&&a.stack&&(b+=newLine+"Stack trace:"+newLine+a.stack),b}return null}function bool(a){return Boolean(a)}function trim(a){return a.replace(/^\s+/,"").replace(/\s+$/,"")}function splitIntoLines(a){var b=a.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return b.split("\n")}function array_remove(a,b){var c=-1;for(var d=0,e=a.length;d<e;d++)if(a[d]===b){c=d;break}return c>=0?(a.splice(c,1),!0):!1}function array_contains(a,b){for(var c=0,d=a.length;c<d;c++)if(a[c]==b)return!0;return!1}function extractBooleanFromParam(a,b){return isUndefined(a)?b:bool(a)}function extractStringFromParam(a,b){return isUndefined(a)?b:String(a)}function extractIntFromParam(a,b){if(isUndefined(a))return b;try{var c=parseInt(a,10);return isNaN(c)?b:c}catch(d){return logLog.warn("Invalid int param "+a,d),b}}function extractFunctionFromParam(a,b){return typeof a=="function"?a:b}function isError(a){return a instanceof Error}function getListenersPropertyName(a){return"__log4javascript_listeners__"+a}function addEvent(a,b,c,d,e){e=e?e:window;if(a.addEventListener)a.addEventListener(b,c,d);else if(a.attachEvent)a.attachEvent("on"+b,c);else{var f=getListenersPropertyName(b);a[f]||(a[f]=[],a["on"+b]=function(a){a=getEvent(a,e);var c=getListenersPropertyName(b),d=this[c].concat([]),f;while(f=d.shift())f.call(this,a)}),a[f].push(c)}}function removeEvent(a,b,c,d){if(a.removeEventListener)a.removeEventListener(b,c,d);else if(a.detachEvent)a.detachEvent("on"+b,c);else{var e=getListenersPropertyName(b);a[e]&&array_remove(a[e],c)}}function getEvent(a,b){return b=b?b:window,a?a:b.event}function stopEventPropagation(a){a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="undefined"&&(a.cancelBubble=!0),a.returnValue=!1}function handleError(a,b){logLog.error(a,b),log4javascript.dispatchEvent("error",{message:a,exception:b})}function Timer(a,b){this.name=a,this.level=isUndefined(b)?Level.INFO:b,this.start=new Date}function Logger(a){this.name=a,this.parent=null,this.children=[];var b=[],c=null,d=this.name===rootLoggerName,e=this.name===nullLoggerName,f=null,g=!1;this.addChild=function(a){this.children.push(a),a.parent=this,a.invalidateAppenderCache()};var h=!0;this.getAdditivity=function(){return h},this.setAdditivity=function(a){var b=h!=a;h=a,b&&this.invalidateAppenderCache()},this.addAppender=function(a){e?handleError("Logger.addAppender: you may not add an appender to the null logger"):a instanceof log4javascript.Appender?array_contains(b,a)||(b.push(a),a.setAddedToLogger(this),this.invalidateAppenderCache()):handleError("Logger.addAppender: appender supplied ('"+toStr(a)+"') is not a subclass of Appender")},this.removeAppender=function(a){array_remove(b,a),a.setRemovedFromLogger(this),this.invalidateAppenderCache()},this.removeAllAppenders=function(){var a=b.length;if(a>0){for(var c=0;c<a;c++)b[c].setRemovedFromLogger(this);b.length=0,this.invalidateAppenderCache()}},this.getEffectiveAppenders=function(){if(f===null||g){var a=d||!this.getAdditivity()?[]:this.parent.getEffectiveAppenders();f=a.concat(b),g=!1}return f},this.invalidateAppenderCache=function(){g=!0;for(var a=0,b=this.children.length;a<b;a++)this.children[a].invalidateAppenderCache()},this.log=function(a,b){if(enabled&&a.isGreaterOrEqual(this.getEffectiveLevel())){var c,d=b.length-1,e=b[d];b.length>1&&isError(e)&&(c=e,d--);var f=[];for(var g=0;g<=d;g++)f[g]=b[g];var h=new LoggingEvent(this,new Date,a,f,c);this.callAppenders(h)}},this.callAppenders=function(a){var b=this.getEffectiveAppenders();for(var c=0,d=b.length;c<d;c++)b[c].doAppend(a)},this.setLevel=function(a){d&&a===null?handleError("Logger.setLevel: you cannot set the level of the root logger to null"):a instanceof Level?c=a:handleError("Logger.setLevel: level supplied to logger "+this.name+" is not an instance of log4javascript.Level")},this.getLevel=function(){return c},this.getEffectiveLevel=function(){for(var a=this;a!==null;a=a.parent){var b=a.getLevel();if(b!==null)return b}},this.group=function(a,b){if(enabled){var c=this.getEffectiveAppenders();for(var d=0,e=c.length;d<e;d++)c[d].group(a,b)}},this.groupEnd=function(a){if(enabled){var b=this.getEffectiveAppenders();for(var c=0,d=b.length;c<d;c++)b[c].groupEnd()}};var i={};this.time=function(a,b){enabled&&(isUndefined(a)?handleError("Logger.time: a name for the timer must be supplied"):!b||b instanceof Level?i[a]=new Timer(a,b):handleError("Logger.time: level supplied to timer "+a+" is not an instance of log4javascript.Level"))},this.timeEnd=function(a){if(enabled)if(isUndefined(a))handleError("Logger.timeEnd: a name for the timer must be supplied");else if(i[a]){var b=i[a],c=b.getElapsedTime();this.log(b.level,["Timer "+toStr(a)+" completed in "+c+"ms"]),delete i[a]}else logLog.warn("Logger.timeEnd: no timer found with name "+a)},this.assert=function(a){if(enabled&&!a){var b=[];for(var c=1,d=arguments.length;c<d;c++)b.push(arguments[c]);b=b.length>0?b:["Assertion Failure"],b.push(newLine),b.push(a),this.log(Level.ERROR,b)}},this.toString=function(){return"Logger["+this.name+"]"}}function SimpleLayout(){this.customFields=[]}function NullLayout(){this.customFields=[]}function XmlLayout(a){this.combineMessages=extractBooleanFromParam(a,!0),this.customFields=[]}function escapeNewLines(a){return a.replace(/\r\n|\r|\n/g,"\\r\\n")}function JsonLayout(a,b){this.readable=extractBooleanFromParam(a,!1),this.combineMessages=extractBooleanFromParam(b,!0),this.batchHeader=this.readable?"["+newLine:"[",this.batchFooter=this.readable?"]"+newLine:"]",this.batchSeparator=this.readable?","+newLine:",",this.setKeys(),this.colon=this.readable?": ":":",this.tab=this.readable?"\t":"",this.lineBreak=this.readable?newLine:"",this.customFields=[]}function HttpPostDataLayout(){this.setKeys(),this.customFields=[],this.returnsPostData=!0}function formatObjectExpansion(a,b,c){function e(a,b,c){function n(a){var b=splitIntoLines(a);for(var d=1,e=b.length;d<e;d++)b[d]=c+b[d];return b.join(newLine)}var f,g,h,i,j,k,l,m;c||(c="");if(a===null)return"null";if(typeof a=="undefined")return"undefined";if(typeof a=="string")return n(a);if(typeof a=="object"&&array_contains(d,a)){try{l=toStr(a)}catch(o){l="Error formatting property. Details: "+getExceptionStringRep(o)}return l+" [already expanded]"}if(a instanceof Array&&b>0){d.push(a),l="["+newLine,i=b-1,j=c+"  ",k=[];for(f=0,h=a.length;f<h;f++)try{m=e(a[f],i,j),k.push(j+m)}catch(o){k.push(j+"Error formatting array member. Details: "+getExceptionStringRep(o)+"")}return l+=k.join(","+newLine)+newLine+c+"]",l}if(typeof a=="object"&&b>0){d.push(a),l="{"+newLine,i=b-1,j=c+"  ",k=[];for(f in a)try{m=e(a[f],i,j),k.push(j+f+": "+m)}catch(o){k.push(j+f+": Error formatting property. Details: "+getExceptionStringRep(o))}return l+=k.join(","+newLine)+newLine+c+"}",l}return n(toStr(a))}var d=[];return e(a,b,c)}function PatternLayout(a){a?this.pattern=a:this.pattern=PatternLayout.DEFAULT_CONVERSION_PATTERN,this.customFields=[]}function AlertAppender(){}function BrowserConsoleAppender(){}function isHttpRequestSuccessful(a){return isUndefined(a.status)||a.status===0||a.status>=200&&a.status<300}function AjaxAppender(a){function q(a){return p?(handleError("AjaxAppender: configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0}function r(){if(c&&enabled){o=!0;var a;if(e)n.length>0?(a=n.shift(),w(t(a),r)):(o=!1,d&&u());else{while(a=n.shift())w(t(a));o=!1,d&&u()}}}function s(){if(c&&enabled){var a=b.getLayout().allowBatching()?f:1,g,h="",i=[];while(g=m.shift())i.push(g),m.length>=a&&(n.push(i),i=[]);i.length>0&&n.push(i),e=!1,d=!1,r()}}function t(a){var c=[],d,e="";while(d=a.shift()){var f=b.getLayout().format(d);b.getLayout().ignoresThrowable()&&(f+=loggingEvent.getThrowableStrRep()),c.push(f)}return a.length==1?e=c.join(""):e=b.getLayout().batchHeader+c.join(b.getLayout().batchSeparator)+b.getLayout().batchFooter,e=b.getLayout().returnsPostData?e:urlEncode(j)+"="+urlEncode(e),e.length>0&&(e+="&"),e+"layout="+urlEncode(b.getLayout().toString())}function u(){window.setTimeout(r,g)}function v(){var a="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(a),c=!1,i&&i(a)}function w(d,e){try{var f=getXmlHttp(v);if(c){f.overrideMimeType&&f.overrideMimeType(b.getLayout().getContentType()),f.onreadystatechange=function(){if(f.readyState==4){if(isHttpRequestSuccessful(f))h&&h(f),e&&e(f);else{var b="AjaxAppender.append: XMLHttpRequest request to URL "+a+" returned status code "+f.status;handleError(b),i&&i(b)}f.onreadystatechange=emptyFunction,f=null}},f.open("POST",a,!0);try{f.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(g){var j="AjaxAppender.append: your browser's XMLHttpRequest implementation does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";handleError(j),c=!1,i&&i(j);return}f.send(d)}}catch(k){var l="AjaxAppender.append: error sending log message to "+a;handleError(l,k),c=!1,i&&i(l+". Details: "+getExceptionStringRep(k))}}function x(){p=!0,k&&addEvent(window,"unload",s),d&&u()}var b=this,c=!0;a||(handleError("AjaxAppender: URL must be specified in constructor"),c=!1);var d=this.defaults.timed,e=this.defaults.waitForResponse,f=this.defaults.batchSize,g=this.defaults.timerInterval,h=this.defaults.requestSuccessCallback,i=this.defaults.failCallback,j=this.defaults.postVarName,k=this.defaults.sendAllOnUnload,l=null,m=[],n=[],o=!1,p=!1;this.getSessionId=function(){return l},this.setSessionId=function(a){l=extractStringFromParam(a,null),this.layout.setCustomField("sessionid",l)},this.setLayout=function(a){q("layout")&&(this.layout=a,l!==null&&this.setSessionId(l))},this.isTimed=function(){return d},this.setTimed=function(a){q("timed")&&(d=bool(a))},this.getTimerInterval=function(){return g},this.setTimerInterval=function(a){q("timerInterval")&&(g=extractIntFromParam(a,g))},this.isWaitForResponse=function(){return e},this.setWaitForResponse=function(a){q("waitForResponse")&&(e=bool(a))},this.getBatchSize=function(){return f},this.setBatchSize=function(a){q("batchSize")&&(f=extractIntFromParam(a,f))},this.isSendAllOnUnload=function(){return k},this.setSendAllOnUnload=function(a){q("sendAllOnUnload")&&(k=extractIntFromParam(a,k))},this.setRequestSuccessCallback=function(a){h=extractFunctionFromParam(a,h)},this.setFailCallback=function(a){i=extractFunctionFromParam(a,i)},this.getPostVarName=function(){return j},this.setPostVarName=function(a){q("postVarName")&&(j=extractStringFromParam(a,j))},this.sendAll=r,this.append=function(a){if(c){p||x(),m.push(a);var b=this.getLayout().allowBatching()?f:1;if(m.length>=b){var g,h=[];while(g=m.shift())h.push(g);n.push(h),!d&&(!e||e&&!o)&&r()}}}}function setCookie(a,b,c,d){var e;d=d?"; path="+d:"";if(c){var f=new Date;f.setTime(f.getTime()+c*24*60*60*1e3),e="; expires="+f.toGMTString()}else e="";document.cookie=escape(a)+"="+escape(b)+e+d}function getCookie(a){var b=escape(a)+"=",c=document.cookie.split(";");for(var d=0,e=c.length;d<e;d++){var f=c[d];while(f.charAt(0)===" ")f=f.substring(1,f.length);if(f.indexOf(b)===0)return unescape(f.substring(b.length,f.length))}return null}function getBaseUrl(){var a=document.getElementsByTagName("script");for(var b=0,c=a.length;b<c;++b)if(a[b].src.indexOf("log4javascript")!=-1){var d=a[b].src.lastIndexOf("/");return d==-1?"":a[b].src.substr(0,d+1)}return null}function isLoaded(a){try{return bool(a.loaded)}catch(b){return!1}}function padWithSpaces(a,b){if(a.length<b){var c=[],d=Math.max(0,b-a.length);for(var e=0;e<d;e++)c[e]=" ";a+=c.join("")}return a}EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(a){if(a instanceof Array){this.eventTypes=a,this.eventListeners={};for(var b=0,c=this.eventTypes.length;b<c;b++)this.eventListeners[this.eventTypes[b]]=[]}else handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array")},addEventListener:function(a,b){typeof b=="function"?(array_contains(this.eventTypes,a)||handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+a+"'"),this.eventListeners[a].push(b)):handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function")},removeEventListener:function(a,b){typeof b=="function"?(array_contains(this.eventTypes,a)||handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+a+"'"),array_remove(this.eventListeners[a],b)):handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function")},dispatchEvent:function(a,b){if(array_contains(this.eventTypes,a)){var c=this.eventListeners[a];for(var d=0,e=c.length;d<e;d++)c[d](this,a,b)}else handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+a+"'")}};var applicationStartDate=new Date,uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+Math.floor(Math.random()*1e8),emptyFunction=function(){},newLine="\r\n",pageLoaded=!1;Log4JavaScript.prototype=new EventSupport,log4javascript=new Log4JavaScript,log4javascript.version="1.4.2",log4javascript.edition="log4javascript";var urlEncode=typeof window.encodeURIComponent!="undefined"?function(a){return encodeURIComponent(a)}:function(a){return escape(a).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D")},urlDecode=typeof window.decodeURIComponent!="undefined"?function(a){return decodeURIComponent(a)}:function(a){return unescape(a).replace(/%2B/g,"+").replace(/%22/g,'"').replace(/%27/g,"'").replace(/%2F/g,"/").replace(/%3D/g,"=")};Function.prototype.apply||(Function.prototype.apply=function(obj,args){var methodName="__apply__";typeof obj[methodName]!="undefined"&&(methodName+=String(Math.random()).substr(2)),obj[methodName]=this;var argsStrings=[];for(var i=0,len=args.length;i<len;i++)argsStrings[i]="args["+i+"]";var script="obj."+methodName+"("+argsStrings.join(",")+")",returnValue=eval(script);return delete obj[methodName],returnValue}),Function.prototype.call||(Function.prototype.call=function(a){var b=[];for(var c=1,d=arguments.length;c<d;c++)b[c-1]=arguments[c];return this.apply(a,b)});var logLog={quietMode:!1,debugMessages:[],setQuietMode:function(a){this.quietMode=bool(a)},numberOfErrors:0,alertAllErrors:!1,setAlertAllErrors:function(a){this.alertAllErrors=a},debug:function(a){this.debugMessages.push(a)},displayDebug:function(){alert(this.debugMessages.join(newLine))},warn:function(a,b){},error:function(a,b){if(++this.numberOfErrors==1||this.alertAllErrors)if(!this.quietMode){var c="log4javascript error: "+a;b&&(c+=newLine+newLine+"Original error: "+getExceptionStringRep(b)),alert(c)}}};log4javascript.logLog=logLog,log4javascript.setEventTypes(["load","error"]),log4javascript.handleError=handleError;var enabled=typeof log4javascript_disabled=="undefined"||!log4javascript_disabled;log4javascript.setEnabled=function(a){enabled=bool(a)},log4javascript.isEnabled=function(){return enabled};var useTimeStampsInMilliseconds=!0;log4javascript.setTimeStampsInMilliseconds=function(a){useTimeStampsInMilliseconds=bool(a)},log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds},log4javascript.evalInScope=function(expr){return eval(expr)};var showStackTraces=!1;log4javascript.setShowStackTraces=function(a){showStackTraces=bool(a)};var Level=function(a,b){this.level=a,this.name=b};Level.prototype={toString:function(){return this.name},equals:function(a){return this.level==a.level},isGreaterOrEqual:function(a){return this.level>=a.level}},Level.ALL=new Level(Number.MIN_VALUE,"ALL"),Level.TRACE=new Level(1e4,"TRACE"),Level.DEBUG=new Level(2e4,"DEBUG"),Level.INFO=new Level(3e4,"INFO"),Level.WARN=new Level(4e4,"WARN"),Level.ERROR=new Level(5e4,"ERROR"),Level.FATAL=new Level(6e4,"FATAL"),Level.OFF=new Level(Number.MAX_VALUE,"OFF"),log4javascript.Level=Level,Timer.prototype.getElapsedTime=function(){return(new Date).getTime()-this.start.getTime()};var anonymousLoggerName="[anonymous]",defaultLoggerName="[default]",nullLoggerName="[null]",rootLoggerName="root";Logger.prototype={trace:function(){this.log(Level.TRACE,arguments)},debug:function(){this.log(Level.DEBUG,arguments)},info:function(){this.log(Level.INFO,arguments)},warn:function(){this.log(Level.WARN,arguments)},error:function(){this.log(Level.ERROR,arguments)},fatal:function(){this.log(Level.FATAL,arguments)},isEnabledFor:function(a){return a.isGreaterOrEqual(this.getEffectiveLevel())},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE)},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG)},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO)},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN)},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR)},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL)}},Logger.prototype.trace.isEntryPoint=!0,Logger.prototype.debug.isEntryPoint=!0,Logger.prototype.info.isEntryPoint=!0,Logger.prototype.warn.isEntryPoint=!0,Logger.prototype.error.isEntryPoint=!0,Logger.prototype.fatal.isEntryPoint=!0;var loggers={},loggerNames=[],ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG,rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),log4javascript.getRootLogger=function(){return rootLogger},log4javascript.getLogger=function(a){typeof a!="string"&&(a=anonymousLoggerName,logLog.warn("log4javascript.getLogger: non-string logger name "+toStr(a)+" supplied, returning anonymous logger")),a==rootLoggerName&&handleError("log4javascript.getLogger: root logger may not be obtained by name");if(!loggers[a]){var b=new Logger(a);loggers[a]=b,loggerNames.push(a);var c=a.lastIndexOf("."),d;if(c>-1){var e=a.substring(0,c);d=log4javascript.getLogger(e)}else d=rootLogger;d.addChild(b)}return loggers[a]};var defaultLogger=null;log4javascript.getDefaultLogger=function(){if(!defaultLogger){defaultLogger=log4javascript.getLogger(defaultLoggerName);var a=new log4javascript.PopUpAppender;defaultLogger.addAppender(a)}return defaultLogger};var nullLogger=null;log4javascript.getNullLogger=function(){return nullLogger||(nullLogger=new Logger(nullLoggerName),nullLogger.setLevel(Level.OFF)),nullLogger},log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL),loggers={}};var LoggingEvent=function(a,b,c,d,e){this.logger=a,this.timeStamp=b,this.timeStampInMilliseconds=b.getTime(),this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1e3),this.milliseconds=this.timeStamp.getMilliseconds(),this.level=c,this.messages=d,this.exception=e};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):""},getCombinedMessages:function(){return this.messages.length==1?this.messages[0]:this.messages.join(newLine)},toString:function(){return"LoggingEvent["+this.level+"]"}},log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:!1,overrideTimeStampsSetting:!1,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method")},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method")},getContentType:function(){return"text/plain"},allowBatching:function(){return!0},setTimeStampsInMilliseconds:function(a){this.overrideTimeStampsSetting=!0,this.useTimeStampsInMilliseconds=bool(a)},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds},getTimeStampValue:function(a){return this.isTimeStampsInMilliseconds()?a.timeStampInMilliseconds:a.timeStampInSeconds},getDataValues:function(a,b){var c=[[this.loggerKey,a.logger.name],[this.timeStampKey,this.getTimeStampValue(a)],[this.levelKey,a.level.name],[this.urlKey,window.location.href],[this.messageKey,b?a.getCombinedMessages():a.messages]];this.isTimeStampsInMilliseconds()||c.push([this.millisecondsKey,a.milliseconds]),a.exception&&c.push([this.exceptionKey,getExceptionStringRep(a.exception)]);if(this.hasCustomFields())for(var d=0,e=this.customFields.length;d<e;d++){var f=this.customFields[d].value;typeof f=="function"&&(f=f(this,a)),c.push([this.customFields[d].name,f])}return c},setKeys:function(a,b,c,d,e,f,g){this.loggerKey=extractStringFromParam(a,this.defaults.loggerKey),this.timeStampKey=extractStringFromParam(b,this.defaults.timeStampKey),this.levelKey=extractStringFromParam(c,this.defaults.levelKey),this.messageKey=extractStringFromParam(d,this.defaults.messageKey),this.exceptionKey=extractStringFromParam(e,this.defaults.exceptionKey),this.urlKey=extractStringFromParam(f,this.defaults.urlKey),this.millisecondsKey=extractStringFromParam(g,this.defaults.millisecondsKey)},setCustomField:function(a,b){var c=!1;for(var d=0,e=this.customFields.length;d<e;d++)this.customFields[d].name===a&&(this.customFields[d].value=b,c=!0);c||this.customFields.push({name:a,value:b})},hasCustomFields:function(){return this.customFields.length>0},toString:function(){handleError("Layout.toString: all layouts must override this method")}},log4javascript.Layout=Layout;var Appender=function(){};Appender.prototype=new EventSupport,Appender.prototype.layout=new PatternLayout,Appender.prototype.threshold=Level.ALL,Appender.prototype.loggers=[],Appender.prototype.doAppend=function(a){enabled&&a.level.level>=this.threshold.level&&this.append(a)},Appender.prototype.append=function(a){},Appender.prototype.setLayout=function(a){a instanceof Layout?this.layout=a:handleError("Appender.setLayout: layout supplied to "+this.toString()+" is not a subclass of Layout")},Appender.prototype.getLayout=function(){return this.layout},Appender.prototype.setThreshold=function(a){a instanceof Level?this.threshold=a:handleError("Appender.setThreshold: threshold supplied to "+this.toString()+" is not a subclass of Level")},Appender.prototype.getThreshold=function(){return this.threshold},Appender.prototype.setAddedToLogger=function(a){this.loggers.push(a)},Appender.prototype.setRemovedFromLogger=function(a){array_remove(this.loggers,a)},Appender.prototype.group=emptyFunction,Appender.prototype.groupEnd=emptyFunction,Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method")},log4javascript.Appender=Appender,SimpleLayout.prototype=new Layout,SimpleLayout.prototype.format=function(a){return a.level.name+" - "+a.getCombinedMessages()},SimpleLayout.prototype.ignoresThrowable=function(){return!0},SimpleLayout.prototype.toString=function(){return"SimpleLayout"},log4javascript.SimpleLayout=SimpleLayout,NullLayout.prototype=new Layout,NullLayout.prototype.format=function(a){return a.messages},NullLayout.prototype.ignoresThrowable=function(){return!0},NullLayout.prototype.toString=function(){return"NullLayout"},log4javascript.NullLayout=NullLayout,XmlLayout.prototype=new Layout,XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages},XmlLayout.prototype.getContentType=function(){return"text/xml"},XmlLayout.prototype.escapeCdata=function(a){return a.replace(/\]\]>/,"]]>]]&gt;<![CDATA[")},XmlLayout.prototype.format=function(a){function e(a){return a=typeof a=="string"?a:toStr(a),"<log4javascript:message><![CDATA["+b.escapeCdata(a)+"]]></log4javascript:message>"}var b=this,c,d,f='<log4javascript:event logger="'+a.logger.name+'" timestamp="'+this.getTimeStampValue(a)+'"';this.isTimeStampsInMilliseconds()||(f+=' milliseconds="'+a.milliseconds+'"'),f+=' level="'+a.level.name+'">'+newLine;if(this.combineMessages)f+=e(a.getCombinedMessages());else{f+="<log4javascript:messages>"+newLine;for(c=0,d=a.messages.length;c<d;c++)f+=e(a.messages[c])+newLine;f+="</log4javascript:messages>"+newLine}if(this.hasCustomFields())for(c=0,d=this.customFields.length;c<d;c++)f+='<log4javascript:customfield name="'+this.customFields[c].name+'"><![CDATA['+this.customFields[c].value.toString()+"]]></log4javascript:customfield>"+newLine;return a.exception&&(f+="<log4javascript:exception><![CDATA["+getExceptionStringRep(a.exception)+"]]></log4javascript:exception>"+newLine),f+="</log4javascript:event>"+newLine+newLine,f},XmlLayout.prototype.ignoresThrowable=function(){return!1},XmlLayout.prototype.toString=function(){return"XmlLayout"},log4javascript.XmlLayout=XmlLayout,JsonLayout.prototype=new Layout,JsonLayout.prototype.isReadable=function(){return this.readable},JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages},JsonLayout.prototype.format=function(a){function g(a,c,d){var e,f=typeof a;if(a instanceof Date)e=String(a.getTime());else if(d&&a instanceof Array){e="["+b.lineBreak;for(var h=0,i=a.length;h<i;h++){var j=c+b.tab;e+=j+g(a[h],j,!1),h<a.length-1&&(e+=","),e+=b.lineBreak}e+=c+"]"}else f!=="number"&&f!=="boolean"?e='"'+escapeNewLines(toStr(a).replace(/\"/g,'\\"'))+'"':e=a;return e}var b=this,c=this.getDataValues(a,this.combineMessages),d="{"+this.lineBreak,e,f;for(e=0,f=c.length-1;e<=f;e++)d+=this.tab+'"'+c[e][0]+'"'+this.colon+g(c[e][1],this.tab,!0),e<f&&(d+=","),d+=this.lineBreak;return d+="}"+this.lineBreak,d},JsonLayout.prototype.ignoresThrowable=function(){return!1},JsonLayout.prototype.toString=function(){return"JsonLayout"},JsonLayout.prototype.getContentType=function(){return"application/json"},log4javascript.JsonLayout=JsonLayout,HttpPostDataLayout.prototype=new Layout,HttpPostDataLayout.prototype.allowBatching=function(){return!1},HttpPostDataLayout.prototype.format=function(a){var b=this.getDataValues(a),c=[];for(var d=0,e=b.length;d<e;d++){var f=b[d][1]instanceof Date?String(b[d][1].getTime()):b[d][1];c.push(urlEncode(b[d][0])+"="+urlEncode(f))}return c.join("&")},HttpPostDataLayout.prototype.ignoresThrowable=function(a){return!1},HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout"},log4javascript.HttpPostDataLayout=HttpPostDataLayout;var SimpleDateFormat;(function(){var a=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/,b=["January","February","March","April","May","June","July","August","September","October","November","December"],c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],d=0,e=1,f=2,g=3,h=4,i=5,j={G:d,y:g,M:h,w:f,W:f,D:f,d:f,F:f,E:e,a:d,H:f,k:f,K:f,h:f,m:f,s:f,S:f,Z:i},k=864e5,l=7*k,m=1,n=function(a,b,c){var d=new Date(a,b,c,0,0,0);return d.setMilliseconds(0),d};Date.prototype.getDifference=function(a){return this.getTime()-a.getTime()},Date.prototype.isBefore=function(a){return this.getTime()<a.getTime()},Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds())},Date.prototype.getTimeSince=function(a){return this.getUTCTime()-a.getUTCTime()},Date.prototype.getPreviousSunday=function(){var a=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0),b=new Date(a.getTime()-this.getDay()*k);return n(b.getFullYear(),b.getMonth(),b.getDate())},Date.prototype.getWeekInYear=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),0,1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return e<a&&f--,f},Date.prototype.getWeekInMonth=function(a){isUndefined(this.minimalDaysInFirstWeek)&&(a=m);var b=this.getPreviousSunday(),c=n(this.getFullYear(),this.getMonth(),1),d=b.isBefore(c)?0:1+Math.floor(b.getTimeSince(c)/l),e=7-c.getDay(),f=d;return e>=a&&f++,f},Date.prototype.getDayInYear=function(){var a=n(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(a)/k)},SimpleDateFormat=function(a){this.formatString=a},SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(a){this.minimalDaysInFirstWeek=a},SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?m:this.minimalDaysInFirstWeek};var o=function(a,b){while(a.length<b)a="0"+a;return a},p=function(a,b,c){return b>=4?a:a.substr(0,Math.max(c,b))},q=function(a,b){var c=""+a;return o(c,b)};SimpleDateFormat.prototype.format=function(k){var l="",m,n=this.formatString;while(m=a.exec(n)){var r=m[1],s=m[2],t=m[3],u=m[4];if(r)r=="''"?l+="'":l+=r.substring(1,r.length-1);else if(!t)if(u)l+=u;else if(s){var v=s.charAt(0),w=s.length,x="";switch(v){case"G":x="AD";break;case"y":x=k.getFullYear();break;case"M":x=k.getMonth();break;case"w":x=k.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":x=k.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":x=k.getDayInYear();break;case"d":x=k.getDate();break;case"F":x=1+Math.floor((k.getDate()-1)/7);break;case"E":x=c[k.getDay()];break;case"a":x=k.getHours()>=12?"PM":"AM";break;case"H":x=k.getHours();break;case"k":x=k.getHours()||24;break;case"K":x=k.getHours()%12;break;case"h":x=k.getHours()%12||12;break;case"m":x=k.getMinutes();break;case"s":x=k.getSeconds();break;case"S":x=k.getMilliseconds();break;case"Z":x=k.getTimezoneOffset()}switch(j[v]){case d:l+=p(x,w,2);break;case e:l+=p(x,w,3);break;case f:l+=q(x,w);break;case g:if(w<=3){var y=""+x;l+=y.substr(2,2)}else l+=q(x,w);break;case h:w>=3?l+=p(b[x],w,w):l+=q(x+1,w);break;case i:var z=x>0,A=z?"-":"+",B=Math.abs(x),C=""+Math.floor(B/60);C=o(C,2);var D=""+B%60;D=o(D,2),l+=A+C+D}}n=n.substr(m.index+m[0].length)}return l}})(),log4javascript.SimpleDateFormat=SimpleDateFormat,PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n",PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n",PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS",PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS",PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS",PatternLayout.prototype=new Layout,PatternLayout.prototype.format=function(a){var b=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/,c="",d,e=this.pattern;while(d=b.exec(e)){var f=d[0],g=d[1],h=d[2],i=d[3],j=d[5],k=d[6];if(k)c+=""+k;else{var l="";switch(i){case"a":case"m":var m=0;j&&(m=parseInt(j,10),isNaN(m)&&(handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character '"+i+"' - should be a number"),m=0));var n=i==="a"?a.messages[0]:a.messages;for(var o=0,p=n.length;o<p;o++)o>0&&l.charAt(l.length-1)!==" "&&(l+=" "),m===0?l+=n[o]:l+=formatObjectExpansion(n[o],m);break;case"c":var q=a.logger.name;if(j){var r=parseInt(j,10),s=a.logger.name.split(".");r>=s.length?l=q:l=s.slice(s.length-r).join(".")}else l=q;break;case"d":var t=PatternLayout.ISO8601_DATEFORMAT;j&&(t=j,t=="ISO8601"?t=PatternLayout.ISO8601_DATEFORMAT:t=="ABSOLUTE"?t=PatternLayout.ABSOLUTETIME_DATEFORMAT:t=="DATE"&&(t=PatternLayout.DATETIME_DATEFORMAT)),l=(new SimpleDateFormat(t)).format(a.timeStamp);break;case"f":if(this.hasCustomFields()){var u=0;j&&(u=parseInt(j,10),isNaN(u)?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - should be a number"):u===0?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - must be greater than zero"):u>this.customFields.length?handleError("PatternLayout.format: invalid specifier '"+j+"' for conversion character 'f' - there aren't that many custom fields"):u-=1),l=this.customFields[u].value}break;case"n":l=newLine;break;case"p":l=a.level.name;break;case"r":l=""+a.timeStamp.getDifference(applicationStartDate);break;case"%":l="%";break;default:l=f}var v;if(h){v=parseInt(h.substr(1),10);var w=l.length;v<w&&(l=l.substring(w-v,w))}if(g)if(g.charAt(0)=="-"){v=parseInt(g.substr(1),10);while(l.length<v)l+=" "}else{v=parseInt(g,10);while(l.length<v)l=" "+l}c+=l}e=e.substr(d.index+d[0].length)}return c},PatternLayout.prototype.ignoresThrowable=function(){return!0},PatternLayout.prototype.toString=function(){return"PatternLayout"},log4javascript.PatternLayout=PatternLayout,AlertAppender.prototype=new Appender,AlertAppender.prototype.layout=new SimpleLayout,AlertAppender.prototype.append=function(a){var b=this.getLayout().format(a);this.getLayout().ignoresThrowable()&&(b+=a.getThrowableStrRep()),alert(b)},AlertAppender.prototype.toString=function(){return"AlertAppender"},log4javascript.AlertAppender=AlertAppender,BrowserConsoleAppender.prototype=new log4javascript.Appender,BrowserConsoleAppender.prototype.layout=new NullLayout,BrowserConsoleAppender.prototype.threshold=Level.DEBUG,BrowserConsoleAppender.prototype.append=function(a){var b=this,c=function(){var c=b.getLayout(),d=c.format(a);return c.ignoresThrowable()&&a.exception&&(d+=a.getThrowableStrRep()),d};if(typeof opera!="undefined"&&opera.postError)opera.postError(c());else if(window.console&&window.console.log){var d=c();$.isArray(d)||(d=[d]);if(window.console.debug&&Level.DEBUG.isGreaterOrEqual(a.level))try{window.console.debug.apply(this,d)}catch(e){window.console.log.apply(this,d)}else window.console.info&&Level.INFO.equals(a.level)?window.console.info.apply(this,d):window.console.warn&&Level.WARN.equals(a.level)?window.console.warn.apply(this,d):window.console.error&&a.level.isGreaterOrEqual(Level.ERROR)?window.console.error.apply(this,d):window.console.log.apply(this,d)}},BrowserConsoleAppender.prototype.group=function(a){window.console&&window.console.group&&window.console.group(a)},BrowserConsoleAppender.prototype.groupEnd=function(){window.console&&window.console.groupEnd&&window.console.groupEnd()},BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender"},log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xmlHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],getXmlHttp=function(a){var b=null,c;for(var d=0,e=xmlHttpFactories.length;d<e;d++){c=xmlHttpFactories[d];try{return b=c(),getXmlHttp=c,b}catch(f){}}a?a():handleError("getXmlHttp: unable to obtain XMLHttpRequest object")};AjaxAppender.prototype=new Appender,AjaxAppender.prototype.defaults={waitForResponse:!1,timed:!1,timerInterval:1e3,batchSize:1,sendAllOnUnload:!0,requestSuccessCallback:null,failCallback:null,postVarName:"data"},AjaxAppender.prototype.layout=new HttpPostDataLayout,AjaxAppender.prototype.toString=function(){return"AjaxAppender"},log4javascript.AjaxAppender=AjaxAppender;var ConsoleAppender;(function(){function d(a,b,c,d,e){this.create(!1,null,a,b,c,d,e,this.defaults.focusPopUp)}function e(a,b,c,d,e,f){this.create(!0,a,b,c,d,e,f,!1)}var a=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">',"\t<head>","\t\t<title>log4javascript</title>",'\t\t<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />',"\t\t<!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->",'\t\t<meta http-equiv="X-UA-Compatible" content="IE=7" />','\t\t<script type="text/javascript">var isIe = false, isIePre7 = false;</script>','\t\t<!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','\t\t<!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','\t\t<script type="text/javascript">',"\t\t\t//<![CDATA[","\t\t\tvar loggingEnabled = true;","\t\t\tvar logQueuedEventsTimer = null;","\t\t\tvar logEntries = [];","\t\t\tvar logEntriesAndSeparators = [];","\t\t\tvar logItems = [];","\t\t\tvar renderDelay = 100;","\t\t\tvar unrenderedLogItemsExist = false;","\t\t\tvar rootGroup, currentGroup = null;","\t\t\tvar loaded = false;","\t\t\tvar currentLogItem = null;","\t\t\tvar logMainContainer;","","\t\t\tfunction copyProperties(obj, props) {","\t\t\t\tfor (var i in props) {","\t\t\t\t\tobj[i] = props[i];","\t\t\t\t}","\t\t\t}","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogItem() {","\t\t\t}","","\t\t\tLogItem.prototype = {","\t\t\t\tmainContainer: null,","\t\t\t\twrappedContainer: null,","\t\t\t\tunwrappedContainer: null,","\t\t\t\tgroup: null,","","\t\t\t\tappendToLog: function() {","\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\tthis.elementContainers[i].appendToLog();","\t\t\t\t\t}","\t\t\t\t\tthis.group.update();","\t\t\t\t},","","\t\t\t\tdoRemove: function(doUpdate, removeFromGroup) {","\t\t\t\t\tif (this.rendered) {","\t\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\t\tthis.elementContainers[i].remove();","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.unwrappedElementContainer = null;","\t\t\t\t\t\tthis.wrappedElementContainer = null;","\t\t\t\t\t\tthis.mainElementContainer = null;","\t\t\t\t\t}","\t\t\t\t\tif (this.group && removeFromGroup) {","\t\t\t\t\t\tthis.group.removeChild(this, doUpdate);","\t\t\t\t\t}","\t\t\t\t\tif (this === currentLogItem) {","\t\t\t\t\t\tcurrentLogItem = null;","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tremove: function(doUpdate, removeFromGroup) {","\t\t\t\t\tthis.doRemove(doUpdate, removeFromGroup);","\t\t\t\t},","","\t\t\t\trender: function() {},","","\t\t\t\taccept: function(visitor) {","\t\t\t\t\tvisitor.visit(this);","\t\t\t\t},","","\t\t\t\tgetUnwrappedDomContainer: function() {","\t\t\t\t\treturn this.group.unwrappedElementContainer.contentDiv;","\t\t\t\t},","","\t\t\t\tgetWrappedDomContainer: function() {","\t\t\t\t\treturn this.group.wrappedElementContainer.contentDiv;","\t\t\t\t},","","\t\t\t\tgetMainDomContainer: function() {","\t\t\t\t\treturn this.group.mainElementContainer.contentDiv;","\t\t\t\t}","\t\t\t};","","\t\t\tLogItem.serializedItemKeys = {LOG_ENTRY: 0, GROUP_START: 1, GROUP_END: 2};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogItemContainerElement() {","\t\t\t}","","\t\t\tLogItemContainerElement.prototype = {","\t\t\t\tappendToLog: function() {","\t\t\t\t\tvar insertBeforeFirst = (newestAtTop && this.containerDomNode.hasChildNodes());","\t\t\t\t\tif (insertBeforeFirst) {","\t\t\t\t\t\tthis.containerDomNode.insertBefore(this.mainDiv, this.containerDomNode.firstChild);","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.containerDomNode.appendChild(this.mainDiv);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction SeparatorElementContainer(containerDomNode) {","\t\t\t\tthis.containerDomNode = containerDomNode;",'\t\t\t\tthis.mainDiv = document.createElement("div");','\t\t\t\tthis.mainDiv.className = "separator";','\t\t\t\tthis.mainDiv.innerHTML = "&nbsp;";',"\t\t\t}","","\t\t\tSeparatorElementContainer.prototype = new LogItemContainerElement();","","\t\t\tSeparatorElementContainer.prototype.remove = function() {","\t\t\t\tthis.mainDiv.parentNode.removeChild(this.mainDiv);","\t\t\t\tthis.mainDiv = null;","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction Separator() {","\t\t\t\tthis.rendered = false;","\t\t\t}","","\t\t\tSeparator.prototype = new LogItem();","","\t\t\tcopyProperties(Separator.prototype, {","\t\t\t\trender: function() {","\t\t\t\t\tvar containerDomNode = this.group.contentDiv;","\t\t\t\t\tif (isIe) {","\t\t\t\t\t\tthis.unwrappedElementContainer = new SeparatorElementContainer(this.getUnwrappedDomContainer());","\t\t\t\t\t\tthis.wrappedElementContainer = new SeparatorElementContainer(this.getWrappedDomContainer());","\t\t\t\t\t\tthis.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.mainElementContainer = new SeparatorElementContainer(this.getMainDomContainer());","\t\t\t\t\t\tthis.elementContainers = [this.mainElementContainer];","\t\t\t\t\t}","\t\t\t\t\tthis.content = this.formattedMessage;","\t\t\t\t\tthis.rendered = true;","\t\t\t\t}","\t\t\t});","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction GroupElementContainer(group, containerDomNode, isRoot, isWrapped) {","\t\t\t\tthis.group = group;","\t\t\t\tthis.containerDomNode = containerDomNode;","\t\t\t\tthis.isRoot = isRoot;","\t\t\t\tthis.isWrapped = isWrapped;","\t\t\t\tthis.expandable = false;","","\t\t\t\tif (this.isRoot) {","\t\t\t\t\tif (isIe) {",'\t\t\t\t\t\tthis.contentDiv = logMainContainer.appendChild(document.createElement("div"));','\t\t\t\t\t\tthis.contentDiv.id = this.isWrapped ? "log_wrapped" : "log_unwrapped";',"\t\t\t\t\t} else {","\t\t\t\t\t\tthis.contentDiv = logMainContainer;","\t\t\t\t\t}","\t\t\t\t} else {","\t\t\t\t\tvar groupElementContainer = this;","\t\t\t\t\t",'\t\t\t\t\tthis.mainDiv = document.createElement("div");','\t\t\t\t\tthis.mainDiv.className = "group";',"",'\t\t\t\t\tthis.headingDiv = this.mainDiv.appendChild(document.createElement("div"));','\t\t\t\t\tthis.headingDiv.className = "groupheading";',"",'\t\t\t\t\tthis.expander = this.headingDiv.appendChild(document.createElement("span"));','\t\t\t\t\tthis.expander.className = "expander unselectable greyedout";',"\t\t\t\t\tthis.expander.unselectable = true;",'\t\t\t\t\tvar expanderText = this.group.expanded ? "-" : "+";',"\t\t\t\t\tthis.expanderTextNode = this.expander.appendChild(document.createTextNode(expanderText));","\t\t\t\t\t",'\t\t\t\t\tthis.headingDiv.appendChild(document.createTextNode(" " + this.group.name));',"",'\t\t\t\t\tthis.contentDiv = this.mainDiv.appendChild(document.createElement("div"));','\t\t\t\t\tvar contentCssClass = this.group.expanded ? "expanded" : "collapsed";','\t\t\t\t\tthis.contentDiv.className = "groupcontent " + contentCssClass;',"","\t\t\t\t\tthis.expander.onclick = function() {","\t\t\t\t\t\tif (groupElementContainer.group.expandable) {","\t\t\t\t\t\t\tgroupElementContainer.group.toggleExpanded();","\t\t\t\t\t\t}","\t\t\t\t\t};","\t\t\t\t}","\t\t\t}","","\t\t\tGroupElementContainer.prototype = new LogItemContainerElement();","","\t\t\tcopyProperties(GroupElementContainer.prototype, {","\t\t\t\ttoggleExpanded: function() {","\t\t\t\t\tif (!this.isRoot) {","\t\t\t\t\t\tvar oldCssClass, newCssClass, expanderText;","\t\t\t\t\t\tif (this.group.expanded) {",'\t\t\t\t\t\t\tnewCssClass = "expanded";','\t\t\t\t\t\t\toldCssClass = "collapsed";','\t\t\t\t\t\t\texpanderText = "-";',"\t\t\t\t\t\t} else {",'\t\t\t\t\t\t\tnewCssClass = "collapsed";','\t\t\t\t\t\t\toldCssClass = "expanded";','\t\t\t\t\t\t\texpanderText = "+";',"\t\t\t\t\t\t}","\t\t\t\t\t\treplaceClass(this.contentDiv, newCssClass, oldCssClass);","\t\t\t\t\t\tthis.expanderTextNode.nodeValue = expanderText;","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tremove: function() {","\t\t\t\t\tif (!this.isRoot) {","\t\t\t\t\t\tthis.headingDiv = null;","\t\t\t\t\t\tthis.expander.onclick = null;","\t\t\t\t\t\tthis.expander = null;","\t\t\t\t\t\tthis.expanderTextNode = null;","\t\t\t\t\t\tthis.contentDiv = null;","\t\t\t\t\t\tthis.containerDomNode = null;","\t\t\t\t\t\tthis.mainDiv.parentNode.removeChild(this.mainDiv);","\t\t\t\t\t\tthis.mainDiv = null;","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\treverseChildren: function() {","\t\t\t\t\t// Invert the order of the log entries","\t\t\t\t\tvar node = null;","","\t\t\t\t\t// Remove all the log container nodes","\t\t\t\t\tvar childDomNodes = [];","\t\t\t\t\twhile ((node = this.contentDiv.firstChild)) {","\t\t\t\t\t\tthis.contentDiv.removeChild(node);","\t\t\t\t\t\tchildDomNodes.push(node);","\t\t\t\t\t}","","\t\t\t\t\t// Put them all back in reverse order","\t\t\t\t\twhile ((node = childDomNodes.pop())) {","\t\t\t\t\t\tthis.contentDiv.appendChild(node);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tupdate: function() {","\t\t\t\t\tif (!this.isRoot) {","\t\t\t\t\t\tif (this.group.expandable) {",'\t\t\t\t\t\t\tremoveClass(this.expander, "greyedout");',"\t\t\t\t\t\t} else {",'\t\t\t\t\t\t\taddClass(this.expander, "greyedout");',"\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tclear: function() {","\t\t\t\t\tif (this.isRoot) {",'\t\t\t\t\t\tthis.contentDiv.innerHTML = "";',"\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction Group(name, isRoot, initiallyExpanded) {","\t\t\t\tthis.name = name;","\t\t\t\tthis.group = null;","\t\t\t\tthis.isRoot = isRoot;","\t\t\t\tthis.initiallyExpanded = initiallyExpanded;","\t\t\t\tthis.elementContainers = [];","\t\t\t\tthis.children = [];","\t\t\t\tthis.expanded = initiallyExpanded;","\t\t\t\tthis.rendered = false;","\t\t\t\tthis.expandable = false;","\t\t\t}","","\t\t\tGroup.prototype = new LogItem();","","\t\t\tcopyProperties(Group.prototype, {","\t\t\t\taddChild: function(logItem) {","\t\t\t\t\tthis.children.push(logItem);","\t\t\t\t\tlogItem.group = this;","\t\t\t\t},","","\t\t\t\trender: function() {","\t\t\t\t\tif (isIe) {","\t\t\t\t\t\tvar unwrappedDomContainer, wrappedDomContainer;","\t\t\t\t\t\tif (this.isRoot) {","\t\t\t\t\t\t\tunwrappedDomContainer = logMainContainer;","\t\t\t\t\t\t\twrappedDomContainer = logMainContainer;","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tunwrappedDomContainer = this.getUnwrappedDomContainer();","\t\t\t\t\t\t\twrappedDomContainer = this.getWrappedDomContainer();","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.unwrappedElementContainer = new GroupElementContainer(this, unwrappedDomContainer, this.isRoot, false);","\t\t\t\t\t\tthis.wrappedElementContainer = new GroupElementContainer(this, wrappedDomContainer, this.isRoot, true);","\t\t\t\t\t\tthis.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","\t\t\t\t\t} else {","\t\t\t\t\t\tvar mainDomContainer = this.isRoot ? logMainContainer : this.getMainDomContainer();","\t\t\t\t\t\tthis.mainElementContainer = new GroupElementContainer(this, mainDomContainer, this.isRoot, false);","\t\t\t\t\t\tthis.elementContainers = [this.mainElementContainer];","\t\t\t\t\t}","\t\t\t\t\tthis.rendered = true;","\t\t\t\t},","","\t\t\t\ttoggleExpanded: function() {","\t\t\t\t\tthis.expanded = !this.expanded;","\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\tthis.elementContainers[i].toggleExpanded();","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\texpand: function() {","\t\t\t\t\tif (!this.expanded) {","\t\t\t\t\t\tthis.toggleExpanded();","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\taccept: function(visitor) {","\t\t\t\t\tvisitor.visitGroup(this);","\t\t\t\t},","","\t\t\t\treverseChildren: function() {","\t\t\t\t\tif (this.rendered) {","\t\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\t\tthis.elementContainers[i].reverseChildren();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tupdate: function() {","\t\t\t\t\tvar previouslyExpandable = this.expandable;","\t\t\t\t\tthis.expandable = (this.children.length !== 0);","\t\t\t\t\tif (this.expandable !== previouslyExpandable) {","\t\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\t\tthis.elementContainers[i].update();","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tflatten: function() {","\t\t\t\t\tvar visitor = new GroupFlattener();","\t\t\t\t\tthis.accept(visitor);","\t\t\t\t\treturn visitor.logEntriesAndSeparators;","\t\t\t\t},","","\t\t\t\tremoveChild: function(child, doUpdate) {","\t\t\t\t\tarray_remove(this.children, child);","\t\t\t\t\tchild.group = null;","\t\t\t\t\tif (doUpdate) {","\t\t\t\t\t\tthis.update();","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tremove: function(doUpdate, removeFromGroup) {","\t\t\t\t\tfor (var i = 0, len = this.children.length; i < len; i++) {","\t\t\t\t\t\tthis.children[i].remove(false, false);","\t\t\t\t\t}","\t\t\t\t\tthis.children = [];","\t\t\t\t\tthis.update();","\t\t\t\t\tif (this === currentGroup) {","\t\t\t\t\t\tcurrentGroup = this.group;","\t\t\t\t\t}","\t\t\t\t\tthis.doRemove(doUpdate, removeFromGroup);","\t\t\t\t},","","\t\t\t\tserialize: function(items) {","\t\t\t\t\titems.push([LogItem.serializedItemKeys.GROUP_START, this.name]);","\t\t\t\t\tfor (var i = 0, len = this.children.length; i < len; i++) {","\t\t\t\t\t\tthis.children[i].serialize(items);","\t\t\t\t\t}","\t\t\t\t\tif (this !== currentGroup) {","\t\t\t\t\t\titems.push([LogItem.serializedItemKeys.GROUP_END]);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tclear: function() {","\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\tthis.elementContainers[i].clear();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t});","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogEntryElementContainer() {","\t\t\t}","","\t\t\tLogEntryElementContainer.prototype = new LogItemContainerElement();","","\t\t\tcopyProperties(LogEntryElementContainer.prototype, {","\t\t\t\tremove: function() {","\t\t\t\t\tthis.doRemove();","\t\t\t\t},","","\t\t\t\tdoRemove: function() {","\t\t\t\t\tthis.mainDiv.parentNode.removeChild(this.mainDiv);","\t\t\t\t\tthis.mainDiv = null;","\t\t\t\t\tthis.contentElement = null;","\t\t\t\t\tthis.containerDomNode = null;","\t\t\t\t},","","\t\t\t\tsetContent: function(content, wrappedContent) {","\t\t\t\t\tif (content === this.formattedMessage) {",'\t\t\t\t\t\tthis.contentElement.innerHTML = "";',"\t\t\t\t\t\tthis.contentElement.appendChild(document.createTextNode(this.formattedMessage));","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.contentElement.innerHTML = content;","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tsetSearchMatch: function(isMatch) {",'\t\t\t\t\tvar oldCssClass = isMatch ? "searchnonmatch" : "searchmatch";','\t\t\t\t\tvar newCssClass = isMatch ? "searchmatch" : "searchnonmatch";',"\t\t\t\t\treplaceClass(this.mainDiv, newCssClass, oldCssClass);","\t\t\t\t},","","\t\t\t\tclearSearch: function() {",'\t\t\t\t\tremoveClass(this.mainDiv, "searchmatch");','\t\t\t\t\tremoveClass(this.mainDiv, "searchnonmatch");',"\t\t\t\t}","\t\t\t});","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogEntryWrappedElementContainer(logEntry, containerDomNode) {","\t\t\t\tthis.logEntry = logEntry;","\t\t\t\tthis.containerDomNode = containerDomNode;",'\t\t\t\tthis.mainDiv = document.createElement("div");',"\t\t\t\tthis.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));",'\t\t\t\tthis.mainDiv.className = "logentry wrapped " + this.logEntry.level;',"\t\t\t\tthis.contentElement = this.mainDiv;","\t\t\t}","","\t\t\tLogEntryWrappedElementContainer.prototype = new LogEntryElementContainer();","","\t\t\tLogEntryWrappedElementContainer.prototype.setContent = function(content, wrappedContent) {","\t\t\t\tif (content === this.formattedMessage) {",'\t\t\t\t\tthis.contentElement.innerHTML = "";',"\t\t\t\t\tthis.contentElement.appendChild(document.createTextNode(this.formattedMessage));","\t\t\t\t} else {","\t\t\t\t\tthis.contentElement.innerHTML = wrappedContent;","\t\t\t\t}","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogEntryUnwrappedElementContainer(logEntry, containerDomNode) {","\t\t\t\tthis.logEntry = logEntry;","\t\t\t\tthis.containerDomNode = containerDomNode;",'\t\t\t\tthis.mainDiv = document.createElement("div");','\t\t\t\tthis.mainDiv.className = "logentry unwrapped " + this.logEntry.level;','\t\t\t\tthis.pre = this.mainDiv.appendChild(document.createElement("pre"));',"\t\t\t\tthis.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));",'\t\t\t\tthis.pre.className = "unwrapped";',"\t\t\t\tthis.contentElement = this.pre;","\t\t\t}","","\t\t\tLogEntryUnwrappedElementContainer.prototype = new LogEntryElementContainer();","","\t\t\tLogEntryUnwrappedElementContainer.prototype.remove = function() {","\t\t\t\tthis.doRemove();","\t\t\t\tthis.pre = null;","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogEntryMainElementContainer(logEntry, containerDomNode) {","\t\t\t\tthis.logEntry = logEntry;","\t\t\t\tthis.containerDomNode = containerDomNode;",'\t\t\t\tthis.mainDiv = document.createElement("div");','\t\t\t\tthis.mainDiv.className = "logentry nonielogentry " + this.logEntry.level;','\t\t\t\tthis.contentElement = this.mainDiv.appendChild(document.createElement("span"));',"\t\t\t\tthis.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));","\t\t\t}","","\t\t\tLogEntryMainElementContainer.prototype = new LogEntryElementContainer();","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogEntry(level, formattedMessage) {","\t\t\t\tthis.level = level;","\t\t\t\tthis.formattedMessage = formattedMessage;","\t\t\t\tthis.rendered = false;","\t\t\t}","","\t\t\tLogEntry.prototype = new LogItem();","","\t\t\tcopyProperties(LogEntry.prototype, {","\t\t\t\trender: function() {","\t\t\t\t\tvar logEntry = this;","\t\t\t\t\tvar containerDomNode = this.group.contentDiv;","","\t\t\t\t\t// Support for the CSS attribute white-space in IE for Windows is","\t\t\t\t\t// non-existent pre version 6 and slightly odd in 6, so instead","\t\t\t\t\t// use two different HTML elements","\t\t\t\t\tif (isIe) {",'\t\t\t\t\t\tthis.formattedMessage = this.formattedMessage.replace(/\\r\\n/g, "\\r"); // Workaround for IE\'s treatment of white space',"\t\t\t\t\t\tthis.unwrappedElementContainer = new LogEntryUnwrappedElementContainer(this, this.getUnwrappedDomContainer());","\t\t\t\t\t\tthis.wrappedElementContainer = new LogEntryWrappedElementContainer(this, this.getWrappedDomContainer());","\t\t\t\t\t\tthis.elementContainers = [this.unwrappedElementContainer, this.wrappedElementContainer];","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.mainElementContainer = new LogEntryMainElementContainer(this, this.getMainDomContainer());","\t\t\t\t\t\tthis.elementContainers = [this.mainElementContainer];","\t\t\t\t\t}","\t\t\t\t\tthis.content = this.formattedMessage;","\t\t\t\t\tthis.rendered = true;","\t\t\t\t},","","\t\t\t\tsetContent: function(content, wrappedContent) {","\t\t\t\t\tif (content != this.content) {","\t\t\t\t\t\tif (isIe && (content !== this.formattedMessage)) {",'\t\t\t\t\t\t\tcontent = content.replace(/\\r\\n/g, "\\r"); // Workaround for IE\'s treatment of white space',"\t\t\t\t\t\t}","\t\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\t\tthis.elementContainers[i].setContent(content, wrappedContent);","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.content = content;","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tgetSearchMatches: function() {","\t\t\t\t\tvar matches = [];","\t\t\t\t\tvar i, len;","\t\t\t\t\tif (isIe) {",'\t\t\t\t\t\tvar unwrappedEls = getElementsByClass(this.unwrappedElementContainer.mainDiv, "searchterm", "span");','\t\t\t\t\t\tvar wrappedEls = getElementsByClass(this.wrappedElementContainer.mainDiv, "searchterm", "span");',"\t\t\t\t\t\tfor (i = 0, len = unwrappedEls.length; i < len; i++) {","\t\t\t\t\t\t\tmatches[i] = new Match(this.level, null, unwrappedEls[i], wrappedEls[i]);","\t\t\t\t\t\t}","\t\t\t\t\t} else {",'\t\t\t\t\t\tvar els = getElementsByClass(this.mainElementContainer.mainDiv, "searchterm", "span");',"\t\t\t\t\t\tfor (i = 0, len = els.length; i < len; i++) {","\t\t\t\t\t\t\tmatches[i] = new Match(this.level, els[i]);","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn matches;","\t\t\t\t},","","\t\t\t\tsetSearchMatch: function(isMatch) {","\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\tthis.elementContainers[i].setSearchMatch(isMatch);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tclearSearch: function() {","\t\t\t\t\tfor (var i = 0, len = this.elementContainers.length; i < len; i++) {","\t\t\t\t\t\tthis.elementContainers[i].clearSearch();","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\taccept: function(visitor) {","\t\t\t\t\tvisitor.visitLogEntry(this);","\t\t\t\t},","","\t\t\t\tserialize: function(items) {","\t\t\t\t\titems.push([LogItem.serializedItemKeys.LOG_ENTRY, this.level, this.formattedMessage]);","\t\t\t\t}","\t\t\t});","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogItemVisitor() {","\t\t\t}","","\t\t\tLogItemVisitor.prototype = {","\t\t\t\tvisit: function(logItem) {","\t\t\t\t},","","\t\t\t\tvisitParent: function(logItem) {","\t\t\t\t\tif (logItem.group) {","\t\t\t\t\t\tlogItem.group.accept(this);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tvisitChildren: function(logItem) {","\t\t\t\t\tfor (var i = 0, len = logItem.children.length; i < len; i++) {","\t\t\t\t\t\tlogItem.children[i].accept(this);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tvisitLogEntry: function(logEntry) {","\t\t\t\t\tthis.visit(logEntry);","\t\t\t\t},","","\t\t\t\tvisitSeparator: function(separator) {","\t\t\t\t\tthis.visit(separator);","\t\t\t\t},","","\t\t\t\tvisitGroup: function(group) {","\t\t\t\t\tthis.visit(group);","\t\t\t\t}","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction GroupFlattener() {","\t\t\t\tthis.logEntriesAndSeparators = [];","\t\t\t}","","\t\t\tGroupFlattener.prototype = new LogItemVisitor();","","\t\t\tGroupFlattener.prototype.visitGroup = function(group) {","\t\t\t\tthis.visitChildren(group);","\t\t\t};","","\t\t\tGroupFlattener.prototype.visitLogEntry = function(logEntry) {","\t\t\t\tthis.logEntriesAndSeparators.push(logEntry);","\t\t\t};","","\t\t\tGroupFlattener.prototype.visitSeparator = function(separator) {","\t\t\t\tthis.logEntriesAndSeparators.push(separator);","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\twindow.onload = function() {","\t\t\t\t// Sort out document.domain","\t\t\t\tif (location.search) {",'\t\t\t\t\tvar queryBits = unescape(location.search).substr(1).split("&"), nameValueBits;',"\t\t\t\t\tfor (var i = 0, len = queryBits.length; i < len; i++) {",'\t\t\t\t\t\tnameValueBits = queryBits[i].split("=");','\t\t\t\t\t\tif (nameValueBits[0] == "log4javascript_domain") {',"\t\t\t\t\t\t\tdocument.domain = nameValueBits[1];","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t}","","\t\t\t\t// Create DOM objects",'\t\t\t\tlogMainContainer = $("log");',"\t\t\t\tif (isIePre7) {",'\t\t\t\t\taddClass(logMainContainer, "oldIe");',"\t\t\t\t}","",'\t\t\t\trootGroup = new Group("root", true);',"\t\t\t\trootGroup.render();","\t\t\t\tcurrentGroup = rootGroup;","\t\t\t\t","\t\t\t\tsetCommandInputWidth();","\t\t\t\tsetLogContainerHeight();","\t\t\t\ttoggleLoggingEnabled();","\t\t\t\ttoggleSearchEnabled();","\t\t\t\ttoggleSearchFilter();","\t\t\t\ttoggleSearchHighlight();","\t\t\t\tapplyFilters();","\t\t\t\tcheckAllLevels();","\t\t\t\ttoggleWrap();","\t\t\t\ttoggleNewestAtTop();","\t\t\t\ttoggleScrollToLatest();","\t\t\t\trenderQueuedLogItems();","\t\t\t\tloaded = true;",'\t\t\t\t$("command").value = "";','\t\t\t\t$("command").autocomplete = "off";','\t\t\t\t$("command").onkeydown = function(evt) {',"\t\t\t\t\tevt = getEvent(evt);","\t\t\t\t\tif (evt.keyCode == 10 || evt.keyCode == 13) { // Return/Enter","\t\t\t\t\t\tevalCommandLine();","\t\t\t\t\t\tstopPropagation(evt);","\t\t\t\t\t} else if (evt.keyCode == 27) { // Escape",'\t\t\t\t\t\tthis.value = "";',"\t\t\t\t\t\tthis.focus();","\t\t\t\t\t} else if (evt.keyCode == 38 && commandHistory.length > 0) { // Up","\t\t\t\t\t\tcurrentCommandIndex = Math.max(0, currentCommandIndex - 1);","\t\t\t\t\t\tthis.value = commandHistory[currentCommandIndex];","\t\t\t\t\t\tmoveCaretToEnd(this);","\t\t\t\t\t} else if (evt.keyCode == 40 && commandHistory.length > 0) { // Down","\t\t\t\t\t\tcurrentCommandIndex = Math.min(commandHistory.length - 1, currentCommandIndex + 1);","\t\t\t\t\t\tthis.value = commandHistory[currentCommandIndex];","\t\t\t\t\t\tmoveCaretToEnd(this);","\t\t\t\t\t}","\t\t\t\t};","","\t\t\t\t// Prevent the keypress moving the caret in Firefox",'\t\t\t\t$("command").onkeypress = function(evt) {',"\t\t\t\t\tevt = getEvent(evt);","\t\t\t\t\tif (evt.keyCode == 38 && commandHistory.length > 0 && evt.preventDefault) { // Up","\t\t\t\t\t\tevt.preventDefault();","\t\t\t\t\t}","\t\t\t\t};","","\t\t\t\t// Prevent the keyup event blurring the input in Opera",'\t\t\t\t$("command").onkeyup = function(evt) {',"\t\t\t\t\tevt = getEvent(evt);","\t\t\t\t\tif (evt.keyCode == 27 && evt.preventDefault) { // Up","\t\t\t\t\t\tevt.preventDefault();","\t\t\t\t\t\tthis.focus();","\t\t\t\t\t}","\t\t\t\t};","","\t\t\t\t// Add document keyboard shortcuts","\t\t\t\tdocument.onkeydown = function keyEventHandler(evt) {","\t\t\t\t\tevt = getEvent(evt);","\t\t\t\t\tswitch (evt.keyCode) {","\t\t\t\t\t\tcase 69: // Ctrl + shift + E: re-execute last command","\t\t\t\t\t\t\tif (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","\t\t\t\t\t\t\t\tevalLastCommand();","\t\t\t\t\t\t\t\tcancelKeyEvent(evt);","\t\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tcase 75: // Ctrl + shift + K: focus search","\t\t\t\t\t\t\tif (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","\t\t\t\t\t\t\t\tfocusSearch();","\t\t\t\t\t\t\t\tcancelKeyEvent(evt);","\t\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tcase 40: // Ctrl + shift + down arrow: focus command line","\t\t\t\t\t\tcase 76: // Ctrl + shift + L: focus command line","\t\t\t\t\t\t\tif (evt.shiftKey && (evt.ctrlKey || evt.metaKey)) {","\t\t\t\t\t\t\t\tfocusCommandLine();","\t\t\t\t\t\t\t\tcancelKeyEvent(evt);","\t\t\t\t\t\t\t\treturn false;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t}","\t\t\t\t};","","\t\t\t\t// Workaround to make sure log div starts at the correct size","\t\t\t\tsetTimeout(setLogContainerHeight, 20);","","\t\t\t\tsetShowCommandLine(showCommandLine);","\t\t\t\tdoSearch();","\t\t\t};","","\t\t\twindow.onunload = function() {","\t\t\t\tif (mainWindowExists()) {","\t\t\t\t\tappender.unload();","\t\t\t\t}","\t\t\t\tappender = null;","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction toggleLoggingEnabled() {",'\t\t\t\tsetLoggingEnabled($("enableLogging").checked);',"\t\t\t}","","\t\t\tfunction setLoggingEnabled(enable) {","\t\t\t\tloggingEnabled = enable;","\t\t\t}","","\t\t\tvar appender = null;","","\t\t\tfunction setAppender(appenderParam) {","\t\t\t\tappender = appenderParam;","\t\t\t}","","\t\t\tfunction setShowCloseButton(showCloseButton) {",'\t\t\t\t$("closeButton").style.display = showCloseButton ? "inline" : "none";',"\t\t\t}","","\t\t\tfunction setShowHideButton(showHideButton) {",'\t\t\t\t$("hideButton").style.display = showHideButton ? "inline" : "none";',"\t\t\t}","","\t\t\tvar newestAtTop = false;","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction LogItemContentReverser() {","\t\t\t}","\t\t\t","\t\t\tLogItemContentReverser.prototype = new LogItemVisitor();","\t\t\t","\t\t\tLogItemContentReverser.prototype.visitGroup = function(group) {","\t\t\t\tgroup.reverseChildren();","\t\t\t\tthis.visitChildren(group);","\t\t\t};","","\t\t\t/*----------------------------------------------------------------*/","","\t\t\tfunction setNewestAtTop(isNewestAtTop) {","\t\t\t\tvar oldNewestAtTop = newestAtTop;","\t\t\t\tvar i, iLen, j, jLen;","\t\t\t\tnewestAtTop = Boolean(isNewestAtTop);","\t\t\t\tif (oldNewestAtTop != newestAtTop) {","\t\t\t\t\tvar visitor = new LogItemContentReverser();","\t\t\t\t\trootGroup.accept(visitor);","","\t\t\t\t\t// Reassemble the matches array","\t\t\t\t\tif (currentSearch) {","\t\t\t\t\t\tvar currentMatch = currentSearch.matches[currentMatchIndex];","\t\t\t\t\t\tvar matchIndex = 0;","\t\t\t\t\t\tvar matches = [];","\t\t\t\t\t\tvar actOnLogEntry = function(logEntry) {","\t\t\t\t\t\t\tvar logEntryMatches = logEntry.getSearchMatches();","\t\t\t\t\t\t\tfor (j = 0, jLen = logEntryMatches.length; j < jLen; j++) {","\t\t\t\t\t\t\t\tmatches[matchIndex] = logEntryMatches[j];","\t\t\t\t\t\t\t\tif (currentMatch && logEntryMatches[j].equals(currentMatch)) {","\t\t\t\t\t\t\t\t\tcurrentMatchIndex = matchIndex;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\tmatchIndex++;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t};","\t\t\t\t\t\tif (newestAtTop) {","\t\t\t\t\t\t\tfor (i = logEntries.length - 1; i >= 0; i--) {","\t\t\t\t\t\t\t\tactOnLogEntry(logEntries[i]);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tfor (i = 0, iLen = logEntries.length; i < iLen; i++) {","\t\t\t\t\t\t\t\tactOnLogEntry(logEntries[i]);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\tcurrentSearch.matches = matches;","\t\t\t\t\t\tif (currentMatch) {","\t\t\t\t\t\t\tcurrentMatch.setCurrent();","\t\t\t\t\t\t}","\t\t\t\t\t} else if (scrollToLatest) {","\t\t\t\t\t\tdoScrollToLatest();","\t\t\t\t\t}","\t\t\t\t}",'\t\t\t\t$("newestAtTop").checked = isNewestAtTop;',"\t\t\t}","","\t\t\tfunction toggleNewestAtTop() {",'\t\t\t\tvar isNewestAtTop = $("newestAtTop").checked;',"\t\t\t\tsetNewestAtTop(isNewestAtTop);","\t\t\t}","","\t\t\tvar scrollToLatest = true;","","\t\t\tfunction setScrollToLatest(isScrollToLatest) {","\t\t\t\tscrollToLatest = isScrollToLatest;","\t\t\t\tif (scrollToLatest) {","\t\t\t\t\tdoScrollToLatest();","\t\t\t\t}",'\t\t\t\t$("scrollToLatest").checked = isScrollToLatest;',"\t\t\t}","","\t\t\tfunction toggleScrollToLatest() {",'\t\t\t\tvar isScrollToLatest = $("scrollToLatest").checked;',"\t\t\t\tsetScrollToLatest(isScrollToLatest);","\t\t\t}","","\t\t\tfunction doScrollToLatest() {","\t\t\t\tvar l = logMainContainer;",'\t\t\t\tif (typeof l.scrollTop != "undefined") {',"\t\t\t\t\tif (newestAtTop) {","\t\t\t\t\t\tl.scrollTop = 0;","\t\t\t\t\t} else {","\t\t\t\t\t\tvar latestLogEntry = l.lastChild;","\t\t\t\t\t\tif (latestLogEntry) {","\t\t\t\t\t\t\tl.scrollTop = l.scrollHeight;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tvar closeIfOpenerCloses = true;","","\t\t\tfunction setCloseIfOpenerCloses(isCloseIfOpenerCloses) {","\t\t\t\tcloseIfOpenerCloses = isCloseIfOpenerCloses;","\t\t\t}","","\t\t\tvar maxMessages = null;","","\t\t\tfunction setMaxMessages(max) {","\t\t\t\tmaxMessages = max;","\t\t\t\tpruneLogEntries();","\t\t\t}","","\t\t\tvar showCommandLine = false;","","\t\t\tfunction setShowCommandLine(isShowCommandLine) {","\t\t\t\tshowCommandLine = isShowCommandLine;","\t\t\t\tif (loaded) {",'\t\t\t\t\t$("commandLine").style.display = showCommandLine ? "block" : "none";',"\t\t\t\t\tsetCommandInputWidth();","\t\t\t\t\tsetLogContainerHeight();","\t\t\t\t}","\t\t\t}","","\t\t\tfunction focusCommandLine() {","\t\t\t\tif (loaded) {",'\t\t\t\t\t$("command").focus();',"\t\t\t\t}","\t\t\t}","","\t\t\tfunction focusSearch() {","\t\t\t\tif (loaded) {",'\t\t\t\t\t$("searchBox").focus();',"\t\t\t\t}","\t\t\t}","","\t\t\tfunction getLogItems() {","\t\t\t\tvar items = [];","\t\t\t\tfor (var i = 0, len = logItems.length; i < len; i++) {","\t\t\t\t\tlogItems[i].serialize(items);","\t\t\t\t}","\t\t\t\treturn items;","\t\t\t}","","\t\t\tfunction setLogItems(items) {","\t\t\t\tvar loggingReallyEnabled = loggingEnabled;","\t\t\t\t// Temporarily turn logging on","\t\t\t\tloggingEnabled = true;","\t\t\t\tfor (var i = 0, len = items.length; i < len; i++) {","\t\t\t\t\tswitch (items[i][0]) {","\t\t\t\t\t\tcase LogItem.serializedItemKeys.LOG_ENTRY:","\t\t\t\t\t\t\tlog(items[i][1], items[i][2]);","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tcase LogItem.serializedItemKeys.GROUP_START:","\t\t\t\t\t\t\tgroup(items[i][1]);","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tcase LogItem.serializedItemKeys.GROUP_END:","\t\t\t\t\t\t\tgroupEnd();","\t\t\t\t\t\t\tbreak;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tloggingEnabled = loggingReallyEnabled;","\t\t\t}","","\t\t\tfunction log(logLevel, formattedMessage) {","\t\t\t\tif (loggingEnabled) {","\t\t\t\t\tvar logEntry = new LogEntry(logLevel, formattedMessage);","\t\t\t\t\tlogEntries.push(logEntry);","\t\t\t\t\tlogEntriesAndSeparators.push(logEntry);","\t\t\t\t\tlogItems.push(logEntry);","\t\t\t\t\tcurrentGroup.addChild(logEntry);","\t\t\t\t\tif (loaded) {","\t\t\t\t\t\tif (logQueuedEventsTimer !== null) {","\t\t\t\t\t\t\tclearTimeout(logQueuedEventsTimer);","\t\t\t\t\t\t}","\t\t\t\t\t\tlogQueuedEventsTimer = setTimeout(renderQueuedLogItems, renderDelay);","\t\t\t\t\t\tunrenderedLogItemsExist = true;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction renderQueuedLogItems() {","\t\t\t\tlogQueuedEventsTimer = null;","\t\t\t\tvar pruned = pruneLogEntries();","","\t\t\t\t// Render any unrendered log entries and apply the current search to them","\t\t\t\tvar initiallyHasMatches = currentSearch ? currentSearch.hasMatches() : false;","\t\t\t\tfor (var i = 0, len = logItems.length; i < len; i++) {","\t\t\t\t\tif (!logItems[i].rendered) {","\t\t\t\t\t\tlogItems[i].render();","\t\t\t\t\t\tlogItems[i].appendToLog();","\t\t\t\t\t\tif (currentSearch && (logItems[i] instanceof LogEntry)) {","\t\t\t\t\t\t\tcurrentSearch.applyTo(logItems[i]);","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tif (currentSearch) {","\t\t\t\t\tif (pruned) {","\t\t\t\t\t\tif (currentSearch.hasVisibleMatches()) {","\t\t\t\t\t\t\tif (currentMatchIndex === null) {","\t\t\t\t\t\t\t\tsetCurrentMatchIndex(0);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tdisplayMatches();","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tdisplayNoMatches();","\t\t\t\t\t\t}","\t\t\t\t\t} else if (!initiallyHasMatches && currentSearch.hasVisibleMatches()) {","\t\t\t\t\t\tsetCurrentMatchIndex(0);","\t\t\t\t\t\tdisplayMatches();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tif (scrollToLatest) {","\t\t\t\t\tdoScrollToLatest();","\t\t\t\t}","\t\t\t\tunrenderedLogItemsExist = false;","\t\t\t}","","\t\t\tfunction pruneLogEntries() {","\t\t\t\tif ((maxMessages !== null) && (logEntriesAndSeparators.length > maxMessages)) {","\t\t\t\t\tvar numberToDelete = logEntriesAndSeparators.length - maxMessages;","\t\t\t\t\tvar prunedLogEntries = logEntriesAndSeparators.slice(0, numberToDelete);","\t\t\t\t\tif (currentSearch) {","\t\t\t\t\t\tcurrentSearch.removeMatches(prunedLogEntries);","\t\t\t\t\t}","\t\t\t\t\tvar group;","\t\t\t\t\tfor (var i = 0; i < numberToDelete; i++) {","\t\t\t\t\t\tgroup = logEntriesAndSeparators[i].group;","\t\t\t\t\t\tarray_remove(logItems, logEntriesAndSeparators[i]);","\t\t\t\t\t\tarray_remove(logEntries, logEntriesAndSeparators[i]);","\t\t\t\t\t\tlogEntriesAndSeparators[i].remove(true, true);","\t\t\t\t\t\tif (group.children.length === 0 && group !== currentGroup && group !== rootGroup) {","\t\t\t\t\t\t\tarray_remove(logItems, group);","\t\t\t\t\t\t\tgroup.remove(true, true);","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\tlogEntriesAndSeparators = array_removeFromStart(logEntriesAndSeparators, numberToDelete);","\t\t\t\t\treturn true;","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","","\t\t\tfunction group(name, startExpanded) {","\t\t\t\tif (loggingEnabled) {",'\t\t\t\t\tinitiallyExpanded = (typeof startExpanded === "undefined") ? true : Boolean(startExpanded);',"\t\t\t\t\tvar newGroup = new Group(name, false, initiallyExpanded);","\t\t\t\t\tcurrentGroup.addChild(newGroup);","\t\t\t\t\tcurrentGroup = newGroup;","\t\t\t\t\tlogItems.push(newGroup);","\t\t\t\t\tif (loaded) {","\t\t\t\t\t\tif (logQueuedEventsTimer !== null) {","\t\t\t\t\t\t\tclearTimeout(logQueuedEventsTimer);","\t\t\t\t\t\t}","\t\t\t\t\t\tlogQueuedEventsTimer = setTimeout(renderQueuedLogItems, renderDelay);","\t\t\t\t\t\tunrenderedLogItemsExist = true;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction groupEnd() {","\t\t\t\tcurrentGroup = (currentGroup === rootGroup) ? rootGroup : currentGroup.group;","\t\t\t}","","\t\t\tfunction mainPageReloaded() {","\t\t\t\tcurrentGroup = rootGroup;","\t\t\t\tvar separator = new Separator();","\t\t\t\tlogEntriesAndSeparators.push(separator);","\t\t\t\tlogItems.push(separator);","\t\t\t\tcurrentGroup.addChild(separator);","\t\t\t}","","\t\t\tfunction closeWindow() {","\t\t\t\tif (appender && mainWindowExists()) {","\t\t\t\t\tappender.close(true);","\t\t\t\t} else {","\t\t\t\t\twindow.close();","\t\t\t\t}","\t\t\t}","","\t\t\tfunction hide() {","\t\t\t\tif (appender && mainWindowExists()) {","\t\t\t\t\tappender.hide();","\t\t\t\t}","\t\t\t}","","\t\t\tvar mainWindow = window;",'\t\t\tvar windowId = "log4javascriptConsoleWindow_" + new Date().getTime() + "_" + ("" + Math.random()).substr(2);',"","\t\t\tfunction setMainWindow(win) {","\t\t\t\tmainWindow = win;","\t\t\t\tmainWindow[windowId] = window;","\t\t\t\t// If this is a pop-up, poll the opener to see if it's closed","\t\t\t\tif (opener && closeIfOpenerCloses) {","\t\t\t\t\tpollOpener();","\t\t\t\t}","\t\t\t}","","\t\t\tfunction pollOpener() {","\t\t\t\tif (closeIfOpenerCloses) {","\t\t\t\t\tif (mainWindowExists()) {","\t\t\t\t\t\tsetTimeout(pollOpener, 500);","\t\t\t\t\t} else {","\t\t\t\t\t\tcloseWindow();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction mainWindowExists() {","\t\t\t\ttry {","\t\t\t\t\treturn (mainWindow && !mainWindow.closed &&","\t\t\t\t\t\tmainWindow[windowId] == window);","\t\t\t\t} catch (ex) {}","\t\t\t\treturn false;","\t\t\t}","",'\t\t\tvar logLevels = ["TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL"];',"","\t\t\tfunction getCheckBox(logLevel) {",'\t\t\t\treturn $("switch_" + logLevel);',"\t\t\t}","","\t\t\tfunction getIeWrappedLogContainer() {",'\t\t\t\treturn $("log_wrapped");',"\t\t\t}","","\t\t\tfunction getIeUnwrappedLogContainer() {",'\t\t\t\treturn $("log_unwrapped");',"\t\t\t}","","\t\t\tfunction applyFilters() {","\t\t\t\tfor (var i = 0; i < logLevels.length; i++) {","\t\t\t\t\tif (getCheckBox(logLevels[i]).checked) {","\t\t\t\t\t\taddClass(logMainContainer, logLevels[i]);","\t\t\t\t\t} else {","\t\t\t\t\t\tremoveClass(logMainContainer, logLevels[i]);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tupdateSearchFromFilters();","\t\t\t}","","\t\t\tfunction toggleAllLevels() {",'\t\t\t\tvar turnOn = $("switch_ALL").checked;',"\t\t\t\tfor (var i = 0; i < logLevels.length; i++) {","\t\t\t\t\tgetCheckBox(logLevels[i]).checked = turnOn;","\t\t\t\t\tif (turnOn) {","\t\t\t\t\t\taddClass(logMainContainer, logLevels[i]);","\t\t\t\t\t} else {","\t\t\t\t\t\tremoveClass(logMainContainer, logLevels[i]);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction checkAllLevels() {","\t\t\t\tfor (var i = 0; i < logLevels.length; i++) {","\t\t\t\t\tif (!getCheckBox(logLevels[i]).checked) {",'\t\t\t\t\t\tgetCheckBox("ALL").checked = false;',"\t\t\t\t\t\treturn;","\t\t\t\t\t}","\t\t\t\t}",'\t\t\t\tgetCheckBox("ALL").checked = true;',"\t\t\t}","","\t\t\tfunction clearLog() {","\t\t\t\trootGroup.clear();","\t\t\t\tcurrentGroup = rootGroup;","\t\t\t\tlogEntries = [];","\t\t\t\tlogItems = [];","\t\t\t\tlogEntriesAndSeparators = [];"," \t\t\t\tdoSearch();","\t\t\t}","","\t\t\tfunction toggleWrap() {",'\t\t\t\tvar enable = $("wrap").checked;',"\t\t\t\tif (enable) {",'\t\t\t\t\taddClass(logMainContainer, "wrap");',"\t\t\t\t} else {",'\t\t\t\t\tremoveClass(logMainContainer, "wrap");',"\t\t\t\t}","\t\t\t\trefreshCurrentMatch();","\t\t\t}","","\t\t\t/* ------------------------------------------------------------------- */","","\t\t\t// Search","","\t\t\tvar searchTimer = null;","","\t\t\tfunction scheduleSearch() {","\t\t\t\ttry {","\t\t\t\t\tclearTimeout(searchTimer);","\t\t\t\t} catch (ex) {","\t\t\t\t\t// Do nothing","\t\t\t\t}","\t\t\t\tsearchTimer = setTimeout(doSearch, 500);","\t\t\t}","","\t\t\tfunction Search(searchTerm, isRegex, searchRegex, isCaseSensitive) {","\t\t\t\tthis.searchTerm = searchTerm;","\t\t\t\tthis.isRegex = isRegex;","\t\t\t\tthis.searchRegex = searchRegex;","\t\t\t\tthis.isCaseSensitive = isCaseSensitive;","\t\t\t\tthis.matches = [];","\t\t\t}","","\t\t\tSearch.prototype = {","\t\t\t\thasMatches: function() {","\t\t\t\t\treturn this.matches.length > 0;","\t\t\t\t},","","\t\t\t\thasVisibleMatches: function() {","\t\t\t\t\tif (this.hasMatches()) {","\t\t\t\t\t\tfor (var i = 0; i < this.matches.length; i++) {","\t\t\t\t\t\t\tif (this.matches[i].isVisible()) {","\t\t\t\t\t\t\t\treturn true;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn false;","\t\t\t\t},","","\t\t\t\tmatch: function(logEntry) {","\t\t\t\t\tvar entryText = String(logEntry.formattedMessage);","\t\t\t\t\tvar matchesSearch = false;","\t\t\t\t\tif (this.isRegex) {","\t\t\t\t\t\tmatchesSearch = this.searchRegex.test(entryText);","\t\t\t\t\t} else if (this.isCaseSensitive) {","\t\t\t\t\t\tmatchesSearch = (entryText.indexOf(this.searchTerm) > -1);","\t\t\t\t\t} else {","\t\t\t\t\t\tmatchesSearch = (entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase()) > -1);","\t\t\t\t\t}","\t\t\t\t\treturn matchesSearch;","\t\t\t\t},","","\t\t\t\tgetNextVisibleMatchIndex: function() {","\t\t\t\t\tfor (var i = currentMatchIndex + 1; i < this.matches.length; i++) {","\t\t\t\t\t\tif (this.matches[i].isVisible()) {","\t\t\t\t\t\t\treturn i;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t// Start again from the first match","\t\t\t\t\tfor (i = 0; i <= currentMatchIndex; i++) {","\t\t\t\t\t\tif (this.matches[i].isVisible()) {","\t\t\t\t\t\t\treturn i;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn -1;","\t\t\t\t},","","\t\t\t\tgetPreviousVisibleMatchIndex: function() {","\t\t\t\t\tfor (var i = currentMatchIndex - 1; i >= 0; i--) {","\t\t\t\t\t\tif (this.matches[i].isVisible()) {","\t\t\t\t\t\t\treturn i;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\t// Start again from the last match","\t\t\t\t\tfor (var i = this.matches.length - 1; i >= currentMatchIndex; i--) {","\t\t\t\t\t\tif (this.matches[i].isVisible()) {","\t\t\t\t\t\t\treturn i;","\t\t\t\t\t\t}","\t\t\t\t\t}","\t\t\t\t\treturn -1;","\t\t\t\t},","","\t\t\t\tapplyTo: function(logEntry) {","\t\t\t\t\tvar doesMatch = this.match(logEntry);","\t\t\t\t\tif (doesMatch) {","\t\t\t\t\t\tlogEntry.group.expand();","\t\t\t\t\t\tlogEntry.setSearchMatch(true);","\t\t\t\t\t\tvar logEntryContent;","\t\t\t\t\t\tvar wrappedLogEntryContent;",'\t\t\t\t\t\tvar searchTermReplacementStartTag = "<span class=\\"searchterm\\">";','\t\t\t\t\t\tvar searchTermReplacementEndTag = "<" + "/span>";','\t\t\t\t\t\tvar preTagName = isIe ? "pre" : "span";','\t\t\t\t\t\tvar preStartTag = "<" + preTagName + " class=\\"pre\\">";','\t\t\t\t\t\tvar preEndTag = "<" + "/" + preTagName + ">";',"\t\t\t\t\t\tvar startIndex = 0;","\t\t\t\t\t\tvar searchIndex, matchedText, textBeforeMatch;","\t\t\t\t\t\tif (this.isRegex) {",'\t\t\t\t\t\t\tvar flags = this.isCaseSensitive ? "g" : "gi";','\t\t\t\t\t\t\tvar capturingRegex = new RegExp("(" + this.searchRegex.source + ")", flags);',"","\t\t\t\t\t\t\t// Replace the search term with temporary tokens for the start and end tags",'\t\t\t\t\t\t\tvar rnd = ("" + Math.random()).substr(2);','\t\t\t\t\t\t\tvar startToken = "%%s" + rnd + "%%";','\t\t\t\t\t\t\tvar endToken = "%%e" + rnd + "%%";','\t\t\t\t\t\t\tlogEntryContent = logEntry.formattedMessage.replace(capturingRegex, startToken + "$1" + endToken);',"","\t\t\t\t\t\t\t// Escape the HTML to get rid of angle brackets","\t\t\t\t\t\t\tlogEntryContent = escapeHtml(logEntryContent);","","\t\t\t\t\t\t\t// Substitute the proper HTML back in for the search match","\t\t\t\t\t\t\tvar result;","\t\t\t\t\t\t\tvar searchString = logEntryContent;",'\t\t\t\t\t\t\tlogEntryContent = "";','\t\t\t\t\t\t\twrappedLogEntryContent = "";',"\t\t\t\t\t\t\twhile ((searchIndex = searchString.indexOf(startToken, startIndex)) > -1) {","\t\t\t\t\t\t\t\tvar endTokenIndex = searchString.indexOf(endToken, searchIndex);","\t\t\t\t\t\t\t\tmatchedText = searchString.substring(searchIndex + startToken.length, endTokenIndex);","\t\t\t\t\t\t\t\ttextBeforeMatch = searchString.substring(startIndex, searchIndex);","\t\t\t\t\t\t\t\tlogEntryContent += preStartTag + textBeforeMatch + preEndTag;","\t\t\t\t\t\t\t\tlogEntryContent += searchTermReplacementStartTag + preStartTag + matchedText +","\t\t\t\t\t\t\t\t\tpreEndTag + searchTermReplacementEndTag;","\t\t\t\t\t\t\t\tif (isIe) {","\t\t\t\t\t\t\t\t\twrappedLogEntryContent += textBeforeMatch + searchTermReplacementStartTag +","\t\t\t\t\t\t\t\t\t\tmatchedText + searchTermReplacementEndTag;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\tstartIndex = endTokenIndex + endToken.length;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tlogEntryContent += preStartTag + searchString.substr(startIndex) + preEndTag;","\t\t\t\t\t\t\tif (isIe) {","\t\t\t\t\t\t\t\twrappedLogEntryContent += searchString.substr(startIndex);","\t\t\t\t\t\t\t}","\t\t\t\t\t\t} else {",'\t\t\t\t\t\t\tlogEntryContent = "";','\t\t\t\t\t\t\twrappedLogEntryContent = "";',"\t\t\t\t\t\t\tvar searchTermReplacementLength = searchTermReplacementStartTag.length +","\t\t\t\t\t\t\t\tthis.searchTerm.length + searchTermReplacementEndTag.length;","\t\t\t\t\t\t\tvar searchTermLength = this.searchTerm.length;","\t\t\t\t\t\t\tvar searchTermLowerCase = this.searchTerm.toLowerCase();","\t\t\t\t\t\t\tvar logTextLowerCase = logEntry.formattedMessage.toLowerCase();","\t\t\t\t\t\t\twhile ((searchIndex = logTextLowerCase.indexOf(searchTermLowerCase, startIndex)) > -1) {","\t\t\t\t\t\t\t\tmatchedText = escapeHtml(logEntry.formattedMessage.substr(searchIndex, this.searchTerm.length));","\t\t\t\t\t\t\t\ttextBeforeMatch = escapeHtml(logEntry.formattedMessage.substring(startIndex, searchIndex));","\t\t\t\t\t\t\t\tvar searchTermReplacement = searchTermReplacementStartTag +","\t\t\t\t\t\t\t\t\tpreStartTag + matchedText + preEndTag + searchTermReplacementEndTag;","\t\t\t\t\t\t\t\tlogEntryContent += preStartTag + textBeforeMatch + preEndTag + searchTermReplacement;","\t\t\t\t\t\t\t\tif (isIe) {","\t\t\t\t\t\t\t\t\twrappedLogEntryContent += textBeforeMatch + searchTermReplacementStartTag +","\t\t\t\t\t\t\t\t\t\tmatchedText + searchTermReplacementEndTag;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\tstartIndex = searchIndex + searchTermLength;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tvar textAfterLastMatch = escapeHtml(logEntry.formattedMessage.substr(startIndex));","\t\t\t\t\t\t\tlogEntryContent += preStartTag + textAfterLastMatch + preEndTag;","\t\t\t\t\t\t\tif (isIe) {","\t\t\t\t\t\t\t\twrappedLogEntryContent += textAfterLastMatch;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\tlogEntry.setContent(logEntryContent, wrappedLogEntryContent);","\t\t\t\t\t\tvar logEntryMatches = logEntry.getSearchMatches();","\t\t\t\t\t\tthis.matches = this.matches.concat(logEntryMatches);","\t\t\t\t\t} else {","\t\t\t\t\t\tlogEntry.setSearchMatch(false);","\t\t\t\t\t\tlogEntry.setContent(logEntry.formattedMessage, logEntry.formattedMessage);","\t\t\t\t\t}","\t\t\t\t\treturn doesMatch;","\t\t\t\t},","","\t\t\t\tremoveMatches: function(logEntries) {","\t\t\t\t\tvar matchesToRemoveCount = 0;","\t\t\t\t\tvar currentMatchRemoved = false;","\t\t\t\t\tvar matchesToRemove = [];","\t\t\t\t\tvar i, iLen, j, jLen;","","\t\t\t\t\t// Establish the list of matches to be removed","\t\t\t\t\tfor (i = 0, iLen = this.matches.length; i < iLen; i++) {","\t\t\t\t\t\tfor (j = 0, jLen = logEntries.length; j < jLen; j++) {","\t\t\t\t\t\t\tif (this.matches[i].belongsTo(logEntries[j])) {","\t\t\t\t\t\t\t\tmatchesToRemove.push(this.matches[i]);","\t\t\t\t\t\t\t\tif (i === currentMatchIndex) {","\t\t\t\t\t\t\t\t\tcurrentMatchRemoved = true;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t}","","\t\t\t\t\t// Set the new current match index if the current match has been deleted","\t\t\t\t\t// This will be the first match that appears after the first log entry being","\t\t\t\t\t// deleted, if one exists; otherwise, it's the first match overall","\t\t\t\t\tvar newMatch = currentMatchRemoved ? null : this.matches[currentMatchIndex];","\t\t\t\t\tif (currentMatchRemoved) {","\t\t\t\t\t\tfor (i = currentMatchIndex, iLen = this.matches.length; i < iLen; i++) {","\t\t\t\t\t\t\tif (this.matches[i].isVisible() && !array_contains(matchesToRemove, this.matches[i])) {","\t\t\t\t\t\t\t\tnewMatch = this.matches[i];","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t}","","\t\t\t\t\t// Remove the matches","\t\t\t\t\tfor (i = 0, iLen = matchesToRemove.length; i < iLen; i++) {","\t\t\t\t\t\tarray_remove(this.matches, matchesToRemove[i]);","\t\t\t\t\t\tmatchesToRemove[i].remove();","\t\t\t\t\t}","","\t\t\t\t\t// Set the new match, if one exists","\t\t\t\t\tif (this.hasVisibleMatches()) {","\t\t\t\t\t\tif (newMatch === null) {","\t\t\t\t\t\t\tsetCurrentMatchIndex(0);","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\t// Get the index of the new match","\t\t\t\t\t\t\tvar newMatchIndex = 0;","\t\t\t\t\t\t\tfor (i = 0, iLen = this.matches.length; i < iLen; i++) {","\t\t\t\t\t\t\t\tif (newMatch === this.matches[i]) {","\t\t\t\t\t\t\t\t\tnewMatchIndex = i;","\t\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t}","\t\t\t\t\t\t\tsetCurrentMatchIndex(newMatchIndex);","\t\t\t\t\t\t}","\t\t\t\t\t} else {","\t\t\t\t\t\tcurrentMatchIndex = null;","\t\t\t\t\t\tdisplayNoMatches();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t};","","\t\t\tfunction getPageOffsetTop(el, container) {","\t\t\t\tvar currentEl = el;","\t\t\t\tvar y = 0;","\t\t\t\twhile (currentEl && currentEl != container) {","\t\t\t\t\ty += currentEl.offsetTop;","\t\t\t\t\tcurrentEl = currentEl.offsetParent;","\t\t\t\t}","\t\t\t\treturn y;","\t\t\t}","","\t\t\tfunction scrollIntoView(el) {","\t\t\t\tvar logContainer = logMainContainer;","\t\t\t\t// Check if the whole width of the element is visible and centre if not",'\t\t\t\tif (!$("wrap").checked) {',"\t\t\t\t\tvar logContainerLeft = logContainer.scrollLeft;","\t\t\t\t\tvar logContainerRight = logContainerLeft  + logContainer.offsetWidth;","\t\t\t\t\tvar elLeft = el.offsetLeft;","\t\t\t\t\tvar elRight = elLeft + el.offsetWidth;","\t\t\t\t\tif (elLeft < logContainerLeft || elRight > logContainerRight) {","\t\t\t\t\t\tlogContainer.scrollLeft = elLeft - (logContainer.offsetWidth - el.offsetWidth) / 2;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\t// Check if the whole height of the element is visible and centre if not","\t\t\t\tvar logContainerTop = logContainer.scrollTop;","\t\t\t\tvar logContainerBottom = logContainerTop  + logContainer.offsetHeight;","\t\t\t\tvar elTop = getPageOffsetTop(el) - getToolBarsHeight();","\t\t\t\tvar elBottom = elTop + el.offsetHeight;","\t\t\t\tif (elTop < logContainerTop || elBottom > logContainerBottom) {","\t\t\t\t\tlogContainer.scrollTop = elTop - (logContainer.offsetHeight - el.offsetHeight) / 2;","\t\t\t\t}","\t\t\t}","","\t\t\tfunction Match(logEntryLevel, spanInMainDiv, spanInUnwrappedPre, spanInWrappedDiv) {","\t\t\t\tthis.logEntryLevel = logEntryLevel;","\t\t\t\tthis.spanInMainDiv = spanInMainDiv;","\t\t\t\tif (isIe) {","\t\t\t\t\tthis.spanInUnwrappedPre = spanInUnwrappedPre;","\t\t\t\t\tthis.spanInWrappedDiv = spanInWrappedDiv;","\t\t\t\t}","\t\t\t\tthis.mainSpan = isIe ? spanInUnwrappedPre : spanInMainDiv;","\t\t\t}","","\t\t\tMatch.prototype = {","\t\t\t\tequals: function(match) {","\t\t\t\t\treturn this.mainSpan === match.mainSpan;","\t\t\t\t},","","\t\t\t\tsetCurrent: function() {","\t\t\t\t\tif (isIe) {",'\t\t\t\t\t\taddClass(this.spanInUnwrappedPre, "currentmatch");','\t\t\t\t\t\taddClass(this.spanInWrappedDiv, "currentmatch");',"\t\t\t\t\t\t// Scroll the visible one into view",'\t\t\t\t\t\tvar elementToScroll = $("wrap").checked ? this.spanInWrappedDiv : this.spanInUnwrappedPre;',"\t\t\t\t\t\tscrollIntoView(elementToScroll);","\t\t\t\t\t} else {",'\t\t\t\t\t\taddClass(this.spanInMainDiv, "currentmatch");',"\t\t\t\t\t\tscrollIntoView(this.spanInMainDiv);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tbelongsTo: function(logEntry) {","\t\t\t\t\tif (isIe) {","\t\t\t\t\t\treturn isDescendant(this.spanInUnwrappedPre, logEntry.unwrappedPre);","\t\t\t\t\t} else {","\t\t\t\t\t\treturn isDescendant(this.spanInMainDiv, logEntry.mainDiv);","\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tsetNotCurrent: function() {","\t\t\t\t\tif (isIe) {",'\t\t\t\t\t\tremoveClass(this.spanInUnwrappedPre, "currentmatch");','\t\t\t\t\t\tremoveClass(this.spanInWrappedDiv, "currentmatch");',"\t\t\t\t\t} else {",'\t\t\t\t\t\tremoveClass(this.spanInMainDiv, "currentmatch");',"\t\t\t\t\t}","\t\t\t\t},","","\t\t\t\tisOrphan: function() {","\t\t\t\t\treturn isOrphan(this.mainSpan);","\t\t\t\t},","","\t\t\t\tisVisible: function() {","\t\t\t\t\treturn getCheckBox(this.logEntryLevel).checked;","\t\t\t\t},","","\t\t\t\tremove: function() {","\t\t\t\t\tif (isIe) {","\t\t\t\t\t\tthis.spanInUnwrappedPre = null;","\t\t\t\t\t\tthis.spanInWrappedDiv = null;","\t\t\t\t\t} else {","\t\t\t\t\t\tthis.spanInMainDiv = null;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t};","","\t\t\tvar currentSearch = null;","\t\t\tvar currentMatchIndex = null;","","\t\t\tfunction doSearch() {",'\t\t\t\tvar searchBox = $("searchBox");',"\t\t\t\tvar searchTerm = searchBox.value;",'\t\t\t\tvar isRegex = $("searchRegex").checked;','\t\t\t\tvar isCaseSensitive = $("searchCaseSensitive").checked;',"\t\t\t\tvar i;","",'\t\t\t\tif (searchTerm === "") {','\t\t\t\t\t$("searchReset").disabled = true;','\t\t\t\t\t$("searchNav").style.display = "none";','\t\t\t\t\tremoveClass(document.body, "searching");','\t\t\t\t\tremoveClass(searchBox, "hasmatches");','\t\t\t\t\tremoveClass(searchBox, "nomatches");',"\t\t\t\t\tfor (i = 0; i < logEntries.length; i++) {","\t\t\t\t\t\tlogEntries[i].clearSearch();","\t\t\t\t\t\tlogEntries[i].setContent(logEntries[i].formattedMessage, logEntries[i].formattedMessage);","\t\t\t\t\t}","\t\t\t\t\tcurrentSearch = null;","\t\t\t\t\tsetLogContainerHeight();","\t\t\t\t} else {",'\t\t\t\t\t$("searchReset").disabled = false;','\t\t\t\t\t$("searchNav").style.display = "block";',"\t\t\t\t\tvar searchRegex;","\t\t\t\t\tvar regexValid;","\t\t\t\t\tif (isRegex) {","\t\t\t\t\t\ttry {",'\t\t\t\t\t\t\tsearchRegex = isCaseSensitive ? new RegExp(searchTerm, "g") : new RegExp(searchTerm, "gi");',"\t\t\t\t\t\t\tregexValid = true;",'\t\t\t\t\t\t\treplaceClass(searchBox, "validregex", "invalidregex");','\t\t\t\t\t\t\tsearchBox.title = "Valid regex";',"\t\t\t\t\t\t} catch (ex) {","\t\t\t\t\t\t\tregexValid = false;",'\t\t\t\t\t\t\treplaceClass(searchBox, "invalidregex", "validregex");','\t\t\t\t\t\t\tsearchBox.title = "Invalid regex: " + (ex.message ? ex.message : (ex.description ? ex.description : "unknown error"));',"\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t}","\t\t\t\t\t} else {",'\t\t\t\t\t\tsearchBox.title = "";','\t\t\t\t\t\tremoveClass(searchBox, "validregex");','\t\t\t\t\t\tremoveClass(searchBox, "invalidregex");',"\t\t\t\t\t}",'\t\t\t\t\taddClass(document.body, "searching");',"\t\t\t\t\tcurrentSearch = new Search(searchTerm, isRegex, searchRegex, isCaseSensitive);","\t\t\t\t\tfor (i = 0; i < logEntries.length; i++) {","\t\t\t\t\t\tcurrentSearch.applyTo(logEntries[i]);","\t\t\t\t\t}","\t\t\t\t\tsetLogContainerHeight();","","\t\t\t\t\t// Highlight the first search match","\t\t\t\t\tif (currentSearch.hasVisibleMatches()) {","\t\t\t\t\t\tsetCurrentMatchIndex(0);","\t\t\t\t\t\tdisplayMatches();","\t\t\t\t\t} else {","\t\t\t\t\t\tdisplayNoMatches();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction updateSearchFromFilters() {","\t\t\t\tif (currentSearch) {","\t\t\t\t\tif (currentSearch.hasMatches()) {","\t\t\t\t\t\tif (currentMatchIndex === null) {","\t\t\t\t\t\t\tcurrentMatchIndex = 0;","\t\t\t\t\t\t}","\t\t\t\t\t\tvar currentMatch = currentSearch.matches[currentMatchIndex];","\t\t\t\t\t\tif (currentMatch.isVisible()) {","\t\t\t\t\t\t\tdisplayMatches();","\t\t\t\t\t\t\tsetCurrentMatchIndex(currentMatchIndex);","\t\t\t\t\t\t} else {","\t\t\t\t\t\t\tcurrentMatch.setNotCurrent();","\t\t\t\t\t\t\t// Find the next visible match, if one exists","\t\t\t\t\t\t\tvar nextVisibleMatchIndex = currentSearch.getNextVisibleMatchIndex();","\t\t\t\t\t\t\tif (nextVisibleMatchIndex > -1) {","\t\t\t\t\t\t\t\tsetCurrentMatchIndex(nextVisibleMatchIndex);","\t\t\t\t\t\t\t\tdisplayMatches();","\t\t\t\t\t\t\t} else {","\t\t\t\t\t\t\t\tdisplayNoMatches();","\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t} else {","\t\t\t\t\t\tdisplayNoMatches();","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction refreshCurrentMatch() {","\t\t\t\tif (currentSearch && currentSearch.hasVisibleMatches()) {","\t\t\t\t\tsetCurrentMatchIndex(currentMatchIndex);","\t\t\t\t}","\t\t\t}","","\t\t\tfunction displayMatches() {",'\t\t\t\treplaceClass($("searchBox"), "hasmatches", "nomatches");','\t\t\t\t$("searchBox").title = "" + currentSearch.matches.length + " matches found";','\t\t\t\t$("searchNav").style.display = "block";',"\t\t\t\tsetLogContainerHeight();","\t\t\t}","","\t\t\tfunction displayNoMatches() {",'\t\t\t\treplaceClass($("searchBox"), "nomatches", "hasmatches");','\t\t\t\t$("searchBox").title = "No matches found";','\t\t\t\t$("searchNav").style.display = "none";',"\t\t\t\tsetLogContainerHeight();","\t\t\t}","","\t\t\tfunction toggleSearchEnabled(enable) {",'\t\t\t\tenable = (typeof enable == "undefined") ? !$("searchDisable").checked : enable;','\t\t\t\t$("searchBox").disabled = !enable;','\t\t\t\t$("searchReset").disabled = !enable;','\t\t\t\t$("searchRegex").disabled = !enable;','\t\t\t\t$("searchNext").disabled = !enable;','\t\t\t\t$("searchPrevious").disabled = !enable;','\t\t\t\t$("searchCaseSensitive").disabled = !enable;','\t\t\t\t$("searchNav").style.display = (enable && ($("searchBox").value !== "") &&',"\t\t\t\t\t\tcurrentSearch && currentSearch.hasVisibleMatches()) ?",'\t\t\t\t\t"block" : "none";',"\t\t\t\tif (enable) {",'\t\t\t\t\tremoveClass($("search"), "greyedout");','\t\t\t\t\taddClass(document.body, "searching");','\t\t\t\t\tif ($("searchHighlight").checked) {','\t\t\t\t\t\taddClass(logMainContainer, "searchhighlight");',"\t\t\t\t\t} else {",'\t\t\t\t\t\tremoveClass(logMainContainer, "searchhighlight");',"\t\t\t\t\t}",'\t\t\t\t\tif ($("searchFilter").checked) {','\t\t\t\t\t\taddClass(logMainContainer, "searchfilter");',"\t\t\t\t\t} else {",'\t\t\t\t\t\tremoveClass(logMainContainer, "searchfilter");',"\t\t\t\t\t}",'\t\t\t\t\t$("searchDisable").checked = !enable;',"\t\t\t\t} else {",'\t\t\t\t\taddClass($("search"), "greyedout");','\t\t\t\t\tremoveClass(document.body, "searching");','\t\t\t\t\tremoveClass(logMainContainer, "searchhighlight");','\t\t\t\t\tremoveClass(logMainContainer, "searchfilter");',"\t\t\t\t}","\t\t\t\tsetLogContainerHeight();","\t\t\t}","","\t\t\tfunction toggleSearchFilter() {",'\t\t\t\tvar enable = $("searchFilter").checked;',"\t\t\t\tif (enable) {",'\t\t\t\t\taddClass(logMainContainer, "searchfilter");',"\t\t\t\t} else {",'\t\t\t\t\tremoveClass(logMainContainer, "searchfilter");',"\t\t\t\t}","\t\t\t\trefreshCurrentMatch();","\t\t\t}","","\t\t\tfunction toggleSearchHighlight() {",'\t\t\t\tvar enable = $("searchHighlight").checked;',"\t\t\t\tif (enable) {",'\t\t\t\t\taddClass(logMainContainer, "searchhighlight");',"\t\t\t\t} else {",'\t\t\t\t\tremoveClass(logMainContainer, "searchhighlight");',"\t\t\t\t}","\t\t\t}","","\t\t\tfunction clearSearch() {",'\t\t\t\t$("searchBox").value = "";',"\t\t\t\tdoSearch();","\t\t\t}","","\t\t\tfunction searchNext() {","\t\t\t\tif (currentSearch !== null && currentMatchIndex !== null) {","\t\t\t\t\tcurrentSearch.matches[currentMatchIndex].setNotCurrent();","\t\t\t\t\tvar nextMatchIndex = currentSearch.getNextVisibleMatchIndex();",'\t\t\t\t\tif (nextMatchIndex > currentMatchIndex || confirm("Reached the end of the page. Start from the top?")) {',"\t\t\t\t\t\tsetCurrentMatchIndex(nextMatchIndex);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction searchPrevious() {","\t\t\t\tif (currentSearch !== null && currentMatchIndex !== null) {","\t\t\t\t\tcurrentSearch.matches[currentMatchIndex].setNotCurrent();","\t\t\t\t\tvar previousMatchIndex = currentSearch.getPreviousVisibleMatchIndex();",'\t\t\t\t\tif (previousMatchIndex < currentMatchIndex || confirm("Reached the start of the page. Continue from the bottom?")) {',"\t\t\t\t\t\tsetCurrentMatchIndex(previousMatchIndex);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction setCurrentMatchIndex(index) {","\t\t\t\tcurrentMatchIndex = index;","\t\t\t\tcurrentSearch.matches[currentMatchIndex].setCurrent();","\t\t\t}","","\t\t\t/* ------------------------------------------------------------------------- */","","\t\t\t// CSS Utilities","","\t\t\tfunction addClass(el, cssClass) {","\t\t\t\tif (!hasClass(el, cssClass)) {","\t\t\t\t\tif (el.className) {",'\t\t\t\t\t\tel.className += " " + cssClass;',"\t\t\t\t\t} else {","\t\t\t\t\t\tel.className = cssClass;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction hasClass(el, cssClass) {","\t\t\t\tif (el.className) {",'\t\t\t\t\tvar classNames = el.className.split(" ");',"\t\t\t\t\treturn array_contains(classNames, cssClass);","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","","\t\t\tfunction removeClass(el, cssClass) {","\t\t\t\tif (hasClass(el, cssClass)) {","\t\t\t\t\t// Rebuild the className property",'\t\t\t\t\tvar existingClasses = el.className.split(" ");',"\t\t\t\t\tvar newClasses = [];","\t\t\t\t\tfor (var i = 0, len = existingClasses.length; i < len; i++) {","\t\t\t\t\t\tif (existingClasses[i] != cssClass) {","\t\t\t\t\t\t\tnewClasses[newClasses.length] = existingClasses[i];","\t\t\t\t\t\t}","\t\t\t\t\t}",'\t\t\t\t\tel.className = newClasses.join(" ");',"\t\t\t\t}","\t\t\t}","","\t\t\tfunction replaceClass(el, newCssClass, oldCssClass) {","\t\t\t\tremoveClass(el, oldCssClass);","\t\t\t\taddClass(el, newCssClass);","\t\t\t}","","\t\t\t/* ------------------------------------------------------------------------- */","","\t\t\t// Other utility functions","","\t\t\tfunction getElementsByClass(el, cssClass, tagName) {","\t\t\t\tvar elements = el.getElementsByTagName(tagName);","\t\t\t\tvar matches = [];","\t\t\t\tfor (var i = 0, len = elements.length; i < len; i++) {","\t\t\t\t\tif (hasClass(elements[i], cssClass)) {","\t\t\t\t\t\tmatches.push(elements[i]);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\treturn matches;","\t\t\t}","","\t\t\t// Syntax borrowed from Prototype library","\t\t\tfunction $(id) {","\t\t\t\treturn document.getElementById(id);","\t\t\t}","","\t\t\tfunction isDescendant(node, ancestorNode) {","\t\t\t\twhile (node != null) {","\t\t\t\t\tif (node === ancestorNode) {","\t\t\t\t\t\treturn true;","\t\t\t\t\t}","\t\t\t\t\tnode = node.parentNode;","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","","\t\t\tfunction isOrphan(node) {","\t\t\t\tvar currentNode = node;","\t\t\t\twhile (currentNode) {","\t\t\t\t\tif (currentNode == document.body) {","\t\t\t\t\t\treturn false;","\t\t\t\t\t}","\t\t\t\t\tcurrentNode = currentNode.parentNode;","\t\t\t\t}","\t\t\t\treturn true;","\t\t\t}","","\t\t\tfunction escapeHtml(str) {",'\t\t\t\treturn str.replace(/&/g, "&amp;").replace(/[<]/g, "&lt;").replace(/>/g, "&gt;");',"\t\t\t}","","\t\t\tfunction getWindowWidth() {","\t\t\t\tif (window.innerWidth) {","\t\t\t\t\treturn window.innerWidth;","\t\t\t\t} else if (document.documentElement && document.documentElement.clientWidth) {","\t\t\t\t\treturn document.documentElement.clientWidth;","\t\t\t\t} else if (document.body) {","\t\t\t\t\treturn document.body.clientWidth;","\t\t\t\t}","\t\t\t\treturn 0;","\t\t\t}","","\t\t\tfunction getWindowHeight() {","\t\t\t\tif (window.innerHeight) {","\t\t\t\t\treturn window.innerHeight;","\t\t\t\t} else if (document.documentElement && document.documentElement.clientHeight) {","\t\t\t\t\treturn document.documentElement.clientHeight;","\t\t\t\t} else if (document.body) {","\t\t\t\t\treturn document.body.clientHeight;","\t\t\t\t}","\t\t\t\treturn 0;","\t\t\t}","","\t\t\tfunction getToolBarsHeight() {",'\t\t\t\treturn $("switches").offsetHeight;',"\t\t\t}","","\t\t\tfunction getChromeHeight() {","\t\t\t\tvar height = getToolBarsHeight();","\t\t\t\tif (showCommandLine) {",'\t\t\t\t\theight += $("commandLine").offsetHeight;',"\t\t\t\t}","\t\t\t\treturn height;","\t\t\t}","","\t\t\tfunction setLogContainerHeight() {","\t\t\t\tif (logMainContainer) {","\t\t\t\t\tvar windowHeight = getWindowHeight();",'\t\t\t\t\t$("body").style.height = getWindowHeight() + "px";','\t\t\t\t\tlogMainContainer.style.height = "" +','\t\t\t\t\t\tMath.max(0, windowHeight - getChromeHeight()) + "px";',"\t\t\t\t}","\t\t\t}","","\t\t\tfunction setCommandInputWidth() {","\t\t\t\tif (showCommandLine) {",'\t\t\t\t\t$("command").style.width = "" + Math.max(0, $("commandLineContainer").offsetWidth -','\t\t\t\t\t\t($("evaluateButton").offsetWidth + 13)) + "px";',"\t\t\t\t}","\t\t\t}","","\t\t\twindow.onresize = function() {","\t\t\t\tsetCommandInputWidth();","\t\t\t\tsetLogContainerHeight();","\t\t\t};","","\t\t\tif (!Array.prototype.push) {","\t\t\t\tArray.prototype.push = function() {","\t\t\t        for (var i = 0, len = arguments.length; i < len; i++){","\t\t\t            this[this.length] = arguments[i];","\t\t\t        }","\t\t\t        return this.length;","\t\t\t\t};","\t\t\t}","","\t\t\tif (!Array.prototype.pop) {","\t\t\t\tArray.prototype.pop = function() {","\t\t\t\t\tif (this.length > 0) {","\t\t\t\t\t\tvar val = this[this.length - 1];","\t\t\t\t\t\tthis.length = this.length - 1;","\t\t\t\t\t\treturn val;","\t\t\t\t\t}","\t\t\t\t};","\t\t\t}","","\t\t\tif (!Array.prototype.shift) {","\t\t\t\tArray.prototype.shift = function() {","\t\t\t\t\tif (this.length > 0) {","\t\t\t\t\t\tvar firstItem = this[0];","\t\t\t\t\t\tfor (var i = 0, len = this.length - 1; i < len; i++) {","\t\t\t\t\t\t\tthis[i] = this[i + 1];","\t\t\t\t\t\t}","\t\t\t\t\t\tthis.length = this.length - 1;","\t\t\t\t\t\treturn firstItem;","\t\t\t\t\t}","\t\t\t\t};","\t\t\t}","","\t\t\tif (!Array.prototype.splice) {","\t\t\t\tArray.prototype.splice = function(startIndex, deleteCount) {","\t\t\t\t\tvar itemsAfterDeleted = this.slice(startIndex + deleteCount);","\t\t\t\t\tvar itemsDeleted = this.slice(startIndex, startIndex + deleteCount);","\t\t\t\t\tthis.length = startIndex;","\t\t\t\t\t// Copy the arguments into a proper Array object","\t\t\t\t\tvar argumentsArray = [];","\t\t\t\t\tfor (var i = 0, len = arguments.length; i < len; i++) {","\t\t\t\t\t\targumentsArray[i] = arguments[i];","\t\t\t\t\t}","\t\t\t\t\tvar itemsToAppend = (argumentsArray.length > 2) ?","\t\t\t\t\t\titemsAfterDeleted = argumentsArray.slice(2).concat(itemsAfterDeleted) : itemsAfterDeleted;","\t\t\t\t\tfor (i = 0, len = itemsToAppend.length; i < len; i++) {","\t\t\t\t\t\tthis.push(itemsToAppend[i]);","\t\t\t\t\t}","\t\t\t\t\treturn itemsDeleted;","\t\t\t\t};","\t\t\t}","","\t\t\tfunction array_remove(arr, val) {","\t\t\t\tvar index = -1;","\t\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {","\t\t\t\t\tif (arr[i] === val) {","\t\t\t\t\t\tindex = i;","\t\t\t\t\t\tbreak;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tif (index >= 0) {","\t\t\t\t\tarr.splice(index, 1);","\t\t\t\t\treturn index;","\t\t\t\t} else {","\t\t\t\t\treturn false;","\t\t\t\t}","\t\t\t}","","\t\t\tfunction array_removeFromStart(array, numberToRemove) {","\t\t\t\tif (Array.prototype.splice) {","\t\t\t\t\tarray.splice(0, numberToRemove);","\t\t\t\t} else {","\t\t\t\t\tfor (var i = numberToRemove, len = array.length; i < len; i++) {","\t\t\t\t\t\tarray[i - numberToRemove] = array[i];","\t\t\t\t\t}","\t\t\t\t\tarray.length = array.length - numberToRemove;","\t\t\t\t}","\t\t\t\treturn array;","\t\t\t}","","\t\t\tfunction array_contains(arr, val) {","\t\t\t\tfor (var i = 0, len = arr.length; i < len; i++) {","\t\t\t\t\tif (arr[i] == val) {","\t\t\t\t\t\treturn true;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\treturn false;","\t\t\t}","","\t\t\tfunction getErrorMessage(ex) {","\t\t\t\tif (ex.message) {","\t\t\t\t\treturn ex.message;","\t\t\t\t} else if (ex.description) {","\t\t\t\t\treturn ex.description;","\t\t\t\t}",'\t\t\t\treturn "" + ex;',"\t\t\t}","","\t\t\tfunction moveCaretToEnd(input) {","\t\t\t\tif (input.setSelectionRange) {","\t\t\t\t\tinput.focus();","\t\t\t\t\tvar length = input.value.length;","\t\t\t\t\tinput.setSelectionRange(length, length);","\t\t\t\t} else if (input.createTextRange) {","\t\t\t\t\tvar range = input.createTextRange();","\t\t\t\t\trange.collapse(false);","\t\t\t\t\trange.select();","\t\t\t\t}","\t\t\t\tinput.focus();","\t\t\t}","","\t\t\tfunction stopPropagation(evt) {","\t\t\t\tif (evt.stopPropagation) {","\t\t\t\t\tevt.stopPropagation();",'\t\t\t\t} else if (typeof evt.cancelBubble != "undefined") {',"\t\t\t\t\tevt.cancelBubble = true;","\t\t\t\t}","\t\t\t}","","\t\t\tfunction getEvent(evt) {","\t\t\t\treturn evt ? evt : event;","\t\t\t}","","\t\t\tfunction getTarget(evt) {","\t\t\t\treturn evt.target ? evt.target : evt.srcElement;","\t\t\t}","","\t\t\tfunction getRelatedTarget(evt) {","\t\t\t\tif (evt.relatedTarget) {","\t\t\t\t\treturn evt.relatedTarget;","\t\t\t\t} else if (evt.srcElement) {","\t\t\t\t\tswitch(evt.type) {",'\t\t\t\t\t\tcase "mouseover":',"\t\t\t\t\t\t\treturn evt.fromElement;",'\t\t\t\t\t\tcase "mouseout":',"\t\t\t\t\t\t\treturn evt.toElement;","\t\t\t\t\t\tdefault:","\t\t\t\t\t\t\treturn evt.srcElement;","\t\t\t\t\t}","\t\t\t\t}","\t\t\t}","","\t\t\tfunction cancelKeyEvent(evt) {","\t\t\t\tevt.returnValue = false;","\t\t\t\tstopPropagation(evt);","\t\t\t}","","\t\t\tfunction evalCommandLine() {",'\t\t\t\tvar expr = $("command").value;',"\t\t\t\tevalCommand(expr);",'\t\t\t\t$("command").value = "";',"\t\t\t}","","\t\t\tfunction evalLastCommand() {","\t\t\t\tif (lastCommand != null) {","\t\t\t\t\tevalCommand(lastCommand);","\t\t\t\t}","\t\t\t}","","\t\t\tvar lastCommand = null;","\t\t\tvar commandHistory = [];","\t\t\tvar currentCommandIndex = 0;","","\t\t\tfunction evalCommand(expr) {","\t\t\t\tif (appender) {","\t\t\t\t\tappender.evalCommandAndAppend(expr);","\t\t\t\t} else {",'\t\t\t\t\tvar prefix = ">>> " + expr + "\\r\\n";',"\t\t\t\t\ttry {",'\t\t\t\t\t\tlog("INFO", prefix + eval(expr));',"\t\t\t\t\t} catch (ex) {",'\t\t\t\t\t\tlog("ERROR", prefix + "Error: " + getErrorMessage(ex));',"\t\t\t\t\t}","\t\t\t\t}","\t\t\t\t// Update command history","\t\t\t\tif (expr != commandHistory[commandHistory.length - 1]) {","\t\t\t\t\tcommandHistory.push(expr);","\t\t\t\t\t// Update the appender","\t\t\t\t\tif (appender) {","\t\t\t\t\t\tappender.storeCommandHistory(commandHistory);","\t\t\t\t\t}","\t\t\t\t}","\t\t\t\tcurrentCommandIndex = (expr == commandHistory[currentCommandIndex]) ? currentCommandIndex + 1 : commandHistory.length;","\t\t\t\tlastCommand = expr;","\t\t\t}","\t\t\t//]]>","\t\t</script>",'\t\t<style type="text/css">',"\t\t\tbody {","\t\t\t\tbackground-color: white;","\t\t\t\tcolor: black;","\t\t\t\tpadding: 0;","\t\t\t\tmargin: 0;","\t\t\t\tfont-family: tahoma, verdana, arial, helvetica, sans-serif;","\t\t\t\toverflow: hidden;","\t\t\t}","","\t\t\tdiv#switchesContainer input {","\t\t\t\tmargin-bottom: 0;","\t\t\t}","","\t\t\tdiv.toolbar {","\t\t\t\tborder-top: solid #ffffff 1px;","\t\t\t\tborder-bottom: solid #aca899 1px;","\t\t\t\tbackground-color: #f1efe7;","\t\t\t\tpadding: 3px 5px;","\t\t\t\tfont-size: 68.75%;","\t\t\t}","","\t\t\tdiv.toolbar, div#search input {","\t\t\t\tfont-family: tahoma, verdana, arial, helvetica, sans-serif;","\t\t\t}","","\t\t\tdiv.toolbar input.button {","\t\t\t\tpadding: 0 5px;","\t\t\t\tfont-size: 100%;","\t\t\t}","","\t\t\tdiv.toolbar input.hidden {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tdiv#switches input#clearButton {","\t\t\t\tmargin-left: 20px;","\t\t\t}","","\t\t\tdiv#levels label {","\t\t\t\tfont-weight: bold;","\t\t\t}","","\t\t\tdiv#levels label, div#options label {","\t\t\t\tmargin-right: 5px;","\t\t\t}","","\t\t\tdiv#levels label#wrapLabel {","\t\t\t\tfont-weight: normal;","\t\t\t}","","\t\t\tdiv#search label {","\t\t\t\tmargin-right: 10px;","\t\t\t}","","\t\t\tdiv#search label.searchboxlabel {","\t\t\t\tmargin-right: 0;","\t\t\t}","","\t\t\tdiv#search input {","\t\t\t\tfont-size: 100%;","\t\t\t}","","\t\t\tdiv#search input.validregex {","\t\t\t\tcolor: green;","\t\t\t}","","\t\t\tdiv#search input.invalidregex {","\t\t\t\tcolor: red;","\t\t\t}","","\t\t\tdiv#search input.nomatches {","\t\t\t\tcolor: white;","\t\t\t\tbackground-color: #ff6666;","\t\t\t}","","\t\t\tdiv#search input.nomatches {","\t\t\t\tcolor: white;","\t\t\t\tbackground-color: #ff6666;","\t\t\t}","","\t\t\tdiv#searchNav {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tdiv#commandLine {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tdiv#commandLine input#command {","\t\t\t\tfont-size: 100%;","\t\t\t\tfont-family: Courier New, Courier;","\t\t\t}","","\t\t\tdiv#commandLine input#evaluateButton {","\t\t\t}","","\t\t\t*.greyedout {","\t\t\t\tcolor: gray !important;","\t\t\t\tborder-color: gray !important;","\t\t\t}","","\t\t\t*.greyedout *.alwaysenabled { color: black; }","","\t\t\t*.unselectable {","\t\t\t\t-khtml-user-select: none;","\t\t\t\t-moz-user-select: none;","\t\t\t\tuser-select: none;","\t\t\t}","","\t\t\tdiv#log {","\t\t\t\tfont-family: Courier New, Courier;","\t\t\t\tfont-size: 75%;","\t\t\t\twidth: 100%;","\t\t\t\toverflow: auto;","\t\t\t\tclear: both;","\t\t\t\tposition: relative;","\t\t\t}","","\t\t\tdiv.group {","\t\t\t\tborder-color: #cccccc;","\t\t\t\tborder-style: solid;","\t\t\t\tborder-width: 1px 0 1px 1px;","\t\t\t\toverflow: visible;","\t\t\t}","","\t\t\tdiv.oldIe div.group, div.oldIe div.group *, div.oldIe *.logentry {","\t\t\t\theight: 1%;","\t\t\t}","","\t\t\tdiv.group div.groupheading span.expander {","\t\t\t\tborder: solid black 1px;","\t\t\t\tfont-family: Courier New, Courier;","\t\t\t\tfont-size: 0.833em;","\t\t\t\tbackground-color: #eeeeee;","\t\t\t\tposition: relative;","\t\t\t\ttop: -1px;","\t\t\t\tcolor: black;","\t\t\t\tpadding: 0 2px;","\t\t\t\tcursor: pointer;","\t\t\t\tcursor: hand;","\t\t\t\theight: 1%;","\t\t\t}","","\t\t\tdiv.group div.groupcontent {","\t\t\t\tmargin-left: 10px;","\t\t\t\tpadding-bottom: 2px;","\t\t\t\toverflow: visible;","\t\t\t}","","\t\t\tdiv.group div.expanded {","\t\t\t\tdisplay: block;","\t\t\t}","","\t\t\tdiv.group div.collapsed {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\t*.logentry {","\t\t\t\toverflow: visible;","\t\t\t\tdisplay: none;","\t\t\t\twhite-space: pre;","\t\t\t}","","\t\t\tspan.pre {","\t\t\t\twhite-space: pre;","\t\t\t}","\t\t\t","\t\t\tpre.unwrapped {","\t\t\t\tdisplay: inline !important;","\t\t\t}","","\t\t\tpre.unwrapped pre.pre, div.wrapped pre.pre {","\t\t\t\tdisplay: inline;","\t\t\t}","","\t\t\tdiv.wrapped pre.pre {","\t\t\t\twhite-space: normal;","\t\t\t}","","\t\t\tdiv.wrapped {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tbody.searching *.logentry span.currentmatch {","\t\t\t\tcolor: white !important;","\t\t\t\tbackground-color: green !important;","\t\t\t}","","\t\t\tbody.searching div.searchhighlight *.logentry span.searchterm {","\t\t\t\tcolor: black;","\t\t\t\tbackground-color: yellow;","\t\t\t}","","\t\t\tdiv.wrap *.logentry {","\t\t\t\twhite-space: normal !important;","\t\t\t\tborder-width: 0 0 1px 0;","\t\t\t\tborder-color: #dddddd;","\t\t\t\tborder-style: dotted;","\t\t\t}","","\t\t\tdiv.wrap #log_wrapped, #log_unwrapped {","\t\t\t\tdisplay: block;","\t\t\t}","","\t\t\tdiv.wrap #log_unwrapped, #log_wrapped {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tdiv.wrap *.logentry span.pre {","\t\t\t\toverflow: visible;","\t\t\t\twhite-space: normal;","\t\t\t}","","\t\t\tdiv.wrap *.logentry pre.unwrapped {","\t\t\t\tdisplay: none;","\t\t\t}","","\t\t\tdiv.wrap *.logentry span.wrapped {","\t\t\t\tdisplay: inline;","\t\t\t}","","\t\t\tdiv.searchfilter *.searchnonmatch {","\t\t\t\tdisplay: none !important;","\t\t\t}","","\t\t\tdiv#log *.TRACE, label#label_TRACE {","\t\t\t\tcolor: #666666;","\t\t\t}","","\t\t\tdiv#log *.DEBUG, label#label_DEBUG {","\t\t\t\tcolor: green;","\t\t\t}","","\t\t\tdiv#log *.INFO, label#label_INFO {","\t\t\t\tcolor: #000099;","\t\t\t}","","\t\t\tdiv#log *.WARN, label#label_WARN {","\t\t\t\tcolor: #999900;","\t\t\t}","","\t\t\tdiv#log *.ERROR, label#label_ERROR {","\t\t\t\tcolor: red;","\t\t\t}","","\t\t\tdiv#log *.FATAL, label#label_FATAL {","\t\t\t\tcolor: #660066;","\t\t\t}","","\t\t\tdiv.TRACE#log *.TRACE,","\t\t\tdiv.DEBUG#log *.DEBUG,","\t\t\tdiv.INFO#log *.INFO,","\t\t\tdiv.WARN#log *.WARN,","\t\t\tdiv.ERROR#log *.ERROR,","\t\t\tdiv.FATAL#log *.FATAL {","\t\t\t\tdisplay: block;","\t\t\t}","","\t\t\tdiv#log div.separator {","\t\t\t\tbackground-color: #cccccc;","\t\t\t\tmargin: 5px 0;","\t\t\t\tline-height: 1px;","\t\t\t}","\t\t</style>","\t</head>","",'\t<body id="body">','\t\t<div id="switchesContainer">','\t\t\t<div id="switches">','\t\t\t\t<div id="levels" class="toolbar">',"\t\t\t\t\tFilters:",'\t\t\t\t\t<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','\t\t\t\t\t<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','\t\t\t\t\t<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','\t\t\t\t\t<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','\t\t\t\t\t<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','\t\t\t\t\t<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','\t\t\t\t\t<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>',"\t\t\t\t</div>",'\t\t\t\t<div id="search" class="toolbar">','\t\t\t\t\t<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','\t\t\t\t\t<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','\t\t\t\t\t<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','\t\t\t\t\t<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','\t\t\t\t\t<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','\t\t\t\t\t<div id="searchNav">','\t\t\t\t\t\t<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','\t\t\t\t\t\t<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','\t\t\t\t\t\t<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','\t\t\t\t\t\t<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>',"\t\t\t\t\t</div>","\t\t\t\t</div>",'\t\t\t\t<div id="options" class="toolbar">',"\t\t\t\t\tOptions:",'\t\t\t\t\t<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','\t\t\t\t\t<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','\t\t\t\t\t<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','\t\t\t\t\t<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','\t\t\t\t\t<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','\t\t\t\t\t<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','\t\t\t\t\t<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />',"\t\t\t\t</div>","\t\t\t</div>","\t\t</div>",'\t\t<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','\t\t<div id="commandLine" class="toolbar">','\t\t\t<div id="commandLineContainer">','\t\t\t\t<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','\t\t\t\t<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />',"\t\t\t</div>","\t\t</div>","\t</body>","</html>",""]},b=[];ConsoleAppender=function(){};var c=1;ConsoleAppender.prototype=new Appender,ConsoleAppender.prototype.create=function(d,e,f,g,h,i,j,k){function K(a,b){this.loggingEvent=a,this.levelName=a.level.name,this.formattedMessage=b}function L(a,b){this.name=a,this.initiallyExpanded=b}function M(){}var l=this,m=!1,n=!1,o=!1,p=!1,q=[],r=!0,s=c++;g=extractBooleanFromParam(g,this.defaults.initiallyMinimized),f=extractBooleanFromParam(f,this.defaults.lazyInit),h=extractBooleanFromParam(h,this.defaults.useDocumentWrite);var t=this.defaults.newestMessageAtTop,u=this.defaults.scrollToLatestMessage;i=i?i:this.defaults.width,j=j?j:this.defaults.height;var v=this.defaults.maxMessages,w=this.defaults.showCommandLine,x=this.defaults.commandLineObjectExpansionDepth,y=this.defaults.showHideButton,z=this.defaults.showCloseButton,A=this.defaults.showLogEntryDeleteButtons;this.setLayout(this.defaults.layout);var B,C,D,E,F,G=d?"InPageAppender":"PopUpAppender",H=function(a){return n?(handleError(G+": configuration option '"+a+"' may not be set after the appender has been initialized"),!1):!0},I=function(){return o&&r&&!p};this.isNewestMessageAtTop=function(){return t},this.setNewestMessageAtTop=function(a){t=bool(a),I()&&E().setNewestAtTop(t)},this.isScrollToLatestMessage=function(){return u},this.setScrollToLatestMessage=function(a){u=bool(a),I()&&E().setScrollToLatest(u)},this.getWidth=function(){return i},this.setWidth=function(a){H("width")&&(i=extractStringFromParam(a,i))},this.getHeight=function(){return j},this.setHeight=function(a){H("height")&&(j=extractStringFromParam(a,j))},this.getMaxMessages=function(){return v},this.setMaxMessages=function(a){v=extractIntFromParam(a,v),I()&&E().setMaxMessages(v)},this.isShowCommandLine=function(){return w},this.setShowCommandLine=function(a){w=bool(a),I()&&E().setShowCommandLine(w)},this.isShowHideButton=function(){return y},this.setShowHideButton=function(a){y=bool(a),I()&&E().setShowHideButton(y)},this.isShowCloseButton=function(){return z},this.setShowCloseButton=function(a){z=bool(a),I()&&E().setShowCloseButton(z)},this.getCommandLineObjectExpansionDepth=function(){return x},this.setCommandLineObjectExpansionDepth=function(a){x=extractIntFromParam(a,x)};var J=g;this.isInitiallyMinimized=function(){return g},this.setInitiallyMinimized=function(a){H("initiallyMinimized")&&(g=bool(a),J=g)},this.isUseDocumentWrite=function(){return h},this.setUseDocumentWrite=function(a){H("useDocumentWrite")&&(h=bool(a))},K.prototype.append=function(){E().log(this.levelName,this.formattedMessage)},L.prototype.append=function(){E().group(this.name,this.initiallyExpanded)},M.prototype.append=function(){E().groupEnd()};var N=function(){D(),m?p&&bc&&C():B(),D()&&O()};this.append=function(a){if(r){var b=l.getLayout().format(a);this.getLayout().ignoresThrowable()&&(b+=a.getThrowableStrRep()),q.push(new K(a,b)),N()}},this.group=function(a,b){r&&(q.push(new L(a,b)),N())},this.groupEnd=function(){r&&(q.push(new M),N())};var O=function(){var a;while(q.length>0)q.shift().append();k&&E().focus()};this.setAddedToLogger=function(a){this.loggers.push(a),enabled&&!f&&B()},this.clear=function(){I()&&E().clearLog(),q.length=0},this.focus=function(){I()&&E().focus()},this.focusCommandLine=function(){I()&&E().focusCommandLine()},this.focusSearch=function(){I()&&E().focusSearch()};var P=window;this.getCommandWindow=function(){return P},this.setCommandWindow=function(a){P=a},this.executeLastCommand=function(){I()&&E().evalLastCommand()};var Q=new PatternLayout("%m");this.getCommandLayout=function(){return Q},this.setCommandLayout=function(a){Q=a},this.evalCommandAndAppend=function(a){var b={appendResult:!0,isError:!1},c="";try{var d,e;!P.eval&&P.execScript&&P.execScript("null");var f={};for(e=0,len=R.length;e<len;e++)f[R[e][0]]=R[e][1];var g=[],h=function(a){g.push([a,P[a]])};h("appender"),P.appender=l,h("commandReturnValue"),P.commandReturnValue=b,h("commandLineFunctionsHash"),P.commandLineFunctionsHash=f;var i=function(a){h(a),P[a]=function(){return this.commandLineFunctionsHash[a](l,arguments,b)}};for(e=0,len=R.length;e<len;e++)i(R[e][0]);P===window&&P.execScript?(h("evalExpr"),h("result"),window.evalExpr=a,P.execScript("window.result=eval(window.evalExpr);"),d=window.result):d=P.eval(a),c=isUndefined(d)?d:formatObjectExpansion(d,x);for(e=0,len=g.length;e<len;e++)P[g[e][0]]=g[e][1]}catch(j){c="Error evaluating command: "+getExceptionStringRep(j),b.isError=!0}if(b.appendResult){var k=">>> "+a;isUndefined(c)||(k+=newLine+c);var m=b.isError?Level.ERROR:Level.INFO,n=new LoggingEvent(null,new Date,m,[k],null),o=this.getLayout();this.setLayout(Q),this.append(n),this.setLayout(o)}};var R=b.concat([]);this.addCommandLineFunction=function(a,b){R.push([a,b])};var S="log4javascriptCommandHistory";this.storeCommandHistory=function(a){setCookie(S,a.join(","))};var T=function(b){var c=a();b.open();for(var d=0,e=c.length;d<e;d++)b.writeln(c[d]);b.close()};this.setEventTypes(["load","unload"]);var U=function(){var a=E();a.setAppender(l),a.setNewestAtTop(t),a.setScrollToLatest(u),a.setMaxMessages(v),a.setShowCommandLine(w),a.setShowHideButton(y),a.setShowCloseButton(z),a.setMainWindow(window);var b=getCookie(S);b&&(a.commandHistory=b.split(","),a.currentCommandIndex=a.commandHistory.length),l.dispatchEvent("load",{win:a})};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller),p||(logLog.debug("really doing unload "+this),p=!0,o=!1,n=!1,l.dispatchEvent("unload",{}))};var V=function(a,b,c,d){function e(){try{p&&clearInterval(f),a(E())&&(clearInterval(f),c())}catch(b){clearInterval(f),r=!1,handleError(d,b)}}var f=setInterval(e,b)},W=function(){var a=document.domain!=location.hostname;return h?"":getBaseUrl()+"console_uncompressed.html"+(a?"?log4javascript_domain="+escape(document.domain):"")};if(d){var X=null,Y=[];this.addCssProperty=function(a,b){H("cssProperties")&&Y.push([a,b])};var Z=!1,$,_=uniqueId+"_InPageAppender_"+s;this.hide=function(){m&&n&&(I()&&E().$("command").blur(),$.style.display="none",J=!0)},this.show=function(){m&&(n?($.style.display="block",this.setShowCommandLine(w),J=!1):Z||C(!0))},this.isVisible=function(){return!J&&!p},this.close=function(a){!p&&(!a||confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?"))&&($.parentNode.removeChild($),this.unload())},F=function(){function b(){try{g||l.show(),U(),o=!0,O()}catch(b){r=!1,handleError(a,b)}}function c(){try{var c=function(a){return isLoaded(a)};h&&T(E().document),c(E())?b():V(c,100,b,a)}catch(d){r=!1,handleError(a,d)}}var a="InPageAppender.open: unable to create console iframe";J=!1,$=X.appendChild(document.createElement("div")),$.style.width=i,$.style.height=j,$.style.border="solid gray 1px";for(var d=0,e=Y.length;d<e;d++)$.style[Y[d][0]]=Y[d][1];var f=h?"":" src='"+W()+"'";$.innerHTML="<iframe id='"+_+"' name='"+_+"' width='100%' height='100%' frameborder='0'"+f+" scrolling='no'></iframe>",p=!1;var k=function(a){try{return bool(a)&&bool(a.document)}catch(b){return!1}};k(E())?c():V(k,100,c,a),n=!0},C=function(a){if(a||!g){var b=function(){if(!e)X=document.createElement("div"),X.style.position="fixed",X.style.left="0",X.style.right="0",X.style.bottom="0",document.body.appendChild(X),l.addCssProperty("borderWidth","1px 0 0 0"),l.addCssProperty("zIndex",1e6),F();else try{var a=document.getElementById(e);a.nodeType==1&&(X=a),F()}catch(b){handleError("InPageAppender.init: invalid container element '"+e+"' supplied",b)}};pageLoaded&&e&&e.appendChild?(X=e,F()):pageLoaded?b():log4javascript.addEventListener("load",b),Z=!0}},B=function(){C(),m=!0},E=function(){var a=window.frames[_];if(a)return a},D=function(){return r&&!p?(n&&!o&&E()&&isLoaded(E())&&(o=!0),o):!1}}else{var ba=l.defaults.useOldPopUp,bb=l.defaults.complainAboutPopUpBlocking,bc=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return ba},this.setUseOldPopUp=function(a){H("useOldPopUp")&&(ba=bool(a))},this.isComplainAboutPopUpBlocking=function(){return bb},this.setComplainAboutPopUpBlocking=function(a){H("complainAboutPopUpBlocking")&&(bb=bool(a))},this.isFocusPopUp=function(){return k},this.setFocusPopUp=function(a){k=bool(a)},this.isReopenWhenClosed=function(){return bc},this.setReopenWhenClosed=function(a){bc=bool(a)},this.close=function(){logLog.debug("close "+this);try{bd.close(),this.unload()}catch(a){}},this.hide=function(){logLog.debug("hide "+this),I()&&this.close()},this.show=function(){logLog.debug("show "+this),n||F()},this.isVisible=function(){return D()};var bd;F=function(){function e(){E().setCloseIfOpenerCloses(!ba||!h),U(),o=!0,O(),V(c,500,d,"PopUpAppender.checkPopUpClosed: error checking pop-up window")}var a="width="+i+",height="+j+",status,resizable",b="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+s;if(!ba||!h)b=b+"_"+uniqueId;var c=function(a){if(p)return!0;try{return bool(a)&&a.closed}catch(b){}return!1},d=function(){p||l.unload()};try{bd=window.open(W(),b,a),p=!1,n=!0;if(bd&&bd.document)if(h&&ba&&isLoaded(bd))bd.mainPageReloaded(),e();else{h&&T(bd.document);var f=function(a){return bool(a)&&isLoaded(a)};isLoaded(bd)?e():V(f,100,e,"PopUpAppender.init: unable to create console window")}else r=!1,logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender"),bb&&handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.")}catch(g){handleError("PopUpAppender.init: error creating pop-up",g)}},C=function(){g||F()},B=function(){C(),m=!0},E=function(){return bd},D=function(){if(r&&!isUndefined(bd)&&!p){if(bd.closed||o&&isUndefined(bd.closed))return l.unload(),logLog.debug("PopUpAppender: pop-up closed"),!1;!o&&isLoaded(bd)&&(o=!0)}return r&&o&&!p}}this.getConsoleWindow=E},ConsoleAppender.addGlobalCommandLineFunction=function(a,c){b.push([a,c])},d.prototype=new ConsoleAppender,d.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,focusPopUp:!1,lazyInit:!0,useOldPopUp:!0,complainAboutPopUpBlocking:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"600",height:"400",reopenWhenClosed:!1,maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!0,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},d.prototype.toString=function(){return"PopUpAppender"},log4javascript.PopUpAppender=d,e.prototype=new ConsoleAppender,e.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:!1,lazyInit:!0,newestMessageAtTop:!1,scrollToLatestMessage:!0,width:"100%",height:"220px",maxMessages:null,showCommandLine:!0,commandLineObjectExpansionDepth:1,showHideButton:!1,showCloseButton:!1,showLogEntryDeleteButtons:!0,useDocumentWrite:!0},e.prototype.toString=function(){return"InPageAppender"},log4javascript.InPageAppender=e,log4javascript.InlineAppender=e})(),function(){function a(a){var b=0;for(var c in a)b=Math.max(toStr(c).length,b);var d=[];for(c in a){var e="  "+padWithSpaces(toStr(c),b+2),f;try{f=splitIntoLines(toStr(a[c])).join(padWithSpaces(newLine,b+6))}catch(g){f="[Error obtaining property. Details: "+getExceptionMessage(g)+"]"}d.push(e+f)}return d.join(newLine)}function f(a,g,h,i,j){function l(a){return a.nodeType==b.TEXT_NODE&&/^[ \t\r\n]*$/.test(a.nodeValue)}function m(a){return a.toString().replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/\"/g,"&quot;")}function n(a){var b=a.style.cssText.split(";"),c="",d=!0;for(var e=0,f=b.length;e<f;e++){var g=b[e].split(":"),h=[];/^\s*$/.test(g[0])||h.push(trim(g[0]).toLowerCase()+":"+trim(g[1])),c=h.join(";")}return c}function o(a){if(a.prefix)return a.prefix;if(a.outerHTML){var b=new RegExp("<([^:]+):"+a.tagName+"[^>]*>","i");if(b.test(a.outerHTML))return RegExp.$1.toLowerCase()}return""}g=typeof g=="undefined"?!0:!!g,typeof h!="string"&&(h=""),i=!!i,j=!!j;var k,p="<",q=">";if(!g||a.nodeType==b.DOCUMENT_FRAGMENT_NODE){k="";for(var y=0,z=a.childNodes.length;y<z;y++)k+=f(a.childNodes[y],!0,h+e);return k}switch(a.nodeType){case b.ELEMENT_NODE:var r=a.tagName.toLowerCase();k=i?newLine+h:"",k+=p;var s=o(a),t=!!s;t&&(k+=s+":"),k+=r;for(y=0,z=a.attributes.length;y<z;y++){var u=a.attributes[y];if(!u.specified||u.nodeValue===null||u.nodeName.toLowerCase()==="style"||typeof u.nodeValue!="string"||u.nodeName.indexOf("_moz")===0)continue;k+=" "+u.nodeName.toLowerCase()+'="',k+=m(u.nodeValue),k+='"'}if(a.style.cssText){var v=n(a);v!==""&&(k+=' style="'+n(a)+'"')}if(array_contains(d,r)||t&&!a.hasChildNodes())k+="/"+q;else{k+=q;var w=a.childNodes.length!==1||a.childNodes[0].nodeType!==b.TEXT_NODE,x=array_contains(c,r);for(var y=0,z=a.childNodes.length;y<z;y++)k+=f(a.childNodes[y],!0,h+e,w,x);var A=p+"/"+r+q;k+=w?newLine+h+A:A}return k;case b.TEXT_NODE:if(l(a))k="";else{if(j)k=a.nodeValue;else{var B=splitIntoLines(trim(a.nodeValue)),C=[];for(var y=0,z=B.length;y<z;y++)C[y]=trim(B[y]);k=C.join(newLine+h)}i&&(k=newLine+h+k)}return k;case b.CDATA_SECTION_NODE:return"<![CDATA["+a.nodeValue+"]"+"]>"+newLine;case b.DOCUMENT_NODE:k="";for(var y=0,z=a.childNodes.length;y<z;y++)k+=f(a.childNodes[y],!0,h);return k;default:return""}}function h(b){ConsoleAppender.addGlobalCommandLineFunction("$",function(a,b,c){return document.getElementById(b[0])}),ConsoleAppender.addGlobalCommandLineFunction("dir",function(b,c,d){var e=[];for(var f=0,g=c.length;f<g;f++)e[f]=a(c[f]);return e.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(a,b,c){var d=[];for(var e=0,g=b.length;e<g;e++){var h=a.getCommandWindow();d[e]=f(b[e])}return d.join(newLine+newLine)}),ConsoleAppender.addGlobalCommandLineFunction("cd",function(a,b,c){var d,e;return b.length===0||b[0]===""?(d=window,e="Command line set to run in main window"):b[0].window==b[0]?(d=b[0],e="Command line set to run in frame '"+b[0].name+"'"):(d=window.frames[b[0]],d?e="Command line set to run in frame '"+b[0]+"'":(c.isError=!0,e="Frame '"+b[0]+"' does not exist",d=a.getCommandWindow())),a.setCommandWindow(d),e}),ConsoleAppender.addGlobalCommandLineFunction("clear",function(a,b,c){c.appendResult=!1,a.clear()}),ConsoleAppender.addGlobalCommandLineFunction("keys",function(a,b,c){var d=[];for(var e in b[0])d.push(e);return d}),ConsoleAppender.addGlobalCommandLineFunction("values",function(a,b,c){var d=[];for(var e in b[0])try{d.push(b[0][e])}catch(f){logLog.warn("values(): Unable to obtain value for key "+e+". Details: "+getExceptionMessage(f))}return d}),ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(a,b,c){var d=parseInt(b[0],10);return isNaN(d)||d<0?(c.isError=!0,""+b[0]+" is not a valid expansion depth"):(a.setCommandLineObjectExpansionDepth(d),"Object expansion depth set to "+d)})}function i(){h(),initialized=!0}var b={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},c=["script","pre"],d=["br","img","hr","param","link","area","input","col","base","meta"],e="  ",g={};i()}(),log4javascript.setDocumentReady=function(){pageLoaded=!0,log4javascript.dispatchEvent("load",{})};if(window.addEventListener)window.addEventListener("load",log4javascript.setDocumentReady,!1);else if(window.attachEvent)window.attachEvent("onload",log4javascript.setDocumentReady);else{var oldOnload=window.onload;typeof window.onload!="function"?window.onload=log4javascript.setDocumentReady:window.onload=function(a){oldOnload&&oldOnload(a),log4javascript.setDocumentReady()}}return window.log4javascript=log4javascript,log4javascript}();define("../lib/log4javascript",function(){}),define("logging",["require","../lib/log4javascript"],function(a){a("../lib/log4javascript");var b=log4javascript,c=b.Level,d="patterns",e=b.getLogger(d),f=function(){b.setEnabled(!0);var a=new b.BrowserConsoleAppender;e.addAppender(a);var d=function(){this.customFields=[],this.layout_noobjects=new b.PatternLayout("%p %c: %m"),this.layout_objects=new b.PatternLayout("%p %c:")};d.prototype=new b.Layout,d.prototype.format=function(a){var b=!1;a.messages=$.map(a.messages,function(a){return $.isPlainObject(a)&&(b=!0),a&&a.jquery&&(b=!0,a=a.clone()),a});if(b){var c=this.layout_objects.format(a);return a.messages.unshift(c),a.messages}return this.layout_noobjects.format(a)},d.prototype.ignoresThrowable=function(){return!0},d.prototype.toString=function(){return"NullLayout"};var f=new d;a.setLayout(f),e.setLevel(c.INFO)};f();var g={Level:b.Level,setEnabled:function(a){b.setEnabled(!0)},setLevel:function(a){e.setLevel(a)},getLogger:function(a){var e=b.getLogger(d+(a?"."+a:""));return a==="inject_log_old"&&e.setLevel(c.INFO),a==="old-injection"&&e.setLevel(c.WARN),e}};return g}),define("core/parser",["require","../logging"],function(a){function c(a){this.params=[],this.defaults={},a&&this.add_spec(a)}var b=a("../logging").getLogger("parser");return c.prototype={named_param_pattern:/^\s*([a-zA-Z0-9]+)\s*:(.*)/,add_argument:function(a,b){b===undefined&&(b=null),this.params.push(a),this.defaults[a]=b},add_spec:function(a){var b=a.split(";"),c=this;for(var d=0,e;d<b.length;d++){e=b[d].trim();var f=e.match(c.named_param_pattern);f?c.add_argument(f[1],f[2].trim()):c.add_argument(e)}},parse:function(a,c){if(a&&a.match(/&&/))return a.split(/\s*&&\s*/).map(function(a){return this.parse(a,c)},this);var d={},e,f;if(typeof c=="object")for(e in c)d[e]=c[e];for(e in this.defaults)d[e]=d[e]||this.defaults[e];if(!a)return d;var g=a.split(";"),h,i;e=-1;while(g.length){e++;if(e>=this.params.length)break;h=g.shift().trim();if(!h)continue;if(this.named_param_pattern.test(h)){g.unshift(h);break}d[this.params[e]]=h.trim()}for(e=0;e<g.length;e++){i=g[e].match(this.named_param_pattern);if(!i){b.warn("Positional parameters not allowed after named parameters");break}if(this.defaults[i[1]]===undefined){b.warn("Unknown named parameter "+i[1]);continue}d[i[1]]=i[2].trim()}for(f in d)typeof d[f]=="string"&&d[f].slice(0,1)==="$"&&(d[f]=d[d[f].slice(1)]);return d}},c}),define("core/store",["require"],function(a){function b(a,b){this.prefix=b,this.backend=a}b.prototype._key=function(a){return this.prefix+":"+a},b.prototype._allKeys=function(){var a=[],b=this.prefix+":",c=b.length,d,e;for(e=0;e<this.backend.length;e++)d=this.backend.key(e),d.slice(0,c)===b&&a.push(d);return a},b.prototype.get=function(a){var b=this._key(a),c=this.backend.getItem(b);return c!==null&&(c=JSON.parse(c)),c},b.prototype.set=function(a,b){var c=this._key(a);return this.backend.setItem(c,JSON.stringify(b))},b.prototype.remove=function(a){var b=this._key(a);return this.backend.removeItem(b)},b.prototype.clear=function(){var a=this._allKeys();for(var b=0;b<a.length;b++)this.backend.removeItem(a[b])},b.prototype.all=function(){var a=this._allKeys(),b=this.prefix.length+1,c,d={};for(var e=0;e<a.length;e++)c=a[e].slice(b),d[c]=JSON.parse(this.backend.getItem(a[e]));return d};var c={supported:typeof window.sessionStorage!="undefined",local:function(a){return new b(window.localStorage,a)},session:function(a){return new b(window.sessionStorage,a)}};return c}),define("utils",["require","./core/store","./logging"],function(a){var b=a("./core/store"),c=a("./logging").getLogger,d=function(a,c){var d,e,f={};if(a.length>0){var g=a.slice(1).split("!");for(var h=g.length-1;h>=0;h--)if(g[h][0]=="#"){var i,j;g[h].indexOf(".")>0?(d=g[h].split("."),i=d[0],j=d[1]):(i=g[h],j=undefined);var k=[c.pop()];b.injection.load($a,url,i.slice(1),k)}else g[h].indexOf("=")>0?(e=g[h].indexOf("="),f[g[h].slice(0,e)]=g[h].slice(e+1)):f[g[h]]=!0}return f},e=function(a){var b=a.split("!"),c={},d,e,f;for(var g=0;g<b.length;g++)f=b[g].indexOf("="),f===-1?(d=b[g],e=!0):(d=b[g].slice(0,f),e=b[g].slice(f+1)),c[d]=e;return c},f=function(a,b){var d=function(d){var e=c(a);e.debug("Initialising:",d);var f=b.apply(this,arguments);return f===!1?e.debug("skipped",d):e.debug("initialised:",d),f};return d},g=function(a,b){var c=b.initialised_class;if(!c)return a;var d=function(b){var d=a.apply(this,arguments);return d!==!1&&b.addClass(c),d};return d},h=function(a,b){var c=function(c){var d=c.data(a);if(d)return undefined;var e=b.apply(this,arguments);return e!==!1&&c.data(a,!0),e};return c},i=function(a){var b=function(b){var c=Array.prototype.slice.call(arguments,1);b.each(function(){var b=$(this);return a.apply(b,[b].concat(c))})};return b},j=function(a,b){var c={};for(var d in b){var e=b[d];d==="init"&&(e=f(a,e),e=g(e,b),e=h(a+"-"+d,e)),typeof e=="function"&&(e=i(e)),c[d]=e}return c},k=function(a,b){var c=function(c){return!c||typeof c=="object"?b.init.apply(this,[this].concat(arguments)):b[c]?b[c].apply(this,[this].concat(Array.prototype.slice.call(arguments,1))):$.error("Method "+c+" does not exist on jQuery."+a),this};return c},l=function(b,c,d){b=b||"",d=d||"";var e=c.reduce(function(c,e){return c[e]=a(b+e+d),c},{});return e},m=function(a,b){var c;return function(){var d=this,e=arguments,f=function(){c=null,a.apply(d,e)};clearTimeout(c),c=setTimeout(f,b)}},n={extractParameters:d,parseOptions:e,set_initialised_class:g,once:h,turnstiled:i,pimp_pattern:j,jquery_plugin:k,debounce:m};return n}),define("core/init",["require","../lib/dist/jquery.fancybox-1.3.4","../lib/jquery.form/jquery.form","../lib/dist/jquery.jcarousel.min","../lib/dist/jquery.tools.min","../jquery-ext","../utils"],function(a){var b=a("../utils"),c={widthClasses:{},registerWidthClass:function(a,b,d){c.widthClasses[a]={minimum:b,maximum:d}},_renumberAttribute:function(a,b,c){var d=$(a),e=d.attr(b);e&&d.attr(b,e.replace(/[0-9]+/,c))},renumber:function(a,b){var d=a.find(b?b:"fieldset,tr,dd"),e,f;for(f=0;f<d.length;f++)e=d.get(f),c._renumberAttribute(e,"id",f),$("label, :input",e).each(function(){c._renumberAttribute(this,"for",f),c._renumberAttribute(this,"id",f),c._renumberAttribute(this,"name",f)})},initAutofocus:function(a){var b=$(":input.autofocus:not(.cant-touch-this)",a),c;for(c=0;c<b.length;c+=1)if(!b.eq(c).val()){b.get(c).focus();break}c===b.length&&b.eq(0).focus()},initAutocomplete:function(a){$("input.autocomplete:not(.cant-touch-this)",a).each(function(){var a=$(this),b=a.attr("name"),c;a.attr("name","_"+b),c=$("<input type='hidden'/>").attr("name",b).insertBefore(a),a.autocomplete({source:a.attr("src"),minLength:2,select:function(b,d){return c.val(d.item.value),a.val(d.item.label),!1}})})},verifyDependencies:function(a,b){var c=[],d=a.closest("form"),e,f,g,h;d.length||(d=$(document));for(f=0;f<b.on.length;f++){h=b.on[f],e=d.find(":input[name="+h[0]+"]");if(!e.length){c.push(!1);continue}e.attr("type")==="radio"||e.attr("type")==="checkbox"?g=e.filter(":checked").val():g=e.val();if((h.length===1||h[1]==="on")&&!g){c.push(!1);continue}if(h[1]==="off"&&g){c.push(!1);continue}if(h.length>2){if(h[1]==="equals"&&h[2]!==g){c.push(!1);continue}if(h[1]==="notEquals"&&h[2]===g){c.push(!1);continue}}c.push(!0)}if(b.type==="or"){for(f=0;f<c.length;f++)if(c[f])return!0;return!1}for(f=0;f<c.length;f++)if(!c[f])return!1;return!0},getDependMasters:function(a,b){var c=$(),d=a.closest("form"),e,f;d.length||(d=$(document));for(e=0;e<b.on.length;e++){f=b.on[e];if(!f)continue;c=c.add(d.find(":input[name="+f[0]+"]"))}return c},initDepends:function(a){$("*[class*='dependsOn-']",a).each(function(){var a=this,b=$(this),d=$(this),e=b.data("mapal.infoPanel"),f=b.attr("class").split(" "),g={on:[],action:"show",type:"and"},h,i,j,k;for(h=0;h<f.length;h++)j=f[h].split("-"),j[0].indexOf("depends")===0&&(i=j[0].substr(7).toLowerCase(),i==="on"?(j.length>4&&(j=j.slice(0,3).concat(j.slice(3).join("-"))),g.on.push(j.slice(1))):g[i]=j[1]);k=c.verifyDependencies(b,g),e!==undefined&&(d=d.add(e)),g.action==="show"?k?d.show():d.hide():g.action==="enable"&&(k?(a.disabled=null,b.removeClass("disabled")):(a.disabled="disabled",b.addClass("disabled"))),c.getDependMasters(b,g).bind("change.mapal",function(){k=c.verifyDependencies(b,g),g.action==="show"?k?d.slideDown():d.slideUp():g.action==="enable"&&(k?(a.disabled=null,b.removeClass("disabled")):(a.disabled="disabled",b.addClass("disabled")))})})},hasContent:function(a){return a.is(":input")?a.val():a.text().replace(/\s*/g,"")||a.find("img,object,video,audio").length},initSuperImpose:function(a){$("label.superImpose:not(.cant-touch-this)",a).each(function(){var a=$(this),b=a.attr("for").replace(/([.\[\]])/g,"\\$1"),d=b?$(":input#"+b+", .rich[id="+b+"]"):$(":input",this);if(!d.length)return;a.css("display",c.hasContent(d)?"none":"block").click(function(){d.focus()}),setTimeout(function(){a.css("display",c.hasContent(d)?"none":"block")},250),d.bind("blur.mapal",function(){a.css("display",c.hasContent(d)?"none":"block")}).bind("focus.mapal",function(){a.css("display","none")})})},initTransforms:function(a){$(".record-history",a).addClass("cant-touch-this"),$(a).is(".record-history")&&$(a).addClass("cant-touch-this"),$(".jsOnly",a).show(),$("legend:not(.cant-touch-this)",a).each(function(){$(this).replaceWith('<p class="legend">'+$(this).html()+"</p>")}),$("label dfn.infoPanel:not(.cant-touch-this)",a).each(function(){var a=$(this),b=a.closest("label"),c=$("body"),d=a.offset();a.remove().appendTo(c).css({position:"absolute",left:d.left,top:d.top}),b.data("mapal.infoPanel",a)})},initMenu:function(a){$("ul.menu:not(.cant-touch-this)").each(function(){var b=$(this),c,d,e,f,g;e=function(a){c&&(clearTimeout(c),c=null),a.hasClass("open")||(a.siblings("li.open").each(function(){d(b)}),a.addClass("open").removeClass("closed"))},d=function(a){a.find("li.open").andSelf().removeClass("open").addClass("closed")},f=function(){var a=$(this);e(a)},g=function(){var a=$(this);c&&(clearTimeout(c),c=null),c=setTimeout(function(){d(a)},1e3)},$("ul.menu li",a).addClass("closed").filter(":has(ul)").addClass("hasChildren").end().bind("mouseover.mapal",f).bind("mouseout.mapal",g)})},injection:{options:{defaultModifier:"replace",modifiers:{},bodyInjectionId:"__original_body"},load:function(a,b,d,e,f,g){function n(b,h,k){if(typeof b=="string")k=b,h=200;else{k=b.responseText;if(b.status<200||b.status>=400)return}if(a.get(0).tagName=="FORM"){var l=a.parents("#panel");l.length>0&&(l.overlay().close(),l.remove())}var m=$("<div/>").append(k.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<head\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/head>/gi,"").replace(/<body(.*)>/gi,'<div id="__original_body">').replace(/<\/body(.*)>/gi,"</div>")),n=d.length;for(var o=0;o<n;o++){var p=j[o],q,r=$("#"+i[o]),s=!1;if(r.length===0){s=document.body;if(i[o].indexOf(">")>0){var t=i[o].split(">");s=$("#"+t[0]),s.length===0&&(s=$("<div/>").appendTo(document.body),s.attr("id",t[0]))}}e[o]==c.injection.options.bodyInjectionId?(q=m.find("#"+c.injection.options.bodyInjectionId),p="content"):q=m.find("#"+e[o]);if(g&&g.length>0){var u=$(".searchText",g).val();u&&q.find(g.attr("data-filter")+":not(:Contains("+u+"))").remove()}if(c.injection.modifiers[p]&&$.isFunction(c.injection.modifiers[p].execute)){r=c.injection.modifiers[p].execute(q,r,s),s&&r.appendTo(s),c.initContent(r);var v=a.attr("data-href-next");v&&a.attr({href:v,"data-injection":"","data-href-next":""}),typeof f=="function"?f(r):(f.onFinished||$.noop)(r)}else alert('Injection[WARN]: Could not find modifier "'+p+'"')}var w=a.parents("nav, .navigation"),x,y;w.length>0&&!a.is("[data-tooltip]")&&(x=w.find("li"),x.length===0&&(x=w.find("a")),x.removeClass("current"),y=a.parents("li"),y.length>0?$(y[0]).addClass("current"):y.length===0&&a.addClass("current"))}var h;f=f||function(){},typeof e=="string"&&(e=[e]),typeof d=="string"&&(d=[d]);if(e.length>d.length)c.injection.completeArray(e,d);else for(h=e.length;h<d.length;h++)e.push(c.injection.options.bodyInjectionId);var i=[],j=[],k,l=/:[a-zA-Z]+/;for(h=0;h<d.length;h++){if(typeof d[h]=="string"){if(d[h].indexOf(">")>0){var m=d[h].split(">");i.push(m[0]+">#"+m[1].replace(l,""))}else i.push(d[h].replace(l,""));k=l.exec(d[h])||[":"+c.injection.options.defaultModifier]}else i.push($(d[h]).attr("id")),k=":"+c.injection.options.defaultModifier;k.length>0&&(k=k[0],k.length>0&&(k=k.slice(1))),e[h]==c.injection.options.bodyInjectionId?j.push("content"):j.push(k)}var o=$("#"+i.join(",#"));o.addClass("injection-loading"),c.injection.ajax(a,b,function(){n.apply(this,arguments),o.removeClass("injection-loading")})},ajax:function(a,b,d,e){var f="GET";a.get(0).tagName=="FORM"?(f="POST",a.ajaxSubmit({url:b,type:"POST",success:d})):(d&&($.isFunction(d)?(e=d,d=undefined):typeof d=="object"&&(d=$.param(d,$.ajaxSettings.traditional),f="POST")),jQuery.ajax({url:b,type:f,dataType:"html",data:d,complete:function(a,b){var d=a.getResponseHeader("X-Griddeo-Action"),f=!0;if(d){var g=d.split(";");g.length>0&&$.isFunction(c.injection.griddeoActions[g[0]])&&(f=c.injection.griddeoActions[g[0]](g.slice(1)))}f&&e(a,b)},error:function(a,b,c){return}}))},griddeoActions:{"force-redirect":function(a){return window.location=a[0].trim(),!1}},modifiers:{replace:{execute:function(a,b,c){return c?a:(a.addClass("tmp-injection-marker"),b.replaceWith(a),b=$(".tmp-injection-marker"),b.removeClass("tmp-injection-marker"),b)}},content:{execute:function(a,b){return b.html(a.html()),b}},after:{execute:function(a,b){var c=$(a[0].children);return b.append(c),c}},before:{execute:function(a,b){var c=$(a[0].children);return b.prepend(c),c}},prepend:{execute:function(a,b){return b.before(a),b.trigger("injection",a),a}},append:{execute:function(a,b){return b.after(a),b.trigger("injection",a),a}}},completeArray:function(a,b){var c=a.length;for(var d=b.length;d<c;d++)b.push(a[d])}},patterns:{options:{search:{click:["a[rel^=#]:not(.cant-touch-this)","a[rel^='.']:not(.cant-touch-this)","a[data-injection^='.']:not(.cant-touch-this)","a[data-injection^=#]:not(.cant-touch-this)"],submit:["form[data-injection^='.']:not(.cant-touch-this)","form[data-injection^=#]:not(.cant-touch-this)"]}},listeners:{onBeforeStart:[],onFinished:[],onExecuted:[]},init:function(){function d(a){var d,e=$(this),f=(e.attr("href")||e.attr("action")).split("#"),g=e.attr("rel")||e.attr("data-injection"),h=e.find(".filter");if(e.hasClass("openPanel")||e.hasClass("closePanel"))return;var i=f[0];f=f.slice(1);if(g.startsWith("#"))g.length>1?d=g.replace(/\s/g,"").split("#").slice(1):d=[],c.injection.load(e,i,d,f,undefined,h);else{var j=/^[\.][a-zA-Z]+/,k=j.exec(g);if(k.length===0)alert("Pattern[ERROR]: malformed pattern: "+g);else{k=k[0].slice(1);var l=g.replace(j,""),m=b.extractParameters(l,f);c.patterns[k]?c.patterns[k].passive||c.patterns.callListener(e,k,"onBeforeStart")&&(c.patterns[k].execute(e,i,f,m,a),c.patterns.callListener(e,k,"onExecuted")):alert('Pattern[WARN]: the pattern "'+k+'" was not found')}}return a.preventDefault(),!1}var a;for(a in c.patterns)c.patterns[a].execute&&(c.patterns[a].listeners=$.extend(!0,{},c.patterns.listeners));for(a in c.patterns)(c.patterns[a].init||$.noop)(),!c.patterns[a].dataAttr;$(c.patterns.options.search.click.join(", ")).live("click.mapal",d),$(c.patterns.options.search.submit.join(", ")).live("submit.mapal",d)},callListener:function(a,b,d){var e=!0;return $(c.patterns[b].listeners[d]).each(function(){if(e&&!this(a)){e=!1;return}}),e},registerListener:function(a,b,d){typeof a=="string"?c.patterns[a].listeners[b]&&c.patterns[a].listeners[b].push(d):$(a).each(function(){c.patterns[this]&&c.patterns[this].listeners[b]&&c.patterns[this].listeners[b].push(d)})}},closeTooltips:function(){$("dfn.infoPanel.open").removeClass("open"),$("body").unbind("click.tooltip")},initTooltip:function(a){$(a).find(".tooltipTrigger").each(function(){$(this).tooltip({relative:!0}).dynamic()}),$("dfn.infoPanel:not(span)").each(function(){var a=$(this),b=a.attr("title");if(a.data("mapal.tooltip"))return;b&&($("<span/>").addClass("title").text(b).prependTo(a),a.removeAttr("title")),a.click(function(b){a.hasClass("open")?(a.removeClass("open"),$("body").unbind("click.tooltip")):(c.closeTooltips(),a.addClass("open"),$("body").one("click.tooltip",c.closeTooltips)),b.stopPropagation()}).data("mapal.tooltip",!0)})},updateWidthClasses:function(){var a=$(window).width(),b=$("body"),d;for(var e in c.widthClasses)c.widthClasses.hasOwnProperty(e)&&(d=c.widthClasses[e],(d.minimum===null||d.minimum<=a)&&(d.maximum===null||a<=d.maximum)?b.addClass(e):b.removeClass(e))},initWidthClasses:function(){c.updateWidthClasses(),$(window).bind("resize.mapal",c.updateWidthClasses)},initIframes:function(a){$("object[type=text/html]",a).each(function(){var a=$(this),b=$("<iframe allowtransparency='true'/>");b.attr("id",a.attr("id")).attr("class",a.attr("class")).attr("src",a.attr("data")).attr("frameborder","0").attr("style","background-color:transparent"),a.replaceWith(b)})},initIEButtons:function(){if($.browser.msie){var a=Number($.browser.version.split(".",2).join(""));if(a>80)return}$("form button[type=submit]").live("click",function(){var a=this.name,b=$("<input/>"),c=this.attributes.getNamedItem("value").nodeValue;b.attr("type","hidden").attr("name",a).val(c).appendTo(this.form),$("button[type=submit]",this.form).attr("name","_buttonfix")})},initSorts:function(a){$sorting=$(a).find("ul.sorting"),$sorting.length>0&&$sorting.sortable({axis:"y",items:"li",update:function(a,b){var c=$(this),d=c.sortable("serialize");$.post(c.attr("data-injection"),d)}})},initButtonSets:function(a){$(a).buttonset&&$(a).find(".buttonSet").removeClass("buttonSet").buttonset()},initAutoLoads:function(a){$(a).find(".autoLoading-visible:not(.cant-touch-this)").each(function(){var a=$(this),b=a.parents(":scrollable");if(a.data("autoLoading"))return!1;var c=function(){return a.data("autoLoading",!0),a.trigger("click"),!0};if(b.length===0)return c();var d=function(){if(a.data("autoLoading"))return!1;var d=a.offset().top-b.offset().top-1e3,e=d<=b.innerHeight();return e?c():!1};return d()?!0:($(b[0]).on("scroll",d),$(window).on("resize",d),!1)})},passivePatterns:{selectSiblingRadio:{init:function(){},initContent:function(a){$(a).find(".selectSiblingRadio").focus(function(){var a=$(this);a.parent().find("input[type=radio]").attr("checked",!0)})}}},initContent:function(a,b){c.initTransforms(a),c.newstyle.scan(a,b),c.initAutofocus(a),c.initAutocomplete(a),c.initDepends(a),c.initSuperImpose(a),c.initTooltip(a),c.initMenu(a),c.initSorts(a),c.initButtonSets(a),c.initAutoLoads(a);for(var d in c.passivePatterns){var e=c.passivePatterns[d];e.initContent&&$.isFunction(e.initContent)&&e.initContent(a)}if($.browser.msie){var f=Number($.browser.version.split(".",2).join(""));f<=80&&c.initIframes(a)}$(a).trigger("newContent",a)},init:function(){c.initWidthClasses(),c.patterns.init()},ui:{}};return $.extend(c.ui,{modal:function(a,b){var c=".modal";if(b)for(var d in b)c+="!"+d+"=",typeof b[d]=="string"?c+="'"+b[d]+"'":c+=b[d];var e=$("<a>").attr("href",a).attr("rel",c);e.click()}}),c}),define("compat",[],function(){Array.prototype.every||(Array.prototype.every=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&!a.call(d,b[e],e,b))return!1;return!0}),Array.prototype.filter||(Array.prototype.filter=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=[],e=arguments[1];for(var f=0;f<c;f++)if(f in b){var g=b[f];a.call(e,g,f,b)&&d.push(g)}return d}),Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;if(this===null)throw new TypeError(" this is null or not defined");var e=Object(this),f=e.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=0;while(d<f){var g;d in e&&(g=e[d],a.call(c,g,d,e)),d++}}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(c===0)return-1;var d=0;arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:d!==0&&d!=Infinity&&d!=-Infinity&&(d=(d>0||-1)*Math.floor(Math.abs(d))));if(d>=c)return-1;var e=d>=0?d:Math.max(c-Math.abs(d),0);for(;e<c;e++)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.lastIndexOf||(Array.prototype.lastIndexOf=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(c===0)return-1;var d=c;arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:d!==0&&d!=1/0&&d!=-(1/0)&&(d=(d>0||-1)*Math.floor(Math.abs(d))));var e=d>=0?Math.min(d,c-1):c-Math.abs(d);for(;e>=0;e--)if(e in b&&b[e]===a)return e;return-1}),Array.prototype.map||(Array.prototype.map=function(a,b){var c,d,e;if(this===null)throw new TypeError(" this is null or not defined");var f=Object(this),g=f.length>>>0;if({}.toString.call(a)!="[object Function]")throw new TypeError(a+" is not a function");b&&(c=b),d=new Array(g),e=0;while(e<g){var h,i;e in f&&(h=f[e],i=a.call(c,h,e,f),d[e]=i),e++}return d}),Array.prototype.reduce||(Array.prototype.reduce=function(b){if(this===null||this===undefined)throw new TypeError("Object is null or undefined");var c=0,d=this.length>>0,e;if(typeof b!="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(d===0)throw new TypeError("Array length is 0 and no second argument");e=this[0],c=1}else e=arguments[1];while(c<d)c in this&&(e=b.call(undefined,e,this[c],c,this)),++c;return e}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;if(c===0&&arguments.length===1)throw new TypeError;var d=c-1,e;if(arguments.length>=2)e=arguments[1];else do{if(d in this){e=this[d--];break}if(--d<0)throw new TypeError}while(!0);while(d>=0)d in b&&(e=a.call(undefined,e,b[d],d,b)),d--;return e}),Array.prototype.some||(Array.prototype.some=function(a){if(this===null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&a.call(d,b[e],e,b))return!0;return!1}),Array.isArray||(Array.isArray=function(a){return Object.prototype.toString.call(a)=="[object Array]"}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}),function(a){a.fn.autoSuggest=function(b,c){var d={asHtmlID:!1,startText:"Enter Name Here",emptyText:"No Results Found",preFill:{},limitText:"No More Selections Are Allowed",selectedItemProp:"value",selectedValuesProp:"value",searchObjProps:"value",queryParam:"q",retrieveLimit:!1,extraParams:"",matchCase:!1,minChars:1,keyDelay:400,resultsHighlight:!0,neverSubmit:!1,selectionLimit:!1,showResultList:!0,start:function(){},selectionClick:function(a){},selectionAdded:function(a){},selectionRemoved:function(a){a.remove()},formatList:!1,beforeRetrieve:function(a){return a},retrieveComplete:function(a){return a},resultClick:function(a){},resultsComplete:function(){}},e=a.extend(d,c),f="object",g=0;if(typeof b=="string"){f="string";var h=b}else{var i=b;for(k in b)b.hasOwnProperty(k)&&g++}if(f=="object"&&g>0||f=="string")return this.each(function(b){function B(){if(lastKeyPressCode==46||lastKeyPressCode>8&&lastKeyPressCode<32)return n.hide();var b=d.val().replace(/[\\]+|[\/]+/g,"");if(b==y)return;y=b;if(b.length>=e.minChars){l.addClass("loading");if(f=="string"){var c="";e.retrieveLimit&&(c="&limit="+encodeURIComponent(e.retrieveLimit)),e.beforeRetrieve&&(b=e.beforeRetrieve.call(this,b)),a.getJSON(h+"?"+e.queryParam+"="+encodeURIComponent(b)+c+e.extraParams,function(a){g=0;var c=e.retrieveComplete.call(this,a);for(k in c)c.hasOwnProperty(k)&&g++;D(c,b)})}else e.beforeRetrieve&&(b=e.beforeRetrieve.call(this,b)),D(i,b)}else l.removeClass("loading"),n.hide()}function D(b,c){e.matchCase||(c=c.toLowerCase());var f=0;n.html(o.html("")).hide();for(var h=0;h<g;h++){var i=h;C++;var k=!1;if(e.searchObjProps=="value")var m=b[i].value;else{var m="",q=e.searchObjProps.split(",");for(var r=0;r<q.length;r++){var s=a.trim(q[r]);m=m+b[i][s]+" "}}m&&(e.matchCase||(m=m.toLowerCase()),m.search(c)!=-1&&p.val().search(","+b[i][e.selectedValuesProp]+",")==-1&&(k=!0));if(k){var t=a('<li class="as-result-item" id="as-result-item-'+i+'"></li>').click(function(){var b=a(this).data("data"),c=b.num;if(a("#as-selection-"+c,l).length<=0&&!A){var f=b.attributes;d.val("").focus(),y="",E(f,c,!0),e.resultClick.call(this,b),n.hide()}A=!1}).mousedown(function(){j=!1}).mouseover(function(){a("li",o).removeClass("active"),a(this).addClass("active")}).data("data",{attributes:b[i],num:C}),u=a.extend({},b[i]);if(!e.matchCase)var v=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+c+")(?![^<>]*>)(?![^&;]+;)","gi");else var v=new RegExp("(?![^&;]+;)(?!<[^<>]*)("+c+")(?![^<>]*>)(?![^&;]+;)","g");e.resultsHighlight&&(u[e.selectedItemProp]=u[e.selectedItemProp].replace(v,"<em>$1</em>")),e.formatList?t=e.formatList.call(this,u,t):t=t.html(u[e.selectedItemProp]),o.append(t),delete u,f++;if(e.retrieveLimit&&e.retrieveLimit==f)break}}l.removeClass("loading"),f<=0&&o.html('<li class="as-message">'+e.emptyText+"</li>"),o.css("width",l.outerWidth()),n.show(),e.resultsComplete.call(this)}function E(b,c,f){p.val()===""&&p.val(","),p.val(p.val()+b[e.selectedValuesProp]+",");var g=a('<li class="as-selection-item" id="as-selection-'+c+'"></li>').click(function(){e.selectionClick.call(this,a(this)),l.children().removeClass("selected"),a(this).addClass("selected")}).mousedown(function(){j=!1}),h=a('<a class="as-close">&times;</a>').click(function(){return p.val(p.val().replace(","+b[e.selectedValuesProp]+",",",")),e.selectionRemoved.call(this,g),j=!0,d.focus(),!1});m.before(g.html(b[e.selectedItemProp]).prepend(h)),f&&e.selectionAdded.call(this,m.prev())}function F(b){if(a(":visible",n).length>0){var c=a("li",n);if(b=="down")var d=c.eq(0);else var d=c.filter(":last");var e=a("li.active:first",n);e.length>0&&(b=="down"?d=e.next():d=e.prev()),c.removeClass("active"),d.addClass("active")}}if(!e.asHtmlID){b=b+""+Math.floor(Math.random()*100);var c="as-input-"+b}else{b=e.asHtmlID;var c=b}e.start.call(this);var d=a(this);d.attr("autocomplete","off").addClass("as-input").attr("id",c).val(e.startText);var j=!1;d.wrap('<ul class="as-selections" id="as-selections-'+b+'"></ul>').wrap('<li class="as-original" id="as-original-'+b+'"></li>');var l=a("#as-selections-"+b),m=a("#as-original-"+b),n=a('<div class="as-results" id="as-results-'+b+'"></div>').hide(),o=a('<ul class="as-list"></ul>'),p=a('<input type="hidden" class="as-values" name="as_values_'+b+'" id="as-values-'+b+'" />'),q="";if(typeof e.preFill=="string"){var r=e.preFill.split(",");for(var s=0;s<r.length;s++){var t={};t[e.selectedValuesProp]=r[s],r[s]!=""&&E(t,"000"+s)}q=e.preFill}else{q="";var u=0;for(k in e.preFill)e.preFill.hasOwnProperty(k)&&u++;if(u>0)for(var s=0;s<u;s++){var v=e.preFill[s][e.selectedValuesProp];v==undefined&&(v=""),q=q+v+",",v!=""&&E(e.preFill[s],"000"+s)}}if(q!=""){d.val("");var w=q.substring(q.length-1);w!=","&&(q+=","),p.val(","+q),a("li.as-selection-item",l).addClass("blur").removeClass("selected")}d.after(p),l.click(function(){j=!0,d.focus()}).mousedown(function(){j=!1}).after(n);var x=null,y="",z=0,A=!1;d.focus(function(){return a(this).val()==e.startText&&p.val()==""?a(this).val(""):j&&(a("li.as-selection-item",l).removeClass("blur"),a(this).val()!=""&&(o.css("width",l.outerWidth()),n.show())),j=!0,!0}).blur(function(){a(this).val()==""&&p.val()==""&&q==""?a(this).val(e.startText):j&&(a("li.as-selection-item",l).addClass("blur").removeClass("selected"),n.hide())}).keydown(function(b){lastKeyPressCode=b.keyCode,first_focus=!1;switch(b.keyCode){case 38:b.preventDefault(),F("up");break;case 40:b.preventDefault(),F("down");break;case 8:if(d.val()==""){var c=p.val().split(",");c=c[c.length-2],l.children().not(m.prev()).removeClass("selected"),m.prev().hasClass("selected")?(p.val(p.val().replace(","+c+",",",")),e.selectionRemoved.call(this,m.prev())):(e.selectionClick.call(this,m.prev()),m.prev().addClass("selected"))}d.val().length==1&&(n.hide(),y=""),a(":visible",n).length>0&&(x&&clearTimeout(x),x=setTimeout(function(){B()},e.keyDelay));break;case 9:case 188:A=!0;var f=d.val().replace(/(,)/g,"");if(f!=""&&p.val().search(","+f+",")<0&&f.length>=e.minChars){b.preventDefault();var g={};g[e.selectedItemProp]=f,g[e.selectedValuesProp]=f;var h=a("li",l).length;E(g,"00"+(h+1),!0),d.val("")};case 13:A=!1;var i=a("li.active:first",n);i.length>0&&(i.click(),n.hide()),(e.neverSubmit||i.length>0)&&b.preventDefault();break;default:e.showResultList&&(e.selectionLimit&&a("li.as-selection-item",l).length>=e.selectionLimit?(o.html('<li class="as-message">'+e.limitText+"</li>"),n.show()):(x&&clearTimeout(x),x=setTimeout(function(){B()},e.keyDelay)))}});var C=0})}}(jQuery),define("patterns/../../lib/jquery.autoSuggest",function(){}),define("patterns/autosuggest",["require","../logging","../utils","../../lib/jquery.autoSuggest"],function(a){var b=a("../logging").getLogger("autosuggest"),c=a("../utils"),d=function(a,d){var e=a.parents("[data-auto-suggest-config]:first"),f=((e.data("auto-suggest-config")||"").split(":")[1]||"").split(/\s*,\s*/),g=f.map(function(a){return{value:a,name:a}}),h=a.parents("[data-auto-suggest-prefill]:first"),i=h.data("auto-suggest-prefill");i===undefined&&(i=""),i.slice(0,1)===","&&(i=i.slice(1));var j=a.parents("[data-auto-suggest-ashtmlid]:first"),k=j.data("auto-suggest-ashtmlid")||!1,l=a.is(".auto-submit")||a.parents(".auto-submit").length>0;b.debug("auto-submit",l,a),a.on("keydown",function(b){if(b.which===13){var c=a.parents(".as-selections").next();b.preventDefault();if(c.is(":visible")&&c.find(".active").length>0)return;var d=$.Event("keydown");d.ctrlKey=!1,d.which=188,d.keyCode=188,a.trigger(d)}});var m={asHtmlID:k,preFill:i,selectedValueProp:"name",searchObjProp:"name",startText:a.attr("readonly")?"":"Click to add labels"},n;if(l){n=a.parents("form");var o=c.debounce(function(){n.submit()},400);m.selectionAdded=function(a){b.debug("submit because selection was added",a),o()},m.selectionRemoved=function(c){if(a.attr("readonly"))return;b.debug("submit because selection was removed",c),c.remove(),o()}}a.autoSuggest(g,m)},e={markup_trigger:"input.auto-suggest",initialised_class:"auto-suggest",register_jquery_plugin:!1,init:d};return e}),define("patterns/autosubmit",["require","../lib/jquery.form/jquery.form","../logging","../utils"],function(a){var b=a("../logging").getLogger("autosubmit"),c=a("../utils"),d=function(a){var d=a.is("form")?a:a.parents("form").first(),e=function(a){var c=$(a.target);if(c.is(".auto-suggest")){b.debug("ignored event from autosuggest field");return}if(c.is("input[type=search]")){var e=c.attr("name"),f=e+"-autosubmit-oldvalue",g=d.data(f)||"",h=c[0].value||"";e||b.warn("type=search without name, will be a problem if there are multiple",c);if(g===h)return;d.data(f,h)}b.info("triggered by "+a.type),d.submit()};return a.on("change",e),a.hasClass("auto-submit-keyup")&&(a.is("input")?a:a.find("input")).on("keyup",c.debounce(e,400)),(a.is("input[type=search]")?a:a.find("input[type=search]")).on("click",e),a},e={markup_trigger:".auto-submit, .auto-submit-keyup",initialised_class:"auto-submit",init:d};return e}),function(){var a;a=function(){function a(){this.options_index=0,this.parsed=[]}return a.prototype.add_node=function(a){return a.nodeName==="OPTGROUP"?this.add_group(a):this.add_option(a)},a.prototype.add_group=function(a){var b,c,d,e,f,g;b=this.parsed.length,this.parsed.push({array_index:b,group:!0,label:a.label,children:0,disabled:a.disabled}),f=a.childNodes,g=[];for(d=0,e=f.length;d<e;d++)c=f[d],g.push(this.add_option(c,b,a.disabled));return g},a.prototype.add_option=function(a,b,c){if(a.nodeName==="OPTION")return a.text!==""?(b!=null&&(this.parsed[b].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:a.value,text:a.text,html:a.innerHTML,selected:a.selected,disabled:c===!0?c:a.disabled,group_array_index:b,classes:a.className,style:a.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},a}(),a.select_to_array=function(b){var c,d,e,f,g;d=new a,g=b.childNodes;for(e=0,f=g.length;e<f;e++)c=g[e],d.add_node(c);return d.parsed},this.SelectParser=a}.call(this),function(){var a,b;b=this,a=function(){function a(a,b){this.form_field=a,this.options=b!=null?b:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.default_text_default=this.is_multiple?"Select Some Options":"Select an Option",this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return a.prototype.set_default_values=function(){var a=this;return this.click_test_action=function(b){return a.test_active_click(b)},this.activate_action=function(b){return a.activate_field(b)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.results_none_found=this.options.no_results_text||"No results match"},a.prototype.mouse_enter=function(){return this.mouse_on_container=!0},a.prototype.mouse_leave=function(){return this.mouse_on_container=!1},a.prototype.input_focus=function(a){var b=this;if(!this.active_field)return setTimeout(function(){return b.container_mousedown()},50)},a.prototype.input_blur=function(a){var b=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return b.blur_test()},100)},a.prototype.result_add_option=function(a){var b,c;return a.disabled?"":(a.dom_id=this.container_id+"_o_"+a.array_index,b=a.selected&&this.is_multiple?[]:["active-result"],a.selected&&b.push("result-selected"),a.group_array_index!=null&&b.push("group-option"),a.classes!==""&&b.push(a.classes),c=a.style.cssText!==""?' style="'+a.style+'"':"",'<li id="'+a.dom_id+'" class="'+b.join(" ")+'"'+c+">"+a.html+"</li>")},a.prototype.results_update_field=function(){return this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},a.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},a.prototype.results_search=function(a){return this.results_showing?this.winnow_results():this.results_show()},a.prototype.keyup_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode,this.search_field_scale();switch(b){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:a.preventDefault();if(this.results_showing)return this.result_select(a);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},a.prototype.generate_field_id=function(){var a;return a=this.generate_random_id(),this.form_field.id=a,a},a.prototype.generate_random_char=function(){var a,b,c;return a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",c=Math.floor(Math.random()*a.length),b=a.substring(c,c+1)},a}(),b.AbstractChosen=a}.call(this),function(){var a,b,c,d,e=Object.prototype.hasOwnProperty,f=function(a,b){function d(){this.constructor=a}for(var c in b)e.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a};d=this,a=jQuery,a.fn.extend({chosen:function(c){return!a.browser.msie||a.browser.version!=="6.0"&&a.browser.version!=="7.0"?this.each(function(d){var e;e=a(this);if(!e.hasClass("chzn-done"))return e.data("chosen",new b(this,c))}):this}}),b=function(b){function e(){e.__super__.constructor.apply(this,arguments)}return f(e,b),e.prototype.setup=function(){return this.form_field_jq=a(this.form_field),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},e.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},e.prototype.set_up_html=function(){var b,d,e,f;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),this.default_text=this.form_field_jq.data("placeholder")?this.form_field_jq.data("placeholder"):this.default_text_default,b=a("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?b.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):b.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(b),this.container=a("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),d=this.container.height(),e=this.f_width-c(this.dropdown),this.dropdown.css({width:e+"px",top:d+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),f=e-c(this.search_container)-c(this.search_field),this.search_field.css({width:f+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},e.prototype.register_observers=function(){var a=this;return this.container.mousedown(function(b){return a.container_mousedown(b)}),this.container.mouseup(function(b){return a.container_mouseup(b)}),this.container.mouseenter(function(b){return a.mouse_enter(b)}),this.container.mouseleave(function(b){return a.mouse_leave(b)}),this.search_results.mouseup(function(b){return a.search_results_mouseup(b)}),this.search_results.mouseover(function(b){return a.search_results_mouseover(b)}),this.search_results.mouseout(function(b){return a.search_results_mouseout(b)}),this.form_field_jq.bind("liszt:updated",function(b){return a.results_update_field(b)}),this.search_field.blur(function(b){return a.input_blur(b)}),this.search_field.keyup(function(b){return a.keyup_checker(b)}),this.search_field.keydown(function(b){return a.keydown_checker(b)}),this.is_multiple?(this.search_choices.click(function(b){return a.choices_click(b)}),this.search_field.focus(function(b){return a.input_focus(b)})):this.container.click(function(a){return a.preventDefault()})},e.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled)return this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field();this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1;if(!this.is_multiple)return this.selected_item.bind("focus",this.activate_action)},e.prototype.container_mousedown=function(b){var c;if(!this.is_disabled)return c=b!=null?a(b.target).hasClass("search-choice-close"):!1,b&&b.type==="mousedown"&&!this.results_showing&&b.stopPropagation(),!this.pending_destroy_click&&!c?(this.active_field?!this.is_multiple&&b&&(a(b.target)[0]===this.selected_item[0]||a(b.target).parents("a.chzn-single").length)&&(b.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),a(document).click(this.click_test_action),this.results_show()),this.activate_field()):this.pending_destroy_click=!1},e.prototype.container_mouseup=function(a){if(a.target.nodeName==="ABBR")return this.results_reset(a)},e.prototype.blur_test=function(a){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()},e.prototype.close_field=function(){return a(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){return!this.is_multiple&&!this.active_field&&(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},e.prototype.test_active_click=function(b){return a(b.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){var a,b,c,e,f;this.parsing=!0,this.results_data=d.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.find("span").text(this.default_text),this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),a="",f=this.results_data;for(c=0,e=f.length;c<e;c++)b=f[c],b.group?a+=this.result_add_group(b):b.empty||(a+=this.result_add_option(b),b.selected&&this.is_multiple?this.choice_build(b):b.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(b.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(a),this.parsing=!1},e.prototype.result_add_group=function(b){return b.disabled?"":(b.dom_id=this.container_id+"_g_"+b.array_index,'<li id="'+b.dom_id+'" class="group-result">'+a("<div />").text(b.label).html()+"</li>")},e.prototype.result_do_highlight=function(a){var b,c,d,e,f;if(a.length){this.result_clear_highlight(),this.result_highlight=a,this.result_highlight.addClass("highlighted"),d=parseInt(this.search_results.css("maxHeight"),10),f=this.search_results.scrollTop(),e=d+f,c=this.result_highlight.position().top+this.search_results.scrollTop(),b=c+this.result_highlight.outerHeight();if(b>=e)return this.search_results.scrollTop(b-d>0?b-d:0);if(c<f)return this.search_results.scrollTop(c)}},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_show=function(){var a;return this.is_multiple||(this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected)),a=this.is_multiple?this.container.height():this.container.height()-1,this.dropdown.css({top:a+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},e.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},e.prototype.set_tab_index=function(a){var b;if(this.form_field_jq.attr("tabindex"))return b=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",b):(this.selected_item.attr("tabindex",b),this.search_field.attr("tabindex",-1))},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(b){var c;c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first();if(c.length)return this.result_highlight=c,this.result_select(b)},e.prototype.search_results_mouseover=function(b){var c;c=a(b.target).hasClass("active-result")?a(b.target):a(b.target).parents(".active-result").first();if(c)return this.result_do_highlight(c)},e.prototype.search_results_mouseout=function(b){if(a(b.target).hasClass("active-result"))return this.result_clear_highlight()},e.prototype.choices_click=function(b){b.preventDefault();if(this.active_field&&!a(b.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()},e.prototype.choice_build=function(b){var c,d,e=this;return c=this.container_id+"_c_"+b.array_index,this.choices+=1,this.search_container.before('<li class="search-choice" id="'+c+'"><span>'+b.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+b.array_index+'"></a></li>'),d=a("#"+c).find("a").first(),d.click(function(a){return e.choice_destroy_link_click(a)})},e.prototype.choice_destroy_link_click=function(b){return b.preventDefault(),this.is_disabled?b.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(a(b.target)))},e.prototype.choice_destroy=function(a){return this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),this.result_deselect(a.attr("rel")),a.parents("li").first().remove()},e.prototype.results_reset=function(b){this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),a(b.target).remove(),this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()},e.prototype.result_select=function(a){var b,c,d,e;if(this.result_highlight)return b=this.result_highlight,c=b.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(b):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=b,this.selected_item.removeClass("chzn-default")),b.addClass("result-selected"),e=c.substr(c.lastIndexOf("_")+1),d=this.results_data[e],d.selected=!0,this.form_field.options[d.options_index].selected=!0,this.is_multiple?this.choice_build(d):(this.selected_item.find("span").first().text(d.text),this.allow_single_deselect&&this.single_deselect_control_build()),(!a.metaKey||!this.is_multiple)&&this.results_hide(),this.search_field.val(""),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.result_activate=function(a){return a.addClass("active-result")},e.prototype.result_deactivate=function(a){return a.removeClass("active-result")},e.prototype.result_deselect=function(b){var c,d;return d=this.results_data[b],d.selected=!1,this.form_field.options[d.options_index].selected=!1,c=a("#"+this.container_id+"_o_"+b),c.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change"),this.search_field_scale()},e.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')},e.prototype.winnow_results=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s;this.no_results_clear(),j=0,k=this.search_field.val()===this.default_text?"":a("<div/>").text(a.trim(this.search_field.val())).html(),g=this.search_contains?"":"^",f=new RegExp(g+k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),n=new RegExp(k.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),s=this.results_data;for(o=0,q=s.length;o<q;o++){c=s[o];if(!c.disabled&&!c.empty)if(c.group)a("#"+c.dom_id).css("display","none");else if(!this.is_multiple||!c.selected){b=!1,i=c.dom_id,h=a("#"+i);if(f.test(c.html))b=!0,j+=1;else if(c.html.indexOf(" ")>=0||c.html.indexOf("[")===0){e=c.html.replace(/\[|\]/g,"").split(" ");if(e.length)for(p=0,r=e.length;p<r;p++)d=e[p],f.test(d)&&(b=!0,j+=1)}b?(k.length?(l=c.html.search(n),m=c.html.substr(0,l+k.length)+"</em>"+c.html.substr(l+k.length),m=m.substr(0,l)+"<em>"+m.substr(l)):m=c.html,h.html(m),this.result_activate(h),c.group_array_index!=null&&a("#"+this.results_data[c.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&i===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(h))}}return j<1&&k.length?this.no_results(k):this.winnow_results_set_highlight()},e.prototype.winnow_results_clear=function(){var b,c,d,e,f;this.search_field.val(""),c=this.search_results.find("li"),f=[];for(d=0,e=c.length;d<e;d++)b=c[d],b=a(b),b.hasClass("group-result")?f.push(b.css("display","auto")):!this.is_multiple||!b.hasClass("result-selected")?f.push(this.result_activate(b)):f.push(void 0);return f},e.prototype.winnow_results_set_highlight=function(){var a,b;if(!this.result_highlight){b=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),a=b.length?b.first():this.search_results.find(".active-result").first();if(a!=null)return this.result_do_highlight(a)}},e.prototype.no_results=function(b){var c;return c=a('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),c.find("span").first().html(b),this.search_results.append(c)},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var b,c;this.result_highlight?this.results_showing&&(c=this.result_highlight.nextAll("li.active-result").first(),c&&this.result_do_highlight(c)):(b=this.search_results.find("li.active-result").first(),b&&this.result_do_highlight(a(b)));if(!this.results_showing)return this.results_show()},e.prototype.keyup_arrow=function(){var a;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight)return a=this.result_highlight.prevAll("li.active-result"),a.length?this.result_do_highlight(a.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())},e.prototype.keydown_backstroke=function(){return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(this.pending_backstroke=this.search_container.siblings("li.search-choice").last(),this.pending_backstroke.addClass("search-choice-focus"))},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keydown_checker=function(a){var b,c;b=(c=a.which)!=null?c:a.keyCode,this.search_field_scale(),b!==8&&this.pending_backstroke&&this.clear_backstroke();switch(b){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(a),this.mouse_on_container=!1;break;case 13:a.preventDefault();break;case 38:a.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},e.prototype.search_field_scale=function(){var b,c,d,e,f,g,h,i,j;if(this.is_multiple){d=0,h=0,f="position:absolute; left: -1000px; top: -1000px; display:none;",g=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(i=0,j=g.length;i<j;i++)e=g[i],f+=e+":"+this.search_field.css(e)+";";return c=a("<div />",{style:f}),c.text(this.search_field.val()),a("body").append(c),h=c.width()+25,c.remove(),h>this.f_width-10&&(h=this.f_width-10),this.search_field.css({width:h+"px"}),b=this.container.height(),this.dropdown.css({top:b+"px"})}},e.prototype.generate_random_id=function(){var b;b="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while(a("#"+b).length>0)b+=this.generate_random_char();return b},e}(AbstractChosen),c=function(a){var b;return b=a.outerWidth()-a.width()},d.get_side_border_padding=c}.call(this),define("patterns/../../lib/chosen.jquery",function(){}),define("patterns/breadcrumbs",["require","../../lib/chosen.jquery","../logging"],function(a){var b=a("../logging").getLogger("breadcrumbs"),c=function(a,b){var c=a.children().wrapAll('<div class="breadcrumbs-content"></div>').parent(),d=c.children().toArray().reduce(function(a,b){return a+$(b).outerWidth(!0)},0);c.width(d);var e=$('<span class="button shift">shift</span>').prependTo(a),f=!1,g=!1,h=0,i=function(a){return function(){var b;a?(b=f?0:h,c.animate({"margin-left":b},function(){e.toggleClass("shift-right shift-left"),f=!f})):(b=f?h:0,c.css({"margin-left":b}))}},j=function(){h=a.innerWidth()-c.width()-100,h<0?g?i(!1)():(g=!0,a.addClass("shifting"),e.removeClass("shift-right"),e.addClass("shift-left"),e.on("click.breadcrumbs",i(!0)),e.click()):g&&c.animate({"margin-left":0},function(){f=!1,g=!1,a.removeClass("shifting"),e.removeClass("shift-left shift-right"),e.off(".breadcrumbs")})};j(),$(window).on("resize.breadcrumbs",j)},d={markup_trigger:"nav.breadcrumbs",init:c};return d}),define("patterns/collapsible",["require","../logging"],function(a){var b=a("../logging").getLogger("collapsible"),c=function(a,b){var c=a.children(":first"),d=a.children(":gt(0)"),f;return d.length>0?f=d.wrapAll('<div class="panel-content" />').parent():f=$('<div class="panel-content" />').insertAfter(c),b&&b.closed||a.hasClass("closed")?(a.removeClass("closed"),e(a,0)):(a.addClass("open"),a.trigger("patterns-collapsible-open")),c.bind("click",function(){g(a,"fast")}),a},d=function(a,b){return a.hasClass("open")?null:(g(a,b),a)},e=function(a,b){return a.hasClass("closed")?null:(g(a,b),a)},f=function(a,b,c,d,e){a.removeClass(c),e&&a.addClass("in-progress"),b.slideToggle(e,function(){e&&a.removeClass("in-progress"),a.addClass(d)})},g=function(a,b){var c=a.find(".panel-content");return a.hasClass("closed")?(a.trigger("patterns-collapsible-open"),f(a,c,"closed","open",b)):(a.trigger("patterns-collapsible-close"),f(a,c,"open","closed",b)),a},h={markup_trigger:".collapsible",initialised_class:"collapsible",init:c,open:d,close:e,toggle:g};return h}),define("patterns/checklist",["require","../logging"],function(a){var b=a("../logging").getLogger("checklist"),c=function(a,b){var c=a.find(".functions .select-all"),f=a.find(".functions .deselect-all");c.click(function(b){b.preventDefault(),d(a)}),f.click(function(b){b.preventDefault(),e(a)}),a.on("change","input[type=checkbox]",function(b){a.find("input[type=checkbox]:visible:checked").length===0&&!f.prop("disabled")?f.attr({disabled:"disabled"}):f.prop("disabled")&&f.prop("disabled",!1),a.find("input[type=checkbox]:visible:not(:checked)").length===0&&!c.prop("disabled")?c.attr({disabled:"disabled"}):c.prop("disabled")&&c.prop("disabled",!1)})},d=function(a){var b=a.find("input[type=checkbox]:not(:checked)"),c=a.find(".functions .deselect-all"),d=a.find(".functions .select-all");b.prop("checked",!0),c.prop("disabled",!1),d.attr({disabled:"disabled"}),a.change()},e=function(a){var b=a.find("input[type=checkbox]:checked"),c=a.find(".functions .deselect-all"),d=a.find(".functions .select-all");b.prop("checked",!1),c.attr({disabled:"disabled"}),d.prop("disabled",!1),a.change()},f={markup_trigger:".check-list",initialised_class:"check-list",init:c,selectall:d,deselectall:e};return f}),define("patterns/chosen",["require","../../lib/chosen.jquery","../logging"],function(a){var b=a("../logging").getLogger("chosen"),c=function(a,b){return a.chosen(),a},d={markup_trigger:"select.chosen",register_jquery_plugin:!1,init:c};return d}),function(a){var b=/^\s*|\s*$/g,c,d="B".replace(/A(.)|B/,"$1")==="$1",e={majorVersion:"3",minorVersion:"5.0.1",releaseDate:"2012-05-10",_init:function(){function l(a){return a.src&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(a.src)?(/_(src|dev)\.js/g.test(a.src)&&(b.suffix="_src"),(j=a.src.indexOf("?"))!=-1&&(b.query=a.src.substring(j+1)),b.baseURL=a.src.substring(0,a.src.lastIndexOf("/")),i&&b.baseURL.indexOf("://")==-1&&b.baseURL.indexOf("/")!==0&&(b.baseURL=i+b.baseURL),b.baseURL):null}var b=this,c=document,d=navigator,e=d.userAgent,f,g,h,i,j,k;b.isOpera=a.opera&&opera.buildNumber,b.isWebKit=/WebKit/.test(e),b.isIE=!b.isWebKit&&!b.isOpera&&/MSIE/gi.test(e)&&/Explorer/gi.test(d.appName),b.isIE6=b.isIE&&/MSIE [56]/.test(e),b.isIE7=b.isIE&&/MSIE [7]/.test(e),b.isIE8=b.isIE&&/MSIE [8]/.test(e),b.isIE9=b.isIE&&/MSIE [9]/.test(e),b.isGecko=!b.isWebKit&&/Gecko/.test(e),b.isMac=e.indexOf("Mac")!=-1,b.isAir=/adobeair/i.test(e),b.isIDevice=/(iPad|iPhone)/.test(e),b.isIOS5=b.isIDevice&&e.match(/AppleWebKit\/(\d*)/)[1]>=534;if(a.tinyMCEPreInit){b.suffix=tinyMCEPreInit.suffix,b.baseURL=tinyMCEPreInit.base,b.query=tinyMCEPreInit.query;return}b.suffix="",g=c.getElementsByTagName("base");for(f=0;f<g.length;f++)k=g[f].href,k&&(/^https?:\/\/[^\/]+$/.test(k)&&(k+="/"),i=k?k.match(/.*\//)[0]:"");g=c.getElementsByTagName("script");for(f=0;f<g.length;f++)if(l(g[f]))return;h=c.getElementsByTagName("head")[0];if(h){g=h.getElementsByTagName("script");for(f=0;f<g.length;f++)if(l(g[f]))return}return},is:function(a,b){return b?b=="array"&&a.hasOwnProperty&&a instanceof Array?!0:typeof a==b:a!==c},makeMap:function(a,b,c){var d;a=a||[],b=b||",",typeof a=="string"&&(a=a.split(b)),c=c||{},d=a.length;while(d--)c[a[d]]={};return c},each:function(a,b,d){var e,f;if(!a)return 0;d=d||a;if(a.length!==c){for(e=0,f=a.length;e<f;e++)if(b.call(d,a[e],e,a)===!1)return 0}else for(e in a)if(a.hasOwnProperty(e)&&b.call(d,a[e],e,a)===!1)return 0;return 1},map:function(a,b){var c=[];return e.each(a,function(a){c.push(b(a))}),c},grep:function(a,b){var c=[];return e.each(a,function(a){(!b||b(a))&&c.push(a)}),c},inArray:function(a,b){var c,d;if(a)for(c=0,d=a.length;c<d;c++)if(a[c]===b)return c;return-1},extend:function(a,b){var d,e,f,g=arguments,h;for(d=1,e=g.length;d<e;d++){b=g[d];for(f in b)b.hasOwnProperty(f)&&(h=b[f],h!==c&&(a[f]=h))}return a},trim:function(a){return(a?""+a:"").replace(b,"")},create:function(a,b,c){var d=this,e,f,g,h,i,j=0;a=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(a),g=a[3].match(/(^|\.)(\w+)$/i)[2],f=d.createNS(a[3].replace(/\.\w+$/,""),c);if(f[g])return;if(a[2]=="static"){f[g]=b,this.onCreate&&this.onCreate(a[2],a[3],f[g]);return}b[g]||(b[g]=function(){},j=1),f[g]=b[g],d.extend(f[g].prototype,b),a[5]&&(e=d.resolve(a[5]).prototype,h=a[5].match(/\.(\w+)$/i)[1],i=f[g],j?f[g]=function(){return e[h].apply(this,arguments)}:f[g]=function(){return this.parent=e[h],i.apply(this,arguments)},f[g].prototype[g]=f[g],d.each(e,function(a,b){f[g].prototype[b]=e[b]}),d.each(b,function(a,b){e[b]?f[g].prototype[b]=function(){return this.parent=e[b],a.apply(this,arguments)}:b!=g&&(f[g].prototype[b]=a)})),d.each(b["static"],function(a,b){f[g][b]=a}),this.onCreate&&this.onCreate(a[2],a[3],f[g].prototype)},walk:function(a,b,c,d){d=d||this,a&&(c&&(a=a[c]),e.each(a,function(a,g){if(b.call(d,a,g,c)===!1)return!1;e.walk(a,b,c,d)}))},createNS:function(b,c){var d,e;c=c||a,b=b.split(".");for(d=0;d<b.length;d++)e=b[d],c[e]||(c[e]={}),c=c[e];return c},resolve:function(b,c){var d,e;c=c||a,b=b.split(".");for(d=0,e=b.length;d<e;d++){c=c[b[d]];if(!c)break}return c},addUnload:function(b,c){function f(){function c(){b.detachEvent("onstop",c),e&&e(),b=0}var b=document;b.readyState=="interactive"&&(b&&b.attachEvent("onstop",c),a.setTimeout(function(){b&&b.detachEvent("onstop",c)},0))}var d=this,e;return e=function(){var b=d.unloads,c,g;if(b){for(g in b)c=b[g],c&&c.func&&c.func.call(c.scope,1);a.detachEvent?(a.detachEvent("onbeforeunload",f),a.detachEvent("onunload",e)):a.removeEventListener&&a.removeEventListener("unload",e,!1),d.unloads=c=b=w=e=0,a.CollectGarbage&&CollectGarbage()}},b={func:b,scope:c||this},d.unloads?d.unloads.push(b):(a.attachEvent?(a.attachEvent("onunload",e),a.attachEvent("onbeforeunload",f)):a.addEventListener&&a.addEventListener("unload",e,!1),d.unloads=[b]),b},removeUnload:function(a){var b=this.unloads,c=null;return e.each(b,function(d,e){if(d&&d.func==a)return b.splice(e,1),c=a,!1}),c},explode:function(a,b){return!a||e.is(a,"array")?a:e.map(a.split(b||","),e.trim)},_addVer:function(a){var b;return this.query?(b=(a.indexOf("?")==-1?"?":"&")+this.query,a.indexOf("#")==-1?a+b:a.replace("#",b+"#")):a},_replace:function(a,b,e){return d?e.replace(a,function(){var a=b,d=arguments,e;for(e=0;e<d.length-2;e++)d[e]===c?a=a.replace(new RegExp("\\$"+e,"g"),""):a=a.replace(new RegExp("\\$"+e,"g"),d[e]);return a}):e.replace(a,b)}};e._init(),a.tinymce=a.tinyMCE=e}(window),tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,inDispatch:!1,Dispatcher:function(a){this.scope=a||this,this.listeners=[]},add:function(a,b){return this.listeners.push({cb:a,scope:b||this.scope}),a},addToTop:function(a,b){var c=this,d={cb:a,scope:b||c.scope};return c.inDispatch?c.listeners=[d].concat(c.listeners):c.listeners.unshift(d),a},remove:function(a){var b=this.listeners,c=null;return tinymce.each(b,function(d,e){if(a==d.cb)return c=d,b.splice(e,1),!1}),c},dispatch:function(){var a=this,b,c=arguments,d,e=a.listeners,f;a.inDispatch=!0;for(d=0;d<e.length;d++){f=e[d],b=f.cb.apply(f.scope,c.length>0?c:[f.scope]);if(b===!1)break}return a.inDispatch=!1,b}}),function(){var a=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(b,c){var d=this,e,f,g,h;b=tinymce.trim(b),c=d.settings=c||{};if(/^([\w\-]+):([^\/]{2})/i.test(b)||/^\s*#/.test(b)){d.source=b;return}b.indexOf("/")===0&&b.indexOf("//")!==0&&(b=(c.base_uri?c.base_uri.protocol||"http":"http")+"://mce_host"+b),/^[\w\-]*:?\/\//.test(b)||(h=c.base_uri?c.base_uri.path:(new tinymce.util.URI(location.href)).directory,b=(c.base_uri&&c.base_uri.protocol||"http")+"://mce_host"+d.toAbsPath(h,b)),b=b.replace(/@@/g,"(mce_at)"),b=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(b),a(["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],function(a,c){var e=b[c];e&&(e=e.replace(/\(mce_at\)/g,"@@")),d[a]=e}),g=c.base_uri;if(g){d.protocol||(d.protocol=g.protocol),d.userInfo||(d.userInfo=g.userInfo),!d.port&&d.host==="mce_host"&&(d.port=g.port);if(!d.host||d.host==="mce_host")d.host=g.host;d.source=""}},setPath:function(a){var b=this;a=/^(.*?)\/?(\w+)?$/.exec(a),b.path=a[0],b.directory=a[1],b.file=a[2],b.source="",b.getURI()},toRelative:function(a){var b=this,c;if(a==="./")return a;a=new tinymce.util.URI(a,{base_uri:b});if(a.host!="mce_host"&&b.host!=a.host&&a.host||b.port!=a.port||b.protocol!=a.protocol)return a.getURI();var d=b.getURI(),e=a.getURI();return d==e||d.charAt(d.length-1)=="/"&&d.substr(0,d.length-1)==e?d:(c=b.toRelPath(b.path,a.path),a.query&&(c+="?"+a.query),a.anchor&&(c+="#"+a.anchor),c)},toAbsolute:function(a,b){return a=new tinymce.util.URI(a,{base_uri:this}),a.getURI(this.host==a.host&&this.protocol==a.protocol?b:0)},toRelPath:function(a,b){var c,d=0,e="",f,g;a=a.substring(0,a.lastIndexOf("/")),a=a.split("/"),c=b.split("/");if(a.length>=c.length)for(f=0,g=a.length;f<g;f++)if(f>=c.length||a[f]!=c[f]){d=f+1;break}if(a.length<c.length)for(f=0,g=c.length;f<g;f++)if(f>=a.length||a[f]!=c[f]){d=f+1;break}if(d===1)return b;for(f=0,g=a.length-(d-1);f<g;f++)e+="../";for(f=d-1,g=c.length;f<g;f++)f!=d-1?e+="/"+c[f]:e+=c[f];return e},toAbsPath:function(b,c){var d,e=0,f=[],g,h;g=/\/$/.test(c)?"/":"",b=b.split("/"),c=c.split("/"),a(b,function(a){a&&f.push(a)}),b=f;for(d=c.length-1,f=[];d>=0;d--){if(c[d].length===0||c[d]===".")continue;if(c[d]===".."){e++;continue}if(e>0){e--;continue}f.push(c[d])}return d=b.length-e,d<=0?h=f.reverse().join("/"):h=b.slice(0,d).join("/")+"/"+f.reverse().join("/"),h.indexOf("/")!==0&&(h="/"+h),g&&h.lastIndexOf("/")!==h.length-1&&(h+=g),h},getURI:function(a){var b,c=this;if(!c.source||a)b="",a||(c.protocol&&(b+=c.protocol+"://"),c.userInfo&&(b+=c.userInfo+"@"),c.host&&(b+=c.host),c.port&&(b+=":"+c.port)),c.path&&(b+=c.path),c.query&&(b+="?"+c.query),c.anchor&&(b+="#"+c.anchor),c.source=b;return c.source}})}(),function(){var a=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(b){var c=this.get(b),d;return c&&a(c.split("&"),function(a){a=a.split("="),d=d||{},d[unescape(a[0])]=unescape(a[1])}),d},setHash:function(b,c,d,e,f,g){var h="";a(c,function(a,b){h+=(h?"&":"")+escape(b)+"="+escape(a)}),this.set(b,h,d,e,f,g)},get:function(a){var b=document.cookie,c,d=a+"=",e;if(!b)return;e=b.indexOf("; "+d);if(e==-1){e=b.indexOf(d);if(e!==0)return null}else e+=2;return c=b.indexOf(";",e),c==-1&&(c=b.length),unescape(b.substring(e+d.length,c))},set:function(a,b,c,d,e,f){document.cookie=a+"="+escape(b)+(c?"; expires="+c.toGMTString():"")+(d?"; path="+escape(d):"")+(e?"; domain="+e:"")+(f?"; secure":"")},remove:function(a,b){var c=new Date;c.setTime(c.getTime()-1e3),this.set(a,"",c,b,c)}})}(),function(){function serialize(a,b){var c,d,e,f;b=b||'"';if(a==null)return"null";e=typeof a;if(e=="string")return d="\bb\tt\nn\ff\rr\"\"''\\\\",b+a.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,e){return b==='"'&&a==="'"?a:(c=d.indexOf(e),c+1?"\\"+d.charAt(c+1):(a=e.charCodeAt().toString(16),"\\u"+"0000".substring(a.length)+a))})+b;if(e=="object"){if(a.hasOwnProperty&&a instanceof Array){for(c=0,d="[";c<a.length;c++)d+=(c>0?",":"")+serialize(a[c],b);return d+"]"}d="{";for(f in a)a.hasOwnProperty(f)&&(d+=typeof a[f]!="function"?(d.length>1?","+b:b)+f+b+":"+serialize(a[f],b):"");return d+"}"}return""+a}tinymce.util.JSON={serialize:serialize,parse:function(s){try{return eval("("+s+")")}catch(ex){}}}}(),tinymce.create("static tinymce.util.XHR",{send:function(a){function f(){!a.async||b.readyState==4||e++>1e4?(a.success&&e<1e4&&b.status==200?a.success.call(a.success_scope,""+b.responseText,b,a):a.error&&a.error.call(a.error_scope,e>1e4?"TIMED_OUT":"GENERAL",b,a),b=null):d.setTimeout(f,10)}function g(a){b=0;try{b=new ActiveXObject(a)}catch(c){}return b}var b,c,d=window,e=0;a.scope=a.scope||this,a.success_scope=a.success_scope||a.scope,a.error_scope=a.error_scope||a.scope,a.async=a.async===!1?!1:!0,a.data=a.data||"",b=d.XMLHttpRequest?new XMLHttpRequest:g("Microsoft.XMLHTTP")||g("Msxml2.XMLHTTP");if(b){b.overrideMimeType&&b.overrideMimeType(a.content_type),b.open(a.type||(a.data?"POST":"GET"),a.url,a.async),a.content_type&&b.setRequestHeader("Content-Type",a.content_type),b.setRequestHeader("X-Requested-With","XMLHttpRequest"),b.send(a.data);if(!a.async)return f();c=d.setTimeout(f,10)}}}),function(){var a=tinymce.extend,b=tinymce.util.JSON,c=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(b){this.settings=a({},b),this.count=0},send:function(d){var e=d.error,f=d.success;d=a(this.settings,d),d.success=function(a,c){a=b.parse(a),typeof a=="undefined"&&(a={error:"JSON Parse error."}),a.error?e.call(d.error_scope||d.scope,a.error,c):f.call(d.success_scope||d.scope,a.result)},d.error=function(a,b){e&&e.call(d.error_scope||d.scope,a,b)},d.data=b.serialize({id:d.id||"c"+this.count++,method:d.method,params:d.params}),d.content_type="application/json",c.send(d)},"static":{sendRPC:function(a){return(new tinymce.util.JSONRequest).send(a)}}})}(),function(a){a.VK={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,modifierPressed:function(a){return a.shiftKey||a.ctrlKey||a.altKey}}}(tinymce),tinymce.util.Quirks=function(a){function h(b,c){try{a.getDoc().execCommand(b,!1,c)}catch(d){}}function i(){function g(b){var c,d,g,h;c=f.getRng(),d=e.getParent(c.startContainer,e.isBlock),b&&(d=e.getNext(d,e.isBlock));if(d){g=d.firstChild;while(g&&g.nodeType==3&&g.nodeValue.length===0)g=g.nextSibling;g&&g.nodeName==="SPAN"&&(h=g.cloneNode(!1))}a.getDoc().execCommand(b?"ForwardDelete":"Delete",!1,null),d=e.getParent(c.startContainer,e.isBlock),tinymce.each(e.select("span.Apple-style-span,font.Apple-style-span",d),function(a){var b=f.getBookmark();h?e.replace(h.cloneNode(!1),a,!0):e.remove(a,!0),f.moveToBookmark(b)})}a.onKeyDown.add(function(a,e){var f;f=e.keyCode==d,!e.isDefaultPrevented()&&(f||e.keyCode==c)&&!b.modifierPressed(e)&&(e.preventDefault(),g(f))}),a.addCommand("Delete",function(){g()})}function j(){function b(a,b){var c,d,e=b?"start":"end";return c=a[e+"Container"],d=a[e+"Offset"],c.nodeType==1&&c.hasChildNodes()&&(c=c.childNodes[Math.min(b?d:d>0?d-1:0,c.childNodes.length-1)]),c}function g(a,c){var d,f,g,h,i=c?"start":"end",j;d=a[i+"Container"],f=a[i+"Offset"],g=e.getRoot(),d.nodeType==1&&(j=f>=d.childNodes.length,d=b(a,c),d.nodeType==3&&(f=c&&!j?0:d.nodeValue.length));if(d.nodeType==3&&(c&&f>0||!c&&f<d.nodeValue.length))return!1;while(d!==g){h=d.parentNode[c?"firstChild":"lastChild"],h.nodeName=="BR"&&(h=h[c?"nextSibling":"previousSibling"]||h);if(h!==d)return!1;d=d.parentNode}return!0}a.onKeyDown.addToTop(function(a,h){var i,j=h.keyCode;!h.isDefaultPrevented()&&(j==d||j==c)&&(i=f.getRng(!0),g(i,!0)&&g(i,!1)&&(i.collapsed||e.findCommonAncestor(b(i,!0),b(i))===e.getRoot())&&(a.setContent(""),a.nodeChanged(),h.preventDefault()))})}function k(){a.settings.content_editable||(e.bind(a.getDoc(),"focusin",function(a){f.setRng(f.getRng())}),e.bind(a.getDoc(),"mousedown",function(b){b.target==a.getDoc().documentElement&&(a.getWin().focus(),f.setRng(f.getRng()))}))}function l(){a.onKeyDown.add(function(a,b){if(!b.isDefaultPrevented()&&b.keyCode===c&&f.isCollapsed()&&f.getRng(!0).startOffset===0){var d=f.getNode(),g=d.previousSibling;g&&g.nodeName&&g.nodeName.toLowerCase()==="hr"&&(e.remove(g),tinymce.dom.Event.cancel(b))}})}function m(){Range.prototype.getClientRects||a.onMouseDown.add(function(a,b){if(b.target.nodeName==="HTML"){var c=a.getBody();c.blur(),setTimeout(function(){c.focus()},0)}})}function n(){a.onClick.add(function(a,b){b=b.target,/^(IMG|HR)$/.test(b.nodeName)&&f.getSel().setBaseAndExtent(b,0,b,1),b.nodeName=="A"&&e.hasClass(b,"mceItemAnchor")&&f.select(b),a.nodeChanged()})}function o(){function b(){var b=e.getAttribs(f.getStart().cloneNode(!1));return function(){var c=f.getStart();c!==a.getBody()&&(e.setAttrib(c,"style",null),tinymce.each(b,function(a){c.setAttributeNode(a.cloneNode(!0))}))}}function c(){return!f.isCollapsed()&&f.getStart()!=f.getEnd()}function d(a,b){return b.preventDefault(),!1}a.onKeyPress.add(function(a,d){var e;if((d.keyCode==8||d.keyCode==46)&&c())return e=b(),a.getDoc().execCommand("delete",!1,null),e(),d.preventDefault(),!1}),e.bind(a.getDoc(),"cut",function(e){var f;c()&&(f=b(),a.onKeyUp.addToTop(d),setTimeout(function(){f(),a.onKeyUp.remove(d)},0))})}function p(){var b,c;e.bind(a.getDoc(),"selectionchange",function(){c&&(clearTimeout(c),c=0),c=window.setTimeout(function(){var c=f.getRng();if(!b||!tinymce.dom.RangeUtils.compareRanges(c,b))a.nodeChanged(),b=c},50)})}function q(){document.body.setAttribute("role","application")}function r(){a.onKeyDown.add(function(a,b){if(!b.isDefaultPrevented()&&b.keyCode===c&&f.isCollapsed()&&f.getRng(!0).startOffset===0){var d=f.getNode().previousSibling;if(d&&d.nodeName&&d.nodeName.toLowerCase()==="table")return tinymce.dom.Event.cancel(b)}})}function s(){var b=a.getDoc().documentMode;if(b&&b>7)return;h("RespectVisibilityInDesign",!0),e.addClass(a.getBody(),"mceHideBrInPre"),a.parser.addNodeFilter("pre",function(a,b){var c=a.length,d,e,f,g;while(c--){d=a[c].getAll("br"),e=d.length;while(e--)f=d[e],g=f.prev,g&&g.type===3&&g.value.charAt(g.value-1)!="\n"?g.value+="\n":f.parent.insert(new tinymce.html.Node("#text",3),f,!0).value="\n"}}),a.serializer.addNodeFilter("pre",function(a,b){var c=a.length,d,e,f,g;while(c--){d=a[c].getAll("br"),e=d.length;while(e--)f=d[e],g=f.prev,g&&g.type==3&&(g.value=g.value.replace(/\r?\n$/,""))}})}function t(){e.bind(a.getBody(),"mouseup",function(a){var b,c=f.getNode();if(c.nodeName=="IMG"){if(b=e.getStyle(c,"width"))e.setAttrib(c,"width",b.replace(/[^0-9%]+/g,"")),e.setStyle(c,"width","");if(b=e.getStyle(c,"height"))e.setAttrib(c,"height",b.replace(/[^0-9%]+/g,"")),e.setStyle(c,"height","")}})}function u(){a.onKeyDown.add(function(a,g){var h,i,j,k,l,m,n;h=g.keyCode==d,!g.isDefaultPrevented()&&(h||g.keyCode==c)&&!b.modifierPressed(g)&&(i=f.getRng(),j=i.startContainer,k=i.startOffset,n=i.collapsed,j.nodeType==3&&j.nodeValue.length>0&&(k===0&&!n||n&&k===(h?0:1))&&(nonEmptyElements=a.schema.getNonEmptyElements(),g.preventDefault(),l=e.create("br",{id:"__tmp"}),j.parentNode.insertBefore(l,j),a.getDoc().execCommand(h?"ForwardDelete":"Delete",!1,null),j=f.getRng().startContainer,m=j.previousSibling,m&&m.nodeType==1&&!e.isBlock(m)&&e.isEmpty(m)&&!nonEmptyElements[m.nodeName.toLowerCase()]&&e.remove(m),e.remove("__tmp")))})}function v(){a.onKeyDown.add(function(a,c){var d,g,h,i,j;if(c.isDefaultPrevented()||c.keyCode!=b.BACKSPACE)return;d=f.getRng(),g=d.startContainer,h=d.startOffset,i=e.getRoot(),j=g;if(!d.collapsed||h!==0)return;while(j&&j.parentNode&&j.parentNode.firstChild==j&&j.parentNode!=i)j=j.parentNode;j.tagName==="BLOCKQUOTE"&&(a.formatter.toggle("blockquote",null,j),d.setStart(g,0),d.setEnd(g,0),f.setRng(d),f.collapse(!1))})}function w(){function b(){a._refreshContentEditable(),h("StyleWithCSS",!1),h("enableInlineTableEditing",!1),g.object_resizing||h("enableObjectResizing",!1)}g.readonly||(a.onBeforeExecCommand.add(b),a.onMouseDown.add(b))}function x(){function b(a,b){tinymce.each(e.select("a"),function(a){var b=a.parentNode,c=e.getRoot();if(b.lastChild===a){while(b&&!e.isBlock(b)){if(b.parentNode.lastChild!==b||b===c)return;b=b.parentNode}e.add(b,"br",{"data-mce-bogus":1})}})}a.onExecCommand.add(function(a,c){c==="CreateLink"&&b(a)}),a.onSetContent.add(f.onSetContent.add(b))}function y(){function b(b,c){(!b||!c.initial)&&a.execCommand("mceRepaint")}a.onUndo.add(b),a.onRedo.add(b),a.onSetContent.add(b)}function z(){a.onKeyDown.add(function(a,b){!b.isDefaultPrevented()&&b.keyCode==8&&f.getNode().nodeName=="IMG"&&(b.preventDefault(),a.undoManager.beforeChange(),e.remove(f.getNode()),a.undoManager.add())})}var b=tinymce.VK,c=b.BACKSPACE,d=b.DELETE,e=a.dom,f=a.selection,g=a.settings;r(),v(),j(),tinymce.isWebKit&&(u(),i(),k(),n(),tinymce.isIDevice&&p()),tinymce.isIE&&(l(),q(),s(),t(),z()),tinymce.isGecko&&(l(),m(),o(),w(),x(),y())},function(a){function j(a){var b;return b=document.createElement("div"),b.innerHTML=a,b.textContent||b.innerText||a}function k(a,b){var d,e,f,g={};if(a){a=a.split(","),b=b||10;for(d=0;d<a.length;d+=2)e=String.fromCharCode(parseInt(a[d],b)),c[e]||(f="&"+a[d+1]+";",g[e]=f,g[f]=e);return g}}var b,c,d,e=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,f=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,g=/[<>&\"\']/g,h=/&(#x|#)?([\w]+);/g,i={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"};c={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"},d={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},b=k("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),a.html=a.html||{},a.html.Entities={encodeRaw:function(a,b){return a.replace(b?e:f,function(a){return c[a]||a})},encodeAllRaw:function(a){return(""+a).replace(g,function(a){return c[a]||a})},encodeNumeric:function(a,b){return a.replace(b?e:f,function(a){return a.length>1?"&#"+((a.charCodeAt(0)-55296)*1024+(a.charCodeAt(1)-56320)+65536)+";":c[a]||"&#"+a.charCodeAt(0)+";"})},encodeNamed:function(a,d,g){return g=g||b,a.replace(d?e:f,function(a){return c[a]||g[a]||a})},getEncodeFunc:function(d,g){function i(a,b){return a.replace(b?e:f,function(a){return c[a]||g[a]||"&#"+a.charCodeAt(0)+";"||a})}function j(a,b){return h.encodeNamed(a,b,g)}var h=a.html.Entities;return g=k(g)||b,d=a.makeMap(d.replace(/\+/g,",")),d.named&&d.numeric?i:d.named?g?j:h.encodeNamed:d.numeric?h.encodeNumeric:h.encodeRaw},decode:function(a){return a.replace(h,function(a,c,e){return c?(e=parseInt(e,c.length===2?16:10),e>65535?(e-=65536,String.fromCharCode(55296+(e>>10),56320+(e&1023))):i[e]||String.fromCharCode(e)):d[a]||b[a]||j(a)})}}}(tinymce),tinymce.html.Styles=function(a,b){function l(a,b,c,d){function e(a){return a=parseInt(a).toString(16),a.length>1?a:"0"+a}return"#"+e(b)+e(c)+e(d)}var c=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,d=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,e=/\s*([^:]+):\s*([^;]+);?/g,f=/\s+$/,g=/rgb/,h,i,j={},k;a=a||{},k="\\\" \\' \\; \\: ; : ﻿".split(" ");for(i=0;i<k.length;i++)j[k[i]]="﻿"+i,j["﻿"+i]=k[i];return{toHex:function(a){return a.replace(c,l)},parse:function(b){function p(a,b){var c,d,e,f;c=g[a+"-top"+b];if(!c)return;d=g[a+"-right"+b];if(c!=d)return;e=g[a+"-bottom"+b];if(d!=e)return;f=g[a+"-left"+b];if(e!=f)return;g[a+b]=f,delete g[a+"-top"+b],delete g[a+"-right"+b],delete g[a+"-bottom"+b],delete g[a+"-left"+b]}function q(a){var b=g[a],c;if(!b||b.indexOf(" ")<0)return;b=b.split(" "),c=b.length;while(c--)if(b[c]!==b[0])return!1;return g[a]=b[0],!0}function r(a,b,c,d){if(!q(b))return;if(!q(c))return;if(!q(d))return;g[a]=g[b]+" "+g[c]+" "+g[d],delete g[b],delete g[c],delete g[d]}function s(a){return m=!0,j[a]}function t(a,b){return m&&(a=a.replace(/\uFEFF[0-9]/g,function(a){return j[a]})),b||(a=a.replace(/\\([\'\";:])/g,"$1")),a}function u(a,b,c,d,e,f){return e=e||f,e?(e=t(e),"'"+e.replace(/\'/g,"\\'")+"'"):(b=t(b||c||d),n&&(b=n.call(o,b,"style")),"url('"+b.replace(/\'/g,"\\'")+"')")}var g={},h,i,k,m,n=a.url_converter,o=a.url_converter_scope||this;if(b){b=b.replace(/\\[\"\';:\uFEFF]/g,s).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(a){return a.replace(/[;:]/g,s)});while(h=e.exec(b)){i=h[1].replace(f,"").toLowerCase(),k=h[2].replace(f,"");if(i&&k.length>0){if(i==="font-weight"&&k==="700")k="bold";else if(i==="color"||i==="background-color")k=k.toLowerCase();k=k.replace(c,l),k=k.replace(d,u),g[i]=m?t(k,!0):k}e.lastIndex=h.index+h[0].length}p("border",""),p("border","-width"),p("border","-color"),p("border","-style"),p("padding",""),p("margin",""),r("border","border-width","border-style","border-color"),g.border==="medium none"&&delete g.border}return g},serialize:function(a,c){function g(c){var e,f,g,i;e=b.styles[c];if(e)for(f=0,g=e.length;f<g;f++)c=e[f],i=a[c],i!==h&&i.length>0&&(d+=(d.length>0?" ":"")+c+": "+i+";")}var d="",e,f;if(c&&b&&b.styles)g("*"),g(c);else for(e in a)f=a[e],f!==h&&f.length>0&&(d+=(d.length>0?" ":"")+e+": "+f+";");return d}}},function(a){function e(a,b){return a.split(b||",")}function f(a,b){function g(b){return b.replace(/[A-Z]+/g,function(b){return g(a[b])})}var d,f={};for(d in a)a.hasOwnProperty(d)&&(a[d]=g(a[d]));return g(b).replace(/#/g,"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(a,b,d,g){d=e(d,"|"),f[b]={attributes:c(d),attributesOrder:d,children:c(g,"|",{"#comment":{}})}}),f}function g(){var a=b.html5;return a||(a=b.html5=f({A:"id|accesskey|class|dir|draggable|item|hidden|itemprop|role|spellcheck|style|subject|title",B:"#|a|abbr|area|audio|b|bdo|br|button|canvas|cite|code|command|datalist|del|dfn|em|embed|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|meta|meter|noscript|object|output|progress|q|ruby|samp|script|select|small|span|strong|sub|sup|svg|textarea|time|var|video",C:"#|a|abbr|area|address|article|aside|audio|b|bdo|blockquote|br|button|canvas|cite|code|command|datalist|del|details|dfn|dialog|div|dl|em|embed|fieldset|figure|footer|form|h1|h2|h3|h4|h5|h6|header|hgroup|hr|i|iframe|img|input|ins|kbd|keygen|label|link|map|mark|menu|meta|meter|nav|noscript|ol|object|output|p|pre|progress|q|ruby|samp|script|section|select|small|span|strong|style|sub|sup|svg|table|textarea|time|ul|var|video"},"html[A|manifest][body|head]head[A][base|command|link|meta|noscript|script|style|title]title[A][#]base[A|href|target][]link[A|href|rel|media|type|sizes][]meta[A|http-equiv|name|content|charset][]style[A|type|media|scoped][#]script[A|charset|type|src|defer|async][#]noscript[A][C]body[A][C]section[A][C]nav[A][C]article[A][C]aside[A][C]h1[A][B]h2[A][B]h3[A][B]h4[A][B]h5[A][B]h6[A][B]hgroup[A][h1|h2|h3|h4|h5|h6]header[A][C]footer[A][C]address[A][C]p[A][B]br[A][]pre[A][B]dialog[A][dd|dt]blockquote[A|cite][C]ol[A|start|reversed][li]ul[A][li]li[A|value][C]dl[A][dd|dt]dt[A][B]dd[A][C]a[A|href|target|ping|rel|media|type][C]em[A][B]strong[A][B]small[A][B]cite[A][B]q[A|cite][B]dfn[A][B]abbr[A][B]code[A][B]var[A][B]samp[A][B]kbd[A][B]sub[A][B]sup[A][B]i[A][B]b[A][B]mark[A][B]progress[A|value|max][B]meter[A|value|min|max|low|high|optimum][B]time[A|datetime][B]ruby[A][B|rt|rp]rt[A][B]rp[A][B]bdo[A][B]span[A][B]ins[A|cite|datetime][B]del[A|cite|datetime][B]figure[A][C|legend|figcaption]figcaption[A][C]img[A|alt|src|height|width|usemap|ismap][]iframe[A|name|src|height|width|sandbox|seamless][]embed[A|src|height|width|type][]object[A|data|type|height|width|usemap|name|form|classid][param]param[A|name|value][]details[A|open][C|legend]command[A|type|label|icon|disabled|checked|radiogroup][]menu[A|type|label][C|li]legend[A][C|B]div[A][C]source[A|src|type|media][]audio[A|src|autobuffer|autoplay|loop|controls][source]video[A|src|autobuffer|autoplay|loop|controls|width|height|poster][source]hr[A][]form[A|accept-charset|action|autocomplete|enctype|method|name|novalidate|target][C]fieldset[A|disabled|form|name][C|legend]label[A|form|for][B]input[A|type|accept|alt|autocomplete|checked|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|height|list|max|maxlength|min|multiple|pattern|placeholder|readonly|required|size|src|step|width|files|value][]button[A|autofocus|disabled|form|formaction|formenctype|formmethod|formnovalidate|formtarget|name|value|type][B]select[A|autofocus|disabled|form|multiple|name|size][option|optgroup]datalist[A][B|option]optgroup[A|disabled|label][option]option[A|disabled|selected|label|value][]textarea[A|autofocus|disabled|form|maxlength|name|placeholder|readonly|required|rows|cols|wrap][]keygen[A|autofocus|challenge|disabled|form|keytype|name][]output[A|for|form|name][B]canvas[A|width|height][]map[A|name][B|C]area[A|shape|coords|href|alt|target|media|rel|ping|type][]mathml[A][]svg[A][]table[A|summary][caption|colgroup|thead|tfoot|tbody|tr]caption[A][C]colgroup[A|span][col]col[A|span][]thead[A][tr]tfoot[A][tr]tbody[A][tr]tr[A][th|td]th[A|headers|rowspan|colspan|scope][B]td[A|headers|rowspan|colspan][C]")),a}function h(){var a=b.html4;return a||(a=b.html4=f({Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},"script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]")),a}var b={},c=a.makeMap,d=a.each;a.html.Schema=function(f){function v(d,e,g){var h=f[d];return h?h=c(h,",",c(h.toUpperCase()," ")):(h=b[d],h||(h=c(e," ",c(e.toUpperCase()," ")),h=a.extend(h,g),b[d]=h)),h}function w(a){return new RegExp("^"+a.replace(/([?+*])/g,".$1")+"$")}function x(b){var d,f,g,h,i,k,m,n,o,p,q,r,s,t,u,v,x,y,z,A,B,C,D=/^([#+\-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,E=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,F=/[*?+]/;if(b){b=e(b),j["@"]&&(x=j["@"].attributes,y=j["@"].attributesOrder);for(d=0,f=b.length;d<f;d++){k=D.exec(b[d]);if(k){u=k[1],p=k[2],v=k[3],o=k[4],s={},t=[],m={attributes:s,attributesOrder:t},u==="#"&&(m.paddEmpty=!0),u==="-"&&(m.removeEmpty=!0);if(x){for(A in x)s[A]=x[A];t.push.apply(t,y)}if(o){o=e(o,"|");for(g=0,h=o.length;g<h;g++){k=E.exec(o[g]);if(k){n={},r=k[1],q=k[2].replace(/::/g,":"),u=k[3],C=k[4],r==="!"&&(m.attributesRequired=m.attributesRequired||[],m.attributesRequired.push(q),n.required=!0);if(r==="-"){delete s[q],t.splice(a.inArray(t,q),1);continue}u&&(u==="="&&(m.attributesDefault=m.attributesDefault||[],m.attributesDefault.push({name:q,value:C}),n.defaultValue=C),u===":"&&(m.attributesForced=m.attributesForced||[],m.attributesForced.push({name:q,value:C}),n.forcedValue=C),u==="<"&&(n.validValues=c(C,"?"))),F.test(q)?(m.attributePatterns=m.attributePatterns||[],n.pattern=w(q),m.attributePatterns.push(n)):(s[q]||t.push(q),s[q]=n)}}}!x&&p=="@"&&(x=s,y=t),v&&(m.outputName=p,j[v]=m),F.test(p)?(m.pattern=w(p),l.push(m)):j[p]=m}}}}function y(a){j={},l=[],x(a),d(n,function(a,b){k[b]=a.children})}function z(a){var b=/^(~)?(.+)$/;a&&d(e(a),function(a){var c=b.exec(a),e=c[1]==="~",f=e?"span":"div",g=c[2];k[g]=k[f],u[g]=f,e||(s[g]={}),d(k,function(a,b){a[f]&&(a[g]=a[f])})})}function A(a){var b=/^([+\-]?)(\w+)\[([^\]]+)\]$/;a&&d(e(a),function(a){var c=b.exec(a),f,g;c&&(g=c[1],g?f=k[c[2]]:f=k[c[2]]={"#comment":{}},f=k[c[2]],d(e(c[3],"|"),function(a){g==="-"?delete f[a]:f[a]={}}))})}function B(a){var b=j[a],c;if(b)return b;c=l.length;while(c--){b=l[c];if(b.pattern.test(a))return b}}var i=this,j={},k={},l=[],m,n,o,p,q,r,s,t,u={};f=f||{},n=f.schema=="html5"?g():h(),f.verify_html===!1&&(f.valid_elements="*[*]"),f.valid_styles&&(m={},d(f.valid_styles,function(b,c){m[c]=a.explode(b)})),o=v("whitespace_elements","pre script style textarea"),p=v("self_closing_elements","colgroup dd dt li options p td tfoot th thead tr"),q=v("short_ended_elements","area base basefont br col frame hr img input isindex link meta param embed source"),r=v("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls"),t=v("non_empty_elements","td th iframe video audio object",q),s=v("block_elements","h1 h2 h3 h4 h5 h6 hr p div address pre form table tbody thead tfoot th tr td li ol ul caption blockquote center dl dt dd dir fieldset noscript menu isindex samp header footer article section hgroup aside nav figure"),f.valid_elements?y(f.valid_elements):(d(n,function(a,b){j[b]={attributes:a.attributes,attributesOrder:a.attributesOrder},k[b]=a.children}),f.schema!="html5"&&d(e("strong/b,em/i"),function(a){a=e(a,"/"),j[a[1]].outputName=a[0]}),j.img.attributesDefault=[{name:"alt",value:""}],d(e("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr,strong,em,b,i"),function(a){j[a]&&(j[a].removeEmpty=!0)}),d(e("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(a){j[a].paddEmpty=!0})),z(f.custom_elements),A(f.valid_children),x(f.extended_valid_elements),A("+ol[ul|ol],+ul[ul|ol]"),f.invalid_elements&&a.each(a.explode(f.invalid_elements),function(a){j[a]&&delete j[a]}),B("span")||x("span[!data-mce-type|*]"),i.children=k,i.styles=m,i.getBoolAttrs=function(){return r},i.getBlockElements=function(){return s},i.getShortEndedElements=function(){return q},i.getSelfClosingElements=function(){return p},i.getNonEmptyElements=function(){return t},i.getWhiteSpaceElements=function(){return o},i.isValidChild=function(a,b){var c=k[a];return!!c&&!!c[b]},i.getElementRule=B,i.getCustomElements=function(){return u},i.addValidElements=x,i.setValidElements=y,i.addCustomElements=z,i.addValidChildren=A}}(tinymce),function(a){a.html.SaxParser=function(b,c){var d=this,e=function(){};b=b||{},d.schema=c=c||new a.html.Schema,b.fix_self_closing!==!1&&(b.fix_self_closing=!0),a.each("comment cdata text start end pi doctype".split(" "),function(a){a&&(d[a]=b[a]||e)}),d.parse=function(d){function N(a){var b,c;b=j.length;while(b--)if(j[b].name===a)break;if(b>=0){for(c=j.length-1;c>=b;c--)a=j[c],a.valid&&e.end(a.name);j.length=b}}function O(a,b,c,d,e){var f,g;b=b.toLowerCase(),c=b in r?b:K(c||d||e||"");if(t&&!o&&b.indexOf("data-")!==0){f=z[b];if(!f&&A){g=A.length;while(g--){f=A[g];if(f.pattern.test(b))break}g===-1&&(f=null)}if(!f)return;if(f.validValues&&!(c in f.validValues))return}k.map[b]=c,k.push({name:b,value:c})}var e=this,f,g=0,h,i,j=[],k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J=0,K=a.html.Entities.decode,L,M;F=new RegExp("<(?:(?:!--([\\w\\W]*?)-->)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([A-Za-z0-9\\-\\:]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/|\\s+)>))","g"),G=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g,H={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi},q=c.getShortEndedElements(),E=c.getSelfClosingElements(),r=c.getBoolAttrs(),t=b.validate,p=b.remove_internals,L=b.fix_self_closing,M=a.isIE,y=/^:/;while(f=F.exec(d)){g<f.index&&e.text(K(d.substr(g,f.index-g)));if(h=f[6])h=h.toLowerCase(),M&&y.test(h)&&(h=h.substr(1)),N(h);else if(h=f[7]){h=h.toLowerCase(),M&&y.test(h)&&(h=h.substr(1)),s=h in q,L&&E[h]&&j.length>0&&j[j.length-1].name===h&&N(h);if(!t||(u=c.getElementRule(h))){v=!0,t&&(z=u.attributes,A=u.attributePatterns),(x=f[8])?(o=x.indexOf("data-mce-type")!==-1,o&&p&&(v=!1),k=[],k.map={},x.replace(G,O)):(k=[],k.map={});if(t&&!o){B=u.attributesRequired,C=u.attributesDefault,D=u.attributesForced;if(D){l=D.length;while(l--)w=D[l],n=w.name,I=w.value,I==="{$uid}"&&(I="mce_"+J++),k.map[n]=I,k.push({name:n,value:I})}if(C){l=C.length;while(l--)w=C[l],n=w.name,n in k.map||(I=w.value,I==="{$uid}"&&(I="mce_"+J++),k.map[n]=I,k.push({name:n,value:I}))}if(B){l=B.length;while(l--)if(B[l]in k.map)break;l===-1&&(v=!1)}k.map["data-mce-bogus"]&&(v=!1)}v&&e.start(h,k,s)}else v=!1;if(i=H[h]){i.lastIndex=g=f.index+f[0].length,(f=i.exec(d))?(v&&(m=d.substr(g,f.index-g)),g=f.index+f[0].length):(m=d.substr(g),g=d.length),v&&m.length>0&&e.text(m,!0),v&&e.end(h),F.lastIndex=g;continue}s||(!x||x.indexOf("/")!=x.length-1?j.push({name:h,valid:v}):v&&e.end(h))}else(h=f[1])?e.comment(h):(h=f[2])?e.cdata(h):(h=f[3])?e.doctype(h):(h=f[4])&&e.pi(h,f[5]);g=f.index+f[0].length}g<d.length&&e.text(K(d.substr(g)));for(l=j.length-1;l>=0;l--)h=j[l],h.valid&&e.end(h.name)}}}(tinymce),function(a){function d(a,b,c){var d,e,f=c?"lastChild":"firstChild",g=c?"prev":"next";if(a[f])return a[f];if(a!==b){d=a[g];if(d)return d;for(e=a.parent;e&&e!==b;e=e.parent){d=e[g];if(d)return d}}}function e(a,b){this.name=a,this.type=b,b===1&&(this.attributes=[],this.attributes.map={})}var b=/^[ \t\r\n]*$/,c={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};a.extend(e.prototype,{replace:function(a){var b=this;return a.parent&&a.remove(),b.insert(a,b),b.remove(),b},attr:function(a,b){var c=this,d,e,f;if(typeof a!="string"){for(e in a)c.attr(e,a[e]);return c}if(d=c.attributes){if(b!==f){if(b===null){if(a in d.map){delete d.map[a],e=d.length;while(e--)if(d[e].name===a)return d=d.splice(e,1),c}return c}if(a in d.map){e=d.length;while(e--)if(d[e].name===a){d[e].value=b;break}}else d.push({name:a,value:b});return d.map[a]=b,c}return d.map[a]}},clone:function(){var a=this,b=new e(a.name,a.type),c,d,f,g,h;if(f=a.attributes){h=[],h.map={};for(c=0,d=f.length;c<d;c++)g=f[c],g.name!=="id"&&(h[h.length]={name:g.name,value:g.value},h.map[g.name]=g.value);b.attributes=h}return b.value=a.value,b.shortEnded=a.shortEnded,b},wrap:function(a){var b=this;return b.parent.insert(a,b),a.append(b),b},unwrap:function(){var a=this,b,c;for(b=a.firstChild;b;)c=b.next,a.insert(b,a,!0),b=c;a.remove()},remove:function(){var a=this,b=a.parent,c=a.next,d=a.prev;return b&&(b.firstChild===a?(b.firstChild=c,c&&(c.prev=null)):d.next=c,b.lastChild===a?(b.lastChild=d,d&&(d.next=null)):c.prev=d,a.parent=a.next=a.prev=null),a},append:function(a){var b=this,c;return a.parent&&a.remove(),c=b.lastChild,c?(c.next=a,a.prev=c,b.lastChild=a):b.lastChild=b.firstChild=a,a.parent=b,a},insert:function(a,b,c){var d;return a.parent&&a.remove(),d=b.parent||this,c?(b===d.firstChild?d.firstChild=a:b.prev.next=a,a.prev=b.prev,a.next=b,b.prev=a):(b===d.lastChild?d.lastChild=a:b.next.prev=a,a.next=b.next,a.prev=b,b.next=a),a.parent=d,a},getAll:function(a){var b=this,c,e=[];for(c=b.firstChild;c;c=d(c,b))c.name===a&&e.push(c);return e},empty:function(){var a=this,b,c,e;if(a.firstChild){b=[];for(e=a.firstChild;e;e=d(e,a))b.push(e);c=b.length;while(c--)e=b[c],e.parent=e.firstChild=e.lastChild=e.next=e.prev=null}return a.firstChild=a.lastChild=null,a},isEmpty:function(a){var c=this,e=c.firstChild,f,g;if(e)do{if(e.type===1){if(e.attributes.map["data-mce-bogus"])continue;if(a[e.name])return!1;f=e.attributes.length;while(f--){g=e.attributes[f].name;if(g==="name"||g.indexOf("data-")===0)return!1}}if(e.type===8)return!1;if(e.type===3&&!b.test(e.value))return!1}while(e=d(e,c));return!0},walk:function(a){return d(this,null,a)}}),a.extend(e,{create:function(a,b){var d,f;d=new e(a,c[a]||1);if(b)for(f in b)d.attr(f,b[f]);return d}}),a.html.Node=e}(tinymce),function(a){var b=a.html.Node;a.html.DomParser=function(c,d){function j(c){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;q=a.makeMap("tr,td,th,tbody,thead,tfoot,table"),p=d.getNonEmptyElements();for(f=0;f<c.length;f++){g=c[f];if(!g.parent)continue;i=[g];for(h=g.parent;h&&!d.isValidChild(h.name,g.name)&&!q[h.name];h=h.parent)i.push(h);if(h&&i.length>1){i.reverse(),j=k=e.filterNode(i[0].clone());for(n=0;n<i.length-1;n++){d.isValidChild(k.name,i[n].name)?(l=e.filterNode(i[n].clone()),k.append(l)):l=k;for(m=i[n].firstChild;m&&m!=i[n+1];)s=m.next,l.append(m),m=s;k=l}j.isEmpty(p)?h.insert(g,i[0],!0):(h.insert(j,i[0],!0),h.insert(g,j)),h=i[0],(h.isEmpty(p)||h.firstChild===h.lastChild&&h.firstChild.name==="br")&&h.empty().remove()}else if(g.parent){if(g.name==="li"){r=g.prev;if(!r||r.name!=="ul"&&r.name!=="ul"){r=g.next;if(!r||r.name!=="ul"&&r.name!=="ul"){g.wrap(e.filterNode(new b("ul",1)));continue}r.insert(g,r.firstChild,!0);continue}r.append(g);continue}d.isValidChild(g.parent.name,"div")&&d.isValidChild("div",g.name)?g.wrap(e.filterNode(new b("div",1))):g.name==="style"||g.name==="script"?g.empty().remove():g.unwrap()}}}var e=this,f={},g=[],h={},i={};c=c||{},c.validate="validate"in c?c.validate:!0,c.root_name=c.root_name||"body",e.schema=d=d||new a.html.Schema,e.filterNode=function(a){var b,c,d;c in f&&(d=h[c],d?d.push(a):h[c]=[a]),b=g.length;while(b--)c=g[b].name,c in a.attributes.map&&(d=i[c],d?d.push(a):i[c]=[a]);return a},e.addNodeFilter=function(b,c){a.each(a.explode(b),function(a){var b=f[a];b||(f[a]=b=[]),b.push(c)})},e.addAttributeFilter=function(b,c){a.each(a.explode(b),function(a){var b;for(b=0;b<g.length;b++)if(g[b].name===a){g[b].callbacks.push(c);return}g.push({name:a,callbacks:[c]})})},e.parse=function(e,k){function H(){var a=m.firstChild,b,c;while(a)b=a.next,a.type==3||a.type==1&&a.name!=="p"&&!w[a.name]&&!a.attr("data-mce-type")?c?c.append(a):(c=I(G,1),m.insert(c,a),c.append(a)):c=null,a=b}function I(a,c){var d=new b(a,c),e;return a in f&&(e=h[a],e?e.push(d):h[a]=[d]),d}function J(a){var b,c,d;for(b=a.prev;b&&b.type===3;)c=b.value.replace(A,""),c.length>0?(b.value=c,b=b.prev):(d=b.prev,b.remove(),b=d)}var l,m,n,o,p,q,r,s,t,u,v,w,x,y=[],z,A,B,C,D,E,F,G;k=k||{},h={},i={},w=a.extend(a.makeMap("script,style,head,html,body,title,meta,param"),d.getBlockElements()),F=d.getNonEmptyElements(),E=d.children,v=c.validate,G="forced_root_block"in k?k.forced_root_block:c.forced_root_block,D=d.getWhiteSpaceElements(),x=/^[ \t\r\n]+/,A=/[ \t\r\n]+$/,B=/[ \t\r\n]+/g,C=/^[ \t\r\n]+$/,l=new a.html.SaxParser({validate:v,fix_self_closing:!v,cdata:function(a){n.append(I("#cdata",4)).value=a},text:function(a,b){var c;z||(a=a.replace(B," "),n.lastChild&&w[n.lastChild.name]&&(a=a.replace(x,""))),a.length!==0&&(c=I("#text",3),c.raw=!!b,n.append(c).value=a)},comment:function(a){n.append(I("#comment",8)).value=a},pi:function(a,b){n.append(I(a,7)).value=b,J(n)},doctype:function(a){var b;b=n.append(I("#doctype",10)),b.value=a,J(n)},start:function(a,b,c){var e,f,h,j,k,l,m,o;h=v?d.getElementRule(a):{};if(h){e=I(h.outputName||a,1),e.attributes=b,e.shortEnded=c,n.append(e),o=E[n.name],o&&E[e.name]&&!o[e.name]&&y.push(e),f=g.length;while(f--)k=g[f].name,k in b.map&&(t=i[k],t?t.push(e):i[k]=[e]);w[a]&&J(e),c||(n=e),!z&&D[a]&&(z=!0)}},end:function(a){var c,e,f,g,h;e=v?d.getElementRule(a):{};if(e){if(w[a]){if(!z){c=n.firstChild;if(c&&c.type===3){f=c.value.replace(x,""),f.length>0?(c.value=f,c=c.next):(g=c.next,c.remove(),c=g);while(c&&c.type===3){f=c.value,g=c.next;if(f.length===0||C.test(f))c.remove(),c=g;c=g}}c=n.lastChild;if(c&&c.type===3){f=c.value.replace(A,""),f.length>0?(c.value=f,c=c.prev):(g=c.prev,c.remove(),c=g);while(c&&c.type===3){f=c.value,g=c.prev;if(f.length===0||C.test(f))c.remove(),c=g;c=g}}}c=n.prev,c&&c.type===3&&(f=c.value.replace(x,""),f.length>0?c.value=f:c.remove())}z&&D[a]&&(z=!1);if(e.removeEmpty||e.paddEmpty)if(n.isEmpty(F))if(e.paddEmpty)n.empty().append(new b("#text","3")).value=" ";else if(!n.attributes.map.name){h=n.parent,n.empty().remove(),n=h;return}n=n.parent}}},d),m=n=new b(k.context||c.root_name,11),l.parse(e),v&&y.length&&(k.context?k.invalid=!0:j(y)),G&&m.name=="body"&&H();if(!k.invalid){for(u in h){t=f[u],o=h[u],r=o.length;while(r--)o[r].parent||o.splice(r,1);for(p=0,q=t.length;p<q;p++)t[p](o,u,k)}for(p=0,q=g.length;p<q;p++){t=g[p];if(t.name in i){o=i[t.name],r=o.length;while(r--)o[r].parent||o.splice(r,1);for(r=0,s=t.callbacks.length;r<s;r++)t.callbacks[r](o,t.name,k)}}}return m},c.remove_trailing_brs&&e.addNodeFilter("br",function(b,c){var e,f=b.length,g,h=a.extend({},d.getBlockElements()),i=d.getNonEmptyElements(),j,k,l,m;h.body=1;for(e=0;e<f;e++){g=b[e],j=g.parent;if(h[g.parent.name]&&g===j.lastChild){l=g.prev;while(l){m=l.name;if(m!=="span"||l.attr("data-mce-type")!=="bookmark"){if(m!=="br")break;if(m==="br"){g=null;break}}l=l.prev}g&&(g.remove(),j.isEmpty(i)&&(elementRule=d.getElementRule(j.name),elementRule&&(elementRule.removeEmpty?j.remove():elementRule.paddEmpty&&(j.empty().append(new a.html.Node("#text",3)).value=" "))))}else{k=g;while(j.firstChild===k&&j.lastChild===k){k=j;if(h[j.name])break;j=j.parent}k===j&&(textNode=new a.html.Node("#text",3),textNode.value=" ",g.replace(textNode))}}}),c.allow_html_in_named_anchor||e.addAttributeFilter("name",function(a,b){var c=a.length,d,e,f,g;while(c--){g=a[c];if(g.name==="a"&&g.firstChild){f=g.parent,d=g.lastChild;do e=d.prev,f.insert(d,g),d=e;while(d)}}})}}(tinymce),tinymce.html.Writer=function(a){var b=[],c,d,e,f,g;return a=a||{},c=a.indent,d=tinymce.makeMap(a.indent_before||""),e=tinymce.makeMap(a.indent_after||""),f=tinymce.html.Entities.getEncodeFunc(a.entity_encoding||"raw",a.entities),g=a.element_format=="html",{start:function(a,h,i){var j,k,l,m;c&&d[a]&&b.length>0&&(m=b[b.length-1],m.length>0&&m!=="\n"&&b.push("\n")),b.push("<",a);if(h)for(j=0,k=h.length;j<k;j++)l=h[j],b.push(" ",l.name,'="',f(l.value,!0),'"');!i||g?b[b.length]=">":b[b.length]=" />",i&&c&&e[a]&&b.length>0&&(m=b[b.length-1],m.length>0&&m!=="\n"&&b.push("\n"))},end:function(a){var d;b.push("</",a,">"),c&&e[a]&&b.length>0&&(d=b[b.length-1],d.length>0&&d!=="\n"&&b.push("\n"))},text:function(a,c){a.length>0&&(b[b.length]=c?a:f(a))},cdata:function(a){b.push("<![CDATA[",a,"]]>")},comment:function(a){b.push("<!--",a,"-->")},pi:function(a,d){d?b.push("<?",a," ",d,"?>"):b.push("<?",a,"?>"),c&&b.push("\n")},doctype:function(a){b.push("<!DOCTYPE",a,">",c?"\n":"")},reset:function(){b.length=0},getContent:function(){return b.join("").replace(/\n$/,"")}}},function(a){a.html.Serializer=function(b,c){var d=this,e=new a.html.Writer(b);b=b||{},b.validate="validate"in b?b.validate:!0,d.schema=c=c||new a.html.Schema,d.writer=e,d.serialize=function(a){function g(a){var b=d[a.type],h,i,j,k,l,m,n,o,p;if(!b){h=a.name,i=a.shortEnded,j=a.attributes;if(f&&j&&j.length>1){m=[],m.map={},p=c.getElementRule(a.name);for(n=0,o=p.attributesOrder.length;n<o;n++)k=p.attributesOrder[n],k in j.map&&(l=j.map[k],m.map[k]=l,m.push({name:k,value:l}));for(n=0,o=j.length;n<o;n++)k=j[n].name,k in m.map||(l=j.map[k],m.map[k]=l,m.push({name:k,value:l}));j=m}e.start(a.name,j,i);if(!i){if(a=a.firstChild)do g(a);while(a=a.next);e.end(h)}}else b(a)}var d,f;return f=b.validate,d={3:function(a,b){e.text(a.value,a.raw)},8:function(a){e.comment(a.value)},7:function(a){e.pi(a.name,a.value)},10:function(a){e.doctype(a.value)},4:function(a){e.cdata(a.value)},11:function(a){if(a=a.firstChild)do g(a);while(a=a.next)}},e.reset(),a.type==1&&!b.inner?g(a):d[11](a),e.getContent()}}}(tinymce),tinymce.dom={},function(a,b){function d(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&a.attachEvent("on"+b,c)}function e(a,b,c,d){a.removeEventListener?a.removeEventListener(b,c,d||!1):a.detachEvent&&a.detachEvent("on"+b,c)}function f(a,b){function e(){return!1}function f(){return!0}var c,d=b||{};for(c in a)c!=="layerX"&&c!=="layerY"&&(d[c]=a[c]);return d.target||(d.target=d.srcElement||document),d.preventDefault=function(){d.isDefaultPrevented=f,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},d.stopPropagation=function(){d.isPropagationStopped=f,a&&(a.stopPropagation?a.stopPropagation():a.cancelBubble=!0)},d.stopImmediatePropagation=function(){d.isImmediatePropagationStopped=f,d.stopPropagation()},d.isDefaultPrevented||(d.isDefaultPrevented=e,d.isPropagationStopped=e,d.isImmediatePropagationStopped=e),d}function g(a,b,f){function i(){f.domLoaded||(f.domLoaded=!0,b(h))}var g=a.document,h={type:"ready"};c?d(a,"DOMContentLoaded",i):(d(g,"readystatechange",function(){g.readyState==="complete"&&(e(g,"readystatechange",arguments.callee),i())}),g.documentElement.doScroll&&a===a.top&&function(){try{g.documentElement.doScroll("left")}catch(a){setTimeout(arguments.callee,0);return}i()}()),d(a,"load",i)}function h(a){function o(a,b){var c,d,e,f;c=i[b][a.type];if(c)for(d=0,e=c.length;d<e;d++){f=c[d],f&&f.func.call(f.scope,a)===!1&&a.preventDefault();if(a.isImmediatePropagationStopped())return}}var h=this,i={},j,k,l,m,n;m="onmouseenter"in document.documentElement,l="onfocusin"in document.documentElement,n={mouseenter:"mouseover",mouseleave:"mouseout"},j=1,h.domLoaded=!1,h.events=i,h.bind=function(e,k,p,q){function z(a){o(f(a||y.event),r)}var r,s,t,u,v,w,x,y=window;if(!e||e.nodeType===3||e.nodeType===8)return;e[b]?(r=e[b],i[r]||(i[r]={})):(r=j++,e[b]=r,i[r]={}),q=q||e,k=k.split(" "),t=k.length;while(t--){u=k[t],w=z,v=x=!1,u==="DOMContentLoaded"&&(u="ready");if(!h.domLoaded&&e.readyState!="complete"||u!=="ready")m||(v=n[u],v&&(w=function(a){var b,c;b=a.currentTarget,c=a.relatedTarget;if(c&&b.contains)c=b.contains(c);else while(c&&c!==b)c=c.parentNode;c||(a=f(a||y.event),a.type=a.type==="mouseout"?"mouseleave":"mouseenter",a.target=b,o(a,r))})),!l&&(u==="focusin"||u==="focusout")&&(x=!0,v=u==="focusin"?"focus":"blur",w=function(a){a=f(a||y.event),a.type=a.type==="focus"?"focusin":"focusout",o(a,r)}),s=i[r][u],s?s.push({func:p,scope:q}):(i[r][u]=s=[{func:p,scope:q}],s.fakeName=v,s.capture=x,s.nativeHandler=w,c||(s.proxyHandler=a(r)),u==="ready"?g(e,w,h):d(e,v||u,c?w:s.proxyHandler,x));else{h.domLoaded=!0,p.call(q,f({type:u}));continue}}return e=s=0,p},h.unbind=function(a,d,f){var g,j,k,l,m,n;if(!a||a.nodeType===3||a.nodeType===8)return h;g=a[b];if(g){n=i[g];if(d){d=d.split(" "),k=d.length;while(k--){m=d[k],j=n[m];if(j){if(f){l=j.length;while(l--)j[l].func===f&&j.splice(l,1)}if(!f||j.length===0)delete n[m],e(a,j.fakeName||m,c?j.nativeHandler:j.proxyHandler,j.capture)}}}else{for(m in n)j=n[m],e(a,j.fakeName||m,c?j.nativeHandler:j.proxyHandler,j.capture);n={}}for(m in n)return h;delete i[g];try{delete a[b]}catch(o){a[b]=null}}return h},h.fire=function(a,c,d){var e,g;if(!a||a.nodeType===3||a.nodeType===8)return h;g=f(null,d),g.type=c;do e=a[b],e&&o(g,e),a=a.parentNode||a.ownerDocument||a.defaultView||a.parentWindow;while(a&&!g.isPropagationStopped());return h},h.clean=function(a){var c,d,e=h.unbind;if(!a||a.nodeType===3||a.nodeType===8)return h;a[b]&&e(a),a.getElementsByTagName||(a=a.document);if(a&&a.getElementsByTagName){e(a),d=a.getElementsByTagName("*"),c=d.length;while(c--)a=d[c],a[b]&&e(a)}return h},h.callNativeHandler=function(a,b){i&&i[a][b.type].nativeHandler(b)},h.destory=function(){i={}},h.add=function(a,b,c,d){typeof a=="string"&&(a=document.getElementById(a));if(a&&a instanceof Array){var e=a;while(e--)h.add(a[e],b,c,d);return}return b==="init"&&(b="ready"),h.bind(a,b instanceof Array?b.join(" "):b,c,d)},h.remove=function(a,b,c,d){if(!a)return h;typeof a=="string"&&(a=document.getElementById(a));if(a instanceof Array){var e=a.length;while(e--)h.remove(a[e],b,c,d);return h}return h.unbind(a,b instanceof Array?b.join(" "):b,c)},h.clear=function(a){return typeof a=="string"&&(a=document.getElementById(a)),h.clean(a)},h.cancel=function(a){return a&&(h.prevent(a),h.stop(a)),!1},h.prevent=function(a){return a.preventDefault(),!1},h.stop=function(a){return a.stopPropagation(),!1}}var c=!!document.addEventListener;a.EventUtils=h,a.Event=new h(function(a){return function(b){tinymce.dom.Event.callNativeHandler(a,b)}}),a.Event.bind(window,"ready",function(){}),a=0}(tinymce.dom,"data-mce-expando"),tinymce.dom.TreeWalker=function(a,b){function d(a,c,d,e){var f,g;if(a){if(!e&&a[c])return a[c];if(a!=b){f=a[d];if(f)return f;for(g=a.parentNode;g&&g!=b;g=g.parentNode){f=g[d];if(f)return f}}}}var c=a;this.current=function(){return c},this.next=function(a){return c=d(c,"firstChild","nextSibling",a)},this.prev=function(a){return c=d(c,"lastChild","previousSibling",a)}},function(a){var b=a.each,c=a.is,d=a.isWebKit,e=a.isIE,f=a.html.Entities,g=/^([a-z0-9],?)+$/i,h=/^[ \t\r\n]*$/;a.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(b,c){var d=this,e,f,g;d.doc=b,d.win=window,d.files={},d.cssFlicker=!1,d.counter=0,d.stdMode=!a.isIE||b.documentMode>=8,d.boxModel=!a.isIE||b.compatMode=="CSS1Compat"||d.stdMode,d.hasOuterHTML="outerHTML"in b.createElement("a"),d.settings=c=a.extend({keep_values:!1,hex_colors:1},c),d.schema=c.schema,d.styles=new a.html.Styles({url_converter:c.url_converter,url_converter_scope:c.url_converter_scope},c.schema);if(a.isIE6)try{b.execCommand("BackgroundImageCache",!1,!0)}catch(h){d.cssFlicker=!0}d.fixDoc(b),d.events=c.ownEvents?new a.dom.EventUtils(c.proxy):a.dom.Event,a.addUnload(d.destroy,d),g=c.schema?c.schema.getBlockElements():{},d.isBlock=function(a){var b=a.nodeType;return b?b===1&&!!g[a.nodeName]:!!g[a]}},fixDoc:function(a){var b=this.settings,c;if(e&&b.schema){"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(b){a.createElement(b)});for(c in b.schema.getCustomElements())a.createElement(c)}},clone:function(a,c){var d=this,f,g;return!e||a.nodeType!==1||c?a.cloneNode(c):(g=d.doc,c?f.firstChild:(f=g.createElement(a.nodeName),b(d.getAttribs(a),function(b){d.setAttrib(f,b.nodeName,d.getAttrib(a,b.nodeName))}),f))},getRoot:function(){var a=this,b=a.settings;return b&&a.get(b.root_element)||a.doc.body},getViewPort:function(a){var b,c;return a=a?a:this.win,b=a.document,c=this.boxModel?b.documentElement:b.body,{x:a.pageXOffset||c.scrollLeft,y:a.pageYOffset||c.scrollTop,w:a.innerWidth||c.clientWidth,h:a.innerHeight||c.clientHeight}},getRect:function(a){var b,c=this,d;return a=c.get(a),b=c.getPos(a),d=c.getSize(a),{x:b.x,y:b.y,w:d.w,h:d.h}},getSize:function(a){var b=this,c,d;return a=b.get(a),c=b.getStyle(a,"width"),d=b.getStyle(a,"height"),c.indexOf("px")===-1&&(c=0),d.indexOf("px")===-1&&(d=0),{w:parseInt(c,10)||a.offsetWidth||a.clientWidth,h:parseInt(d,10)||a.offsetHeight||a.clientHeight}},getParent:function(a,b,c){return this.getParents(a,b,c,!1)},getParents:function(a,b,d,e){var f=this,g,h=f.settings,i=[];a=f.get(a),e=e===undefined,h.strict_root&&(d=d||f.getRoot()),c(b,"string")&&(g=b,b==="*"?b=function(a){return a.nodeType==1}:b=function(a){return f.is(a,g)});while(a){if(a==d||!a.nodeType||a.nodeType===9)break;if(!b||b(a))if(e)i.push(a);else return a;a=a.parentNode}return e?i:null},get:function(a){var b;if(a&&this.doc&&typeof a=="string"){b=a,a=this.doc.getElementById(a);if(a&&a.id!==b)return this.doc.getElementsByName(b)[1]}return a},getNext:function(a,b){return this._findSib(a,b,"nextSibling")},getPrev:function(a,b){return this._findSib(a,b,"previousSibling")},select:function(b,c){var d=this;return a.dom.Sizzle(b,d.get(c)||d.get(d.settings.root_element)||d.doc,[])},is:function(b,c){var d;if(b.length===undefined){if(c==="*")return b.nodeType==1;if(g.test(c)){c=c.toLowerCase().split(/,/),b=b.nodeName.toLowerCase();for(d=c.length-1;d>=0;d--)if(c[d]==b)return!0;return!1}}return a.dom.Sizzle.matches(c,b.nodeType?[b]:b).length>0},add:function(a,b,d,e,f){var g=this;return this.run(a,function(a){var h,i;return h=c(b,"string")?g.doc.createElement(b):b,g.setAttribs(h,d),e&&(e.nodeType?h.appendChild(e):g.setHTML(h,e)),f?h:a.appendChild(h)})},create:function(a,b,c){return this.add(this.doc.createElement(a),a,b,c,1)},createHTML:function(a,b,c){var d="",e=this,f;d+="<"+a;for(f in b)b.hasOwnProperty(f)&&(d+=" "+f+'="'+e.encode(b[f])+'"');return typeof c!="undefined"?d+">"+c+"</"+a+">":d+" />"},remove:function(b,c){return this.run(b,function(b){var d,e=b.parentNode;if(!e)return null;if(c)while(d=b.firstChild)!a.isIE||d.nodeType!==3||d.nodeValue?e.insertBefore(d,b):b.removeChild(d);return e.removeChild(b)})},setStyle:function(b,c,d){var f=this;return f.run(b,function(g){var h,i;h=g.style,c=c.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),f.pixelStyles.test(c)&&(a.is(d,"number")||/^[\-0-9\.]+$/.test(d))&&(d+="px");switch(c){case"opacity":if(e){h.filter=d===""?"":"alpha(opacity="+d*100+")";if(!b.currentStyle||!b.currentStyle.hasLayout)h.display="inline-block"}h[c]=h["-moz-opacity"]=h["-khtml-opacity"]=d||"";break;case"float":e?h.styleFloat=d:h.cssFloat=d;break;default:h[c]=d||""}f.settings.update_styles&&f.setAttrib(g,"data-mce-style")})},getStyle:function(a,b,c){a=this.get(a);if(!a)return;if(this.doc.defaultView&&c){b=b.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(a,null).getPropertyValue(b)}catch(d){return null}}return b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()}),b=="float"&&(b=e?"styleFloat":"cssFloat"),a.currentStyle&&c?a.currentStyle[b]:a.style?a.style[b]:undefined},setStyles:function(a,c){var d=this,e=d.settings,f;f=e.update_styles,e.update_styles=0,b(c,function(b,c){d.setStyle(a,c,b)}),e.update_styles=f,e.update_styles&&d.setAttrib(a,e.cssText)},removeAllAttribs:function(a){return this.run(a,function(a){var b,c=a.attributes;for(b=c.length-1;b>=0;b--)a.removeAttributeNode(c.item(b))})},setAttrib:function(a,d,e){var f=this;if(!a||!d)return;return f.settings.strict&&(d=d.toLowerCase()),this.run(a,function(a){var g=f.settings,h=a.getAttribute(d);if(e!==null)switch(d){case"style":if(!c(e,"string")){b(e,function(b,c){f.setStyle(a,c,b)});return}g.keep_values&&(e&&!f._isRes(e)?a.setAttribute("data-mce-style",e,2):a.removeAttribute("data-mce-style",2)),a.style.cssText=e;break;case"class":a.className=e||"";break;case"src":case"href":g.keep_values&&(g.url_converter&&(e=g.url_converter.call(g.url_converter_scope||f,e,d,a)),f.setAttrib(a,"data-mce-"+d,e,2));break;case"shape":a.setAttribute("data-mce-style",e)}c(e)&&e!==null&&e.length!==0?a.setAttribute(d,""+e,2):a.removeAttribute(d,2);if(tinyMCE.activeEditor&&h!=e){var i=tinyMCE.activeEditor;i.onSetAttrib.dispatch(i,a,d,e)}})},setAttribs:function(a,c){var d=this;return this.run(a,function(a){b(c,function(b,c){d.setAttrib(a,c,b)})})},getAttrib:function(b,f,g){var h,i=this,j;b=i.get(b);if(!b||b.nodeType!==1)return g===j?!1:g;c(g)||(g="");if(/^(src|href|style|coords|shape)$/.test(f)){h=b.getAttribute("data-mce-"+f);if(h)return h}e&&i.props[f]&&(h=b[i.props[f]],h=h&&h.nodeValue?h.nodeValue:h),h||(h=b.getAttribute(f,2));if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(f))return b[i.props[f]]===!0&&h===""?f:h?f:"";if(b.nodeName==="FORM"&&b.getAttributeNode(f))return b.getAttributeNode(f).nodeValue;f==="style"&&(h=h||b.style.cssText,h&&(h=i.serializeStyle(i.parseStyle(h),b.nodeName),i.settings.keep_values&&!i._isRes(h)&&b.setAttribute("data-mce-style",h))),d&&f==="class"&&h&&(h=h.replace(/(apple|webkit)\-[a-z\-]+/gi,""));if(e)switch(f){case"rowspan":case"colspan":h===1&&(h="");break;case"size":if(h==="+0"||h===20||h===0)h="";break;case"width":case"height":case"vspace":case"checked":case"disabled":case"readonly":h===0&&(h="");break;case"hspace":h===-1&&(h="");break;case"maxlength":case"tabindex":if(h===32768||h===2147483647||h==="32768")h="";break;case"multiple":case"compact":case"noshade":case"nowrap":if(h===65535)return f;return g;case"shape":h=h.toLowerCase();break;default:f.indexOf("on")===0&&h&&(h=a._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+h))}return h!==j&&h!==null&&h!==""?""+h:g},getPos:function(a,b){var c=this,d=0,e=0,f,g=c.doc,h;a=c.get(a),b=b||g.body;if(a){if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),f=c.boxModel?g.documentElement:g.body,d=a.left+(g.documentElement.scrollLeft||g.body.scrollLeft)-f.clientTop,e=a.top+(g.documentElement.scrollTop||g.body.scrollTop)-f.clientLeft,{x:d,y:e};h=a;while(h&&h!=b&&h.nodeType)d+=h.offsetLeft||0,e+=h.offsetTop||0,h=h.offsetParent;h=a.parentNode;while(h&&h!=b&&h.nodeType)d-=h.scrollLeft||0,e-=h.scrollTop||0,h=h.parentNode}return{x:d,y:e}},parseStyle:function(a){return this.styles.parse(a)},serializeStyle:function(a,b){return this.styles.serialize(a,b)},loadCSS:function(c){var d=this,f=d.doc,g;c||(c=""),g=f.getElementsByTagName("head")[0],b(c.split(","),function(b){var c;if(d.files[b])return;d.files[b]=!0,c=d.create("link",{rel:"stylesheet",href:a._addVer(b)}),e&&f.documentMode&&f.recalc&&(c.onload=function(){f.recalc&&f.recalc(),c.onload=null}),g.appendChild(c)})},addClass:function(a,b){return this.run(a,function(a){var c;return b?this.hasClass(a,b)?a.className:(c=this.removeClass(a,b),a.className=(c!=""?c+" ":"")+b):0})},removeClass:function(b,c){var d=this,e;return d.run(b,function(b){var f;return d.hasClass(b,c)?(e||(e=new RegExp("(^|\\s+)"+c+"(\\s+|$)","g")),f=b.className.replace(e," "),f=a.trim(f!=" "?f:""),b.className=f,f||(b.removeAttribute("class"),b.removeAttribute("className")),f):b.className})},hasClass:function(a,b){return a=this.get(a),!a||!b?!1:(" "+a.className+" ").indexOf(" "+b+" ")!==-1},show:function(a){return this.setStyle(a,"display","block")},hide:function(a){return this.setStyle(a,"display","none")},isHidden:function(a){return a=this.get(a),!a||a.style.display=="none"||this.getStyle(a,"display")=="none"},uniqueId:function(a){return(a?a:"mce_")+this.counter++},setHTML:function(a,c){var d=this;return d.run(a,function(a){if(e){while(a.firstChild)a.removeChild(a.firstChild);try{a.innerHTML="<br />"+c,a.removeChild(a.firstChild)}catch(f){a=d.create("div"),a.innerHTML="<br />"+c,b(a.childNodes,function(b,c){c&&a.appendChild(b)})}}else a.innerHTML=c;return c})},getOuterHTML:function(a){var b,c=this;return a=c.get(a),a?a.nodeType===1&&c.hasOuterHTML?a.outerHTML:(b=(a.ownerDocument||c.doc).createElement("body"),b.appendChild(a.cloneNode(!0)),b.innerHTML):null},setOuterHTML:function(a,b,c){function f(a,b,c){var e,f;f=c.createElement("body"),f.innerHTML=b,e=f.lastChild;while(e)d.insertAfter(e.cloneNode(!0),a),e=e.previousSibling;d.remove(a)}var d=this;return this.run(a,function(a){a=d.get(a);if(a.nodeType==1){c=c||a.ownerDocument||d.doc;if(e)try{e&&a.nodeType==1?a.outerHTML=b:f(a,b,c)}catch(g){f(a,b,c)}else f(a,b,c)}})},decode:f.decode,encode:f.encodeAllRaw,insertAfter:function(a,b){return b=this.get(b),this.run(a,function(a){var c,d;return c=b.parentNode,d=b.nextSibling,d?c.insertBefore(a,d):c.appendChild(a),a})},replace:function(d,e,f){var g=this;return c(e,"array")&&(d=d.cloneNode(!0)),g.run(e,function(c){return f&&b(a.grep(c.childNodes),function(a){d.appendChild(a)}),c.parentNode.replaceChild(d,c)})},rename:function(a,c){var d=this,e;return a.nodeName!=c.toUpperCase()&&(e=d.create(c),b(d.getAttribs(a),function(b){d.setAttrib(e,b.nodeName,d.getAttrib(a,b.nodeName))}),d.replace(e,a,1)),e||a},findCommonAncestor:function(a,b){var c=a,d;while(c){d=b;while(d&&c!=d)d=d.parentNode;if(c==d)break;c=c.parentNode}return!c&&a.ownerDocument?a.ownerDocument.documentElement:c},toHex:function(a){function c(a){return a=parseInt(a,10).toString(16),a.length>1?a:"0"+a}var b=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(a);return b?(a="#"+c(b[1])+c(b[2])+c(b[3]),a):a},getClasses:function(){function i(c){b(c.imports,function(a){i(a)}),b(c.cssRules||c.rules,function(c){switch(c.type||1){case 1:c.selectorText&&b(c.selectorText.split(","),function(b){b=b.replace(/^\s*|\s*$|^\s\./g,"");if(/\.mce/.test(b)||!/\.[\w\-]+$/.test(b))return;h=b,b=a._replace(/.*\.([a-z0-9_\-]+).*/i,"$1",b);if(g&&!(b=g(b,h)))return;f[b]||(d.push({"class":b}),f[b]=1)});break;case 3:i(c.styleSheet)}})}var c=this,d=[],e,f={},g=c.settings.class_filter,h;if(c.classes)return c.classes;try{b(c.doc.styleSheets,i)}catch(j){}return d.length>0&&(c.classes=d),d},run:function(a,c,d){var e=this,f;return e.doc&&typeof a=="string"&&(a=e.get(a)),a?(d=d||this,!a.nodeType&&(a.length||a.length===0)?(f=[],b(a,function(a,b){a&&(typeof a=="string"&&(a=e.doc.getElementById(a)),f.push(c.call(d,a,b)))}),f):c.call(d,a)):!1},getAttribs:function(a){var b;return a=this.get(a),a?e?(b=[],a.nodeName=="OBJECT"?a.attributes:(a.nodeName==="OPTION"&&this.getAttrib(a,"selected")&&b.push({specified:1,nodeName:"selected"}),a.cloneNode(!1).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(a){b.push({specified:1,nodeName:a})}),b)):a.attributes:[]},isEmpty:function(b,c){var d=this,e,f,g,i,j,k=0;b=b.firstChild;if(b){i=new a.dom.TreeWalker(b,b.parentNode),c=c||d.schema?d.schema.getNonEmptyElements():null;do{g=b.nodeType;if(g===1){if(b.getAttribute("data-mce-bogus"))continue;j=b.nodeName.toLowerCase();if(c&&c[j]){if(j==="br"){k++;continue}return!1}f=d.getAttribs(b),e=b.attributes.length;while(e--){j=b.attributes[e].nodeName;if(j==="name"||j==="data-mce-bookmark")return!1}}if(g==8)return!1;if(g===3&&!h.test(b.nodeValue))return!1}while(b=i.next())}return k<=1},destroy:function(b){var c=this;c.win=c.doc=c.root=c.events=c.frag=null,b||a.removeUnload(c.destroy)},createRng:function(){var b=this.doc;return b.createRange?b.createRange():new a.dom.Range(this)},nodeIndex:function(a,b){var c=0,d,e,f;if(a)for(d=a.nodeType,a=a.previousSibling,e=a;a;a=a.previousSibling){f=a.nodeType;if(b&&f==3)if(f==d||!a.nodeValue.length)continue;c++,d=f}return c},split:function(b,c,d){function j(b){function g(a){var b=a.previousSibling&&a.previousSibling.nodeName=="SPAN",c=a.nextSibling&&a.nextSibling.nodeName=="SPAN";return b&&c}var c,d=b.childNodes,f=b.nodeType;if(f==1&&b.getAttribute("data-mce-type")=="bookmark")return;for(c=d.length-1;c>=0;c--)j(d[c]);if(f!=9){if(f==3&&b.nodeValue.length>0){var h=a.trim(b.nodeValue).length;if(!e.isBlock(b.parentNode)||h>0||h===0&&g(b))return}else if(f==1){d=b.childNodes,d.length==1&&d[0]&&d[0].nodeType==1&&d[0].getAttribute("data-mce-type")=="bookmark"&&b.parentNode.insertBefore(d[0],b);if(d.length||/^(br|hr|input|img)$/i.test(b.nodeName))return}e.remove(b)}return b}var e=this,f=e.createRng(),g,h,i;if(b&&c)return f.setStart(b.parentNode,e.nodeIndex(b)),f.setEnd(c.parentNode,e.nodeIndex(c)),g=f.extractContents(),f=e.createRng(),f.setStart(c.parentNode,e.nodeIndex(c)+1),f.setEnd(b.parentNode,e.nodeIndex(b)+1),h=f.extractContents(),i=b.parentNode,i.insertBefore(j(g),b),d?i.replaceChild(d,c):i.insertBefore(c,b),i.insertBefore(j(h),b),e.remove(b),d||c},bind:function(a,b,c,d){return this.events.add(a,b,c,d||this)},unbind:function(a,b,c){return this.events.remove(a,b,c)},fire:function(a,b,c){return this.events.fire(a,b,c)},getContentEditable:function(a){var b;return a.nodeType!=1?null:(b=a.getAttribute("data-mce-contenteditable"),b&&b!=="inherit"?b:a.contentEditable!=="inherit"?a.contentEditable:null)},_findSib:function(a,b,d){var e=this,f=b;if(a){c(f,"string")&&(f=function(a){return e.is(a,b)});for(a=a[d];a;a=a[d])if(f(a))return a}return null},_isRes:function(a){return/^(top|left|bottom|right|width|height)/i.test(a)||/;\s*(top|left|bottom|right|width|height)/i.test(a)}}),a.DOM=new a.dom.DOMUtils(document,{process_html:0})}(tinymce),function(a){function b(a){function p(){return d.createDocumentFragment()}function q(a,b){J(h,a,b)}function r(a,b){J(i,a,b)}function s(a){q(a.parentNode,o(a))}function t(a){q(a.parentNode,o(a)+1)}function u(a){r(a.parentNode,o(a))}function v(a){r(a.parentNode,o(a)+1)}function w(a){a?(c[l]=c[k],c[m]=c[j]):(c[k]=c[l],c[j]=c[m]),c.collapsed=h}function x(a){s(a),v(a)}function y(a){q(a,0),r(a,a.nodeType===1?a.childNodes.length:a.nodeValue.length)}function z(a,b){var d=c[k],e=c[j],f=c[l],g=c[m],h=b.startContainer,i=b.startOffset,n=b.endContainer,o=b.endOffset;if(a===0)return I(d,e,h,i);if(a===1)return I(f,g,h,i);if(a===2)return I(f,g,n,o);if(a===3)return I(d,e,n,o)}function A(){K(g)}function B(){return K(e)}function C(){return K(f)}function D(b){var c=this[k],d=this[j],e,f;c.nodeType!==3&&c.nodeType!==4||!c.nodeValue?(c.childNodes.length>0&&(f=c.childNodes[d]),f?c.insertBefore(b,f):c.appendChild(b)):d?d>=c.nodeValue.length?a.insertAfter(b,c):(e=c.splitText(d),c.parentNode.insertBefore(b,e)):c.parentNode.insertBefore(b,c)}function E(a){var b=c.extractContents();c.insertNode(a),a.appendChild(b),c.selectNode(a)}function F(){return n(new b(a),{startContainer:c[k],startOffset:c[j],endContainer:c[l],endOffset:c[m],collapsed:c.collapsed,commonAncestorContainer:c.commonAncestorContainer})}function G(a,b){var c;if(a.nodeType==3)return a;if(b<0)return a;c=a.firstChild;while(c&&b>0)--b,c=c.nextSibling;return c?c:a}function H(){return c[k]==c[l]&&c[j]==c[m]}function I(b,c,d,e){var f,g,h,i,j,k;if(b==d)return c==e?0:c<e?-1:1;f=d;while(f&&f.parentNode!=b)f=f.parentNode;if(f){g=0,h=b.firstChild;while(h!=f&&g<c)g++,h=h.nextSibling;return c<=g?-1:1}f=b;while(f&&f.parentNode!=d)f=f.parentNode;if(f){g=0,h=d.firstChild;while(h!=f&&g<e)g++,h=h.nextSibling;return g<e?-1:1}i=a.findCommonAncestor(b,d),j=b;while(j&&j.parentNode!=i)j=j.parentNode;j||(j=i),k=d;while(k&&k.parentNode!=i)k=k.parentNode;k||(k=i);if(j==k)return 0;h=i.firstChild;while(h){if(h==j)return-1;if(h==k)return 1;h=h.nextSibling}}function J(b,d,e){var f,g;b?(c[k]=d,c[j]=e):(c[l]=d,c[m]=e),f=c[l];while(f.parentNode)f=f.parentNode;g=c[k];while(g.parentNode)g=g.parentNode;g==f?I(c[k],c[j],c[l],c[m])>0&&c.collapse(b):c.collapse(b),c.collapsed=H(),c.commonAncestorContainer=a.findCommonAncestor(c[k],c[l])}function K(a){var b,d=0,e=0,f,g,h,i,j,m;if(c[k]==c[l])return L(a);for(b=c[l],f=b.parentNode;f;b=f,f=f.parentNode){if(f==c[k])return M(b,a);++d}for(b=c[k],f=b.parentNode;f;b=f,f=f.parentNode){if(f==c[l])return N(b,a);++e}g=e-d,h=c[k];while(g>0)h=h.parentNode,g--;i=c[l];while(g<0)i=i.parentNode,g++;for(j=h.parentNode,m=i.parentNode;j!=m;j=j.parentNode,m=m.parentNode)h=j,i=m;return O(h,i,a)}function L(a){var b,e,i,l,n,o,q,r,s;a!=g&&(b=p());if(c[j]==c[m])return b;if(c[k].nodeType==3){e=c[k].nodeValue,i=e.substring(c[j],c[m]),a!=f&&(l=c[k],r=c[j],s=c[m]-c[j],r===0&&s>=l.nodeValue.length-1?l.parentNode.removeChild(l):l.deleteData(r,s),c.collapse(h));if(a==g)return;return i.length>0&&b.appendChild(d.createTextNode(i)),b}l=G(c[k],c[j]),n=c[m]-c[j];while(l&&n>0)o=l.nextSibling,q=S(l,a),b&&b.appendChild(q),--n,l=o;return a!=f&&c.collapse(h),b}function M(a,b){var d,e,h,k,l,m;b!=g&&(d=p()),e=P(a,b),d&&d.appendChild(e),h=o(a),k=h-c[j];if(k<=0)return b!=f&&(c.setEndBefore(a),c.collapse(i)),d;e=a.previousSibling;while(k>0)l=e.previousSibling,m=S(e,b),d&&d.insertBefore(m,d.firstChild),--k,e=l;return b!=f&&(c.setEndBefore(a),c.collapse(i)),d}function N(a,b){var d,e,i,j,k,l;b!=g&&(d=p()),i=Q(a,b),d&&d.appendChild(i),e=o(a),++e,j=c[m]-e,i=a.nextSibling;while(i&&j>0)k=i.nextSibling,l=S(i,b),d&&d.appendChild(l),--j,i=k;return b!=f&&(c.setStartAfter(a),c.collapse(h)),d}function O(a,b,d){var e,i,j,k,l,m,n,q;d!=g&&(i=p()),e=Q(a,d),i&&i.appendChild(e),j=a.parentNode,k=o(a),l=o(b),++k,m=l-k,n=a.nextSibling;while(m>0)q=n.nextSibling,e=S(n,d),i&&i.appendChild(e),n=q,--m;return e=P(b,d),i&&i.appendChild(e),d!=f&&(c.setStartAfter(a),c.collapse(h)),i}function P(a,b){var d=G(c[l],c[m]-1),e,f,j,k,n,o=d!=c[l];if(d==a)return R(d,o,i,b);e=d.parentNode,f=R(e,i,i,b);while(e){while(d)j=d.previousSibling,k=R(d,o,i,b),b!=g&&f.insertBefore(k,f.firstChild),o=h,d=j;if(e==a)return f;d=e.previousSibling,e=e.parentNode,n=R(e,i,i,b),b!=g&&n.appendChild(f),f=n}}function Q(a,b){var d=G(c[k],c[j]),e=d!=c[k],f,l,m,n,o;if(d==a)return R(d,e,h,b);f=d.parentNode,l=R(f,i,h,b);while(f){while(d)m=d.nextSibling,n=R(d,e,h,b),b!=g&&l.appendChild(n),e=h,d=m;if(f==a)return l;d=f.nextSibling,f=f.parentNode,o=R(f,i,h,b),b!=g&&o.appendChild(l),l=o}}function R(b,d,e,h){var k,l,n,o,p;if(d)return S(b,h);if(b.nodeType==3){k=b.nodeValue,e?(o=c[j],l=k.substring(o),n=k.substring(0,o)):(o=c[m],l=k.substring(0,o),n=k.substring(o)),h!=f&&(b.nodeValue=n);if(h==g)return;return p=a.clone(b,i),p.nodeValue=l,p}if(h==g)return;return a.clone(b,i)}function S(b,c){if(c!=g)return c==f?a.clone(b,h):b;b.parentNode.removeChild(b)}var c=this,d=a.doc,e=0,f=1,g=2,h=!0,i=!1,j="startOffset",k="startContainer",l="endContainer",m="endOffset",n=tinymce.extend,o=a.nodeIndex;n(c,{startContainer:d,startOffset:0,endContainer:d,endOffset:0,collapsed:h,commonAncestorContainer:d,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:q,setEnd:r,setStartBefore:s,setStartAfter:t,setEndBefore:u,setEndAfter:v,collapse:w,selectNode:x,selectNodeContents:y,compareBoundaryPoints:z,deleteContents:A,extractContents:B,cloneContents:C,insertNode:D,surroundContents:E,cloneRange:F})}a.Range=b}(tinymce.dom),function(){function a(a){function f(b,c){var d,e=0,f,g,h,i,j,k,l=-1,m;d=b.duplicate(),d.collapse(c),m=d.parentElement();if(m.ownerDocument!==a.dom.doc)return;while(m.contentEditable==="false")m=m.parentNode;if(!m.hasChildNodes())return{node:m,inside:1};h=m.children,f=h.length-1;while(e<=f){k=Math.floor((e+f)/2),i=h[k],d.moveToElementText(i),l=d.compareEndPoints(c?"StartToStart":"EndToEnd",b);if(l>0)f=k-1;else if(l<0)e=k+1;else return{node:i}}if(l<0){i?d.collapse(!1):(d.moveToElementText(m),d.collapse(!0),i=m,g=!0),j=0;while(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)!==0){if(d.move("character",1)===0||m!=d.parentElement())break;j++}}else{d.collapse(!0),j=0;while(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)!==0){if(d.move("character",-1)===0||m!=d.parentElement())break;j++}}return{node:i,position:l,offset:j,inside:g}}function g(){function m(a){var b=f(d,a),c,g,h=0,i,j,k;c=b.node,g=b.offset;if(b.inside&&!c.hasChildNodes()){e[a?"setStart":"setEnd"](c,0);return}if(g===j){e[a?"setStartBefore":"setEndAfter"](c);return}if(b.position<0){i=b.inside?c.firstChild:c.nextSibling;if(!i){e[a?"setStartAfter":"setEndAfter"](c);return}if(!g){i.nodeType==3?e[a?"setStart":"setEnd"](i,0):e[a?"setStartBefore":"setEndBefore"](i);return}while(i){k=i.nodeValue,h+=k.length;if(h>=g){c=i,h-=g,h=k.length-h;break}i=i.nextSibling}}else{i=c.previousSibling;if(!i)return e[a?"setStartBefore":"setEndBefore"](c);if(!g){c.nodeType==3?e[a?"setStart":"setEnd"](i,c.nodeValue.length):e[a?"setStartAfter":"setEndAfter"](i);return}while(i){h+=i.nodeValue.length;if(h>=g){c=i,h-=g;break}i=i.previousSibling}}e[a?"setStart":"setEnd"](c,h)}var d=a.getRng(),e=c.createRng(),g,h,i,j,k,l;g=d.item?d.item(0):d.parentElement();if(g.ownerDocument!=c.doc)return e;h=a.isCollapsed();if(d.item)return e.setStart(g.parentNode,c.nodeIndex(g)),e.setEnd(e.startContainer,e.startOffset+1),e;try{m(!0),h||m()}catch(n){if(n.number==-2147024809)k=b.getBookmark(2),i=d.duplicate(),i.collapse(!0),g=i.parentElement(),h||(i=d.duplicate(),i.collapse(!1),j=i.parentElement(),j.innerHTML=j.innerHTML),g.innerHTML=g.innerHTML,b.moveToBookmark(k),d=a.getRng(),m(!0),h||m();else throw n}return e}var b=this,c=a.dom,d=!0,e=!1;this.getBookmark=function(b){function i(a){var b,d,e,f,g=[];b=a.parentNode,d=c.getRoot().parentNode;while(b!=d&&b.nodeType!==9){e=b.children,f=e.length;while(f--)if(a===e[f]){g.push(f);break}a=b,b=b.parentNode}return g}function j(a){var b;b=f(d,a);if(b)return{position:b.position,offset:b.offset,indexes:i(b.node),inside:b.inside}}var d=a.getRng(),e,g,h={};return b===2&&(d.item?h.start={ctrl:!0,indexes:i(d.item(0))}:(h.start=j(!0),a.isCollapsed()||(h.end=j()))),h},this.moveToBookmark=function(a){function e(a){var b,d,e,f;b=c.getRoot();for(d=a.length-1;d>=0;d--)f=b.children,e=a[d],e<=f.length-1&&(b=f[e]);return b}function f(c){var f=a[c?"start":"end"],g,h,i;f&&(g=f.position>0,h=d.createTextRange(),h.moveToElementText(e(f.indexes)),offset=f.offset,offset!==i?(h.collapse(f.inside||g),h.moveStart("character",g?-offset:offset)):h.collapse(c),b.setEndPoint(c?"StartToStart":"EndToStart",h),c&&b.collapse(!0))}var b,d=c.doc.body;a.start&&(a.start.ctrl?(b=d.createControlRange(),b.addElement(e(a.start.indexes)),b.select()):(b=d.createTextRange(),f(!0),f(),b.select()))},this.addRange=function(b){function m(a){var b,f,m,n,o;m=c.create("a"),b=a?g:i,f=a?h:j,n=d.duplicate();if(b==k||b==k.documentElement)b=l,f=0;b.nodeType==3?(b.parentNode.insertBefore(m,b),n.moveToElementText(m),n.moveStart("character",f),c.remove(m),d.setEndPoint(a?"StartToStart":"EndToEnd",n)):(o=b.childNodes,o.length?(f>=o.length?c.insertAfter(m,o[o.length-1]):b.insertBefore(m,o[f]),n.moveToElementText(m)):b.canHaveHTML&&(b.innerHTML="<span>﻿</span>",m=b.firstChild,n.moveToElementText(m),n.collapse(e)),d.setEndPoint(a?"StartToStart":"EndToEnd",n),c.remove(m))}var d,f,g,h,i,j,k=a.dom.doc,l=k.body;g=b.startContainer,h=b.startOffset,i=b.endContainer,j=b.endOffset,d=l.createTextRange();if(g==i&&g.nodeType==1){if(h==j&&!g.hasChildNodes()){if(g.canHaveHTML){g.innerHTML="<span>﻿</span><span>﻿</span>",d.moveToElementText(g.lastChild),d.select(),c.doc.selection.clear(),g.innerHTML="";return}h=c.nodeIndex(g),g=g.parentNode}if(h==j-1)try{f=l.createControlRange(),f.addElement(g.childNodes[h]),f.select();return}catch(n){}}m(!0),m(),d.select()},this.getRangeAt=g}tinymce.dom.TridentSelection=a}(),function(){function t(a,c,d,e,f,g){for(var h=0,i=e.length;h<i;h++){var j=e[h];if(j){var k=!1;j=j[a];while(j){if(j[b]===d){k=e[j.sizset];break}j.nodeType===1&&!g&&(j[b]=d,j.sizset=h);if(j.nodeName.toLowerCase()===c){k=j;break}j=j[a]}e[h]=k}}}function u(a,c,d,e,f,g){for(var h=0,i=e.length;h<i;h++){var k=e[h];if(k){var l=!1;k=k[a];while(k){if(k[b]===d){l=e[k.sizset];break}if(k.nodeType===1){g||(k[b]=d,k.sizset=h);if(typeof c!="string"){if(k===c){l=!0;break}}else if(j.filter(c,[k]).length>0){l=k;break}}k=k[a]}e[h]=l}}}var a=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,b="sizcache",c=0,d=Object.prototype.toString,e=!1,f=!0,g=/\\/g,h=/\r\n/g,i=/\W/;[0,0].sort(function(){return f=!1,0});var j=function(b,c,e,f){e=e||[],c=c||document;var g=c;if(c.nodeType!==1&&c.nodeType!==9)return[];if(!b||typeof b!="string")return e;var h,i,k,n,o,q,r,s,t=!0,u=j.isXML(c),w=[],x=b;do{a.exec(""),h=a.exec(x);if(h){x=h[3],w.push(h[1]);if(h[2]){n=h[3];break}}}while(h);if(w.length>1&&m.exec(b))if(w.length===2&&l.relative[w[0]])i=v(w[0]+w[1],c,f);else{i=l.relative[w[0]]?[c]:j(w.shift(),c);while(w.length)b=w.shift(),l.relative[b]&&(b+=w.shift()),i=v(b,i,f)}else{!f&&w.length>1&&c.nodeType===9&&!u&&l.match.ID.test(w[0])&&!l.match.ID.test(w[w.length-1])&&(o=j.find(w.shift(),c,u),c=o.expr?j.filter(o.expr,o.set)[0]:o.set[0]);if(c){o=f?{expr:w.pop(),set:p(f)}:j.find(w.pop(),w.length!==1||w[0]!=="~"&&w[0]!=="+"||!c.parentNode?c:c.parentNode,u),i=o.expr?j.filter(o.expr,o.set):o.set,w.length>0?k=p(i):t=!1;while(w.length)q=w.pop(),r=q,l.relative[q]?r=w.pop():q="",r==null&&(r=c),l.relative[q](k,r,u)}else k=w=[]}k||(k=i),k||j.error(q||b);if(d.call(k)==="[object Array]")if(!t)e.push.apply(e,k);else if(c&&c.nodeType===1)for(s=0;k[s]!=null;s++)k[s]&&(k[s]===!0||k[s].nodeType===1&&j.contains(c,k[s]))&&e.push(i[s]);else for(s=0;k[s]!=null;s++)k[s]&&k[s].nodeType===1&&e.push(i[s]);else p(k,e);return n&&(j(n,g,e,f),j.uniqueSort(e)),e};j.uniqueSort=function(a){if(r){e=f,a.sort(r);if(e)for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1)}return a},j.matches=function(a,b){return j(a,null,null,b)},j.matchesSelector=function(a,b){return j(b,null,null,[a]).length>0},j.find=function(a,b,c){var d,e,f,h,i,j;if(!a)return[];for(e=0,f=l.order.length;e<f;e++){i=l.order[e];if(h=l.leftMatch[i].exec(a)){j=h[1],h.splice(1,1);if(j.substr(j.length-1)!=="\\"){h[1]=(h[1]||"").replace(g,""),d=l.find[i](h,b,c);if(d!=null){a=a.replace(l.match[i],"");break}}}}return d||(d=typeof b.getElementsByTagName!="undefined"?b.getElementsByTagName("*"):[]),{set:d,expr:a}},j.filter=function(a,b,c,d){var e,f,g,h,i,k,m,n,o,p=a,q=[],r=b,s=b&&b[0]&&j.isXML(b[0]);while(a&&b.length){for(g in l.filter)if((e=l.leftMatch[g].exec(a))!=null&&e[2]){k=l.filter[g],m=e[1],f=!1,e.splice(1,1);if(m.substr(m.length-1)==="\\")continue;r===q&&(q=[]);if(l.preFilter[g]){e=l.preFilter[g](e,r,c,q,d,s);if(!e)f=h=!0;else if(e===!0)continue}if(e)for(n=0;(i=r[n])!=null;n++)i&&(h=k(i,e,n,r),o=d^h,c&&h!=null?o?f=!0:r[n]=!1:o&&(q.push(i),f=!0));if(h!==undefined){c||(r=q),a=a.replace(l.match[g],"");if(!f)return[];break}}if(a===p)if(f==null)j.error(a);else break;p=a}return r},j.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var k=j.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(d===1||d===9||d===11){if(typeof a.textContent=="string")return a.textContent;if(typeof a.innerText=="string")return a.innerText.replace(h,"");for(a=a.firstChild;a;a=a.nextSibling)e+=k(a)}else if(d===3||d===4)return a.nodeValue}else for(b=0;c=a[b];b++)c.nodeType!==8&&(e+=k(c));return e},l=j.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c=typeof b=="string",d=c&&!i.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f=0,g=a.length,h;f<g;f++)if(h=a[f]){while((h=h.previousSibling)&&h.nodeType!==1);a[f]=e||h&&h.nodeName.toLowerCase()===b?h||!1:h===b}e&&j.filter(b,a,!0)},">":function(a,b){var c,d=typeof b=="string",e=0,f=a.length;if(d&&!i.test(b)){b=b.toLowerCase();for(;e<f;e++){c=a[e];if(c){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}}else{for(;e<f;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&j.filter(b,a,!0)}},"":function(a,b,d){var e,f=c++,g=u;typeof b=="string"&&!i.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("parentNode",b,f,a,e,d)},"~":function(a,b,d){var e,f=c++,g=u;typeof b=="string"&&!i.test(b)&&(b=b.toLowerCase(),e=b,g=t),g("previousSibling",b,f,a,e,d)}},find:{ID:function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if(typeof b.getElementsByName!="undefined"){var c=[],d=b.getElementsByName(a[1]);for(var e=0,f=d.length;e<f;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return c.length===0?null:c}},TAG:function(a,b){if(typeof b.getElementsByTagName!="undefined")return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,e,f){a=" "+a[1].replace(g,"")+" ";if(f)return a;for(var h=0,i;(i=b[h])!=null;h++)i&&(e^(i.className&&(" "+i.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(i):c&&(b[h]=!1));return!1},ID:function(a){return a[1].replace(g,"")},TAG:function(a,b){return a[1].replace(g,"").toLowerCase()},CHILD:function(a){if(a[1]==="nth"){a[2]||j.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(a[2]==="even"&&"2n"||a[2]==="odd"&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&j.error(a[0]);return a[0]=c++,a},ATTR:function(a,b,c,d,e,f){var h=a[1]=a[1].replace(g,"");return!f&&l.attrMap[h]&&(a[1]=l.attrMap[h]),a[4]=(a[4]||a[5]||"").replace(g,""),a[2]==="~="&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(b,c,d,e,f){if(b[1]==="not")if((a.exec(b[3])||"").length>1||/^\w/.test(b[3]))b[3]=j(b[3],null,null,c);else{var g=j.filter(b[3],c,d,!0^f);return d||e.push.apply(e,g),!1}else if(l.match.POS.test(b[0])||l.match.CHILD.test(b[0]))return!0;return b},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&a.type!=="hidden"},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!j(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return a.nodeName.toLowerCase()==="input"&&"text"===c&&(b===c||b===null)},radio:function(a){return a.nodeName.toLowerCase()==="input"&&"radio"===a.type},checkbox:function(a){return a.nodeName.toLowerCase()==="input"&&"checkbox"===a.type},file:function(a){return a.nodeName.toLowerCase()==="input"&&"file"===a.type},password:function(a){return a.nodeName.toLowerCase()==="input"&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"submit"===a.type},image:function(a){return a.nodeName.toLowerCase()==="input"&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return(b==="input"||b==="button")&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return b==="input"&&"button"===a.type||b==="button"},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return b===0},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=l.filters[e];if(f)return f(a,c,b,d);if(e==="contains")return(a.textContent||a.innerText||k([a])||"").indexOf(b[3])>=0;if(e==="not"){var g=b[3];for(var h=0,i=g.length;h<i;h++)if(g[h]===a)return!1;return!0}j.error(e)},CHILD:function(a,c){var d,e,f,g,h,i,j,k=c[1],l=a;switch(k){case"only":case"first":while(l=l.previousSibling)if(l.nodeType===1)return!1;if(k==="first")return!0;l=a;case"last":while(l=l.nextSibling)if(l.nodeType===1)return!1;return!0;case"nth":d=c[2],e=c[3];if(d===1&&e===0)return!0;f=c[0],g=a.parentNode;if(g&&(g[b]!==f||!a.nodeIndex)){i=0;for(l=g.firstChild;l;l=l.nextSibling)l.nodeType===1&&(l.nodeIndex=++i);g[b]=f}return j=a.nodeIndex-e,d===0?j===0:j%d===0&&j/d>=0}},ID:function(a,b){return a.nodeType===1&&a.getAttribute("id")===b},TAG:function(a,b){return b==="*"&&a.nodeType===1||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=j.attr?j.attr(a,c):l.attrHandle[c]?l.attrHandle[c](a):a[c]!=null?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return d==null?f==="!=":!f&&j.attr?d!=null:f==="="?e===g:f==="*="?e.indexOf(g)>=0:f==="~="?(" "+e+" ").indexOf(g)>=0:g?f==="!="?e!==g:f==="^="?e.indexOf(g)===0:f==="$="?e.substr(e.length-g.length)===g:f==="|="?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=l.setFilters[e];if(f)return f(a,c,b,d)}}},m=l.match.POS,n=function(a,b){return"\\"+(b-0+1)};for(var o in l.match)l.match[o]=new RegExp(l.match[o].source+/(?![^\[]*\])(?![^\(]*\))/.source),l.leftMatch[o]=new RegExp(/(^(?:.|\r|\n)*?)/.source+l.match[o].source.replace(/\\(\d+)/g,n));l.match.globalPOS=m;var p=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(q){p=function(a,b){var c=0,e=b||[];if(d.call(a)==="[object Array]")Array.prototype.push.apply(e,a);else if(typeof a.length=="number")for(var f=a.length;c<f;c++)e.push(a[c]);else for(;a[c];c++)e.push(a[c]);return e}}var r,s;document.documentElement.compareDocumentPosition?r=function(a,b){return a===b?(e=!0,0):!a.compareDocumentPosition||!b.compareDocumentPosition?a.compareDocumentPosition?-1:1:a.compareDocumentPosition(b)&4?-1:1}:(r=function(a,b){if(a===b)return e=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,f=[],g=[],h=a.parentNode,i=b.parentNode,j=h;if(h===i)return s(a,b);if(!h)return-1;if(!i)return 1;while(j)f.unshift(j),j=j.parentNode;j=i;while(j)g.unshift(j),j=j.parentNode;c=f.length,d=g.length;for(var k=0;k<c&&k<d;k++)if(f[k]!==g[k])return s(f[k],g[k]);return k===c?s(a,g[k],-1):s(f[k],b,1)},s=function(a,b,c){if(a===b)return c;var d=a.nextSibling;while(d){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=document.createElement("div"),b="script"+(new Date).getTime(),c=document.documentElement;a.innerHTML="<a name='"+b+"'/>",c.insertBefore(a,c.firstChild),document.getElementById(b)&&(l.find.ID=function(a,b,c){if(typeof b.getElementById!="undefined"&&!c){var d=b.getElementById(a[1]);return d?d.id===a[1]||typeof d.getAttributeNode!="undefined"&&d.getAttributeNode("id").nodeValue===a[1]?[d]:undefined:[]}},l.filter.ID=function(a,b){var c=typeof a.getAttributeNode!="undefined"&&a.getAttributeNode("id");return a.nodeType===1&&c&&c.nodeValue===b}),c.removeChild(a),c=a=null}(),function(){var a=document.createElement("div");a.appendChild(document.createComment("")),a.getElementsByTagName("*").length>0&&(l.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){var d=[];for(var e=0;c[e];e++)c[e].nodeType===1&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&typeof a.firstChild.getAttribute!="undefined"&&a.firstChild.getAttribute("href")!=="#"&&(l.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),document.querySelectorAll&&function(){var a=j,b=document.createElement("div"),c="__sizzle__";b.innerHTML="<p class='TEST'></p>";if(b.querySelectorAll&&b.querySelectorAll(".TEST").length===0)return;j=function(b,d,e,f){d=d||document;if(!f&&!j.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(d.nodeType===1||d.nodeType===9)){if(g[1])return p(d.getElementsByTagName(b),e);if(g[2]&&l.find.CLASS&&d.getElementsByClassName)return p(d.getElementsByClassName(g[2]),e)}if(d.nodeType===9){if(b==="body"&&d.body)return p([d.body],e);if(g&&g[3]){var h=d.getElementById(g[3]);if(!h||!h.parentNode)return p([],e);if(h.id===g[3])return p([h],e)}try{return p(d.querySelectorAll(b),e)}catch(i){}}else if(d.nodeType===1&&d.nodeName.toLowerCase()!=="object"){var k=d,m=d.getAttribute("id"),n=m||c,o=d.parentNode,q=/^\s*[+~]/.test(b);m?n=n.replace(/'/g,"\\$&"):d.setAttribute("id",n),q&&o&&(d=d.parentNode);try{if(!q||o)return p(d.querySelectorAll("[id='"+n+"'] "+b),e)}catch(r){}finally{m||k.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)j[d]=a[d];b=null}(),function(){var a=document.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(document.createElement("div"),"div"),d=!1;try{b.call(document.documentElement,"[test!='']:sizzle")}catch(e){d=!0}j.matchesSelector=function(a,e){e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!j.isXML(a))try{if(d||!l.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&a.document.nodeType!==11)return f}}catch(g){}return j(e,null,null,[a]).length>0}}}(),function(){var a=document.createElement("div");a.innerHTML="<div class='test e'></div><div class='test'></div>";if(!a.getElementsByClassName||a.getElementsByClassName("e").length===0)return;a.lastChild.className="e";if(a.getElementsByClassName("e").length===1)return;l.order.splice(1,0,"CLASS"),l.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!="undefined"&&!c)return b.getElementsByClassName(a[1])},a=null}(),document.documentElement.contains?j.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:document.documentElement.compareDocumentPosition?j.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)}:j.contains=function(){return!1},j.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?b.nodeName!=="HTML":!1};var v=function(a,b,c){var d,e=[],f="",g=b.nodeType?[b]:b;while(d=l.match.PSEUDO.exec(a))f+=d[0],a=a.replace(l.match.PSEUDO,"");a=l.relative[a]?a+"*":a;for(var h=0,i=g.length;h<i;h++)j(a,g[h],e,c);return j.filter(f,e)};window.tinymce.dom.Sizzle=j}(),function(a){a.dom.Element=function(b,c){var d=this,e,f;d.settings=c=c||{},d.id=b,d.dom=e=c.dom||a.DOM,a.isIE||(f=e.get(d.id)),a.each("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get".split(/,/),function(a){d[a]=function(){var c=[b],f;for(f=0;f<arguments.length;f++)c.push(arguments[f]);return c=e[a].apply(e,c),d.update(a),c}}),a.extend(d,{on:function(b,c,e){return a.dom.Event.add(d.id,b,c,e)},getXY:function(){return{x:parseInt(d.getStyle("left")),y:parseInt(d.getStyle("top"))}},getSize:function(){var a=e.get(d.id);return{w:parseInt(d.getStyle("width")||a.clientWidth),h:parseInt(d.getStyle("height")||a.clientHeight)}},moveTo:function(a,b){d.setStyles({left:a,top:b})},moveBy:function(a,b){var c=d.getXY();d.moveTo(c.x+a,c.y+b)},resizeTo:function(a,b){d.setStyles({width:a,height:b})},resizeBy:function(a,b){var c=d.getSize();d.resizeTo(c.w+a,c.h+b)},update:function(b){var f;if(a.isIE6&&c.blocker){b=b||"";if(b.indexOf("get")===0||b.indexOf("has")===0||b.indexOf("is")===0)return;if(b=="remove"){e.remove(d.blocker);return}d.blocker?f=e.get(d.blocker):(d.blocker=e.uniqueId(),f=e.add(c.container||e.getRoot(),"iframe",{id:d.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'}),e.setStyle(f,"opacity",0)),e.setStyles(f,{left:d.getStyle("left",1),top:d.getStyle("top",1),width:d.getStyle("width",1),height:d.getStyle("height",1),display:d.getStyle("display",1),zIndex:parseInt(d.getStyle("zIndex",1)||0)-1})}}})}}(tinymce),function(a){function b(a){return a.replace(/[\n\r]+/g,"")}var c=a.is,d=a.isIE,e=a.each,f=a.dom.TreeWalker;a.create("tinymce.dom.Selection",{Selection:function(b,c,d){var f=this;f.dom=b,f.win=c,f.serializer=d,e(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(b){f[b]=new a.util.Dispatcher(f)}),f.win.getSelection||(f.tridentSel=new a.dom.TridentSelection(f)),a.isIE&&b.boxModel&&this._fixIESelection(),a.addUnload(f.destroy,f)},setCursorLocation:function(a,b){var c=this,d=c.dom.createRng();d.setStart(a,b),d.setEnd(a,b),c.setRng(d),c.collapse(!1)},getContent:function(a){var b=this,d=b.getRng(),e=b.dom.create("body"),f=b.getSel(),g,h,i;return a=a||{},g=h="",a.get=!0,a.format=a.format||"html",a.forced_root_block="",b.onBeforeGetContent.dispatch(b,a),a.format=="text"?b.isCollapsed()?"":d.text||(f.toString?f.toString():""):(d.cloneContents?(i=d.cloneContents(),i&&e.appendChild(i)):c(d.item)||c(d.htmlText)?(e.innerHTML="<br>"+(d.item?d.item(0).outerHTML:d.htmlText),e.removeChild(e.firstChild)):e.innerHTML=d.toString(),/^\s/.test(e.innerHTML)&&(g=" "),/\s+$/.test(e.innerHTML)&&(h=" "),a.getInner=!0,a.content=b.isCollapsed()?"":g+b.serializer.serialize(e,a)+h,b.onGetContent.dispatch(b,a),a.content)},setContent:function(a,b){var c=this,d=c.getRng(),e,f=c.win.document,g,h;b=b||{format:"html"},b.set=!0,a=b.content=a,b.no_events||c.onBeforeSetContent.dispatch(c,b),a=b.content;if(d.insertNode){a+='<span id="__caret">_</span>',d.startContainer==f&&d.endContainer==f?f.body.innerHTML=a:(d.deleteContents(),f.body.childNodes.length===0?f.body.innerHTML=a:d.createContextualFragment?d.insertNode(d.createContextualFragment(a)):(g=f.createDocumentFragment(),h=f.createElement("div"),g.appendChild(h),h.outerHTML=a,d.insertNode(g))),e=c.dom.get("__caret"),d=f.createRange(),d.setStartBefore(e),d.setEndBefore(e),c.setRng(d),c.dom.remove("__caret");try{c.setRng(d)}catch(i){}}else d.item&&(f.execCommand("Delete",!1,null),d=c.getRng()),/^\s+/.test(a)?(d.pasteHTML('<span id="__mce_tmp">_</span>'+a),c.dom.remove("__mce_tmp")):d.pasteHTML(a);b.no_events||c.onSetContent.dispatch(c,b)},getStart:function(){var a=this.getRng(),b,c,d,e;if(a.duplicate||a.item){if(a.item)return a.item(0);d=a.duplicate(),d.collapse(1),b=d.parentElement(),c=e=a.parentElement();while(e=e.parentNode)if(e==b){b=c;break}return b}return b=a.startContainer,b.nodeType==1&&b.hasChildNodes()&&(b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)]),b&&b.nodeType==3?b.parentNode:b},getEnd:function(){var a=this,b=a.getRng(),c,d;return b.duplicate||b.item?b.item?b.item(0):(b=b.duplicate(),b.collapse(0),c=b.parentElement(),c&&c.nodeName=="BODY"?c.lastChild||c:c):(c=b.endContainer,d=b.endOffset,c.nodeType==1&&c.hasChildNodes()&&(c=c.childNodes[d>0?d-1:d]),c&&c.nodeType==3?c.parentNode:c)},getBookmark:function(a,b){function o(a,b){var c=0;return e(d.select(a),function(a,d){a==b&&(c=d)}),c}function p(a){function b(b){var c,d,e,f=b?"start":"end";c=a[f+"Container"],d=a[f+"Offset"],c.nodeType==1&&c.nodeName=="TR"&&(e=c.childNodes,c=e[Math.min(b?d:d-1,e.length-1)],c&&(d=b?0:c.childNodes.length,a["set"+(b?"Start":"End")](c,d)))}return b(!0),b(),a}function q(){function g(a,d){var f=a[d?"startContainer":"endContainer"],g=a[d?"startOffset":"endOffset"],h=[],i,j,k=0;if(f.nodeType==3){if(b)for(i=f.previousSibling;i&&i.nodeType==3;i=i.previousSibling)g+=i.nodeValue.length;h.push(g)}else j=f.childNodes,g>=j.length&&j.length&&(k=1,g=Math.max(0,j.length-1)),h.push(c.dom.nodeIndex(j[g],b)+k);for(;f&&f!=e;f=f.parentNode)h.push(c.dom.nodeIndex(f,b));return h}var a=c.getRng(!0),e=d.getRoot(),f={};return f.start=g(a,!0),c.isCollapsed()||(f.end=g(a)),f}var c=this,d=c.dom,f,g,h,i,j,k,l,m="﻿",n;if(a==2)return c.tridentSel?c.tridentSel.getBookmark(a):q();if(a)return{rng:c.getRng()};f=c.getRng(),h=d.uniqueId(),i=tinyMCE.activeEditor.selection.isCollapsed(),n="overflow:hidden;line-height:0px";if(f.duplicate||f.item){if(!!f.item)return k=f.item(0),j=k.nodeName,{name:j,index:o(j,k)};g=f.duplicate();try{f.collapse(),f.pasteHTML('<span data-mce-type="bookmark" id="'+h+'_start" style="'+n+'">'+m+"</span>"),i||(g.collapse(!1),f.moveToElementText(g.parentElement()),f.compareEndPoints("StartToEnd",g)===0&&g.move("character",-1),g.pasteHTML('<span data-mce-type="bookmark" id="'+h+'_end" style="'+n+'">'+m+"</span>"))}catch(r){return null}}else{k=c.getNode(),j=k.nodeName;if(j=="IMG")return{name:j,index:o(j,k)};g=p(f.cloneRange()),i||(g.collapse(!1),g.insertNode(d.create("span",{"data-mce-type":"bookmark",id:h+"_end",style:n},m))),f=p(f),f.collapse(!0),f.insertNode(d.create("span",{"data-mce-type":"bookmark",id:h+"_start",style:n},m))}return c.moveToBookmark({id:h,keep:1}),{id:h}},moveToBookmark:function(b){function o(a){var c=b[a?"start":"end"],d,e,f,g;if(c){f=c[0];for(e=j,d=c.length-1;d>=1;d--){g=e.childNodes;if(c[d]>g.length-1)return;e=g[c[d]]}e.nodeType===3&&(f=Math.min(c[0],e.nodeValue.length)),e.nodeType===1&&(f=Math.min(c[0],e.childNodes.length)),a?i.setStart(e,f):i.setEnd(e,f)}return!0}function p(c){var d=f.get(b.id+"_"+c),g,h,i,j,o=b.keep;if(d){g=d.parentNode,c=="start"?(o?(g=d.firstChild,h=1):h=f.nodeIndex(d),k=l=g,m=n=h):(o?(g=d.firstChild,h=1):h=f.nodeIndex(d),l=g,n=h);if(!o){j=d.previousSibling,i=d.nextSibling,e(a.grep(d.childNodes),function(a){a.nodeType==3&&(a.nodeValue=a.nodeValue.replace(/\uFEFF/g,""))});while(d=f.get(b.id+"_"+c))f.remove(d,1);j&&i&&j.nodeType==i.nodeType&&j.nodeType==3&&!a.isOpera&&(h=j.nodeValue.length,j.appendData(i.nodeValue),f.remove(i),c=="start"?(k=l=j,m=n=h):(l=j,n=h))}}}function q(a){return f.isBlock(a)&&!a.innerHTML&&!d&&(a.innerHTML='<br data-mce-bogus="1" />'),a}var c=this,f=c.dom,g,h,i,j,k,l,m,n;if(b)if(b.start){i=f.createRng(),j=f.getRoot();if(c.tridentSel)return c.tridentSel.moveToBookmark(b);o(!0)&&o()&&c.setRng(i)}else b.id?(p("start"),p("end"),k&&(i=f.createRng(),i.setStart(q(k),m),i.setEnd(q(l),n),c.setRng(i))):b.name?c.select(f.select(b.name)[b.index]):b.rng&&c.setRng(b.rng)},select:function(b,c){function i(b,c){var d=new f(b,b);do{if(b.nodeType==3&&a.trim(b.nodeValue).length!==0){c?g.setStart(b,0):g.setEnd(b,b.nodeValue.length);return}if(b.nodeName=="BR"){c?g.setStartBefore(b):g.setEndBefore(b);return}}while(b=c?d.next():d.prev())}var d=this,e=d.dom,g=e.createRng(),h;return b&&(h=e.nodeIndex(b),g.setStart(b.parentNode,h),g.setEnd(b.parentNode,h+1),c&&(i(b,1),i(b)),d.setRng(g)),b},isCollapsed:function(){var a=this,b=a.getRng(),c=a.getSel();return!b||b.item?!1:b.compareEndPoints?b.compareEndPoints("StartToEnd",b)===0:!c||b.collapsed},collapse:function(a){var b=this,c=b.getRng(),d;c.item&&(d=c.item(0),c=b.win.document.body.createTextRange(),c.moveToElementText(d)),c.collapse(!!a),b.setRng(c)},getSel:function(){var a=this,b=this.win;return b.getSelection?b.getSelection():b.document.selection},getRng:function(b){var c=this,d,e,f,g=c.win.document;if(b&&c.tridentSel)return c.tridentSel.getRangeAt(0);try{if(d=c.getSel())e=d.rangeCount>0?d.getRangeAt(0):d.createRange?d.createRange():g.createRange()}catch(h){}return a.isIE&&e&&e.setStart&&g.selection.createRange().item&&(f=g.selection.createRange().item(0),e=g.createRange(),e.setStartBefore(f),e.setEndAfter(f)),e||(e=g.createRange?g.createRange():g.body.createTextRange()),e.setStart&&e.startContainer.nodeType===9&&e.collapsed&&(f=c.dom.getRoot(),e.setStart(f,0),e.setEnd(f,0)),c.selectedRange&&c.explicitRange&&(e.compareBoundaryPoints(e.START_TO_START,c.selectedRange)===0&&e.compareBoundaryPoints(e.END_TO_END,c.selectedRange)===0?e=c.explicitRange:(c.selectedRange=null,c.explicitRange=null)),e},setRng:function(a,b){var c,d=this;if(!d.tridentSel){c=d.getSel();if(c){d.explicitRange=a;try{c.removeAllRanges()}catch(e){}c.addRange(a),b===!1&&c.extend&&(c.collapse(a.endContainer,a.endOffset),c.extend(a.startContainer,a.startOffset)),d.selectedRange=c.rangeCount>0?c.getRangeAt(0):null}}else{if(a.cloneRange)try{d.tridentSel.addRange(a);return}catch(e){}try{a.select()}catch(e){}}},setNode:function(a){var b=this;return b.setContent(b.dom.getOuterHTML(a)),a},getNode:function(){function g(a,b){var c=a;while(a&&a.nodeType===3&&a.length===0)a=b?a.nextSibling:a.previousSibling;return a||c}var a=this,b=a.getRng(),c=a.getSel(),d,e=b.startContainer,f=b.endContainer;if(!b)return a.dom.getRoot();if(b.setStart){d=b.commonAncestorContainer;if(!b.collapsed){b.startContainer==b.endContainer&&b.endOffset-b.startOffset<2&&b.startContainer.hasChildNodes()&&(d=b.startContainer.childNodes[b.startOffset]);if(e.nodeType===3&&f.nodeType===3){e.length===b.startOffset?e=g(e.nextSibling,!0):e=e.parentNode,b.endOffset===0?f=g(f.previousSibling,!1):f=f.parentNode;if(e&&e===f)return e}}return d&&d.nodeType==3?d.parentNode:d}return b.item?b.item(0):b.parentElement()},getSelectedBlocks:function(a,b){var c=this,d=c.dom,e,g,h,i=[];e=d.getParent(a||c.getStart(),d.isBlock),g=d.getParent(b||c.getEnd(),d.isBlock),e&&i.push(e);if(e&&g&&e!=g){h=e;var j=new f(e,d.getRoot());while((h=j.next())&&h!=g)d.isBlock(h)&&i.push(h)}return g&&e!=g&&i.push(g),i},isForward:function(){var a=this.dom,b=this.getSel(),c,d;return!b||b.anchorNode==null||b.focusNode==null?!0:(c=a.createRng(),c.setStart(b.anchorNode,b.anchorOffset),c.collapse(!0),d=a.createRng(),d.setStart(b.focusNode,b.focusOffset),d.collapse(!0),c.compareBoundaryPoints(c.START_TO_START,d)<=0)},normalize:function(){function i(a){function o(a,b){var c=new f(a,j.getParent(a.parentNode,j.isBlock)||k);while(a=c[b?"prev":"next"]())if(a.nodeName==="BR")return!0}function p(a,b){var c,i;b=b||g,c=new f(b,j.getParent(b.parentNode,j.isBlock)||k);while(l=c[a?"prev":"next"]()){if(l.nodeType===3&&l.nodeValue.length>0){g=l,h=a?l.nodeValue.length:0,d=!0;return}if(j.isBlock(l)||m[l.nodeName.toLowerCase()])return;i=l}e&&i&&(g=i,d=!0,h=0)}var g,h,i,j=b.dom,k=j.getRoot(),l,m,n;g=c[(a?"start":"end")+"Container"],h=c[(a?"start":"end")+"Offset"],m=j.schema.getNonEmptyElements(),g.nodeType===9&&(g=j.getRoot(),h=0);if(g===k){if(a){l=g.childNodes[h>0?h-1:0];if(l){n=l.nodeName.toLowerCase();if(m[l.nodeName]||l.nodeName=="TABLE")return}}if(g.hasChildNodes()){g=g.childNodes[Math.min(!a&&h>0?h-1:h,g.childNodes.length-1)],h=0;if(g.hasChildNodes()&&!/TABLE/.test(g.nodeName)){l=g,i=new f(g,k);do{if(l.nodeType===3&&l.nodeValue.length>0){h=a?0:l.nodeValue.length,g=l,d=!0;break}if(m[l.nodeName.toLowerCase()]){h=j.nodeIndex(l),g=l.parentNode,l.nodeName=="IMG"&&!a&&h++,d=!0;break}}while(l=a?i.next():i.prev())}}}e&&(g.nodeType===3&&h===0&&p(!0),g.nodeType===1&&(l=g.childNodes[h],l&&l.nodeName==="BR"&&!o(l)&&!o(l,!0)&&p(!0,g.childNodes[h]))),a&&!e&&g.nodeType===3&&h===g.nodeValue.length&&p(!1),d&&c["set"+(a?"Start":"End")](g,h)}var b=this,c,d,e,g,h;if(a.isIE)return;c=b.getRng(),e=c.collapsed,i(!0),e||i(),d&&(e&&c.collapse(!0),b.setRng(c,b.isForward()))},destroy:function(b){var c=this;c.win=null,b||a.removeUnload(c.destroy)},_fixIESelection:function(){function g(a,b){var d=c.createTextRange();try{d.moveToPoint(a,b)}catch(e){d=null}return d}function h(a){var b;a.button?(b=g(a.x,a.y),b&&(b.compareEndPoints("StartToStart",e)>0?b.setEndPoint("StartToStart",e):b.setEndPoint("EndToEnd",e),b.select())):i()}function i(){var c=b.selection.createRange();e&&!c.item&&c.compareEndPoints("StartToEnd",c)===0&&e.select(),a.unbind(b,"mouseup",i),a.unbind(b,"mousemove",h),e=d=0}var a=this.dom,b=a.doc,c=b.body,d,e,f;b.documentElement.unselectable=!0,a.bind(b,["mousedown","contextmenu"],function(c){if(c.target.nodeName==="HTML"){d&&i(),f=b.documentElement;if(f.scrollHeight>f.clientHeight)return;d=1,e=g(c.x,c.y),e&&(a.bind(b,"mouseup",i),a.bind(b,"mousemove",h),a.win.focus(),e.select())}})}})}(tinymce),function(a){a.dom.Serializer=function(b,c,d){var e,f,g=a.isIE,h=a.each,i;return b.apply_source_formatting||(b.indent=!1),c=c||a.DOM,d=d||new a.html.Schema(b),b.entity_encoding=b.entity_encoding||"named",b.remove_trailing_brs="remove_trailing_brs"in b?b.remove_trailing_brs:!0,e=new a.util.Dispatcher(self),f=new a.util.Dispatcher(self),i=new a.html.DomParser(b,d),i.addAttributeFilter("src,href,style",function(a,d){var e=a.length,f,g,h="data-mce-"+d,i=b.url_converter,j=b.url_converter_scope,k;while(e--)f=a[e],g=f.attributes.map[h],g!==k?(f.attr(d,g.length>0?g:null),f.attr(h,null)):(g=f.attributes.map[d],d==="style"?g=c.serializeStyle(c.parseStyle(g),f.name):i&&(g=i.call(j,g,d,f.name)),f.attr(d,g.length>0?g:null))}),i.addAttributeFilter("class",function(a,b){var c=a.length,d,e;while(c--)d=a[c],e=d.attr("class").replace(/(?:^|\s)mce(Item\w+|Selected)(?!\S)/g,""),d.attr("class",e.length>0?e:null)}),i.addAttributeFilter("data-mce-type",function(a,b,c){var d=a.length,e;while(d--)e=a[d],e.attributes.map["data-mce-type"]==="bookmark"&&!c.cleanup&&e.remove()}),i.addAttributeFilter("data-mce-expando",function(a,b,c){var d=a.length;while(d--)a[d].attr(b,null)}),i.addNodeFilter("script,style",function(a,b){function f(a){return a.replace(/(<!--\[CDATA\[|\]\]-->)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"")}var c=a.length,d,e;while(c--)d=a[c],e=d.firstChild?d.firstChild.value:"",b==="script"?(d.attr("type",(d.attr("type")||"text/javascript").replace(/^mce\-/,"")),e.length>0&&(d.firstChild.value="// <![CDATA[\n"+f(e)+"\n// ]]>")):e.length>0&&(d.firstChild.value="<!--\n"+f(e)+"\n-->")}),i.addNodeFilter("#comment",function(a,b){var c=a.length,d;while(c--)d=a[c],d.value.indexOf("[CDATA[")===0?(d.name="#cdata",d.type=4,d.value=d.value.replace(/^\[CDATA\[|\]\]$/g,"")):d.value.indexOf("mce:protected ")===0&&(d.name="#text",d.type=3,d.raw=!0,d.value=unescape(d.value).substr(14))}),i.addNodeFilter("xml:namespace,input",function(a,b){var c=a.length,d;while(c--)d=a[c],d.type===7?d.remove():d.type===1&&b==="input"&&!("type"in d.attributes.map)&&d.attr("type","text")}),b.fix_list_elements&&i.addNodeFilter("ul,ol",function(a,b){var c=a.length,d,e;while(c--)d=a[c],e=d.parent,(e.name==="ul"||e.name==="ol")&&d.prev&&d.prev.name==="li"&&d.prev.append(d)}),i.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(a,b){var c=a.length;while(c--)a[c].attr(b,null)}),{schema:d,addNodeFilter:i.addNodeFilter,addAttributeFilter:i.addAttributeFilter,onPreProcess:e,onPostProcess:f,serialize:function(j,k){var l,m,n,o,p;return g&&c.select("script,style,select,map").length>0?(p=j.innerHTML,j=j.cloneNode(!1),c.setHTML(j,p)):j=j.cloneNode(!0),l=j.ownerDocument.implementation,l.createHTMLDocument&&(m=l.createHTMLDocument(""),h(j.nodeName=="BODY"?j.childNodes:[j],function(a){m.body.appendChild(m.importNode(a,!0))}),j.nodeName!="BODY"?j=m.body.firstChild:j=m.body,n=c.doc,c.doc=m),k=k||{},k.format=k.format||"html",k.no_events||(k.node=j,e.dispatch(self,k)),o=new a.html.Serializer(b,d),k.content=o.serialize(i.parse(a.trim(k.getInner?j.innerHTML:c.getOuterHTML(j)),k)),k.cleanup||(k.content=k.content.replace(/\uFEFF|\u200B/g,"")),k.no_events||f.dispatch(self,k),n&&(c.doc=n),k.node=null,k.content},addRules:function(a){d.addValidElements(a)},setRules:function(a){d.setValidElements(a)}}}}(tinymce),function(a){a.dom.ScriptLoader=function(b){function l(b,c){function j(){e.remove(i),f&&(f.onreadystatechange=f.onload=f=null),c()}function k(){typeof console!="undefined"&&console.log&&console.log("Failed to load: "+b)}var d=this,e=a.DOM,f,g,h,i;i=e.uniqueId();if(a.isIE6){g=new a.util.URI(b),h=location;if(g.host==h.hostname&&g.port==h.port&&g.protocol+":"==h.protocol&&g.protocol.toLowerCase()!="file"){a.util.XHR.send({url:a._addVer(g.getURI()),success:function(a){var b=e.create("script",{type:"text/javascript"});b.text=a,document.getElementsByTagName("head")[0].appendChild(b),e.remove(b),j()},error:k});return}}f=e.create("script",{id:i,type:"text/javascript",src:a._addVer(b)}),a.isIE||(f.onload=j),f.onerror=k,a.isOpera||(f.onreadystatechange=function(){var a=f.readyState;(a=="complete"||a=="loaded")&&j()}),(document.getElementsByTagName("head")[0]||document.body).appendChild(f)}var c=0,d=1,e=2,f={},g=[],h={},i=[],j=0,k;this.isDone=function(a){return f[a]==e},this.markDone=function(a){f[a]=e},this.add=this.load=function(a,b,d){var e,i=f[a];i==k&&(g.push(a),f[a]=c),b&&(h[a]||(h[a]=[]),h[a].push({func:b,scope:d||this}))},this.loadQueue=function(a,b){this.loadScripts(g,a,b)},this.loadScripts=function(b,c,g){function n(b){a.each(h[b],function(a){a.func.call(a.scope)}),h[b]=k}var m;i.push({func:c,scope:g||this}),m=function(){var c=a.grep(b);b.length=0,a.each(c,function(a){if(f[a]==e){n(a);return}f[a]!=d&&(f[a]=d,j++,l(a,function(){f[a]=e,j--,n(a),m()}))}),j||(a.each(i,function(a){a.func.call(a.scope)}),i.length=0)},m()}},a.ScriptLoader=new a.dom.ScriptLoader}(tinymce),function(a){a.dom.RangeUtils=function(b){var c="﻿";this.walk=function(c,d){function p(a){var b;return b=a[0],b.nodeType===3&&b===e&&f>=b.nodeValue.length&&a.splice(0,1),b=a[a.length-1],h===0&&a.length>0&&b===g&&b.nodeType===3&&a.splice(a.length-1,1),a}function q(a,b,c){var d=[];for(;a&&a!=c;a=a[b])d.push(a);return d}function r(a,b){do{if(a.parentNode==b)return a;a=a.parentNode}while(a)}function s(a,b,c){var e=c?"nextSibling":"previousSibling";for(l=a,m=l.parentNode;l&&l!=b;l=m)m=l.parentNode,n=q(l==a?l:l[e],e),n.length&&(c||n.reverse(),d(p(n)))}var e=c.startContainer,f=c.startOffset,g=c.endContainer,h=c.endOffset,i,j,k,l,m,n,o;o=b.select("td.mceSelected,th.mceSelected");if(o.length>0){a.each(o,function(a){d([a])});return}e.nodeType==1&&e.hasChildNodes()&&(e=e.childNodes[f]),g.nodeType==1&&g.hasChildNodes()&&(g=g.childNodes[Math.min(h-1,g.childNodes.length-1)]);if(e==g)return d(p([e]));i=b.findCommonAncestor(e,g);for(l=e;l;l=l.parentNode){if(l===g)return s(e,i,!0);if(l===i)break}for(l=g;l;l=l.parentNode){if(l===e)return s(g,i);if(l===i)break}j=r(e,i)||e,k=r(g,i)||g,s(e,j,!0),n=q(j==e?j:j.nextSibling,"nextSibling",k==g?k.nextSibling:k),n.length&&d(p(n)),s(g,k)},this.split=function(a){function f(a,b){return a.splitText(b)}var b=a.startContainer,c=a.startOffset,d=a.endContainer,e=a.endOffset;return b==d&&b.nodeType==3?c>0&&c<b.nodeValue.length&&(d=f(b,c),b=d.previousSibling,e>c?(e-=c,b=d=f(d,e).previousSibling,e=d.nodeValue.length,c=0):e=0):(b.nodeType==3&&c>0&&c<b.nodeValue.length&&(b=f(b,c),c=0),d.nodeType==3&&e>0&&e<d.nodeValue.length&&(d=f(d,e).previousSibling,e=d.nodeValue.length)),{startContainer:b,startOffset:c,endContainer:d,endOffset:e}}},a.dom.RangeUtils.compareRanges=function(a,b){if(a&&b){if(!a.item&&!a.duplicate)return a.startContainer==b.startContainer&&a.startOffset==b.startOffset;if(a.item&&b.item&&a.item(0)===b.item(0))return!0;if(a.isEqual&&b.isEqual&&b.isEqual(a))return!0}return!1}}(tinymce),function(a){var b=a.dom.Event,c=a.each;a.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(d,e){var f=this,g=d.root,h=d.items,i=d.enableUpDown,j=d.enableLeftRight||!d.enableUpDown,k=d.excludeFromTabOrder,l,m,n,o,p;e=e||a.DOM,l=function(a){p=a.target.id},m=function(a){e.setAttrib(a.target.id,"tabindex","-1")},o=function(a){var b=e.get(p);e.setAttrib(b,"tabindex","0"),b.focus()},f.focus=function(){e.get(p).focus()},f.destroy=function(){c(h,function(a){e.unbind(e.get(a.id),"focus",l),e.unbind(e.get(a.id),"blur",m)}),e.unbind(e.get(g),"focus",o),e.unbind(e.get(g),"keydown",n),h=e=g=f.focus=l=m=n=o=null,f.destroy=function(){}},f.moveFocus=function(a,g){var i=-1,j=f.controls,k;if(!p)return;c(h,function(a,b){if(a.id===p)return i=b,!1}),i+=a,i<0?i=h.length-1:i>=h.length&&(i=0),k=h[i],e.setAttrib(p,"tabindex","-1"),e.setAttrib(k.id,"tabindex","0"),e.get(k.id).focus(),d.actOnFocus&&d.onAction(k.id),g&&b.cancel(g)},n=function(a){var c=37,e=39,g=38,h=40,k=27,l=14,m=13,n=32;switch(a.keyCode){case c:j&&f.moveFocus(-1);break;case e:j&&f.moveFocus(1);break;case g:i&&f.moveFocus(-1);break;case h:i&&f.moveFocus(1);break;case k:d.onCancel&&(d.onCancel(),b.cancel(a));break;case l:case m:case n:d.onAction&&(d.onAction(p),b.cancel(a))}},c(h,function(a,b){var c;a.id||(a.id=e.uniqueId("_mce_item_")),k?(e.bind(a.id,"blur",m),c="-1"):c=b===0?"0":"-1",e.setAttrib(a.id,"tabindex",c),e.bind(e.get(a.id),"focus",l)}),h[0]&&(p=h[0].id),e.setAttrib(g,"tabindex","-1"),e.bind(e.get(g),"focus",o),e.bind(e.get(g),"keydown",n)}})}(tinymce),function(a){var b=a.DOM,c=a.is;a.create("tinymce.ui.Control",{Control:function(b,c,d){this.id=b,this.settings=c=c||{},this.rendered=!1,this.onRender=new a.util.Dispatcher(this),this.classPrefix="",this.scope=c.scope||this,this.disabled=0,this.active=0,this.editor=d},setAriaProperty:function(a,c){var d=b.get(this.id+"_aria")||b.get(this.id);d&&b.setAttrib(d,"aria-"+a,!!c)},focus:function(){b.get(this.id).focus()},setDisabled:function(a){a!=this.disabled&&(this.setAriaProperty("disabled",a),this.setState("Disabled",a),this.setState("Enabled",!a),this.disabled=a)},isDisabled:function(){return this.disabled},setActive:function(a){a!=this.active&&(this.setState("Active",a),this.active=a,this.setAriaProperty("pressed",a))},isActive:function(){return this.active},setState:function(a,c){var d=b.get(this.id);a=this.classPrefix+a,c?b.addClass(d,a):b.removeClass(d,a)},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(a){b.setHTML(a,this.renderHTML())},postRender:function(){var a=this,b;c(a.disabled)&&(b=a.disabled,a.disabled=-1,a.setDisabled(b)),c(a.active)&&(b=a.active,a.active=-1,a.setActive(b))},remove:function(){b.remove(this.id),this.destroy()},destroy:function(){a.dom.Event.clear(this.id)}})}(tinymce),tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(a,b,c){this.parent(a,b,c),this.controls=[],this.lookup={}},add:function(a){return this.lookup[a.id]=a,this.controls.push(a),a},get:function(a){return this.lookup[a]}}),tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(a,b){this.parent(a,b),this.classPrefix="mceSeparator",this.setDisabled(!0)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}}),function(a){var b=a.is,c=a.DOM,d=a.each,e=a.walk;a.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(a,b){this.parent(a,b),this.classPrefix="mceMenuItem"},setSelected:function(a){this.setState("Selected",a),this.setAriaProperty("checked",!!a),this.selected=a},isSelected:function(){return this.selected},postRender:function(){var a=this;a.parent(),b(a.selected)&&a.setSelected(a.selected)}})}(tinymce),function(a){var b=a.is,c=a.DOM,d=a.each,e=a.walk;a.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(b,c){var d=this;d.parent(b,c),d.items={},d.collapsed=!1,d.menuCount=0,d.onAddItem=new a.util.Dispatcher(this)},expand:function(a){var b=this;a&&e(b,function(a){a.expand&&a.expand()},"items",b),b.collapsed=!1},collapse:function(a){var b=this;a&&e(b,function(a){a.collapse&&a.collapse()},"items",b),b.collapsed=!0},isCollapsed:function(){return this.collapsed},add:function(b){return b.settings||(b=new a.ui.MenuItem(b.id||c.uniqueId(),b)),this.onAddItem.dispatch(this,b),this.items[b.id]=b},addSeparator:function(){return this.add({separator:!0})},addMenu:function(a){return a.collapse||(a=this.createMenu(a)),this.menuCount++,this.add(a)},hasMenus:function(){return this.menuCount!==0},remove:function(a){delete this.items[a.id]},removeAll:function(){var a=this;e(a,function(a){a.removeAll?a.removeAll():a.remove(),a.destroy()},"items",a),a.items={}},createMenu:function(b){var d=new a.ui.Menu(b.id||c.uniqueId(),b);return d.onAddItem.add(this.onAddItem.dispatch,this.onAddItem),d}})}(tinymce),function(a){var b=a.is,c=a.DOM,d=a.each,e=a.dom.Event,f=a.dom.Element;a.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(d,e){e=e||{},e.container=e.container||c.doc.body,e.offset_x=e.offset_x||0,e.offset_y=e.offset_y||0,e.vp_offset_x=e.vp_offset_x||0,e.vp_offset_y=e.vp_offset_y||0,b(e.icons)&&!e.icons&&(e["class"]+=" mceNoIcons"),this.parent(d,e),this.onShowMenu=new a.util.Dispatcher(this),this.onHideMenu=new a.util.Dispatcher(this),this.classPrefix="mceMenu"},createMenu:function(b){var d=this,e=d.settings,f;return b.container=b.container||e.container,b.parent=d,b.constrain=b.constrain||e.constrain,b["class"]=b["class"]||e["class"],b.vp_offset_x=b.vp_offset_x||e.vp_offset_x,b.vp_offset_y=b.vp_offset_y||e.vp_offset_y,b.keyboard_focus=e.keyboard_focus,f=new a.ui.DropMenu(b.id||c.uniqueId(),b),f.onAddItem.add(d.onAddItem.dispatch,d.onAddItem),f},focus:function(){var a=this;a.keyboardNav&&a.keyboardNav.focus()},update:function(){var a=this,b=a.settings,d=c.get("menu_"+a.id+"_tbl"),e=c.get("menu_"+a.id+"_co"),f,g;f=b.max_width?Math.min(d.offsetWidth,b.max_width):d.offsetWidth,g=b.max_height?Math.min(d.offsetHeight,b.max_height):d.offsetHeight,c.boxModel?a.element.setStyles({width:f,height:g}):a.element.setStyles({width:f+2,height:g+2}),b.max_width&&c.setStyle(e,"width",f),b.max_height&&(c.setStyle(e,"height",g),d.clientHeight<b.max_height&&c.setStyle(e,"overflow","hidden"))},showMenu:function(b,g,h){var i=this,j=i.settings,k,l=c.getViewPort(),m,n,o,p,q=2,r,s,t=i.classPrefix;i.collapse(1);if(i.isMenuVisible)return;i.rendered?k=c.get("menu_"+i.id):(k=c.add(i.settings.container,i.renderNode()),d(i.items,function(a){a.postRender()}),i.element=new f("menu_"+i.id,{blocker:1,container:j.container})),a.isOpera||c.setStyles(k,{left:-65535,top:-65535}),c.show(k),i.update(),b+=j.offset_x||0,g+=j.offset_y||0,l.w-=4,l.h-=4,j.constrain&&(m=k.clientWidth-q,n=k.clientHeight-q,o=l.x+l.w,p=l.y+l.h,b+j.vp_offset_x+m>o&&(b=h?h-m:Math.max(0,o-j.vp_offset_x-m)),g+j.vp_offset_y+n>p&&(g=Math.max(0,p-j.vp_offset_y-n))),c.setStyles(k,{left:b,top:g}),i.element.update(),i.isMenuVisible=1,i.mouseClickFunc=e.add(k,"click",function(a){var b;a=a.target;if(a&&(a=c.getParent(a,"tr"))&&!c.hasClass(a,t+"ItemSub")){b=i.items[a.id];if(b.isDisabled())return;r=i;while(r)r.hideMenu&&r.hideMenu(),r=r.settings.parent;return b.settings.onclick&&b.settings.onclick(a),!1}}),i.hasMenus()&&(i.mouseOverFunc=e.add(k,"mouseover",function(a){var b,d,e;a=a.target;if(a&&(a=c.getParent(a,"tr"))){b=i.items[a.id],i.lastMenu&&i.lastMenu.collapse(1);if(b.isDisabled())return;a&&c.hasClass(a,t+"ItemSub")&&(d=c.getRect(a),b.showMenu(d.x+d.w-q,d.y-q,d.x),i.lastMenu=b,c.addClass(c.get(b.id).firstChild,t+"ItemActive"))}})),e.add(k,"keydown",i._keyHandler,i),i.onShowMenu.dispatch(i),j.keyboard_focus&&i._setupKeyboardNav()},hideMenu:function(a){var b=this,d=c.get("menu_"+b.id),f;if(!b.isMenuVisible)return;b.keyboardNav&&b.keyboardNav.destroy(),e.remove(d,"mouseover",b.mouseOverFunc),e.remove(d,"click",b.mouseClickFunc),e.remove(d,"keydown",b._keyHandler),c.hide(d),b.isMenuVisible=0,a||b.collapse(1),b.element&&b.element.hide(),(f=c.get(b.id))&&c.removeClass(f.firstChild,b.classPrefix+"ItemActive"),b.onHideMenu.dispatch(b)},add:function(a){var b=this,d;return a=b.parent(a),b.isRendered&&(d=c.get("menu_"+b.id))&&b._add(c.select("tbody",d)[0],a),a},collapse:function(a){this.parent(a),this.hideMenu(1)},remove:function(a){return c.remove(a.id),this.destroy(),this.parent(a)},destroy:function(){var a=this,b=c.get("menu_"+a.id);a.keyboardNav&&a.keyboardNav.destroy(),e.remove(b,"mouseover",a.mouseOverFunc),e.remove(c.select("a",b),"focus",a.mouseOverFunc),e.remove(b,"click",a.mouseClickFunc),e.remove(b,"keydown",a._keyHandler),a.element&&a.element.remove(),c.remove(b)},renderNode:function(){var a=this,b=a.settings,e,g,h,i;return i=c.create("div",{role:"listbox",id:"menu_"+a.id,"class":b["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"}),a.settings.parent&&c.setAttrib(i,"aria-parent","menu_"+a.settings.parent.id),h=c.add(i,"div",{role:"presentation",id:"menu_"+a.id+"_co","class":a.classPrefix+(b["class"]?" "+b["class"]:"")}),a.element=new f("menu_"+a.id,{blocker:1,container:b.container}),b.menu_line&&c.add(h,"span",{"class":a.classPrefix+"Line"}),e=c.add(h,"table",{role:"presentation",id:"menu_"+a.id+"_tbl",border:0,cellPadding:0,cellSpacing:0}),g=c.add(e,"tbody"),d(a.items,function(b){a._add(g,b)}),a.rendered=!0,i},_setupKeyboardNav:function(){var b,d,e=this;b=c.get("menu_"+e.id),d=c.select("a[role=option]","menu_"+e.id),d.splice(0,0,b),e.keyboardNav=new a.ui.KeyboardNavigation({root:"menu_"+e.id,items:d,onCancel:function(){e.hideMenu()},enableUpDown:!0}),b.focus()},_keyHandler:function(a){var b=this,c;switch(a.keyCode){case 37:b.settings.parent&&(b.hideMenu(),b.settings.parent.focus(),e.cancel(a));break;case 39:b.mouseOverFunc&&b.mouseOverFunc(a)}},_add:function(a,b){var d,e=b.settings,f,g,h,i=this.classPrefix,j;if(e.separator){g=c.add(a,"tr",{id:b.id,"class":i+"ItemSeparator"}),c.add(g,"td",{"class":i+"ItemSeparator"}),(d=g.previousSibling)&&c.addClass(d,"mceLast");return}d=g=c.add(a,"tr",{id:b.id,"class":i+"Item "+i+"ItemEnabled"}),d=h=c.add(d,e.titleItem?"th":"td"),d=f=c.add(d,"a",{id:b.id+"_aria",role:e.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"}),e.parent&&(c.setAttrib(f,"aria-haspopup","true"),c.setAttrib(f,"aria-owns","menu_"+b.id)),c.addClass(h,e["class"]),j=c.add(d,"span",{"class":"mceIcon"+(e.icon?" mce_"+e.icon:"")}),e.icon_src&&c.add(j,"img",{src:e.icon_src}),d=c.add(d,e.element||"span",{"class":"mceText",title:b.settings.title},b.settings.title),b.settings.style&&(typeof b.settings.style=="function"&&(b.settings.style=b.settings.style()),c.setAttrib(d,"style",b.settings.style)),a.childNodes.length==1&&c.addClass(g,"mceFirst"),(d=g.previousSibling)&&c.hasClass(d,i+"ItemSeparator")&&c.addClass(g,"mceFirst"),b.collapse&&c.addClass(g,i+"ItemSub"),(d=g.previousSibling)&&c.removeClass(d,"mceLast"),c.addClass(g,"mceLast")}})}(tinymce),function(a){var b=a.DOM;a.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(a,b,c){this.parent(a,b,c),this.classPrefix="mceButton"},renderHTML:function(){var a=this.classPrefix,c=this.settings,d,e;return e=b.encode(c.label||""),d='<a role="button" id="'+this.id+'" href="javascript:;" class="'+a+" "+a+"Enabled "+c["class"]+(e?" "+a+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+b.encode(c.title)+'">',c.image&&(!this.editor||!this.editor.forcedHighContrastMode)?d+='<img class="mceIcon" src="'+c.image+'" alt="'+b.encode(c.title)+'" />'+e:d+='<span class="mceIcon '+c["class"]+'"></span>'+(e?'<span class="'+a+'Label">'+e+"</span>":""),d+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+c.title+"</span>",d+="</a>",d},postRender:function(){var b=this,c=b.settings,d;a.isIE&&b.editor&&a.dom.Event.add(b.id,"mousedown",function(a){var c=b.editor.selection.getNode().nodeName;d=c==="IMG"?b.editor.selection.getBookmark():null}),a.dom.Event.add(b.id,"click",function(e){if(!b.isDisabled())return a.isIE&&b.editor&&d!==null&&b.editor.selection.moveToBookmark(d),c.onclick.call(c.scope,e)}),a.dom.Event.add(b.id,"keyup",function(d){if(!b.isDisabled()&&d.keyCode==a.VK.SPACEBAR)return c.onclick.call(c.scope,d)})}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.each,e=a.util.Dispatcher,f;a.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(b,c,d){var f=this;f.parent(b,c,d),f.items=[],f.onChange=new e(f),f.onPostRender=new e(f),f.onAdd=new e(f),f.onRenderMenu=new a.util.Dispatcher(this),f.classPrefix="mceListBox",f.marked={}},select:function(a){var b=this,c,e;b.marked={};if(a==f)return b.selectByIndex(-1);a&&typeof a=="function"?e=a:e=function(b){return b==a},a!=b.selectedValue&&(d(b.items,function(a,d){if(e(a.value))return c=1,b.selectByIndex(d),!1}),c||b.selectByIndex(-1))},selectByIndex:function(a){var c=this,d,e,f;c.marked={},a!=c.selectedIndex&&(d=b.get(c.id+"_text"),f=b.get(c.id+"_voiceDesc"),e=c.items[a],e?(c.selectedValue=e.value,c.selectedIndex=a,b.setHTML(d,b.encode(e.title)),b.setHTML(f,c.settings.title+" - "+e.title),b.removeClass(d,"mceTitle"),b.setAttrib(c.id,"aria-valuenow",e.title)):(b.setHTML(d,b.encode(c.settings.title)),b.setHTML(f,b.encode(c.settings.title)),b.addClass(d,"mceTitle"),c.selectedValue=c.selectedIndex=null,b.setAttrib(c.id,"aria-valuenow",c.settings.title)),d=0)},mark:function(a){this.marked[a]=!0},add:function(b,c,d){var e=this;d=d||{},d=a.extend(d,{title:b,value:c}),e.items.push(d),e.onAdd.dispatch(e,d)},getLength:function(){return this.items.length},renderHTML:function(){var a="",c=this,d=c.settings,e=c.classPrefix;return a='<span role="listbox" aria-haspopup="true" aria-labelledby="'+c.id+'_voiceDesc" aria-describedby="'+c.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+c.id+'" cellpadding="0" cellspacing="0" class="'+e+" "+e+"Enabled"+(d["class"]?" "+d["class"]:"")+'"><tbody><tr>',a+="<td>"+b.createHTML("span",{id:c.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},c.settings.title),a+=b.createHTML("a",{id:c.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},b.encode(c.settings.title))+"</td>",a+="<td>"+b.createHTML("a",{id:c.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true">▼</span></span>')+"</td>",a+="</tr></tbody></table></span>",a},showMenu:function(){var e=this,f,g=b.get(this.id),h;if(e.isDisabled()||e.items.length===0)return;if(e.menu&&e.menu.isMenuVisible)return e.hideMenu();e.isMenuRendered||(e.renderMenu(),e.isMenuRendered=!0),f=b.getPos(g),h=e.menu,h.settings.offset_x=f.x,h.settings.offset_y=f.y,h.settings.keyboard_focus=!a.isOpera,d(e.items,function(a){h.items[a.id]&&h.items[a.id].setSelected(0)}),d(e.items,function(a){h.items[a.id]&&e.marked[a.value]&&h.items[a.id].setSelected(1),a.value===e.selectedValue&&h.items[a.id].setSelected(1)}),h.showMenu(0,g.clientHeight),c.add(b.doc,"mousedown",e.hideMenu,e),b.addClass(e.id,e.classPrefix+"Selected")},hideMenu:function(a){var d=this;if(d.menu&&d.menu.isMenuVisible){b.removeClass(d.id,d.classPrefix+"Selected");if(!(!a||a.type!="mousedown"||a.target.id!=d.id+"_text"&&a.target.id!=d.id+"_open"))return;if(!a||!b.getParent(a.target,".mceMenu"))b.removeClass(d.id,d.classPrefix+"Selected"),c.remove(b.doc,"mousedown",d.hideMenu,d),d.menu.hideMenu()}},renderMenu:function(){var a=this,c;c=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":a.classPrefix+"Menu mceNoIcons",max_width:250,max_height:150}),c.onHideMenu.add(function(){a.hideMenu(),a.focus()}),c.add({title:a.settings.title,"class":"mceMenuItemTitle",onclick:function(){a.settings.onselect("")!==!1&&a.select("")}}),d(a.items,function(d){d.value===f?c.add({title:d.title,role:"option","class":"mceMenuItemTitle",onclick:function(){a.settings.onselect("")!==!1&&a.select("")}}):(d.id=b.uniqueId(),d.role="option",d.onclick=function(){a.settings.onselect(d.value)!==!1&&a.select(d.value)},c.add(d))}),a.onRenderMenu.dispatch(a,c),a.menu=c},postRender:function(){var d=this,e=d.classPrefix;c.add(d.id,"click",d.showMenu,d),c.add(d.id,"keydown",function(a){a.keyCode==32&&(d.showMenu(a),c.cancel(a))}),c.add(d.id,"focus",function(){d._focused||(d.keyDownHandler=c.add(d.id,"keydown",function(a){a.keyCode==40&&(d.showMenu(),c.cancel(a))}),d.keyPressHandler=c.add(d.id,"keypress",function(a){var b;a.keyCode==13&&(b=d.selectedValue,d.selectedValue=null,c.cancel(a),d.settings.onselect(b))})),d._focused=1}),c.add(d.id,"blur",function(){c.remove(d.id,"keydown",d.keyDownHandler),c.remove(d.id,"keypress",d.keyPressHandler),d._focused=0});if(a.isIE6||!b.boxModel)c.add(d.id,"mouseover",function(){b.hasClass(d.id,e+"Disabled")||b.addClass(d.id,e+"Hover")}),c.add(d.id,"mouseout",function(){b.hasClass(d.id,e+"Disabled")||b.removeClass(d.id,e+"Hover")});d.onPostRender.dispatch(d,b.get(d.id))},destroy:function(){this.parent(),c.clear(this.id+"_text"),c.clear(this.id+"_open")}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.each,e=a.util.Dispatcher,f;a.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(a,b){this.parent(a,b),this.classPrefix="mceNativeListBox"},setDisabled:function(a){b.get(this.id).disabled=a,this.setAriaProperty("disabled",a)},isDisabled:function(){return b.get(this.id).disabled},select:function(a){var b=this,c,e;if(a==f)return b.selectByIndex(-1);a&&typeof a=="function"?e=a:e=function(b){return b==a},a!=b.selectedValue&&(d(b.items,function(a,d){if(e(a.value))return c=1,b.selectByIndex(d),!1}),c||b.selectByIndex(-1))},selectByIndex:function(a){b.get(this.id).selectedIndex=a+1,this.selectedValue=this.items[a]?this.items[a].value:null},add:function(a,c,d){var e,f=this;d=d||{},d.value=c,f.isRendered()&&b.add(b.get(this.id),"option",d,a),e={title:a,value:c,attribs:d},f.items.push(e),f.onAdd.dispatch(f,e)},getLength:function(){return this.items.length},renderHTML:function(){var a,c=this;return a=b.createHTML("option",{value:""},"-- "+c.settings.title+" --"),d(c.items,function(c){a+=b.createHTML("option",{value:c.value},c.title)}),a=b.createHTML("select",{id:c.id,"class":"mceNativeListBox","aria-labelledby":c.id+"_aria"},a),a+=b.createHTML("span",{id:c.id+"_aria",style:"display: none"},c.settings.title),a},postRender:function(){function g(a){var b=d.items[a.target.selectedIndex-1];b&&(b=b.value)&&(d.onChange.dispatch(d,b),d.settings.onselect&&d.settings.onselect(b))}var d=this,e,f=!0;d.rendered=!0,c.add(d.id,"change",g),c.add(d.id,"keydown",function(b){var h;c.remove(d.id,"change",e),f=!1,h=c.add(d.id,"blur",function(){if(f)return;f=!0,c.add(d.id,"change",g),c.remove(d.id,"blur",h)});if(!(!a.isWebKit||b.keyCode!=37&&b.keyCode!=39))return c.prevent(b);if(b.keyCode==13||b.keyCode==32)return g(b),c.cancel(b)}),d.onPostRender.dispatch(d,b.get(d.id))}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.each;a.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(c,d,e){this.parent(c,d,e),this.onRenderMenu=new a.util.Dispatcher(this),d.menu_container=d.menu_container||b.doc.body},showMenu:function(){var a=this,d,e,f=b.get(a.id),g;if(a.isDisabled())return;a.isMenuRendered||(a.renderMenu(),a.isMenuRendered=!0);if(a.isMenuVisible)return a.hideMenu();d=b.getPos(a.settings.menu_container),e=b.getPos(f),g=a.menu,g.settings.offset_x=e.x,g.settings.offset_y=e.y,g.settings.vp_offset_x=e.x,g.settings.vp_offset_y=e.y,g.settings.keyboard_focus=a._focused,g.showMenu(0,f.firstChild.clientHeight),c.add(b.doc,"mousedown",a.hideMenu,a),a.setState("Selected",1),a.isMenuVisible=1},renderMenu:function(){var a=this,b;b=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:a.settings.icons}),b.onHideMenu.add(function(){a.hideMenu(),a.focus()}),a.onRenderMenu.dispatch(a,b),a.menu=b},hideMenu:function(a){var d=this;if(a&&a.type=="mousedown"&&b.getParent(a.target,function(a){return a.id===d.id||a.id===d.id+"_open"}))return;if(!a||!b.getParent(a.target,".mceMenu"))d.setState("Selected",0),c.remove(b.doc,"mousedown",d.hideMenu,d),d.menu&&d.menu.hideMenu();d.isMenuVisible=0},postRender:function(){var a=this,b=a.settings;c.add(a.id,"click",function(){a.isDisabled()||(b.onclick&&b.onclick(a.value),a.showMenu())})}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.each;a.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(a,b,c){this.parent(a,b,c),this.classPrefix="mceSplitButton"},renderHTML:function(){var a,c=this,d=c.settings,e;return a="<tbody><tr>",d.image?e=b.createHTML("img ",{src:d.image,role:"presentation","class":"mceAction "+d["class"]}):e=b.createHTML("span",{"class":"mceAction "+d["class"]},""),e+=b.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",id:c.id+"_voice",style:"display:none;"},d.title),a+="<td >"+b.createHTML("a",{role:"button",id:c.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+d["class"],onclick:"return false;",onmousedown:"return false;",title:d.title},e)+"</td>",e=b.createHTML("span",{"class":"mceOpen "+d["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true">▼</span>'),a+="<td >"+b.createHTML("a",{role:"button",id:c.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+d["class"],onclick:"return false;",onmousedown:"return false;",title:d.title},e)+"</td>",a+="</tr></tbody>",a=b.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+d["class"],cellpadding:"0",cellspacing:"0",title:d.title},a),b.createHTML("div",{id:c.id,role:"button",tabindex:"0","aria-labelledby":c.id+"_voice","aria-haspopup":"true"},a)},postRender:function(){var d=this,e=d.settings,f;e.onclick&&(f=function(a){d.isDisabled()||(e.onclick(d.value),c.cancel(a))},c.add(d.id+"_action","click",f),c.add(d.id,["click","keydown"],function(a){var b=32,e=14,g=13,h=38,i=40;if((a.keyCode===32||a.keyCode===13||a.keyCode===14)&&!a.altKey&&!a.ctrlKey&&!a.metaKey)f(),c.cancel(a);else if(a.type==="click"||a.keyCode===i)d.showMenu(),c.cancel(a)})),c.add(d.id+"_open","click",function(a){d.showMenu(),c.cancel(a)}),c.add([d.id,d.id+"_open"],"focus",function(){d._focused=1}),c.add([d.id,d.id+"_open"],"blur",function(){d._focused=0});if(a.isIE6||!b.boxModel)c.add(d.id,"mouseover",function(){b.hasClass(d.id,"mceSplitButtonDisabled")||b.addClass(d.id,"mceSplitButtonHover")}),c.add(d.id,"mouseout",function(){b.hasClass(d.id,"mceSplitButtonDisabled")||b.removeClass(d.id,"mceSplitButtonHover")})},destroy:function(){this.parent(),c.clear(this.id+"_action"),c.clear(this.id+"_open"),c.clear(this.id)}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.is,e=a.each;a.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(b,c,d){var e=this;e.parent(b,c,d),e.settings=c=a.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},e.settings),e.onShowMenu=new a.util.Dispatcher(e),e.onHideMenu=new a.util.Dispatcher(e),e.value=c.default_color},showMenu:function(){var a=this,d,e,f,g;if(a.isDisabled())return;a.isMenuRendered||(a.renderMenu(),a.isMenuRendered=!0);if(a.isMenuVisible)return a.hideMenu();f=b.get(a.id),b.show(a.id+"_menu"),b.addClass(f,"mceSplitButtonSelected"),g=b.getPos(f),b.setStyles(a.id+"_menu",{left:g.x,top:g.y+f.firstChild.clientHeight,zIndex:2e5}),f=0,c.add(b.doc,"mousedown",a.hideMenu,a),a.onShowMenu.dispatch(a),a._focused&&(a._keyHandler=c.add(a.id+"_menu","keydown",function(b){b.keyCode==27&&a.hideMenu()}),b.select("a",a.id+"_menu")[0].focus()),a.isMenuVisible=1},hideMenu:function(a){var d=this;if(d.isMenuVisible){if(a&&a.type=="mousedown"&&b.getParent(a.target,function(a){return a.id===d.id+"_open"}))return;if(!a||!b.getParent(a.target,".mceSplitButtonMenu"))b.removeClass(d.id,"mceSplitButtonSelected"),c.remove(b.doc,"mousedown",d.hideMenu,d),c.remove(d.id+"_menu","keydown",d._keyHandler),b.hide(d.id+"_menu");d.isMenuVisible=0,d.onHideMenu.dispatch()}},renderMenu:function(){var f=this,g,h=0,i=f.settings,j,k,l,m,n;return m=b.add(i.menu_container,"div",{role:"listbox",id:f.id+"_menu","class":i.menu_class+" "+i["class"],style:"position:absolute;left:0;top:-1000px;"}),g=b.add(m,"div",{"class":i["class"]+" mceSplitButtonMenu"}),b.add(g,"span",{"class":"mceMenuLine"}),j=b.add(g,"table",{role:"presentation","class":"mceColorSplitMenu"}),k=b.add(j,"tbody"),h=0,e(d(i.colors,"array")?i.colors:i.colors.split(","),function(c){c=c.replace(/^#/,""),h--||(l=b.add(k,"tr"),h=i.grid_width-1),j=b.add(l,"td");var d={href:"javascript:;",style:{backgroundColor:"#"+c},title:f.editor.getLang("colors."+c,c),"data-mce-color":"#"+c};a.isIE||(d.role="option"),j=b.add(j,"a",d),f.editor.forcedHighContrastMode&&(j=b.add(j,"canvas",{width:16,height:16,"aria-hidden":"true"}),j.getContext&&(n=j.getContext("2d"))?(n.fillStyle="#"+c,n.fillRect(0,0,16,16)):b.remove(j))}),i.more_colors_func&&(j=b.add(k,"tr"),j=b.add(j,"td",{colspan:i.grid_width,"class":"mceMoreColors"}),j=b.add(j,"a",{role:"option",id:f.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},i.more_colors_title),c.add(j,"click",function(a){return i.more_colors_func.call(i.more_colors_scope||this),c.cancel(a)})),b.addClass(g,"mceColorSplitMenu"),new a.ui.KeyboardNavigation({root:f.id+"_menu",items:b.select("a",f.id+"_menu"),onCancel:function(){f.hideMenu(),f.focus()}}),c.add(f.id+"_menu","mousedown",function(a){return c.cancel(a)}),c.add(f.id+"_menu","click",function(a){var c;return a=b.getParent(a.target,"a",k),a&&a.nodeName.toLowerCase()=="a"&&(c=a.getAttribute("data-mce-color"))&&f.setColor(c),!1}),m},setColor:function(a){this.displayColor(a),this.hideMenu(),this.settings.onselect(a)},displayColor:function(a){var c=this;b.setStyle(c.id+"_preview","backgroundColor",a),c.value=a},postRender:function(){var a=this,c=a.id;a.parent(),b.add(c+"_action","div",{id:c+"_preview","class":"mceColorPreview"}),b.setStyle(a.id+"_preview","backgroundColor",a.value)},destroy:function(){this.parent(),c.clear(this.id+"_menu"),c.clear(this.id+"_more"),b.remove(this.id+"_menu")}})}(tinymce),function(a){var b=a.DOM,c=a.each,d=a.dom.Event;a.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var c=this,d=[],e=c.controls,f=a.each,g=c.settings;return d.push('<div id="'+c.id+'" role="group" aria-labelledby="'+c.id+'_voice">'),d.push("<span role='application'>"),d.push('<span id="'+c.id+'_voice" class="mceVoiceLabel" style="display:none;">'+b.encode(g.name)+"</span>"),f(e,function(a){d.push(a.renderHTML())}),d.push("</span>"),d.push("</div>"),d.join("")},focus:function(){var a=this;b.get(a.id).focus()},postRender:function(){var d=this,e=[];c(d.controls,function(a){c(a.controls,function(a){a.id&&e.push(a)})}),d.keyNav=new a.ui.KeyboardNavigation({root:d.id,items:e,onCancel:function(){a.isWebKit&&b.get(d.editor.id+"_ifr").focus(),d.editor.focus()},excludeFromTabOrder:!d.settings.tab_focus_toolbar})},destroy:function(){var a=this;a.parent(),a.keyNav.destroy(),d.clear(a.id)}})}(tinymce),function(a){var b=a.DOM,c=a.each;a.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var a=this,c="",d,e,f=a.settings,g,h,i,j;j=a.controls;for(g=0;g<j.length;g++)e=j[g],h=j[g-1],i=j[g+1],g===0&&(d="mceToolbarStart",e.Button?d+=" mceToolbarStartButton":e.SplitButton?d+=" mceToolbarStartSplitButton":e.ListBox&&(d+=" mceToolbarStartListBox"),c+=b.createHTML("td",{"class":d},b.createHTML("span",null,"<!-- IE -->"))),h&&e.ListBox&&(h.Button||h.SplitButton)&&(c+=b.createHTML("td",{"class":"mceToolbarEnd"},b.createHTML("span",null,"<!-- IE -->"))),b.stdMode?c+='<td style="position: relative">'+e.renderHTML()+"</td>":c+="<td>"+e.renderHTML()+"</td>",i&&e.ListBox&&(i.Button||i.SplitButton)&&(c+=b.createHTML("td",{"class":"mceToolbarStart"},b.createHTML("span",null,"<!-- IE -->")));return d="mceToolbarEnd",e.Button?d+=" mceToolbarEndButton":e.SplitButton?d+=" mceToolbarEndSplitButton":e.ListBox&&(d+=" mceToolbarEndListBox"),c+=b.createHTML("td",{"class":d},b.createHTML("span",null,"<!-- IE -->")),b.createHTML("table",{id:a.id,"class":"mceToolbar"+(f["class"]?" "+f["class"]:""),cellpadding:"0",cellspacing:"0",align:a.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+c+"</tr></tbody>")}})}(tinymce),function(a){var b=a.util.Dispatcher,c=a.each;a.create("tinymce.AddOnManager",{AddOnManager:function(){var a=this;a.items=[],a.urls={},a.lookup={},a.onAdd=new b(a)},get:function(a){return this.lookup[a]?this.lookup[a].instance:undefined},dependencies:function(a){var b;return this.lookup[a]&&(b=this.lookup[a].dependencies),b||[]},requireLangPack:function(b){var c=a.settings;c&&c.language&&c.language_load!==!1&&a.ScriptLoader.add(this.urls[b]+"/langs/"+c.language+".js")},add:function(a,b,c){return this.items.push(b),this.lookup[a]={instance:b,dependencies:c},this.onAdd.dispatch(this,a,b),b},createUrl:function(a,b){return typeof b=="object"?b:{prefix:a.prefix,resource:b,suffix:a.suffix}},addComponents:function(b,c){var d=this.urls[b];a.each(c,function(b){a.ScriptLoader.add(d+"/"+b)})},load:function(b,c,d,e){function h(){var g=f.dependencies(b);a.each(g,function(a){var b=f.createUrl(c,a);f.load(b.resource,b,undefined,undefined)}),d&&(e?d.call(e):d.call(a.ScriptLoader))}var f=this,g=c;if(f.urls[b])return;typeof c=="object"&&(g=c.prefix+c.resource+c.suffix),g.indexOf("/")!==0&&g.indexOf("://")==-1&&(g=a.baseURL+"/"+g),f.urls[b]=g.substring(0,g.lastIndexOf("/")),f.lookup[b]?h():a.ScriptLoader.add(g,h,e)}}),a.PluginManager=new a.AddOnManager,a.ThemeManager=new a.AddOnManager}(tinymce),function(a){var b=a.each,c=a.extend,d=a.DOM,e=a.dom.Event,f=a.ThemeManager,g=a.PluginManager,h=a.explode,i=a.util.Dispatcher,j,k=0;a.documentBaseURL=window.location.href.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(a.documentBaseURL)||(a.documentBaseURL+="/"),a.baseURL=(new a.util.URI(a.documentBaseURL)).toAbsolute(a.baseURL),a.baseURI=new a.util.URI(a.baseURL),a.onBeforeUnload=new i(a),e.add(window,"beforeunload",function(b){a.onBeforeUnload.dispatch(a,b)}),a.onAddEditor=new i(a),a.onRemoveEditor=new i(a),a.EditorManager=c(a,{editors:[],i18n:{},activeEditor:null,init:function(f){function o(a){var b=a.id;return b||(b=a.name,b&&!d.get(b)?b=a.name:b=d.uniqueId(),a.setAttribute("id",b)),b}function p(b,c,d){var e=b[c];if(!e)return;return a.is(e,"string")&&(d=e.replace(/\.\w+$/,""),d=d?a.resolve(d):0,e=a.resolve(e)),e.apply(d||this,Array.prototype.slice.call(arguments,2))}function q(a,b){return b.constructor===RegExp?b.test(a.className):d.hasClass(a,b)}var g=this,i,j=a.ScriptLoader,l,m=[],n;f=c({theme:"simple",language:"en"},f),g.settings=f,e.bind(window,"ready",function(){var c,e;p(f,"onpageload");switch(f.mode){case"exact":c=f.elements||"",c.length>0&&b(h(c),function(c){d.get(c)?(n=new a.Editor(c,f),m.push(n),n.render(1)):b(document.forms,function(e){b(e.elements,function(b){b.name===c&&(c="mce_editor_"+k++,d.setAttrib(b,"id",c),n=new a.Editor(c,f),m.push(n),n.render(1))})})});break;case"textareas":case"specific_textareas":b(d.select("textarea"),function(b){if(f.editor_deselector&&q(b,f.editor_deselector))return;if(!f.editor_selector||q(b,f.editor_selector))n=new a.Editor(o(b),f),m.push(n),n.render(1)});break;default:f.types?b(f.types,function(c){b(d.select(c.selector),function(b){var d=new a.Editor(o(b),a.extend({},f,c));m.push(d),d.render(1)})}):f.selector&&b(d.select(f.selector),function(b){var c=new a.Editor(o(b),f);m.push(c),c.render(1)})}f.oninit&&(c=e=0,b(m,function(a){e++,a.initialized?c++:a.onInit.add(function(){c++,c==e&&p(f,"oninit")}),c==e&&p(f,"oninit")}))})},get:function(a){return a===j?this.editors:this.editors[a]},getInstanceById:function(a){return this.get(a)},add:function(a){var b=this,c=b.editors;return c[a.id]=a,c.push(a),b._setActive(a),b.onAddEditor.dispatch(b,a),a},remove:function(a){var b=this,c,d=b.editors;if(!d[a.id])return null;delete d[a.id];for(c=0;c<d.length;c++)if(d[c]==a){d.splice(c,1);break}return b.activeEditor==a&&b._setActive(d[0]),a.destroy(),b.onRemoveEditor.dispatch(b,a),a},execCommand:function(b,c,d){function h(){f.destroy(),g.detachEvent("onunload",h),g=g.tinyMCE=g.tinymce=null}var e=this,f=e.get(d),g;switch(b){case"mceFocus":return f.focus(),!0;case"mceAddEditor":case"mceAddControl":return e.get(d)||(new a.Editor(d,e.settings)).render(),!0;case"mceAddFrameControl":return g=d.window,g.tinyMCE=tinyMCE,g.tinymce=a,a.DOM.doc=g.document,a.DOM.win=g,f=new a.Editor(d.element_id,d),f.render(),a.isIE&&g.attachEvent("onunload",h),d.page_window=null,!0;case"mceRemoveEditor":case"mceRemoveControl":return f&&f.remove(),!0;case"mceToggleEditor":if(!f)return e.execCommand("mceAddControl",0,d),!0;return f.isHidden()?f.show():f.hide(),!0}return e.activeEditor?e.activeEditor.execCommand(b,c,d):!1},execInstanceCommand:function(a,b,c,d){var e=this.get(a);return e?e.execCommand(b,c,d):!1},triggerSave:function(){b(this.editors,function(a){a.save()})},addI18n:function(c,d){var e,f=this.i18n;a.is(c,"string")?b(d,function(a,b){f[c+"."+b]=a}):b(c,function(a,c){b(a,function(a,d){b(a,function(a,b){d==="common"?f[c+"."+b]=a:f[c+"."+d+"."+b]=a})})})},_setActive:function(a){this.selectedInstance=this.activeEditor=a}})}(tinymce),function(a){var b=a.DOM,c=a.dom.Event,d=a.extend,e=a.each,f=a.isGecko,g=a.isIE,h=a.isWebKit,i=a.is,j=a.ThemeManager,k=a.PluginManager,l=a.explode;a.create("tinymce.Editor",{Editor:function(b,c){var e=this,f=!0;e.settings=c=d({id:b,language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:a.documentBaseURL,add_form_submit_trigger:f,submit_patch:f,add_unload_trigger:f,convert_urls:f,relative_urls:f,remove_script_host:f,table_inline_editing:!1,object_resizing:f,accessibility_focus:f,doctype:a.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE>",visual:f,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",apply_source_formatting:f,directionality:"ltr",forced_root_block:"p",hidden_input:f,padd_empty_editor:f,render_ui:f,indentation:"30px",fix_table_elements:f,inline_styles:f,convert_fonts_to_spans:f,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure",validate:f,entity_encoding:"named",url_converter:e.convertURL,url_converter_scope:e,ie7_compat:f},c),e.id=e.editorId=b,e.isNotDirty=!1,e.plugins={},e.documentBaseURI=new a.util.URI(c.document_base_url||a.documentBaseURL,{base_uri:tinyMCE.baseURI}),e.baseURI=a.baseURI,e.contentCSS=[],e.setupEvents(),e.execCommands={},e.queryStateCommands={},e.queryValueCommands={},e.execCallback("setup",e)},render:function(d){function m(){g.language&&g.language_load!==!1&&i.add(a.baseURL+"/langs/"+g.language+".js"),g.theme&&g.theme.charAt(0)!="-"&&!j.urls[g.theme]&&j.load(g.theme,"themes/"+g.theme+"/editor_template"+a.suffix+".js"),e(l(g.plugins),function(b){if(b&&!k.urls[b])if(b.charAt(0)=="-"){b=b.substr(1,b.length);var c=k.dependencies(b);e(c,function(b){var c={prefix:"plugins/",resource:b,suffix:"/editor_plugin"+a.suffix+".js"};b=k.createUrl(c,b),k.load(b.resource,b)})}else{if(b=="safari")return;k.load(b,{prefix:"plugins/",resource:b,suffix:"/editor_plugin"+a.suffix+".js"})}}),i.loadQueue(function(){f.removed||f.init()})}var f=this,g=f.settings,h=f.id,i=a.ScriptLoader;if(!c.domLoaded){c.add(window,"ready",function(){f.render()});return}tinyMCE.settings=g;if(!f.getElement())return;if(a.isIDevice&&!a.isIOS5)return;!/TEXTAREA|INPUT/i.test(f.getElement().nodeName)&&g.hidden_input&&b.getParent(h,"form")&&b.insertAfter(b.create("input",{type:"hidden",name:h}),h),a.WindowManager&&(f.windowManager=new a.WindowManager(f)),g.encoding=="xml"&&f.onGetContent.add(function(a,c){c.save&&(c.content=b.encode(c.content))}),g.add_form_submit_trigger&&f.onSubmit.addToTop(function(){f.initialized&&(f.save(),f.isNotDirty=1)}),g.add_unload_trigger&&(f._beforeUnload=tinyMCE.onBeforeUnload.add(function(){try{f.initialized&&!f.destroyed&&!f.isHidden()&&f.save({format:"raw",no_events:!0})}catch(a){}})),a.addUnload(f.destroy,f),g.submit_patch&&f.onBeforeRenderUI.add(function(){var b=f.getElement().form;if(!b)return;if(b._mceOldSubmit)return;!b.submit.nodeType&&!b.submit.length&&(f.formElement=b,b._mceOldSubmit=b.submit,b.submit=function(){return a.triggerSave(),f.isNotDirty=1,f.formElement._mceOldSubmit(f.formElement)}),b=null}),m()},init:function(){function v(b){var c=k.get(b),f=k.urls[b]||a.documentBaseURL.replace(/\/$/,""),g;c&&a.inArray(u,b)===-1&&(e(k.dependencies(b),function(a){v(a)}),g=new c(d,f),d.plugins[b]=g,g.init&&(g.init(d,f),u.push(b)))}var c,d=this,f=d.settings,h,i,m=d.getElement(),n,o,p,q,r,s,t,u=[];a.add(d),f.aria_label=f.aria_label||b.getAttrib(m,"aria-label",d.getLang("aria.rich_text_area")),f.theme&&(f.theme=f.theme.replace(/-/,""),n=j.get(f.theme),d.theme=new n,d.theme.init&&d.theme.init(d,j.urls[f.theme]||a.documentBaseURL.replace(/\/$/,""))),e(l(f.plugins.replace(/\-/g,"")),v),f.popup_css!==!1&&(f.popup_css?f.popup_css=d.documentBaseURI.toAbsolute(f.popup_css):f.popup_css=d.baseURI.toAbsolute("themes/"+f.theme+"/skins/"+f.skin+"/dialog.css")),f.popup_css_add&&(f.popup_css+=","+d.documentBaseURI.toAbsolute(f.popup_css_add)),d.controlManager=new a.ControlManager(d),d.onExecCommand.add(function(a,b){/^(FontName|FontSize)$/.test(b)||d.nodeChanged()}),d.onBeforeRenderUI.dispatch(d,d.controlManager),f.render_ui&&d.theme&&(h=f.width||m.style.width||m.offsetWidth,i=f.height||m.style.height||m.offsetHeight,d.orgDisplay=m.style.display,s=/^[0-9\.]+(|px)$/i,s.test(""+h)&&(h=Math.max(parseInt(h,10)+(n.deltaWidth||0),100)),s.test(""+i)&&(i=Math.max(parseInt(i,10)+(n.deltaHeight||0),100)),n=d.theme.renderUI({targetNode:m,width:h,height:i,deltaWidth:f.delta_width,deltaHeight:f.delta_height}),d.editorContainer=n.editorContainer),f.content_css&&e(l(f.content_css),function(a){d.contentCSS.push(d.documentBaseURI.toAbsolute(a))});if(f.content_editable)return m=c=n=null,d.initContentBody();document.domain&&location.hostname!=document.domain&&(a.relaxedDomain=document.domain),b.setStyles(n.sizeContainer||n.editorContainer,{width:h,height:i}),i=(n.iframeHeight||i)+(typeof i=="number"?n.deltaHeight||0:""),i<100&&(i=100),d.iframeHTML=f.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">',f.document_base_url!=a.documentBaseURL&&(d.iframeHTML+='<base href="'+d.documentBaseURI.getURI()+'" />'),f.ie7_compat?d.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=7" />':d.iframeHTML+='<meta http-equiv="X-UA-Compatible" content="IE=edge" />',d.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(t=0;t<d.contentCSS.length;t++)d.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+d.contentCSS[t]+'" />';d.contentCSS=[],q=f.body_id||"tinymce",q.indexOf("=")!=-1&&(q=d.getParam("body_id","","hash"),q=q[d.id]||q),r=f.body_class||"",r.indexOf("=")!=-1&&(r=d.getParam("body_class","","hash"),r=r[d.id]||""),d.iframeHTML+='</head><body id="'+q+'" class="mceContentBody '+r+'" onload="window.parent.tinyMCE.get(\''+d.id+"').onLoad.dispatch();\"><br></body></html>",a.relaxedDomain&&(g||a.isOpera&&parseFloat(opera.version())<11)&&(p='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+d.id+'");document.write(ed.iframeHTML);document.close();ed.initContentBody();})()'),c=b.add(n.iframeContainer,"iframe",{id:d.id+"_ifr",src:p||'javascript:""',frameBorder:"0",allowTransparency:"true",title:f.aria_label,style:{width:"100%",height:i,display:"block"}}),d.contentAreaContainer=n.iframeContainer,b.get(n.editorContainer).style.display=d.orgDisplay,b.get(d.id).style.display="none",b.setAttrib(d.id,"aria-hidden",!0),(!a.relaxedDomain||!p)&&d.initContentBody(),m=c=n=null},initContentBody:function(){var c=this,d=c.settings,f=b.get(c.id),h=c.getDoc(),i,j;(!g||!a.relaxedDomain)&&!d.content_editable&&(h.open(),h.write(c.iframeHTML),h.close(),a.relaxedDomain&&(h.domain=a.relaxedDomain)),d.content_editable&&(b.addClass(f,"mceContentBody"),c.contentDocument=h=d.content_document||document,c.contentWindow=d.content_window||window,c.bodyElement=f,d.content_document=d.content_window=null),j=c.getBody(),j.disabled=!0,d.readonly||(j.contentEditable=c.getParam("content_editable_state",!0)),j.disabled=!1,c.schema=new a.html.Schema(d),c.dom=new a.dom.DOMUtils(h,{keep_values:!0,url_converter:c.convertURL,url_converter_scope:c,hex_colors:d.force_hex_style_colors,class_filter:d.class_filter,update_styles:!0,root_element:d.content_editable?c.id:null,schema:c.schema}),c.parser=new a.html.DomParser(d,c.schema),c.parser.addAttributeFilter("src,href,style",function(a,b){var d=a.length,e,f=c.dom,g,h;while(d--)e=a[d],g=e.attr(b),h="data-mce-"+b,e.attributes.map[h]||(b==="style"?e.attr(h,f.serializeStyle(f.parseStyle(g),e.name)):e.attr(h,c.convertURL(g,b,e.name)))}),c.parser.addNodeFilter("script",function(a,b){var c=a.length,d;while(c--)d=a[c],d.attr("type","mce-"+(d.attr("type")||"text/javascript"))}),c.parser.addNodeFilter("#cdata",function(a,b){var c=a.length,d;while(c--)d=a[c],d.type=8,d.name="#comment",d.value="[CDATA["+d.value+"]]"}),c.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(b,d){var e=b.length,f,g=c.schema.getNonEmptyElements();while(e--)f=b[e],f.isEmpty(g)&&(f.empty().append(new a.html.Node("br",1)).shortEnded=!0)}),c.serializer=new a.dom.Serializer(d,c.dom,c.schema),c.selection=new a.dom.Selection(c.dom,c.getWin(),c.serializer),c.formatter=new a.Formatter(c),c.undoManager=new a.UndoManager(c),c.forceBlocks=new a.ForceBlocks(c),c.enterKey=new a.EnterKey(c),c.editorCommands=new a.EditorCommands(c),c.serializer.onPreProcess.add(function(a,b){return c.onPreProcess.dispatch(c,b,a)}),c.serializer.onPostProcess.add(function(a,b){return c.onPostProcess.dispatch(c,b,a)}),c.onPreInit.dispatch(c),d.gecko_spellcheck||(h.body.spellcheck=!1),d.readonly||c.bindNativeEvents(),c.controlManager.onPostRender.dispatch(c,c.controlManager),c.onPostRender.dispatch(c),c.quirks=a.util.Quirks(c),d.directionality&&(j.dir=d.directionality),d.nowrap&&(j.style.whiteSpace="nowrap"),d.protect&&c.onBeforeSetContent.add(function(a,b){e(d.protect,function(a){b.content=b.content.replace(a,function(a){return"<!--mce:protected "+escape(a)+"-->"})})}),c.onSetContent.add(function(){c.addVisual(c.getBody())}),d.padd_empty_editor&&c.onPostProcess.add(function(a,b){b.content=b.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")}),c.load({initial:!0,format:"html"}),c.startContent=c.getContent({format:"raw"}),c.initialized=!0,c.onInit.dispatch(c),c.execCallback("setupcontent_callback",c.id,j,h),c.execCallback("init_instance_callback",c),c.focus(!0),c.nodeChanged({initial:!0}),e(c.contentCSS,function(a){c.dom.loadCSS(a)}),d.auto_focus&&setTimeout(function(){var b=a.get(d.auto_focus);b.selection.select(b.getBody(),1),b.selection.collapse(1),b.getBody().focus(),b.getWin().focus()},100),f=h=j=null},focus:function(b){var c,d=this,e=d.selection,f=d.settings.content_editable,g,h,i=d.getDoc(),j;if(!b){g=e.getRng(),g.item&&(h=g.item(0)),d._refreshContentEditable(),f||d.getWin().focus();if(a.isGecko||f)j=d.getBody(),j.setActive?j.setActive():j.focus(),f&&e.normalize();h&&h.ownerDocument==i&&(g=i.body.createControlRange(),g.addElement(h),g.select())}a.activeEditor!=d&&((c=a.activeEditor)!=null&&c.onDeactivate.dispatch(c,d),d.onActivate.dispatch(d,c)),a._setActive(d)},execCallback:function(b){var c=this,d=c.settings[b],e;if(!d)return;return c.callbackLookup&&(e=c.callbackLookup[b])&&(d=e.func,e=e.scope),i(d,"string")&&(e=d.replace(/\.\w+$/,""),e=e?a.resolve(e):0,d=a.resolve(d),c.callbackLookup=c.callbackLookup||{},c.callbackLookup[b]={func:d,scope:e}),d.apply(e||c,Array.prototype.slice.call(arguments,1))},translate:function(b){var c=this.settings.language||"en",d=a.i18n;return b?d[c+"."+b]||b.replace(/\{\#([^\}]+)\}/g,function(a,b){return d[c+"."+b]||"{#"+b+"}"}):""},getLang:function(b,c){return a.i18n[(this.settings.language||"en")+"."+b]||(i(c)?c:"{#"+b+"}")},getParam:function(b,c,d){var f=a.trim,g=i(this.settings[b])?this.settings[b]:c,h;return d==="hash"?(h={},i(g,"string")?e(g.indexOf("=")>0?g.split(/[;,](?![^=;,]*(?:[;,]|$))/):g.split(","),function(a){a=a.split("="),a.length>1?h[f(a[0])]=f(a[1]):h[f(a[0])]=f(a)}):h=g,h):g},nodeChanged:function(a){var b=this,c=b.selection,d;b.initialized&&(a=a||{},d=c.getStart()||b.getBody(),d=g&&d.ownerDocument!=b.getDoc()?b.getBody():d,a.parents=[],b.dom.getParent(d,function(b){if(b.nodeName=="BODY")return!0;a.parents.push(b)}),b.onNodeChange.dispatch(b,a?a.controlManager||b.controlManager:b.controlManager,d,c.isCollapsed(),a))},addButton:function(a,b){var c=this;c.buttons=c.buttons||{},c.buttons[a]=b},addCommand:function(a,b,c){this.execCommands[a]={func:b,scope:c||this}},addQueryStateHandler:function(a,b,c){this.queryStateCommands[a]={func:b,scope:c||this}},addQueryValueHandler:function(a,b,c){this.queryValueCommands[a]={func:b,scope:c||this}},addShortcut:function(a,b,c,d){var f=this,g;return f.settings.custom_shortcuts===!1?!1:(f.shortcuts=f.shortcuts||{},i(c,"string")&&(g=c,c=function(){f.execCommand(g,!1,null)}),i(c,"object")&&(g=c,c=function(){f.execCommand(g[0],g[1],g[2])}),e(l(a),function(a){var g={func:c,scope:d||this,desc:f.translate(b),alt:!1,ctrl:!1,shift:!1};e(l(a,"+"),function(a){switch(a){case"alt":case"ctrl":case"shift":g[a]=!0;break;default:g.charCode=a.charCodeAt(0),g.keyCode=a.toUpperCase().charCodeAt(0)}}),f.shortcuts[(g.ctrl?"ctrl":"")+","+(g.alt?"alt":"")+","+(g.shift?"shift":"")+","+g.keyCode]=g}),!0)},execCommand:function(a,b,c,f){var g=this,h=0,i,j;!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(a)&&(!f||!f.skip_focus)&&g.focus(),f=d({},f),g.onBeforeExecCommand.dispatch(g,a,b,c,f);if(f.terminate)return!1;if(g.execCallback("execcommand_callback",g.id,g.selection.getNode(),a,b,c))return g.onExecCommand.dispatch(g,a,b,c,f),!0;if(i=g.execCommands[a]){j=i.func.call(i.scope,b,c);if(j!==!0)return g.onExecCommand.dispatch(g,a,b,c,f),j}e(g.plugins,function(d){if(d.execCommand&&d.execCommand(a,b,c))return g.onExecCommand.dispatch(g,a,b,c,f),h=1,!1});if(h)return!0;if(g.theme&&g.theme.execCommand&&g.theme.execCommand(a,b,c))return g.onExecCommand.dispatch(g,a,b,c,f),!0;if(g.editorCommands.execCommand(a,b,c))return g.onExecCommand.dispatch(g,a,b,c,f),!0;g.getDoc().execCommand(a,b,c),g.onExecCommand.dispatch(g,a,b,c,f)},queryCommandState:function(a){var b=this,c,d;if(b._isHidden())return;if(c=b.queryStateCommands[a]){d=c.func.call(c.scope);if(d!==!0)return d}c=b.editorCommands.queryCommandState(a);if(c!==-1)return c;try{return this.getDoc().queryCommandState(a)}catch(e){}},queryCommandValue:function(a){var b=this,c,d;if(b._isHidden())return;if(c=b.queryValueCommands[a]){d=c.func.call(c.scope);if(d!==!0)return d}c=b.editorCommands.queryCommandValue(a);if(i(c))return c;try{return this.getDoc().queryCommandValue(a)}catch(e){}},show:function(){var a=this;b.show(a.getContainer()),b.hide(a.id),a.load()},hide:function(){var a=this,c=a.getDoc();g&&c&&c.execCommand("SelectAll"),a.save(),b.hide(a.getContainer()),b.setStyle(a.id,"display",a.orgDisplay)},isHidden:function(){return!b.isHidden(this.id)},setProgressState:function(a,b,c){return this.onSetProgressState.dispatch(this,a,b,c),a},load:function(a){var b=this,c=b.getElement(),d;if(c)return a=a||{},a.load=!0,d=b.setContent(i(c.value)?c.value:c.innerHTML,a),a.element=c,a.no_events||b.onLoadContent.dispatch(b,a),a.element=c=null,d},save:function(a){var c=this,d=c.getElement(),f,g;if(!d||!c.initialized)return;return a=a||{},a.save=!0,a.element=d,f=a.content=c.getContent(a),a.no_events||c.onSaveContent.dispatch(c,a),f=a.content,/TEXTAREA|INPUT/i.test(d.nodeName)?d.value=f:(d.innerHTML=f,(g=b.getParent(c.id,"form"))&&e(g.elements,function(a){if(a.name==c.id)return a.value=f,!1})),a.element=d=null,f},setContent:function(b,c){var d=this,e,f=d.getBody(),g;c=c||{},c.format=c.format||"html",c.set=!0,c.content=b,c.no_events||d.onBeforeSetContent.dispatch(d,c),b=c.content;if(!a.isIE&&(b.length===0||/^\s+$/.test(b))){g=d.settings.forced_root_block,g?b="<"+g+'><br data-mce-bogus="1"></'+g+">":b='<br data-mce-bogus="1">',f.innerHTML=b,d.selection.select(f,!0),d.selection.collapse(!0);return}return c.format!=="raw"&&(b=(new a.html.Serializer({},d.schema)).serialize(d.parser.parse(b))),c.content=a.trim(b),d.dom.setHTML(f,c.content),c.no_events||d.onSetContent.dispatch(d,c),d.selection.normalize(),c.content},getContent:function(b){var c=this,d;return b=b||{},b.format=b.format||"html",b.get=!0,b.getInner=!0,b.no_events||c.onBeforeGetContent.dispatch(c,b),b.format=="raw"?d=c.getBody().innerHTML:d=c.serializer.serialize(c.getBody(),b),b.content=a.trim(d),b.no_events||c.onGetContent.dispatch(c,b),b.content},isDirty:function(){var b=this;return a.trim(b.startContent)!=a.trim(b.getContent({format:"raw",no_events:1}))&&!b.isNotDirty},getContainer:function(){var a=this;return a.container||(a.container=b.get(a.editorContainer||a.id+"_parent")),a.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return b.get(this.settings.content_element||this.id)},getWin:function(){var a=this,c;return a.contentWindow||(c=b.get(a.id+"_ifr"),c&&(a.contentWindow=c.contentWindow)),a.contentWindow},getDoc:function(){var a=this,b;return a.contentDocument||(b=a.getWin(),b&&(a.contentDocument=b.document)),a.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(a,b,c){var d=this,e=d.settings;return e.urlconverter_callback?d.execCallback("urlconverter_callback",a,c,!0,b):!e.convert_urls||c&&c.nodeName=="LINK"||a.indexOf("file:")===0?a:e.relative_urls?d.documentBaseURI.toRelative(a):(a=d.documentBaseURI.toAbsolute(a,e.remove_script_host),a)},addVisual:function(a){var b=this,c=b.settings,d=b.dom,f;a=a||b.getBody(),i(b.hasVisual)||(b.hasVisual=c.visual),e(d.select("table,a",a),function(a){var e;switch(a.nodeName){case"TABLE":f=c.visual_table_class||"mceItemTable",e=d.getAttrib(a,"border");if(!e||e=="0")b.hasVisual?d.addClass(a,f):d.removeClass(a,f);return;case"A":e=d.getAttrib(a,"name"),f="mceItemAnchor",e&&(b.hasVisual?d.addClass(a,f):d.removeClass(a,f));return}}),b.onVisualAid.dispatch(b,a,b.hasVisual)},remove:function(){var d=this,e=d.getContainer();d.removed||(d.removed=1,d.hide(),d.settings.content_editable||(c.clear(d.getWin()),c.clear(d.getDoc())),c.clear(d.getBody()),c.clear(d.formElement),c.unbind(e),d.execCallback("remove_instance_callback",d),d.onRemove.dispatch(d),d.onExecCommand.listeners=[],a.remove(d),b.remove(e))},destroy:function(b){var d=this;if(d.destroyed)return;f&&(c.unbind(d.getDoc()),c.unbind(d.getWin()),c.unbind(d.getBody())),b||(a.removeUnload(d.destroy),tinyMCE.onBeforeUnload.remove(d._beforeUnload),d.theme&&d.theme.destroy&&d.theme.destroy(),d.controlManager.destroy(),d.selection.destroy(),d.dom.destroy()),d.formElement&&(d.formElement.submit=d.formElement._mceOldSubmit,d.formElement._mceOldSubmit=null),d.contentAreaContainer=d.formElement=d.container=d.settings.content_element=d.bodyElement=d.contentDocument=d.contentWindow=null,d.selection&&(d.selection=d.selection.win=d.selection.dom=d.selection.dom.doc=null),d.destroyed=1},_refreshContentEditable:function(){var a=this,b,c;a._isHidden()&&(b=a.getBody(),c=b.parentNode,c.removeChild(b),c.appendChild(b),b.focus())},_isHidden:function(){var a;return f?(a=this.selection.getSel(),!a||!a.rangeCount||a.rangeCount===0):0}})}(tinymce),function(a){var b=a.each;a.Editor.prototype.setupEvents=function(){var c=this,d=c.settings;b(["onPreInit","onBeforeRenderUI","onPostRender","onLoad","onInit","onRemove","onActivate","onDeactivate","onClick","onEvent","onMouseUp","onMouseDown","onDblClick","onKeyDown","onKeyUp","onKeyPress","onContextMenu","onSubmit","onReset","onPaste","onPreProcess","onPostProcess","onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent","onLoadContent","onSaveContent","onNodeChange","onChange","onBeforeExecCommand","onExecCommand","onUndo","onRedo","onVisualAid","onSetProgressState","onSetAttrib"],function(b){c[b]=new a.util.Dispatcher(c)}),d.cleanup_callback&&(c.onBeforeSetContent.add(function(a,b){b.content=a.execCallback("cleanup_callback","insert_to_editor",b.content,b)}),c.onPreProcess.add(function(a,b){b.set&&a.execCallback("cleanup_callback","insert_to_editor_dom",b.node,b),b.get&&a.execCallback("cleanup_callback","get_from_editor_dom",b.node,b)}),c.onPostProcess.add(function(a,b){b.set&&(b.content=a.execCallback("cleanup_callback","insert_to_editor",b.content,b)),b.get&&(b.content=a.execCallback("cleanup_callback","get_from_editor",b.content,b))})),d.save_callback&&c.onGetContent.add(function(a,b){b.save&&(b.content=a.execCallback("save_callback",a.id,b.content,a.getBody()))}),d.handle_event_callback&&c.onEvent.add(function(a,b,d){c.execCallback("handle_event_callback",b,a,d)===!1&&Event.cancel(b)}),d.handle_node_change_callback&&c.onNodeChange.add(function(a,b,c){a.execCallback("handle_node_change_callback",a.id,c,-1,-1,!0,a.selection.isCollapsed())}),d.save_callback&&c.onSaveContent.add(function(a,b){var c=a.execCallback("save_callback",a.id,b.content,a.getBody());c&&(b.content=c)}),d.onchange_callback&&c.onChange.add(function(a,b){a.execCallback("onchange_callback",a,b)})},a.Editor.prototype.bindNativeEvents=function(){function h(a,b){var d=a.type;if(c.removed)return;c.onEvent.dispatch(c,a,b)!==!1&&c[g[a.fakeType||a.type]].dispatch(c,a,b)}function i(a){c.focus(!0)}function j(){c.selection.normalize(),c.nodeChanged()}function k(d,e){(d.altKey||d.ctrlKey||d.metaKey)&&b(c.shortcuts,function(b){var c=a.isMac?d.metaKey:d.ctrlKey;if(b.ctrl!=c||b.alt!=d.altKey||b.shift!=d.shiftKey)return;if(d.keyCode==b.keyCode||d.charCode&&d.charCode==b.charCode)return d.preventDefault(),e&&b.func.call(b.scope),!0})}var c=this,d,e=c.settings,f=c.dom,g;g={mouseup:"onMouseUp",mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"},b(g,function(b,d){var g=e.content_editable?c.getBody():c.getDoc();switch(d){case"contextmenu":f.bind(g,d,h);break;case"paste":f.bind(c.getBody(),d,h);break;case"submit":case"reset":f.bind(c.getElement().form||a.DOM.getParent(c.id,"form"),d,h);break;default:f.bind(g,d,h)}}),f.bind(e.content_editable?c.getBody():a.isGecko?c.getDoc():c.getWin(),"focus",function(a){c.focus(!0)}),e.content_editable&&a.isOpera&&(f.bind(c.getBody(),"click",i),f.bind(c.getBody(),"keydown",i)),c.onMouseUp.add(j),c.onKeyUp.add(function(b,c){var d=c.keyCode;(d>=33&&d<=36||d>=37&&d<=40||d==13||d==45||d==46||d==8||a.isMac&&(d==91||d==93)||c.ctrlKey)&&j()}),c.onReset.add(function(){c.setContent(c.startContent,{format:"raw"})}),c.onKeyUp.add(function(a,b){k(b)}),c.onKeyPress.add(function(a,b){k(b)}),c.onKeyDown.add(function(a,b){k(b,!0)}),a.isOpera&&c.onClick.add(function(a,b){b.preventDefault()})}}(tinymce),function(a){var b=a.each,c,d=!0,e=!1;a.EditorCommands=function(f){function m(a,b,c){var f;return a=a.toLowerCase(),(f=i.exec[a])?(f(a,b,c),d):e}function n(a){var b;return a=a.toLowerCase(),(b=i.state[a])?b(a):-1}function o(a){var b;return a=a.toLowerCase(),(b=i.value[a])?b(a):e}function p(a,c){c=c||"exec",b(a,function(a,d){b(d.toLowerCase().split(","),function(b){i[c][b]=a})})}function q(a,b,d){return b===c&&(b=e),d===c&&(d=null),f.getDoc().execCommand(a,b,d)}function r(a){return k.match(a)}function s(a,b){k.toggle(a,b?{value:b}:c)}function t(a){l=h.getBookmark(a)}function u(){h.moveToBookmark(l)}var g=f.dom,h=f.selection,i={state:{},exec:{},value:{}},j=f.settings,k=f.formatter,l;a.extend(this,{execCommand:m,queryCommandState:n,queryCommandValue:o,addCommands:p}),p({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){f.undoManager.add()},"Cut,Copy,Paste":function(b){var c=f.getDoc(),e;try{q(b)}catch(g){e=d}if(e||!c.queryCommandSupported(b))a.isGecko?f.windowManager.confirm(f.getLang("clipboard_msg"),function(a){a&&open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}):f.windowManager.alert(f.getLang("clipboard_no_support"))},unlink:function(a){h.isCollapsed()&&h.select(h.getNode()),q(a),h.collapse(e)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(a){var c=a.substring(7);b("left,center,right,full".split(","),function(a){c!=a&&k.remove("align"+a)}),s("align"+c),m("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(a){var b,c;q(a),b=g.getParent(h.getNode(),"ol,ul"),b&&(c=b.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(c.nodeName)&&(t(),g.split(c,b),u()))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){s(a)},"ForeColor,HiliteColor,FontName":function(a,b,c){s(a,c)},FontSize:function(b,c,d){var e,f;d>=1&&d<=7&&(f=a.explode(j.font_size_style_values),e=a.explode(j.font_size_classes),e?d=e[d-1]||d:d=f[d-1]||d),s(b,d)},RemoveFormat:function(a){k.remove(a)},mceBlockQuote:function(a){s("blockquote")},FormatBlock:function(a,b,c){return s(c||"p")},mceCleanup:function(){var a=h.getBookmark();f.setContent(f.getContent({cleanup:d}),{cleanup:d}),h.moveToBookmark(a)},mceRemoveNode:function(a,b,c){var e=c||h.getNode();e!=f.getBody()&&(t(),f.dom.remove(e,d),u())},mceSelectNodeDepth:function(a,b,c){var d=0;g.getParent(h.getNode(),function(a){if(a.nodeType==1&&d++==c)return h.select(a),e},f.getBody())},mceSelectNode:function(a,b,c){h.select(c)},mceInsertContent:function(b,c,d){var e,i,j,k,l,m,n,o,p,q,r,s,t,u;e=f.parser,i=new a.html.Serializer({},f.schema),t='<span id="mce_marker" data-mce-type="bookmark">﻿</span>',m={content:d,format:"html"},h.onBeforeSetContent.dispatch(h,m),d=m.content,d.indexOf("{$caret}")==-1&&(d+="{$caret}"),d=d.replace(/\{\$caret\}/,t),h.isCollapsed()||f.getDoc().execCommand("Delete",!1,null),j=h.getNode(),m={context:j.nodeName.toLowerCase()},l=e.parse(d,m),r=l.lastChild;if(r.attr("id")=="mce_marker"){n=r;for(r=r.prev;r;r=r.walk(!0))if(r.type==3||!g.isBlock(r.name)){r.parent.insert(n,r,r.name==="br");break}}if(!m.invalid)d=i.serialize(l),r=j.firstChild,s=j.lastChild,!r||r===s&&r.nodeName==="BR"?g.setHTML(j,d):h.setContent(d);else{h.setContent(t),j=f.selection.getNode(),k=f.getBody(),j.nodeType==9?j=r=k:r=j;while(r!==k)j=r,r=r.parentNode;d=j==k?k.innerHTML:g.getOuterHTML(j),d=i.serialize(e.parse(d.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return i.serialize(l)}))),j==k?g.setHTML(k,d):g.setOuterHTML(j,d)}n=g.get("mce_marker"),o=g.getRect(n),p=g.getViewPort(f.getWin());if(o.y+o.h>p.y+p.h||o.y<p.y||o.x>p.x+p.w||o.x<p.x)u=a.isIE?f.getDoc().documentElement:f.getBody(),u.scrollLeft=o.x,u.scrollTop=o.y-p.h+25;q=g.createRng(),r=n.previousSibling,r&&r.nodeType==3?q.setStart(r,r.nodeValue.length):(q.setStartBefore(n),q.setEndBefore(n)),g.remove(n),h.setRng(q),h.onSetContent.dispatch(h,m),f.addVisual()},mceInsertRawHTML:function(a,b,c){h.setContent("tiny_mce_marker"),f.setContent(f.getContent().replace(/tiny_mce_marker/g,function(){return c}))},mceSetContent:function(a,b,c){f.setContent(c)},"Indent,Outdent":function(a){var c,d,e;c=j.indentation,d=/[a-z%]+$/i.exec(c),c=parseInt(c),!n("InsertUnorderedList")&&!n("InsertOrderedList")?(!j.forced_root_block&&!g.getParent(h.getNode(),g.isBlock)&&k.apply("div"),b(h.getSelectedBlocks(),function(b){a=="outdent"?(e=Math.max(0,parseInt(b.style.paddingLeft||0)-c),g.setStyle(b,"paddingLeft",e?e+d:"")):g.setStyle(b,"paddingLeft",parseInt(b.style.paddingLeft||0)+c+d)})):q(a)},mceRepaint:function(){var b;if(a.isGecko)try{t(d),h.getSel()&&h.getSel().selectAllChildren(f.getBody()),h.collapse(d),u()}catch(c){}},mceToggleFormat:function(a,b,c){k.toggle(c)},InsertHorizontalRule:function(){f.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){f.hasVisual=!f.hasVisual,f.addVisual()},mceReplaceContent:function(a,b,c){f.execCommand("mceInsertContent",!1,c.replace(/\{\$selection\}/g,h.getContent({format:"text"})))},mceInsertLink:function(a,b,c){var d;typeof c=="string"&&(c={href:c}),d=g.getParent(h.getNode(),"a"),c.href=c.href.replace(" ","%20"),(!d||!c.href)&&k.remove("link"),c.href&&k.apply("link",c,d)},selectAll:function(){var a=g.getRoot(),b=g.createRng();b.setStart(a,0),b.setEnd(a,a.childNodes.length),f.selection.setRng(b)}}),p({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(b){var c="align"+b.substring(7),e=h.isCollapsed()?[g.getParent(h.getNode(),g.isBlock)]:h.getSelectedBlocks(),f=a.map(e,function(a){return!!k.matchNode(a,c)});return a.inArray(f,d)!==-1},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(a){return r(a)},mceBlockQuote:function(){return r("blockquote")},Outdent:function(){var a;if(j.inline_styles){if((a=g.getParent(h.getStart(),g.isBlock))&&parseInt(a.style.paddingLeft)>0)return d;if((a=g.getParent(h.getEnd(),g.isBlock))&&parseInt(a.style.paddingLeft)>0)return d}return n("InsertUnorderedList")||n("InsertOrderedList")||!j.inline_styles&&!!g.getParent(h.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList":function(a){return g.getParent(h.getNode(),a=="insertunorderedlist"?"UL":"OL")}},"state"),p({"FontSize,FontName":function(a){var b=0,c;if(c=g.getParent(h.getNode(),"span"))a=="fontsize"?b=c.style.fontSize:b=c.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return b}},"value"),p({Undo:function(){f.undoManager.undo()},Redo:function(){f.undoManager.redo()}})}}(tinymce),function(a){var b=a.util.Dispatcher;a.UndoManager=function(c){function k(){return a.trim(c.getContent({format:"raw",no_events:1}).replace(/<span[^>]+data-mce-bogus[^>]+>[\u200B\uFEFF]+<\/span>/g,""))}function l(){d.typing=!1,d.add()}var d,e=0,f=[],g,h,i,j;return h=new b(d),i=new b(d),j=new b(d),h.add(function(a,b){if(a.hasUndo())return c.onChange.dispatch(c,b,a)}),i.add(function(a,b){return c.onUndo.dispatch(c,b,a)}),j.add(function(a,b){return c.onRedo.dispatch(c,b,a)}),c.onInit.add(function(){d.add()}),c.onBeforeExecCommand.add(function(a,b,c,e,f){b!="Undo"&&b!="Redo"&&b!="mceRepaint"&&(!f||!f.skip_undo)&&d.beforeChange()}),c.onExecCommand.add(function(a,b,c,e,f){b!="Undo"&&b!="Redo"&&b!="mceRepaint"&&(!f||!f.skip_undo)&&d.add()}),c.onSaveContent.add(l),c.dom.bind(c.dom.getRoot(),"dragend",l),c.dom.bind(c.getDoc(),a.isGecko?"blur":"focusout",function(a){!c.removed&&d.typing&&l()}),c.onKeyUp.add(function(a,b){var c=b.keyCode;(c>=33&&c<=36||c>=37&&c<=40||c==45||c==13||b.ctrlKey)&&l()}),c.onKeyDown.add(function(a,b){var c=b.keyCode;if(c>=33&&c<=36||c>=37&&c<=40||c==45){d.typing&&l();return}(c<16||c>20)&&c!=224&&c!=91&&!d.typing&&(d.beforeChange(),d.typing=!0,d.add())}),c.onMouseDown.add(function(a,b){d.typing&&l()}),c.addShortcut("ctrl+z","undo_desc","Undo"),c.addShortcut("ctrl+y","redo_desc","Redo"),d={data:f,typing:!1,onAdd:h,onUndo:i,onRedo:j,beforeChange:function(){g=c.selection.getBookmark(2,!0)},add:function(a){var b,h=c.settings,i;a=a||{},a.content=k(),i=f[e];if(i&&i.content==a.content)return null;f[e]&&(f[e].beforeBookmark=g);if(h.custom_undo_redo_levels&&f.length>h.custom_undo_redo_levels){for(b=0;b<f.length-1;b++)f[b]=f[b+1];f.length--,e=f.length}return a.bookmark=c.selection.getBookmark(2,!0),e<f.length-1&&(f.length=e+1),f.push(a),e=f.length-1,d.onAdd.dispatch(d,a),c.isNotDirty=0,a},undo:function(){var a,b;return d.typing&&(d.add(),d.typing=!1),e>0&&(a=f[--e],c.setContent(a.content,{format:"raw"}),c.selection.moveToBookmark(a.beforeBookmark),d.onUndo.dispatch(d,a)),a},redo:function(){var a;return e<f.length-1&&(a=f[++e],c.setContent(a.content,{format:"raw"}),c.selection.moveToBookmark(a.bookmark),d.onRedo.dispatch(d,a)),a},clear:function(){f=[],e=0,d.typing=!1},hasUndo:function(){return e>0||this.typing},hasRedo:function(){return e<f.length-1&&!this.typing}},d}}(tinymce),tinymce.ForceBlocks=function(a){function f(){var f=d.getStart(),g=a.getBody(),h,i,j,k,l,m,n,o=-16777215,p;if(!f||f.nodeType!==1||!b.forced_root_block)return;while(f&&f!=g){if(e[f.nodeName])return;f=f.parentNode}h=d.getRng(),h.setStart?(i=h.startContainer,j=h.startOffset,k=h.endContainer,l=h.endOffset):(h.item&&(f=h.item(0),h=a.getDoc().body.createTextRange(),h.moveToElementText(f)),tmpRng=h.duplicate(),tmpRng.collapse(!0),j=tmpRng.move("character",o)*-1,tmpRng.collapsed||(tmpRng=h.duplicate(),tmpRng.collapse(!1),l=tmpRng.move("character",o)*-1-j)),f=g.firstChild;while(f)f.nodeType===3||f.nodeType==1&&!e[f.nodeName]?(m||(m=c.create(b.forced_root_block),f.parentNode.insertBefore(m,f),p=!0),n=f,f=f.nextSibling,m.appendChild(n)):(m=null,f=f.nextSibling);if(h.setStart)h.setStart(i,j),h.setEnd(k,l),d.setRng(h);else try{h=a.getDoc().body.createTextRange(),h.moveToElementText(g),h.collapse(!0),h.moveStart("character",j),l>0&&h.moveEnd("character",l),h.select()}catch(q){}p&&a.nodeChanged()}var b=a.settings,c=a.dom,d=a.selection,e=a.schema.getBlockElements();b.forced_root_block&&(a.onKeyUp.add(f),a.onNodeChange.add(f))},function(a){var b=a.DOM,c=a.dom.Event,d=a.each,e=a.extend;a.create("tinymce.ControlManager",{ControlManager:function(b,c){var e=this,f;c=c||{},e.editor=b,e.controls={},e.onAdd=new a.util.Dispatcher(e),e.onPostRender=new a.util.Dispatcher(e),e.prefix=c.prefix||b.id+"_",e._cls={},e.onPostRender.add(function(){d(e.controls,function(a){a.postRender()})})},get:function(a){return this.controls[this.prefix+a]||this.controls[a]},setActive:function(a,b){var c=null;return(c=this.get(a))&&c.setActive(b),c},setDisabled:function(a,b){var c=null;return(c=this.get(a))&&c.setDisabled(b),c},add:function(a){var b=this;return a&&(b.controls[a.id]=a,b.onAdd.dispatch(a,b)),a},createControl:function(a){var b,c=this,e=c.editor;d(e.plugins,function(d){if(d.createControl){b=d.createControl(a,c);if(b)return!1}});switch(a){case"|":case"separator":return c.createSeparator()}return!b&&e.buttons&&(b=e.buttons[a])?c.createButton(a,b):c.add(b)},createDropMenu:function(b,c,d){var f=this,g=f.editor,h,i,j,k;c=e({"class":"mceDropDown",constrain:g.settings.constrain_menus},c),c["class"]=c["class"]+" "+g.getParam("skin")+"Skin";if(j=g.getParam("skin_variant"))c["class"]+=" "+g.getParam("skin")+"Skin"+j.substring(0,1).toUpperCase()+j.substring(1);return c["class"]+=g.settings.directionality=="rtl"?" mceRtl":"",b=f.prefix+b,k=d||f._cls.dropmenu||a.ui.DropMenu,h=f.controls[b]=new k(b,c),h.onAddItem.add(function(a,b){var c=b.settings;c.title=g.getLang(c.title,c.title),c.onclick||(c.onclick=function(a){c.cmd&&g.execCommand(c.cmd,c.ui||!1,c.value)})}),g.onRemove.add(function(){h.destroy()}),a.isIE&&(h.onShowMenu.add(function(){g.focus(),i=g.selection.getBookmark(1)}),h.onHideMenu.add(function(){i&&(g.selection.moveToBookmark(i),i=0)})),f.add(h)},createListBox:function(b,d,f){function l(b){return b.settings.use_accessible_selects&&!a.isGecko}var g=this,h=g.editor,i,j,k;return g.get(b)?null:(d.title=h.translate(d.title),d.scope=d.scope||h,d.onselect||(d.onselect=function(a){h.execCommand(d.cmd,d.ui||!1,a||d.value)}),d=e({title:d.title,"class":"mce_"+b,scope:d.scope,control_manager:g},d),b=g.prefix+b,h.settings.use_native_selects||l(h)?j=new a.ui.NativeListBox(b,d):(k=f||g._cls.listbox||a.ui.ListBox,j=new k(b,d,h)),g.controls[b]=j,a.isWebKit&&j.onPostRender.add(function(a,b){c.add(b,"mousedown",function(){h.bookmark=h.selection.getBookmark(1)}),c.add(b,"focus",function(){h.selection.moveToBookmark(h.bookmark),h.bookmark=null})}),j.hideMenu&&h.onMouseDown.add(j.hideMenu,j),g.add(j))},createButton:function(b,c,d){var f=this,g=f.editor,h,i,j;return f.get(b)?null:(c.title=g.translate(c.title),c.label=g.translate(c.label),c.scope=c.scope||g,!c.onclick&&!c.menu_button&&(c.onclick=function(){g.execCommand(c.cmd,c.ui||!1,c.value)}),c=e({title:c.title,"class":"mce_"+b,unavailable_prefix:g.getLang("unavailable",""),scope:c.scope,control_manager:f},c),b=f.prefix+b,c.menu_button?(j=d||f._cls.menubutton||a.ui.MenuButton,i=new j(b,c,g),g.onMouseDown.add(i.hideMenu,i)):(j=f._cls.button||a.ui.Button,i=new j(b,c,g)),f.add(i))},createMenuButton:function(a,b,c){return b=b||{},b.menu_button=1,this.createButton(a,b,c)},createSplitButton:function(b,c,d){var f=this,g=f.editor,h,i,j;return f.get(b)?null:(c.title=g.translate(c.title),c.scope=c.scope||g,c.onclick||(c.onclick=function(a){g.execCommand(c.cmd,c.ui||!1,a||c.value)}),c.onselect||(c.onselect=function(a){g.execCommand(c.cmd,c.ui||!1,a||c.value)}),c=e({title:c.title,"class":"mce_"+b,scope:c.scope,control_manager:f},c),b=f.prefix+b,j=d||f._cls.splitbutton||a.ui.SplitButton,i=f.add(new j(b,c,g)),g.onMouseDown.add(i.hideMenu,i),i)},createColorSplitButton:function(b,c,d){var f=this,g=f.editor,h,i,j,k;return f.get(b)?null:(c.title=g.translate(c.title),c.scope=c.scope||g,c.onclick||(c.onclick=function(b){a.isIE&&(k=g.selection.getBookmark(1)),g.execCommand(c.cmd,c.ui||!1,b||c.value)}),c.onselect||(c.onselect=function(a){g.execCommand(c.cmd,c.ui||!1,a||c.value)}),c=e({title:c.title,"class":"mce_"+b,menu_class:g.getParam("skin")+"Skin",scope:c.scope,more_colors_title:g.getLang("more_colors")},c),b=f.prefix+b,j=d||f._cls.colorsplitbutton||a.ui.ColorSplitButton,i=new j(b,c,g),g.onMouseDown.add(i.hideMenu,i),g.onRemove.add(function(){i.destroy()}),a.isIE&&(i.onShowMenu.add(function(){g.focus(),k=g.selection.getBookmark(1)}),i.onHideMenu.add(function(){k&&(g.selection.moveToBookmark(k),k=0)})),f.add(i))},createToolbar:function(b,c,d){var e,f=this,g;return b=f.prefix+b,g=d||f._cls.toolbar||a.ui.Toolbar,e=new g(b,c,f.editor),f.get(b)?null:f.add(e)},createToolbarGroup:function(b,c,d){var e,f=this,g;return b=f.prefix+b,g=d||this._cls.toolbarGroup||a.ui.ToolbarGroup,e=new g(b,c,f.editor),f.get(b)?null:f.add(e)},createSeparator:function(b){var c=b||this._cls.separator||a.ui.Separator;return new c},setControlType:function(a,b){return this._cls[a.toLowerCase()]=b},destroy:function(){d(this.controls,function(a){a.destroy()}),this.controls=null}})}(tinymce),function(a){var b=a.util.Dispatcher,c=a.each,d=a.isIE,e=a.isOpera;a.create("tinymce.WindowManager",{WindowManager:function(a){var c=this;c.editor=a,c.onOpen=new b(c),c.onClose=new b(c),c.params={},c.features={}},open:function(b,f){var g=this,h="",i,j,k=g.editor.settings.dialog_type=="modal",l,m,n,o=a.DOM.getViewPort(),p;b=b||{},f=f||{},m=e?o.w:screen.width,n=e?o.h:screen.height,b.name=b.name||"mc_"+(new Date).getTime(),b.width=parseInt(b.width||320),b.height=parseInt(b.height||240),b.resizable=!0,b.left=b.left||parseInt(m/2)-b.width/2,b.top=b.top||parseInt(n/2)-b.height/2,f.inline=!1,f.mce_width=b.width,f.mce_height=b.height,f.mce_auto_focus=b.auto_focus,k&&d&&(b.center=!0,b.help=!1,b.dialogWidth=b.width+"px",b.dialogHeight=b.height+"px",b.scroll=b.scrollbars||!1),c(b,function(b,c){a.is(b,"boolean")&&(b=b?"yes":"no"),/^(name|url)$/.test(c)||(d&&k?h+=(h?";":"")+c+":"+b:h+=(h?",":"")+c+"="+b)}),g.features=b,g.params=f,g.onOpen.dispatch(g,b,f),p=b.url||b.file,p=a._addVer(p);try{d&&k?(l=1,window.showModalDialog(p,window,h)):l=window.open(p,b.name,h)}catch(q){}l||alert(g.editor.getLang("popup_blocked"))},close:function(a){a.close(),this.onClose.dispatch(this)},createInstance:function(b,c,d,e,f,g){var h=a.resolve(b);return new h(c,d,e,f,g)},confirm:function(a,b,c,d){d=d||window,b.call(c||this,d.confirm(this._decode(this.editor.getLang(a,a))))},alert:function(a,b,c,d){var e=this;d=d||window,d.alert(e._decode(e.editor.getLang(a,a))),b&&b.call(c||e)},resizeBy:function(a,b,c){c.resizeBy(a,b)},_decode:function(b){return a.DOM.decode(b).replace(/\\n/g,"\n")}})}(tinymce),function(a){a.Formatter=function(b){function s(a){return a instanceof Array}function t(a,b){return e.getParents(a,b,e.getRoot())}function u(a){return a.nodeType===1&&a.id==="_mce_caret"}function v(){y({alignleft:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},defaultBlock:"div"},{selector:"img",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"}},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},defaultBlock:"div"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignfull:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"},defaultBlock:"div"}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all"}],strikethrough:[{inline:"span",styles:{textDecoration:"line-through"},exact:!0},{inline:"strike",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:!1},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:!1},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(a){return!0},onformat:function(a,b,c){d(c,function(b,c){e.setAttrib(a,c,b)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]}),d("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),function(a){y(a,{block:a,remove:"all"})}),y(b.settings.formats)}function w(){b.addShortcut("ctrl+b","bold_desc","Bold"),b.addShortcut("ctrl+i","italic_desc","Italic"),b.addShortcut("ctrl+u","underline_desc","Underline");for(var a=1;a<=6;a++)b.addShortcut("ctrl+"+a,"",["FormatBlock",!1,"h"+a]);b.addShortcut("ctrl+7","",["FormatBlock",!1,"p"]),b.addShortcut("ctrl+8","",["FormatBlock",!1,"div"]),b.addShortcut("ctrl+9","",["FormatBlock",!1,"address"])}function x(a){return a?c[a]:c}function y(a,b){a&&(typeof a!="string"?d(a,function(a,b){y(b,a)}):(b=b.length?b:[b],d(b,function(a){a.deep===q&&(a.deep=!a.selector),a.split===q&&(a.split=!a.selector||a.inline),a.remove===q&&a.selector&&!a.inline&&(a.remove="none"),a.selector&&a.inline&&(a.mixed=!0,a.block_expand=!0),typeof a.classes=="string"&&(a.classes=a.classes.split(/\s+/))}),c[a]=b))}function B(c,l,m){function y(a,b){b=b||q,a&&(b.onformat&&b.onformat(a,b,l,m),d(b.styles,function(b,c){e.setStyle(a,c,L(b,l))}),d(b.attributes,function(b,c){e.setAttrib(a,c,L(b,l))}),d(b.classes,function(b){b=L(b,l),e.hasClass(a,b)||e.addClass(a,b)}))}function z(){function a(a,b){var c=new g(b);for(m=c.current();m;m=c.prev())if(m.childNodes.length>1||m==a||m.tagName=="BR")return m}var c=b.selection.getRng(),d=c.startContainer,e=c.endContainer;if(d!=e&&c.endOffset===0){var f=a(d,e),h=f.nodeType==3?f.length:f.childNodes.length;c.setEnd(f,h)}return c}function C(b,c,f,g,h){var i=[],j=-1,k,l=-1,m=-1,n;return d(b.childNodes,function(a,b){if(a.nodeName==="UL"||a.nodeName==="OL")return j=b,k=a,!1}),d(b.childNodes,function(a,b){a.nodeName==="SPAN"&&e.getAttrib(a,"data-mce-type")=="bookmark"&&(a.id==c.id+"_start"?l=b:a.id==c.id+"_end"&&(m=b))}),j<=0||l<j&&m>j?(d(a.grep(b.childNodes),h),0):(n=e.clone(f,o),d(a.grep(b.childNodes),function(a,b){if(l<j&&b<j||l>j&&b>j)i.push(a),a.parentNode.removeChild(a)}),l<j?b.insertBefore(n,k):l>j&&b.insertBefore(n,k.nextSibling),g.push(n),d(i,function(a){n.appendChild(a)}),n)}function D(b,f,g){var k=[],m,s,t=!0;m=q.inline||q.block,s=e.create(m),y(s),h.walk(b,function(b){function j(b){var p,v,x,z,A;A=t,p=b.nodeName.toLowerCase(),v=b.parentNode.nodeName.toLowerCase(),b.nodeType===1&&r(b)&&(A=t,t=r(b)==="true",z=!0);if(J(p,"br")){h=0,q.block&&e.remove(b);return}if(q.wrapper&&E(b,c,l)){h=0;return}if(t&&!z&&q.block&&!q.wrapper&&U(p)){b=e.rename(b,m),y(b),k.push(b),h=0;return}if(q.selector){d(n,function(a){if("collapsed"in a&&a.collapsed!==w)return;e.is(b,a.selector)&&!u(b)&&(y(b,a),x=!0)});if(!q.inline||x){h=0;return}}t&&!z&&i(m,p)&&i(v,m)&&(!!g||b.nodeType!==3||b.nodeValue.length!==1||b.nodeValue.charCodeAt(0)!==65279)&&!u(b)?(h||(h=e.clone(s,o),b.parentNode.insertBefore(h,b),k.push(h)),h.appendChild(b)):p=="li"&&f?h=C(b,f,s,k,j):(h=0,d(a.grep(b.childNodes),j),z&&(t=A),h=0)}var h;d(b,j)}),q.wrap_links===!1&&d(k,function(b){function c(b){var f,g,h;if(b.nodeName==="A"){g=e.clone(s,o),k.push(g),h=a.grep(b.childNodes);for(f=0;f<h.length;f++)g.appendChild(h[f]);b.appendChild(g)}d(a.grep(b.childNodes),c)}c(b)}),d(k,function(a){function f(a){var b=0;return d(a.childNodes,function(a){!M(a)&&!S(a)&&b++}),b}function g(a){var b,c;return d(a.childNodes,function(a){if(a.nodeType==1&&!S(a)&&!u(a))return b=a,o}),b&&I(b,q)&&(c=e.clone(b,o),y(c),e.replace(c,a,p),e.remove(b,1)),c||a}var b;b=f(a);if((k.length>1||!j(a))&&b===0){e.remove(a,1);return}if(q.inline||q.wrapper){!q.exact&&b===1&&(a=g(a)),d(n,function(b){d(e.select(b.inline,a),function(a){var c;if(b.wrap_links===!1){c=a.parentNode;do if(c.nodeName==="A")return;while(c=c.parentNode)}P(b,l,a,b.exact?a:null)})});if(E(a.parentNode,c,l))return e.remove(a,1),a=0,p;q.merge_with_parents&&e.getParent(a.parentNode,function(b){if(E(b,c,l))return e.remove(a,1),a=0,p}),a&&q.merge_siblings!==!1&&(a=T(R(a),a),a=T(a,R(a,p)))}})}var n=x(c),q=n[0],s,t,v,w=f.isCollapsed();if(q)if(m)m.nodeType?(t=e.createRng(),t.setStartBefore(m),t.setEndAfter(m),D(O(t,n),null,!0)):D(m,null,!0);else if(!w||!q.inline||e.select("td.mceSelected,th.mceSelected").length){var F=b.selection.getNode();!k&&n[0].defaultBlock&&!e.getParent(F,e.isBlock)&&B(n[0].defaultBlock),b.selection.setRng(z()),s=f.getBookmark(),D(O(f.getRng(p),n),s),q.styles&&(q.styles.color||q.styles.textDecoration)&&(a.walk(F,A,"childNodes"),A(F)),f.moveToBookmark(s),X(f.getRng(p)),b.nodeChanged()}else W("apply",c,l)}function C(c,g,i){function v(b){var c,d,e,f,h,i;b.nodeType===1&&r(b)&&(h=u,u=r(b)==="true",i=!0),c=a.grep(b.childNodes);if(u&&!i)for(d=0,e=k.length;d<e;d++)if(P(k[d],g,b,b))break;if(m.deep&&c.length){for(d=0,e=c.length;d<e;d++)v(c[d]);i&&(u=h)}}function w(a){var b;return d(t(a.parentNode).reverse(),function(a){var d;!b&&a.id!="_start"&&a.id!="_end"&&(d=E(a,c,g),d&&d.split!==!1&&(b=a))}),b}function y(a,b,c,d){var f,h,i,l,n,p;if(a){p=a.parentNode;for(f=b.parentNode;f&&f!=p;f=f.parentNode){h=e.clone(f,o);for(n=0;n<k.length;n++)if(P(k[n],g,h,h)){h=0;break}h&&(i&&h.appendChild(i),l||(l=h),i=h)}d&&(!m.mixed||!j(a))&&(b=e.split(a,b)),i&&(c.parentNode.insertBefore(i,c),l.appendChild(c))}return b}function A(a){return y(w(a),a,a,!0)}function B(a){var b=e.get(a?"_start":"_end"),c=b[a?"firstChild":"lastChild"];return S(c)&&(c=c[a?"firstChild":"lastChild"]),e.remove(b,!0),c}function C(a){var c,e,f;a=O(a,k,p),m.split&&(c=V(a,p),e=V(a),c!=e?(/^(TR|TD)$/.test(c.nodeName)&&c.firstChild&&(c=(c.nodeName=="TD"?c.firstChild:c.firstChild.firstChild)||c),c=N(c,"span",{id:"_start","data-mce-type":"bookmark"}),e=N(e,"span",{id:"_end","data-mce-type":"bookmark"}),A(c),A(e),c=B(p),e=B()):c=e=A(c),a.startContainer=c.parentNode,a.startOffset=l(c),a.endContainer=e.parentNode,a.endOffset=l(e)+1),h.walk(a,function(a){d(a,function(a){v(a),a.nodeType===1&&b.dom.getStyle(a,"text-decoration")==="underline"&&a.parentNode&&z(a.parentNode)==="underline"&&P({deep:!1,exact:!0,inline:"span",styles:{textDecoration:"underline"}},null,a)})})}var k=x(c),m=k[0],n,q,s,u=!0;if(i){i.nodeType?(s=e.createRng(),s.setStartBefore(i),s.setEndAfter(i),C(s)):C(i);return}!f.isCollapsed()||!m.inline||e.select("td.mceSelected,th.mceSelected").length?(n=f.getBookmark(),C(f.getRng(p)),f.moveToBookmark(n),m.inline&&F(c,g,f.getStart())&&X(f.getRng(!0)),b.nodeChanged()):W("remove",c,g)}function D(a,b,c){var d=x(a);!F(a,b,c)||"toggle"in d[0]&&!d[0].toggle?B(a,b,c):C(a,b,c)}function E(a,b,c,d){function j(a,b,f){var g,h,i=b[f],j;if(b.onmatch)return b.onmatch(a,b,f);if(i)if(i.length===q){for(g in i)if(i.hasOwnProperty(g)){f==="attributes"?h=e.getAttrib(a,g):h=K(a,g);if(d&&!h&&!b.exact)return;if((!d||b.exact)&&!J(h,L(i[g],c)))return}}else for(j=0;j<i.length;j++)if(f==="attributes"?e.getAttrib(a,i[j]):K(a,i[j]))return b;return b}var f=x(b),g,h,i;if(f&&a)for(h=0;h<f.length;h++){g=f[h];if(I(a,g)&&j(a,g,"attributes")&&j(a,g,"styles")){if(i=g.classes)for(h=0;h<i.length;h++)if(!e.hasClass(a,i[h]))return;return g}}}function F(a,b,c){function g(c){return c=e.getParent(c,function(c){return!!E(c,a,b,!0)}),E(c,a,b)}var d;return c?g(c):(c=f.getNode(),g(c)?p:(d=f.getStart(),d!=c&&g(d)?p:o))}function G(a,b){var c,d=[],g={},h,i,j;return c=f.getStart(),e.getParent(c,function(c){var e,f;for(e=0;e<a.length;e++)f=a[e],!g[f]&&E(c,f,b)&&(g[f]=!0,d.push(f))}),d}function H(a){var b=x(a),c,d,g,h,i;if(b){c=f.getStart(),d=t(c);for(h=b.length-1;h>=0;h--){i=b[h].selector;if(!i)return p;for(g=d.length-1;g>=0;g--)if(e.is(d[g],i))return p}}return o}function I(a,b){if(J(a,b.inline))return p;if(J(a,b.block))return p;if(b.selector)return e.is(a,b.selector)}function J(a,b){return a=a||"",b=b||"",a=""+(a.nodeName||a),b=""+(b.nodeName||b),a.toLowerCase()==b.toLowerCase()}function K(a,b){var c=e.getStyle(a,b);if(b=="color"||b=="backgroundColor")c=e.toHex(c);return b=="fontWeight"&&c==700&&(c="bold"),""+c}function L(a,b){return typeof a!="string"?a=a(b):b&&(a=a.replace(/%(\w+)/g,function(a,c){return b[c]||a})),a}function M(a){return a&&a.nodeType===3&&/^([\t \r\n]+|)$/.test(a.nodeValue)}function N(a,b,c){var d=e.create(b,c);return a.parentNode.insertBefore(d,a),d.appendChild(a),d}function O(a,c,d){function u(a){var b,d,f,g,h,i;b=d=a?m:p,h=a?"previousSibling":"nextSibling",i=e.getRoot();if(b.nodeType==3&&!M(b))if(a?n>0:s<b.nodeValue.length)return b;for(;;){if(!c[0].block_expand&&j(d))return d;for(g=d[h];g;g=g[h])if(!S(g)&&!M(g))return d;if(d.parentNode==i){b=d;break}d=d.parentNode}return b}function v(a,b){b===q&&(b=a.nodeType===3?a.length:a.childNodes.length);while(a&&a.hasChildNodes())a=a.childNodes[b],a&&(b=a.nodeType===3?a.length:a.childNodes.length);return{node:a,offset:b}}function w(a){var b=a;while(b){if(b.nodeType===1&&r(b))return r(b)==="false"?b:a;b=b.parentNode}return a}function x(a,c,f){function m(a,b){var c,e,g=a.nodeValue;return typeof b=="undefined"&&(b=f?g.length:0),f?(c=g.lastIndexOf(" ",b),e=g.lastIndexOf(" ",b),c=c>e?c:e,c!==-1&&!d&&c++):(c=g.indexOf(" ",b),e=g.indexOf(" ",b),c=c!==-1&&(e===-1||c<e)?c:e),c}var h,i,k,l;if(a.nodeType===3){k=m(a,c);if(k!==-1)return{container:a,offset:k};l=a}h=new g(a,e.getParent(a,j)||b.getBody());while(i=h[f?"prev":"next"]())if(i.nodeType===3){l=i,k=m(i);if(k!==-1)return{container:i,offset:k}}else if(j(i))break;if(l)return f?c=0:c=l.length,{container:l,offset:c}}function y(b,d){var f,g,h,i;b.nodeType==3&&b.nodeValue.length===0&&b[d]&&(b=b[d]),f=t(b);for(g=0;g<f.length;g++)for(h=0;h<c.length;h++){i=c[h];if("collapsed"in i&&i.collapsed!==a.collapsed)continue;if(e.is(f[g],i.selector))return f[g]}return b}function z(a,b,d){var f;c[0].wrapper||(f=e.getParent(a,c[0].block)),f||(f=e.getParent(a.nodeType==3?a.parentNode:a,j)),f&&c[0].wrapper&&(f=t(f,"ul,ol").reverse()[0]||f);if(!f){f=a;while(f[b]&&!j(f[b])){f=f[b];if(J(f,"br"))break}}return f||a}var f,h,i,k,m=a.startContainer,n=a.startOffset,p=a.endContainer,s=a.endOffset;m.nodeType==1&&m.hasChildNodes()&&(h=m.childNodes.length-1,m=m.childNodes[n>h?h:n],m.nodeType==3&&(n=0)),p.nodeType==1&&p.hasChildNodes()&&(h=p.childNodes.length-1,p=p.childNodes[s>h?h:s-1],p.nodeType==3&&(s=p.nodeValue.length)),m=w(m),p=w(p);if(S(m.parentNode)||S(m))m=S(m)?m:m.parentNode,m=m.nextSibling||m,m.nodeType==3&&(n=0);if(S(p.parentNode)||S(p))p=S(p)?p:p.parentNode,p=p.previousSibling||p,p.nodeType==3&&(s=p.length);if(c[0].inline){a.collapsed&&(k=x(m,n,!0),k&&(m=k.container,n=k.offset),k=x(p,s),k&&(p=k.container,s=k.offset)),i=v(p,s);if(i.node){while(i.node&&i.offset===0&&i.node.previousSibling)i=v(i.node.previousSibling);i.node&&i.offset>0&&i.node.nodeType===3&&i.node.nodeValue.charAt(i.offset-1)===" "&&i.offset>1&&(p=i.node,p.splitText(i.offset-1))}}if(c[0].inline||c[0].block_expand){if(!c[0].inline||m.nodeType!=3||n===0)m=u(!0);if(!c[0].inline||p.nodeType!=3||s===p.nodeValue.length)p=u()}c[0].selector&&c[0].expand!==o&&!c[0].inline&&(m=y(m,"previousSibling"),p=y(p,"nextSibling"));if(c[0].block||c[0].selector)m=z(m,"previousSibling"),p=z(p,"nextSibling"),c[0].block&&(j(m)||(m=u(!0)),j(p)||(p=u()));return m.nodeType==1&&(n=l(m),m=m.parentNode),p.nodeType==1&&(s=l(p)+1,p=p.parentNode),{startContainer:m,startOffset:n,endContainer:p,endOffset:s}}function P(a,b,c,f){var g,h,i;if(!I(c,a))return o;if(a.remove!="all"){d(a.styles,function(a,d){a=L(a,b),typeof d=="number"&&(d=a,f=0),(!f||J(K(f,d),a))&&e.setStyle(c,d,""),i=1}),i&&e.getAttrib(c,"style")==""&&(c.removeAttribute("style"),c.removeAttribute("data-mce-style")),d(a.attributes,function(a,g){var h;a=L(a,b),typeof g=="number"&&(g=a,f=0);if(!f||J(e.getAttrib(f,g),a)){if(g=="class"){a=e.getAttrib(c,g);if(a){h="",d(a.split(/\s+/),function(a){/mce\w+/.test(a)&&(h+=(h?" ":"")+a)});if(h){e.setAttrib(c,g,h);return}}}g=="class"&&c.removeAttribute("className"),n.test(g)&&c.removeAttribute("data-mce-"+g),c.removeAttribute(g)}}),d(a.classes,function(a){a=L(a,b),(!f||e.hasClass(f,a))&&e.removeClass(c,a)}),h=e.getAttribs(c);for(g=0;g<h.length;g++)if(h[g].nodeName.indexOf("_")!==0)return o}if(a.remove!="none")return Q(c,a),p}function Q(b,c){function h(a,b,c){return a=R(a,b,c),!a||a.nodeName=="BR"||j(a)}var f=b.parentNode,g;c.block&&(k?f==e.getRoot()&&(!c.list_block||!J(b,c.list_block))&&d(a.grep(b.childNodes),function(a){i(k,a.nodeName.toLowerCase())?g?g.appendChild(a):g=N(a,k):g=0}):j(b)&&!j(f)&&(!h(b,o)&&!h(b.firstChild,p,1)&&b.insertBefore(e.create("br"),b.firstChild),!h(b,p)&&!h(b.lastChild,o,1)&&b.appendChild(e.create("br"))));if(c.selector&&c.inline&&!J(c.inline,b))return;e.remove(b,1)}function R(a,b,c){if(a){b=b?"nextSibling":"previousSibling";for(a=c?a:a[b];a;a=a[b])if(a.nodeType==1||!M(a))return a}}function S(a){return a&&a.nodeType==1&&a.getAttribute("data-mce-type")=="bookmark"}function T(b,c){function i(a,b){function c(a){var b={};return d(e.getAttribs(a),function(c){var d=c.nodeName.toLowerCase();d.indexOf("_")!==0&&d!=="style"&&(b[d]=e.getAttrib(a,d))}),b}function f(a,b){var c,d;for(d in a)if(a.hasOwnProperty(d)){c=b[d];if(c===q)return o;if(a[d]!=c)return o;delete b[d]}for(d in b)if(b.hasOwnProperty(d))return o;return p}return a.nodeName!=b.nodeName?o:f(c(a),c(b))?f(e.parseStyle(e.getAttrib(a,"style")),e.parseStyle(e.getAttrib(b,"style")))?p:o:o}function j(a,b){for(g=a;g;g=g[b]){if(g.nodeType==3&&g.nodeValue.length!==0)return a;if(g.nodeType==1&&!S(g))return g}return a}var f,g,h;if(b&&c){b=j(b,"previousSibling"),c=j(c,"nextSibling");if(i(b,c)){for(g=b.nextSibling;g&&g!=c;)h=g,g=g.nextSibling,b.appendChild(h);return e.remove(c),d(a.grep(c.childNodes),function(a){b.appendChild(a)}),b}}return c}function U(a){return/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(a)}function V(a,c){var d,e,f,h;return d=a[c?"startContainer":"endContainer"],e=a[c?"startOffset":"endOffset"],d.nodeType==1&&(f=d.childNodes.length-1,!c&&e&&e--,d=d.childNodes[e>f?f:e]),d.nodeType===3&&c&&e>=d.nodeValue.length&&(d=(new g(d,b.getBody())).next()||d),d.nodeType===3&&!c&&e===0&&(d=(new g(d,b.getBody())).prev()||d),d}function W(c,d,i){function l(a){var c=e.create("span",{id:j,"data-mce-bogus":!0,style:k?"color:red":""});return a&&c.appendChild(b.getDoc().createTextNode(m)),c}function n(a,b){while(a){if(a.nodeType===3&&a.nodeValue!==m||a.childNodes.length>1)return!1;b&&a.nodeType===1&&b.push(a),a=a.firstChild}return!0}function o(a){while(a){if(a.id===j)return a;a=a.parentNode}}function p(a){var b;if(a){b=new g(a,a);for(a=b.current();a;a=b.next())if(a.nodeType===3)return a}}function q(a,b){var c,d;if(!a){a=o(f.getStart());if(!a)while(a=e.get(j))q(a,!1)}else d=f.getRng(!0),n(a)?(b!==!1&&(d.setStartBefore(a),d.setEndBefore(a)),e.remove(a)):(c=p(a),c.nodeValue.charAt(0)===m&&(c=c.deleteData(0,1)),e.remove(a,1)),f.setRng(d)}function r(){var a,b,c,e,g,j,k;a=f.getRng(!0),e=a.startOffset,j=a.startContainer,k=j.nodeValue,b=o(f.getStart()),b&&(c=p(b)),k&&e>0&&e<k.length&&/\w/.test(k.charAt(e))&&/\w/.test(k.charAt(e-1))?(g=f.getBookmark(),a.collapse(!0),a=O(a,x(d)),a=h.split(a),B(d,i,a),f.moveToBookmark(g)):(!b||c.nodeValue!==m?(b=l(!0),c=b.firstChild,a.insertNode(b),e=1,B(d,i,b)):B(d,i,b),f.setCursorLocation(c,e))}function s(){var a=f.getRng(!0),b,c,g,j,k,n,o=[],p,q;b=a.startContainer,c=a.startOffset,k=b;if(b.nodeType==3){if(c!=b.nodeValue.length||b.nodeValue===m)j=!0;k=k.parentNode}while(k){if(E(k,d,i)){n=k;break}k.nextSibling&&(j=!0),o.push(k),k=k.parentNode}if(!n)return;if(j)g=f.getBookmark(),a.collapse(!0),a=O(a,x(d),!0),a=h.split(a),C(d,i,a),f.moveToBookmark(g);else{q=l(),k=q;for(p=o.length-1;p>=0;p--)k.appendChild(e.clone(o[p],!1)),k=k.firstChild;k.appendChild(e.doc.createTextNode(m)),k=k.firstChild,e.insertAfter(q,n),f.setCursorLocation(k,1)}}var j="_mce_caret",k=b.settings.caret_debug;self._hasCaretEvents||(b.onBeforeGetContent.addToTop(function(){var a=[],b;if(n(o(f.getStart()),a)){b=a.length;while(b--)e.setAttrib(a[b],"data-mce-bogus","1")}}),a.each("onMouseUp onKeyUp".split(" "),function(a){b[a].addToTop(function(){q()})}),b.onKeyDown.addToTop(function(a,b){var c=b.keyCode;(c==8||c==37||c==39)&&q(o(f.getStart()))}),f.onSetContent.add(function(){e.getParent(f.getStart(),function(a){a.id!==j&&e.getAttrib(a,"data-mce-bogus")&&!e.isEmpty(a)&&e.setAttrib(a,"data-mce-bogus",null)})}),self._hasCaretEvents=!0),c=="apply"?r():s()}function X(a){var b=a.startContainer,c=a.startOffset,d,h,i,j,k;b.nodeType==3&&c>=b.nodeValue.length&&(c=l(b),b=b.parentNode,d=!0);if(b.nodeType==1){j=b.childNodes,b=j[Math.min(c,j.length-1)],h=new g(b,e.getParent(b,e.isBlock)),(c>j.length-1||d)&&h.next();for(i=h.current();i;i=h.next())if(i.nodeType==3&&!M(i)){k=e.create("a",null,m),i.parentNode.insertBefore(k,i),a.setStart(i,0),f.setRng(a),e.remove(k);return}}}var c={},d=a.each,e=b.dom,f=b.selection,g=a.dom.TreeWalker,h=new a.dom.RangeUtils(e),i=b.schema.isValidChild,j=e.isBlock,k=b.settings.forced_root_block,l=e.nodeIndex,m=a.isGecko?"​":"﻿",n=/^(src|href|style)$/,o=!1,p=!0,q,r=e.getContentEditable,z=function(a){var c;return b.dom.getParent(a,function(a){return c=b.dom.getStyle(a,"text-decoration"),c&&c!=="none"}),c},A=function(a){var c;a.nodeType===1&&a.parentNode&&a.parentNode.nodeType===1&&(c=z(a.parentNode),b.dom.getStyle(a,"color")&&c?b.dom.setStyle(a,"text-decoration",c):b.dom.getStyle(a,"textdecoration")===c&&b.dom.setStyle(a,"text-decoration",null))};a.extend(this,{get:x,register:y,apply:B,remove:C,toggle:D,match:F,matchAll:G,matchNode:E,canApply:H}),v(),w()}}(tinymce),tinymce.onAddEditor.add(function(a,b){function g(b,c){a.each(c,function(a,c){a&&e.setStyle(b,c,a)}),e.rename(b,"span")}function h(d,g){e=d.dom,f.convert_fonts_to_spans&&a.each(e.select("font,u,strike",g.node),function(a){c[a.nodeName.toLowerCase()](b.dom,a)})}var c,d,e,f=b.settings;f.inline_styles&&(d=a.explode(f.font_size_legacy_values),c={font:function(a,b){g(b,{backgroundColor:b.style.backgroundColor,color:b.color,fontFamily:b.face,fontSize:d[parseInt(b.size,10)-1]})},u:function(a,b){g(b,{textDecoration:"underline"})},strike:function(a,b){g(b,{textDecoration:"line-through"})}},b.onPreProcess.add(h),b.onSetContent.add(h),b.onInit.add(function(){b.selection.onSetContent.add(h)}))}),function(a){var b=a.dom.TreeWalker;a.EnterKey=function(c){function h(h){function w(a){return a&&d.isBlock(a)&&!/^(TD|TH|CAPTION)$/.test(a.nodeName)&&!/^(fixed|absolute)/i.test(a.style.position)&&d.getContentEditable(a)!=="true"}function x(a){var f,g,h,i,j,k=a,l;h=d.createRng();if(a.hasChildNodes()){f=new b(a,a);while(g=f.current()){if(g.nodeType==3){h.setStart(g,0),h.setEnd(g,0);break}if(/^(BR|IMG)$/.test(g.nodeName)){h.setStartBefore(g),h.setEndBefore(g);break}k=g,g=f.next()}g||(h.setStart(k,0),h.setEnd(k,0))}else if(a.nodeName=="BR")if(a.nextSibling&&d.isBlock(a.nextSibling)){if(!o||o<9)l=d.create("br"),a.parentNode.insertBefore(l,a);h.setStartBefore(a),h.setEndBefore(a)}else h.setStartAfter(a),h.setEndAfter(a);else h.setStart(a,0),h.setEnd(a,0);e.setRng(h),d.remove(l),j=d.getViewPort(c.getWin()),i=d.getPos(a).y,(i<j.y||i+25>j.y+j.h)&&c.getWin().scrollTo(0,i<j.y?i:i-j.h+25)}function y(b){var c=l,e,g,h;e=b||s=="TABLE"?d.create(b||u):n.cloneNode(!1),h=e;if(f.keep_styles!==!1)do/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(c.nodeName)&&(g=c.cloneNode(!1),d.setAttrib(g,"id",""),e.hasChildNodes()?(g.appendChild(e.firstChild),e.appendChild(g)):(h=g,e.appendChild(g)));while(c=c.parentNode);return a.isIE||(h.innerHTML="<br>"),e}function z(a){var c,d,e;if(l.nodeType==3&&(a?m>0:m<l.nodeValue.length))return!1;if(l.parentNode==n&&v&&!a)return!0;if(l.nodeName==="TABLE"||l.previousSibling&&l.previousSibling.nodeName=="TABLE")return v&&!a||!v&&a;c=new b(l,n);while(d=a?c.prev():c.next())if(d.nodeType===1){if(d.getAttribute("data-mce-bogus"))continue;e=d.nodeName.toLowerCase();if(e==="IMG")return!1}else if(d.nodeType===3&&!/^[ \t\r\n]*$/.test(d.nodeValue))return!1;return!0}function A(a,b){var c,e,f,g,h,j=u||"P";e=d.getParent(a,d.isBlock);if(!e||!w(e)){e=e||k;if(!e.hasChildNodes())return c=d.create(j),e.appendChild(c),i.setStart(c,0),i.setEnd(c,0),c;g=a;while(g.parentNode!=e)g=g.parentNode;while(g&&!d.isBlock(g))f=g,g=g.previousSibling;if(f){c=d.create(j),f.parentNode.insertBefore(c,f),g=f;while(g&&!d.isBlock(g))h=g.nextSibling,c.appendChild(g),g=h;i.setStart(a,b),i.setEnd(a,b)}}return a}function B(){function a(a){var b=r[a?"firstChild":"lastChild"];while(b){if(b.nodeType==1)break;b=b[a?"nextSibling":"previousSibling"]}return b===n}p=u?y(u):d.create("BR"),a(!0)&&a()?d.replace(p,r):a(!0)?r.parentNode.insertBefore(p,r):a()?d.insertAfter(p,r):(j=i.cloneRange(),j.setStartAfter(n),j.setEndAfter(r),q=j.extractContents(),d.insertAfter(q,r),d.insertAfter(p,r)),d.remove(n),x(p),g.add()}function C(){var a=new b(l,n),c;while(c=a.current()){if(c.nodeName=="BR")return!0;c=a.next()}}function D(){var b,c;l&&l.nodeType==3&&m>=l.nodeValue.length&&!a.isIE&&!C()&&(b=d.create("br"),i.insertNode(b),i.setStartAfter(b),i.setEndAfter(b),c=!0),b=d.create("br"),i.insertNode(b),a.isIE&&s=="PRE"&&(!o||o<8)&&b.parentNode.insertBefore(d.doc.createTextNode("\r"),b),c?(i.setStartBefore(b),i.setEndBefore(b)):(i.setStartAfter(b),i.setEndAfter(b)),e.setRng(i),g.add()}function E(a){do a.nodeType===3&&(a.nodeValue=a.nodeValue.replace(/^[\r\n]+/,"")),a=a.firstChild;while(a)}function F(a){var b=d.getRoot(),c,e;c=a;while(c!==b&&d.getContentEditable(c)!=="false")d.getContentEditable(c)==="true"&&(e=c),c=c.parentNode;return c!==b?e:b}var i=e.getRng(!0),j,k,l,m,n,o,p,q,r,s,t,u,v;if(!i.collapsed){c.execCommand("Delete");return}if(h.isDefaultPrevented())return;l=i.startContainer,m=i.startOffset,u=f.forced_root_block,u=u?u.toUpperCase():"",o=d.doc.documentMode,l.nodeType==1&&l.hasChildNodes()&&(v=m>l.childNodes.length-1,l=l.childNodes[Math.min(m,l.childNodes.length-1)]||l,m=0),k=F(l);if(!k)return;g.beforeChange();if(!d.isBlock(k)&&k!=d.getRoot()){(!u||h.shiftKey)&&D();return}if(u&&!h.shiftKey||!u&&h.shiftKey)l=A(l,m);n=d.getParent(l,d.isBlock),r=n?d.getParent(n.parentNode,d.isBlock):null,s=n?n.nodeName.toUpperCase():"",t=r?r.nodeName.toUpperCase():"";if(s=="LI"&&d.isEmpty(n)){if(/^(UL|OL|LI)$/.test(r.parentNode.nodeName))return!1;B();return}if(s=="PRE"&&f.br_in_pre!==!1){if(!h.shiftKey){D();return}}else if(!u&&!h.shiftKey&&s!="LI"||u&&h.shiftKey){D();return}u=u||"P",z()?(/^(H[1-6]|PRE)$/.test(s)&&t!="HGROUP"?p=y(u):p=y(),f.end_container_on_empty_block&&w(r)&&d.isEmpty(n)?p=d.split(r,n):d.insertAfter(p,n)):z(!0)?p=n.parentNode.insertBefore(y(),n):(j=i.cloneRange(),j.setEndAfter(n),q=j.extractContents(),E(q),p=q.firstChild,d.insertAfter(q,n)),d.setAttrib(p,"id",""),x(p),g.add()}var d=c.dom,e=c.selection,f=c.settings,g=c.undoManager;c.onKeyDown.add(function(a,b){b.keyCode==13&&h(b)!==!1&&b.preventDefault()})}}(tinymce),define("patterns/../../lib/tiny_mce/tiny_mce_src",function(){}),define("lib/ajax",["require","../logging"],function(a){var b=a("../logging").getLogger("ajaxlib"),c=function(a,c){c.context=a,c.error=function(a,c,d,e){b.error(arguments)},a.is("form")?(b.debug("form submit",a),c.url=a.attr("action"),c.beforeSerialize&&c.beforeSerialize(),c.data=a.serialize()+"&submit=submit",c.type="POST",$.ajax(c)):(b.debug("submit",a),$.ajax(c))};return c}),define("patterns/edit-tinymce",["require","../../lib/tiny_mce/tiny_mce_src","../lib/ajax","../logging"],function(a){var b=a("../logging").getLogger("edit-tinymce"),c=a("../lib/ajax"),d=function(a,d){var e=a.parents("form"),f=e.find("[type=reset]"),g=a.attr("id");if(!g){var h=e.attr("id"),i=a.attr("name");if(!h)return b.error("Textarea or parent form needs an id",a,e),!1;if(!i)return b.error("Textarea needs a name",a),!1;g=h+"_"+i;if($("#"+g).length>0)return b.error("Textarea needs an id",a),!1;a.attr({id:g})}var j=a.data("tinymce-json");j||(b.info("data-tinymce-json empty, using default config",a),j="{}"),j.elements=g,j.mode="exact",j.readonly=Boolean(a.attr("readonly"));var k=tinyMCE.init(j),l={beforeSerialize:function(a){return function(){tinyMCE.editors[a].save()}}(g)};return e.on("submit",function(a){a.preventDefault(),c(e,l)}),f.on("click",function(a){return function(b){b.preventDefault(),tinyMCE.editors[a].load()}}(g)),a},e={markup_trigger:"form textarea.edit-tinymce",initialised_class:"edit-tinymce",init:d};return e}),define("patterns/expandable",["require"],function(a){var b=function(a,b){a.find(".folder[data-inject]:not(:has(ul))").append("<ul />");var c=a.find("li.folder:has(ul)");c.prepend('<span class="toggle"></span>'),c.filter(":not(.open,.closed)").addClass("closed"),c.filter(".open").trigger("patterns-folder-open");var d=a.find("span.toggle");d.each(function(){var a=$(this),b=a.parent();a.on("click",function(a){b.toggleClass("open closed"),b.filter(".open").trigger("patterns-folder-open")})})},c={markup_trigger:"ul.expandable",initialised_class:"expandable",init:b};return c}),define("lib/inject",["require"],function(a){var b=function(a,b){var c=function(c,d,e){return d===undefined&&(d=this),d=b(c,d),e=e||{},e.method=a,e.$sources=c,d.trigger("inject",e),d};return c},c={},d="tmp-inject-marker";return c.content=b("content",function(a,b){return b.each(function(){$(this).html(a.html())}),b}),c.replace=b("replace",function(a,b){return b.length===1?(b.replaceWith(a),a):(b.each(function(){$(this).replaceWith(a.clone().addClass(d))}),$("."+d).removeClass(d))}),c.replacetagwithcontent=b("replacetagwithcontent",function(a,b){return b.each(function(){var b=a.clone().children().addClass(d);$(this).replaceWith(b)}),$("."+d).removeClass(d)}),c.pre=b("pre",function(a,b){return b.each(function(){$(this).before(a.clone().addClass(d))}),$("."+d).removeClass(d)}),c.post=b("post",function(a,b){return b.each(function(){$(this).after(a.clone().addClass(d))}),$("."+d).removeClass(d)}),c.append=b("append",function(a,b){return b.each(function(){$(this).append(a.clone().addClass(d))}),$("."+d).removeClass(d)}),c.prepend=b("prepend",function(a,b){return b.each(function(){$(this).append(a.clone().addClass(d))}),$("."+d).removeClass(d)}),c}),define("patterns/inject2",["require","../logging","../lib/inject","../lib/ajax","../core/parser"],function(a){var b=a("../logging").getLogger("inject2"),c=a("../lib/inject"),d=a("../lib/ajax"),e=function(a,c){var d=function(b){b&&b.preventDefault(),g(a)},e=a.data("href-next");return e&&$(e).length>0?(b.debug("Skipping as href-next already exists",$(e)),a.attr({href:e})):(a.is(".collapsible")?(b.debug("will trigger on patterns-collapsible-open",a),a.on("patterns-collapsible-open.inject",d)):a.is(".folder")?(b.debug("will trigger on patterns-folder-open",a),a.on("patterns-folder-open.inject",function(a){if(a.target!==a.currentTarget)return;d(a)})):a.is("a")&&(b.debug("will trigger on click",a),a.on("click.inject",d)),a)},f=function(c,d){var e=function(a){if(!a.url)return;var c=a.url.split("#");a.url=c[0],c[1]&&(a.source="#"+c[1]),c.length>2&&b.error("Ignoring additional source ids:",c.slice(2))},f=a("../core/parser"),g=d.reduce(function(a,b){var d=b[0],g=b[1],h=c.attr(d)||"",i;return d==="href"||d==="action"?a.url=h:(i=new f(g),a=i.parse(h,a)),h&&e(a),a},{});return b.debug("parsed:",g,c),g},g=function(a){var e=[["href"],["data-inject","source; target; replace; pre; post; prepend; append; url; replacetagwithcontent"]],g=f(a,e),h=!1;g.$trigger=a;if(a.is(".collapsible")){if(g.slice){b.error("Multi injection not supported for .collapsible");return}g.$targets=a.find(".panel-content")}else if(a.is(".folder")){if(g.slice){b.error("Multi injection not supported for .folder");return}g.$targets=a.children("ul")}else if(a.is(".modal")){if(g.slice){b.error("Multi injection not supported for modals");return}h=!0,g.replace="#modal"}g.slice||(g=[g]);var i;g.forEach(function(d){d.source=d.source||"#__original_body";var e="content",f;d.$targets||(d.replace?(f=d.replace,e="replace"):d.replacetagwithcontent?(f=d.replacetagwithcontent,e="replacetagwithcontent"):d.pre?(f=d.pre,e="pre"):d.post?(f=d.post,e="post"):d.append?(f=d.append,e="append"):d.prepend?(f=d.prepend,e="prepend"):d.target?f=d.target:f=d.source,d.$targets=$(f)),d.method=c[e],d.$targets.length===0&&(f.slice(0,1)!=="#"&&b.error("only id supported for non-existing target"),d.$targets=$("<div />").attr({id:f.slice(1)}),$("body").append(d.$targets));if(!d.url){b.error("local source not supported yet, need url for now",a,d);return}d.classes="injecting injecting-"+e,d.$targets.addClass(d.classes)});var j=g[0].url;if(!g.every(function(a){return a.url===j})){b.error("Unsupported different urls for inject");return}if(!g.every(function(a){return a.$targets.length})){b.error("Missing targets, aborting");return}d(a,{url:g[0].url,success:function(c,d,e){var f=$("<div/>").html(c.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<head\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/head>/gi,"").replace(/<body(.*)>/gi,'<div id="__original_body">').replace(/<\/body(.*)>/gi,"</div>"));g.forEach(function(a){var d=f.find(a.source);if(d.length===0){b.error("Aborting, sources are empty for selector:",a.source,c);return}if(h){var e=$('<div id="modal" class="modal" />');d.length===1?d=e.html(d.html()):d=e.html(d)}a.method(d,a.$targets,a),a.$targets.removeClass(a.classes)}),a.trigger("patterns-inject-triggered");var i=a.data("href-next");i&&(a.attr({href:i}),a.off(".inject"))}})},h={initialised_class:"inject",markup_trigger:".collapsible[data-inject], .folder[data-inject], a.inject, a[data-inject]",init:e,triggerinject:g};return h}),define("patterns/inject_log_old",["require","../logging"],function(a){var b=a("../logging").getLogger("old-injection"),c=function(a,c){b.info(a)};return{markup_trigger:".injection,[data-injection]",init:c}}),define("patterns/navigation",["require","../logging"],function(a){var b=a("../logging").getLogger("navigation"),c=function(a,c){return c?c!==a.slice(-c.length)?(b.debug(a,"does not end in",c),!1):!0:(b.debug("path empty"),!1)},d=function(a){var c=a.split("#")[0].split("://");return c.length>2?(b.error("weird url",a),""):c.length===1?c[0]:c[1].split("/").slice(1).join("/")},e=function(a){a.find(".navigation-in-path").removeClass("navigation-in-path"),a.find("li:has(.current)").addClass("navigation-in-path")},f=function(a,f){var g=window.location.pathname;return b.debug("current path:",g),a.hasClass("navigation-load-current")&&(a.find("a.current, .current a").click(),a.on("patterns-inject-scanned",function(b){var c=$(b.target);c.is("a.current")&&c.click(),c.is(".current")&&c.find("a").click(),e(a)})),a.on("patterns-inject-triggered",function(b){var c=$(b.target);a.find(".current").removeClass("current"),c.addClass("current"),c.parent("li").addClass("current"),e(a)}),a.find(".current").length===0&&a.find("li a").each(function(){var a=$(this),e=a.parents("li:first"),f=a.attr("href"),h=d(f);b.debug("checking url:",f,"extracted path:",h),c(g,h)&&(b.debug("found match",e),e.addClass("current"))}),e(a),a},g={markup_trigger:"nav, .navigation",init:f};return g}),function(a,b,c){function j(a){var b={},d=/^jQuery\d+$/;return c.each(a.attributes,function(a,c){c.specified&&!d.test(c.name)&&(b[c.name]=c.value)}),b}function k(a,d){var e=this,f=c(e);if(e.value==f.attr("placeholder")&&f.hasClass("placeholder"))if(f.data("placeholder-password")){f=f.hide().next().show().attr("id",f.removeAttr("id").data("placeholder-id"));if(a===!0)return f[0].value=d;f.focus()}else e.value="",f.removeClass("placeholder"),e==b.activeElement&&e.select()}function l(){var a,b=this,d=c(b),e=d,f=this.id;if(b.value==""){if(b.type=="password"){if(!d.data("placeholder-textinput")){try{a=d.clone().attr({type:"text"})}catch(g){a=c("<input>").attr(c.extend(j(this),{type:"text"}))}a.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":f}).bind("focus.placeholder",k),d.data({"placeholder-textinput":a,"placeholder-id":f}).before(a)}d=d.removeAttr("id").hide().prev().attr("id",f).show()}d.addClass("placeholder"),d[0].value=d.attr("placeholder")}else d.removeClass("placeholder")}var d="placeholder"in b.createElement("input"),e="placeholder"in b.createElement("textarea"),f=c.fn,g=c.valHooks,h,i;d&&e?(i=f.placeholder=function(){return this},i.input=i.textarea=!0):(i=f.placeholder=function(){var a=this;return a.filter((d?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":k,"blur.placeholder":l}).data("placeholder-enabled",!0).trigger("blur.placeholder"),a},i.input=d,i.textarea=e,h={get:function(a){var b=c(a);return b.data("placeholder-enabled")&&b.hasClass("placeholder")?"":a.value},set:function(a,d){var e=c(a);return e.data("placeholder-enabled")?(d==""?(a.value=d,a!=b.activeElement&&l.call(a)):e.hasClass("placeholder")?k.call(a,!0,d)||(a.value=d):a.value=d,e):a.value=d}},d||(g.input=h),e||(g.textarea=h),c(function(){c(b).delegate("form","submit.placeholder",function(){var a=c(".placeholder",this).each(k);setTimeout(function(){a.each(l)},10)})}),c(a).bind("beforeunload.placeholder",function(){c(".placeholder").each(function(){this.value=""})}))}(this,document,jQuery),define("patterns/../../lib/jquery.placeholder",function(){}),define("patterns/placeholder",["require","../../lib/jquery.placeholder","../logging"],function(a){var b=a("../logging").getLogger("placeholder"),c=function(a,b){a.placeholder()},d={markup_trigger:"[placeholder]",register_jquery_plugin:!1,init:c};return d}),function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");if(c)return c;this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c);if(c.settings.onsubmit){var d=this.find("input, button");d.filter(".cancel").click(function(){c.cancelSubmit=!0}),c.settings.submitHandler&&d.filter(":submit").click(function(){c.submitButton=this}),this.submit(function(b){function d(){if(c.settings.submitHandler){if(c.submitButton)var b=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm);return c.settings.submitHandler.call(c,c.currentForm),c.submitButton&&b.remove(),!1}return!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})}return c},valid:function(){if(a(this[0]).is("form"))return this.validate().form();var b=!0,c=a(this[0].form).validate();return this.each(function(){b&=c.element(this)}),b},removeAttrs:function(b){var c={},d=this;return a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)}),c},rules:function(b,c){var d=this[0];if(b){var e=a.data(d.form,"validator").settings,f=e.rules,g=a.validator.staticRules(d);switch(b){case"add":a.extend(g,a.validator.normalizeRule(c)),f[d.name]=g,c.messages&&(e.messages[d.name]=a.extend(e.messages[d.name],c.messages));break;case"remove":if(!c)return delete f[d.name],g;var h={};return a.each(c.split(/\s/),function(a,b){h[b]=g[b],delete g[b]}),h}}var i=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(d),a.validator.classRules(d),a.validator.attributeRules(d),a.validator.staticRules(d)),d);if(i.required){var j=i.required;delete i.required,i=a.extend({required:j},i)}return i}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+b.value)},filled:function(b){return!!a.trim(""+b.value)},unchecked:function(a){return!a.checked}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return arguments.length==1?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:(arguments.length>2&&c.constructor!=Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!=Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),c)}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a,b){this.lastActive=a,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a,b){!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))&&this.element(a)},onkeyup:function(a,b){(a.name in this.submitted||a==this.lastElement)&&this.element(a)},onclick:function(a,b){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function d(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,"");c.settings[d]&&c.settings[d].call(c,this[0],b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var b=this.groups={};a.each(this.settings.groups,function(c,d){a.each(d.split(/\s/),function(a,d){b[d]=c})});var c=this.settings.rules;a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",d).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",d),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){b=this.validationTargetFor(this.clean(b)),this.lastElement=b,this.prepareElement(b),this.currentElements=a(b);var c=this.check(b);return c?delete this.invalid[b.name]:this.invalid[b.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),c},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0;for(var c in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(a){return a.element.name==b.name}).length==1&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in c||!b.objectLength(a(this).rules())?!1:(c[this.name]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},check:function(b){b=this.validationTargetFor(this.clean(b));var c=a(b).rules(),d=!1;for(var e in c){var f={method:e,parameters:c[e]};try{var g=a.validator.methods[e].call(this,b.value.replace(/\r/g,""),b,f.parameters);if(g=="dependency-mismatch"){d=!0;continue}d=!1;if(g=="pending"){this.toHide=this.toHide.not(this.errorsFor(b));return}if(!g)return this.formatAndAdd(b,f),!1}catch(h){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+b.id+", check the '"+f.method+"' method",h),h}}if(d)return;return this.objectLength(c)&&this.successList.push(b),!0},customMetaMessage:function(b,c){if(!a.metadata)return;var d=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return d&&d.messages&&d.messages[c]},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor==String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a];return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(a,b){var c=this.defaultMessage(a,b.method),d=/\$?\{(\d+)\}/g;typeof c=="function"?c=c.call(this,b.parameters,a):d.test(c)&&(c=jQuery.format(c.replace(d,"{$1}"),b.parameters)),this.errorList.push({message:c,element:a}),this.errorMap[a.name]=c,this.submitted[a.name]=c},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass),this.showLabel(b.element,b.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(var a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(var a=0,c=this.validElements();c[a];a++)this.settings.unhighlight.call(this,c[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d=this.errorsFor(b);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),d.attr("generated")&&d.html(c)):(d=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(b),generated:!0}).addClass(this.settings.errorClass).html(c||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b))),!c&&this.settings.success&&(d.text(""),typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)),this.toShow=this.toShow.add(d)},errorsFor:function(b){var c=this.idOrName(b);return this.errors().filter(function(){return a(this).attr("for")==c})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){return this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]),a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(a,d){return d.form==c&&d.name==b&&d||null})},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a,b){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){return!a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&this.pendingRequest==0&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&this.pendingRequest==0&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},attributeRules:function(b){var c={},d=a(b);for(var e in a.validator.methods){var f;e==="required"&&typeof a.fn.prop=="function"?f=d.prop(e):f=d.attr(e),f?c[e]=f:d[0].getAttribute("type")===e&&(c[e]=!0)}return c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength,c},metadataRules:function(b){if(!a.metadata)return{};var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1){delete b[d];return}if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=e.param!==undefined?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength","min","max"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){b[this]&&(b[this]=[Number(b[this][0]),Number(b[this][1])])}),a.validator.autoCreateRanges&&(b.min&&b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),b.minlength&&b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b.messages&&delete b.messages,b},normalizeRule:function(b){if(typeof b=="string"){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=d!=undefined?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";switch(c.nodeName.toLowerCase()){case"select":var e=a(c).val();return e&&e.length>0;case"input":if(this.checkable(c))return this.getLength(b,c)>0;default:return a.trim(b).length>0}},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e=this.previousValue(c);this.settings.messages[c.name]||(this.settings.messages[c.name]={}),e.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=e.message,d=typeof d=="string"&&{url:d}||d;if(this.pending[c.name])return"pending";if(e.old===b)return e.valid;e.old=b;var f=this;this.startRequest(c);var g={};return g[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:g,success:function(d){f.settings.messages[c.name].remote=e.originalMessage;var g=d===!0;if(g){var h=f.formSubmitted;f.prepareElement(c),f.formSubmitted=h,f.successList.push(c),f.showErrors()}else{var i={},j=d||f.defaultMessage(c,"remote");i[c.name]=e.message=a.isFunction(j)?j(b):j,f.showErrors(i)}e.valid=g,f.stopRequest(c,g)}},d)),"pending"},minlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),c)>=d},maxlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),c)<=d},rangelength:function(b,c,d){var e=this.getLength(a.trim(b),c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return!1;var c=0,d=0,e=!1;a=a.replace(/\D/g,"");for(var f=a.length-1;f>=0;f--){var g=a.charAt(f),d=parseInt(g,10);e&&(d*=2)>9&&(d-=9),c+=d,e=!e}return c%10==0},accept:function(a,b,c){return c=typeof c=="string"?c.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},equalTo:function(b,c,d){var e=a(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()});return b==e.val()}}}),a.format=a.validator.format}(jQuery),function(a){var b={};if(a.ajaxPrefilter)a.ajaxPrefilter(function(a,c,d){var e=a.port;a.mode=="abort"&&(b[e]&&b[e].abort(),b[e]=d)});else{var c=a.ajax;a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return e=="abort"?(b[f]&&b[f].abort(),b[f]=c.apply(this,arguments)):c.apply(this,arguments)}}}(jQuery),function(a){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&a.each({focus:"focusin",blur:"focusout"},function(b,c){function d(b){return b=a.event.fix(b),b.type=c,a.event.handle.call(this,b)}a.event.special[c]={setup:function(){this.addEventListener(b,d,!0)},teardown:function(){this.removeEventListener(b,d,!0)},handler:function(b){return arguments[0]=a.event.fix(b),arguments[0].type=c,a.event.handle.apply(this,arguments)}}}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);if(e.is(b))return d.apply(e,arguments)})}})}(jQuery),define("patterns/../../lib/jquery.validate",function(){}),function(a){a.extend(a.fn,{validate:function(b){if(!this.length){b&&b.debug&&window.console&&console.warn("nothing selected, can't validate, returning nothing");return}var c=a.data(this[0],"validator");if(c)return c;this.attr("novalidate","novalidate"),c=new a.validator(b,this[0]),a.data(this[0],"validator",c);if(c.settings.onsubmit){var d=this.find("input, button");d.filter(".cancel").click(function(){c.cancelSubmit=!0}),c.settings.submitHandler&&d.filter(":submit").click(function(){c.submitButton=this}),this.submit(function(b){function d(){if(c.settings.submitHandler){if(c.submitButton)var b=a("<input type='hidden'/>").attr("name",c.submitButton.name).val(c.submitButton.value).appendTo(c.currentForm);return c.settings.submitHandler.call(c,c.currentForm),c.submitButton&&b.remove(),!1}return!0}return c.settings.debug&&b.preventDefault(),c.cancelSubmit?(c.cancelSubmit=!1,d()):c.form()?c.pendingRequest?(c.formSubmitted=!0,!1):d():(c.focusInvalid(),!1)})}return c},valid:function(){if(a(this[0]).is("form"))return this.validate().form();var b=!0,c=a(this[0].form).validate();return this.each(function(){b&=c.element(this)}),b},removeAttrs:function(b){var c={},d=this;return a.each(b.split(/\s/),function(a,b){c[b]=d.attr(b),d.removeAttr(b)}),c},rules:function(b,c){var d=this[0];if(b){var e=a.data(d.form,"validator").settings,f=e.rules,g=a.validator.staticRules(d);switch(b){case"add":a.extend(g,a.validator.normalizeRule(c)),f[d.name]=g,c.messages&&(e.messages[d.name]=a.extend(e.messages[d.name],c.messages));break;case"remove":if(!c)return delete f[d.name],g;var h={};return a.each(c.split(/\s/),function(a,b){h[b]=g[b],delete g[b]}),h}}var i=a.validator.normalizeRules(a.extend({},a.validator.metadataRules(d),a.validator.classRules(d),a.validator.attributeRules(d),a.validator.staticRules(d)),d);if(i.required){var j=i.required;delete i.required,i=a.extend({required:j},i)}return i}}),a.extend(a.expr[":"],{blank:function(b){return!a.trim(""+b.value)},filled:function(b){return!!a.trim(""+b.value)},unchecked:function(a){return!a.checked}}),a.validator=function(b,c){this.settings=a.extend(!0,{},a.validator.defaults,b),this.currentForm=c,this.init()},a.validator.format=function(b,c){return arguments.length==1?function(){var c=a.makeArray(arguments);return c.unshift(b),a.validator.format.apply(this,c)}:(arguments.length>2&&c.constructor!=Array&&(c=a.makeArray(arguments).slice(1)),c.constructor!=Array&&(c=[c]),a.each(c,function(a,c){b=b.replace(new RegExp("\\{"+a+"\\}","g"),c)}),b)},a.extend(a.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusInvalid:!0,errorContainer:a([]),errorLabelContainer:a([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(a,b){this.lastActive=a,this.settings.focusCleanup&&!this.blockFocusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,a,this.settings.errorClass,this.settings.validClass),this.addWrapper(this.errorsFor(a)).hide())},onfocusout:function(a,b){!this.checkable(a)&&(a.name in this.submitted||!this.optional(a))&&this.element(a)},onkeyup:function(a,b){(a.name in this.submitted||a==this.lastElement)&&this.element(a)},onclick:function(a,b){a.name in this.submitted?this.element(a):a.parentNode.name in this.submitted&&this.element(a.parentNode)},highlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).addClass(c).removeClass(d):a(b).addClass(c).removeClass(d)},unhighlight:function(b,c,d){b.type==="radio"?this.findByName(b.name).removeClass(c).addClass(d):a(b).removeClass(c).addClass(d)}},setDefaults:function(b){a.extend(a.validator.defaults,b)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:a.validator.format("Please enter no more than {0} characters."),minlength:a.validator.format("Please enter at least {0} characters."),rangelength:a.validator.format("Please enter a value between {0} and {1} characters long."),range:a.validator.format("Please enter a value between {0} and {1}."),max:a.validator.format("Please enter a value less than or equal to {0}."),min:a.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function d(b){var c=a.data(this[0].form,"validator"),d="on"+b.type.replace(/^validate/,"");c.settings[d]&&c.settings[d].call(c,this[0],b)}this.labelContainer=a(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||a(this.currentForm),this.containers=a(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var b=this.groups={};a.each(this.settings.groups,function(c,d){a.each(d.split(/\s/),function(a,d){b[d]=c})});var c=this.settings.rules;a.each(c,function(b,d){c[b]=a.validator.normalizeRule(d)}),a(this.currentForm).validateDelegate("[type='text'], [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'] ","focusin focusout keyup",d).validateDelegate("[type='radio'], [type='checkbox'], select, option","click",d),this.settings.invalidHandler&&a(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler)},form:function(){return this.checkForm(),a.extend(this.submitted,this.errorMap),this.invalid=a.extend({},this.errorMap),this.valid()||a(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var a=0,b=this.currentElements=this.elements();b[a];a++)this.check(b[a]);return this.valid()},element:function(b){b=this.validationTargetFor(this.clean(b)),this.lastElement=b,this.prepareElement(b),this.currentElements=a(b);var c=this.check(b);return c?delete this.invalid[b.name]:this.invalid[b.name]=!0,this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),c},showErrors:function(b){if(b){a.extend(this.errorMap,b),this.errorList=[];for(var c in b)this.errorList.push({message:b[c],element:this.findByName(c)[0]});this.successList=a.grep(this.successList,function(a){return!(a.name in b)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){a.fn.resetForm&&a(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass)},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(a){var b=0;for(var c in a)b++;return b},hideErrors:function(){this.addWrapper(this.toHide).hide()},valid:function(){return this.size()==0},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{a(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(b){}},findLastActive:function(){var b=this.lastActive;return b&&a.grep(this.errorList,function(a){return a.element.name==b.name}).length==1&&b},elements:function(){var b=this,c={};return a(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled]").not(this.settings.ignore).filter(function(){return!this.name&&b.settings.debug&&window.console&&console.error("%o has no name assigned",this),this.name in c||!b.objectLength(a(this).rules())?!1:(c[this.name]=!0,!0)})},clean:function(b){return a(b)[0]},errors:function(){return a(this.settings.errorElement+"."+this.settings.errorClass,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=a([]),this.toHide=a([]),this.currentElements=a([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(a){this.reset(),this.toHide=this.errorsFor(a)},check:function(b){b=this.validationTargetFor(this.clean(b));var c=a(b).rules(),d=!1;for(var e in c){var f={method:e,parameters:c[e]};try{var g=a.validator.methods[e].call(this,b.value.replace(/\r/g,""),b,f.parameters);if(g=="dependency-mismatch"){d=!0;continue}d=!1;if(g=="pending"){this.toHide=this.toHide.not(this.errorsFor(b));return}if(!g)return this.formatAndAdd(b,f),!1}catch(h){throw this.settings.debug&&window.console&&console.log("exception occured when checking element "+b.id+", check the '"+f.method+"' method",h),h}}if(d)return;return this.objectLength(c)&&this.successList.push(b),!0},customMetaMessage:function(b,c){if(!a.metadata)return;var d=this.settings.meta?a(b).metadata()[this.settings.meta]:a(b).metadata();return d&&d.messages&&d.messages[c]},customMessage:function(a,b){var c=this.settings.messages[a];return c&&(c.constructor==String?c:c[b])},findDefined:function(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==undefined)return arguments[a];return undefined},defaultMessage:function(b,c){return this.findDefined(this.customMessage(b.name,c),this.customMetaMessage(b,c),!this.settings.ignoreTitle&&b.title||undefined,a.validator.messages[c],"<strong>Warning: No message defined for "+b.name+"</strong>")},formatAndAdd:function(a,b){var c=this.defaultMessage(a,b.method),d=/\$?\{(\d+)\}/g;typeof c=="function"?c=c.call(this,b.parameters,a):d.test(c)&&(c=jQuery.format(c.replace(d,"{$1}"),b.parameters)),this.errorList.push({message:c,element:a}),this.errorMap[a.name]=c,this.submitted[a.name]=c},addWrapper:function(a){return this.settings.wrapper&&(a=a.add(a.parent(this.settings.wrapper))),a},defaultShowErrors:function(){for(var a=0;this.errorList[a];a++){var b=this.errorList[a];this.settings.highlight&&this.settings.highlight.call(this,b.element,this.settings.errorClass,this.settings.validClass),this.showLabel(b.element,b.message)}this.errorList.length&&(this.toShow=this.toShow.add(this.containers));if(this.settings.success)for(var a=0;this.successList[a];a++)this.showLabel(this.successList[a]);if(this.settings.unhighlight)for(var a=0,c=this.validElements();c[a];a++)this.settings.unhighlight.call(this,c[a],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return a(this.errorList).map(function(){return this.element})},showLabel:function(b,c){var d=this.errorsFor(b);d.length?(d.removeClass(this.settings.validClass).addClass(this.settings.errorClass),d.attr("generated")&&d.html(c)):(d=a("<"+this.settings.errorElement+"/>").attr({"for":this.idOrName(b),generated:!0}).addClass(this.settings.errorClass).html(c||""),this.settings.wrapper&&(d=d.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.append(d).length||(this.settings.errorPlacement?this.settings.errorPlacement(d,a(b)):d.insertAfter(b))),!c&&this.settings.success&&(d.text(""),typeof this.settings.success=="string"?d.addClass(this.settings.success):this.settings.success(d)),this.toShow=this.toShow.add(d)},errorsFor:function(b){var c=this.idOrName(b);return this.errors().filter(function(){return a(this).attr("for")==c})},idOrName:function(a){return this.groups[a.name]||(this.checkable(a)?a.name:a.id||a.name)},validationTargetFor:function(a){return this.checkable(a)&&(a=this.findByName(a.name).not(this.settings.ignore)[0]),a},checkable:function(a){return/radio|checkbox/i.test(a.type)},findByName:function(b){var c=this.currentForm;return a(document.getElementsByName(b)).map(function(a,d){return d.form==c&&d.name==b&&d||null})},getLength:function(b,c){switch(c.nodeName.toLowerCase()){case"select":return a("option:selected",c).length;case"input":if(this.checkable(c))return this.findByName(c.name).filter(":checked").length}return b.length},depend:function(a,b){return this.dependTypes[typeof a]?this.dependTypes[typeof a](a,b):!0},dependTypes:{"boolean":function(a,b){return a},string:function(b,c){return!!a(b,c.form).length},"function":function(a,b){return a(b)}},optional:function(b){return!a.validator.methods.required.call(this,a.trim(b.value),b)&&"dependency-mismatch"},startRequest:function(a){this.pending[a.name]||(this.pendingRequest++,this.pending[a.name]=!0)},stopRequest:function(b,c){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[b.name],c&&this.pendingRequest==0&&this.formSubmitted&&this.form()?(a(this.currentForm).submit(),this.formSubmitted=!1):!c&&this.pendingRequest==0&&this.formSubmitted&&(a(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(b){return a.data(b,"previousValue")||a.data(b,"previousValue",{old:null,valid:!0,message:this.defaultMessage(b,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},dateDE:{dateDE:!0},number:{number:!0},numberDE:{numberDE:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(b,c){b.constructor==String?this.classRuleSettings[b]=c:a.extend(this.classRuleSettings,b)},classRules:function(b){var c={},d=a(b).attr("class");return d&&a.each(d.split(" "),function(){this in a.validator.classRuleSettings&&a.extend(c,a.validator.classRuleSettings[this])}),c},attributeRules:function(b){var c={},d=a(b);for(var e in a.validator.methods){var f;e==="required"&&typeof a.fn.prop=="function"?f=d.prop(e):f=d.attr(e),f?c[e]=f:d[0].getAttribute("type")===e&&(c[e]=!0)}return c.maxlength&&/-1|2147483647|524288/.test(c.maxlength)&&delete c.maxlength,c},metadataRules:function(b){if(!a.metadata)return{};var c=a.data(b.form,"validator").settings.meta;return c?a(b).metadata()[c]:a(b).metadata()},staticRules:function(b){var c={},d=a.data(b.form,"validator");return d.settings.rules&&(c=a.validator.normalizeRule(d.settings.rules[b.name])||{}),c},normalizeRules:function(b,c){return a.each(b,function(d,e){if(e===!1){delete b[d];return}if(e.param||e.depends){var f=!0;switch(typeof e.depends){case"string":f=!!a(e.depends,c.form).length;break;case"function":f=e.depends.call(c,c)}f?b[d]=e.param!==undefined?e.param:!0:delete b[d]}}),a.each(b,function(d,e){b[d]=a.isFunction(e)?e(c):e}),a.each(["minlength","maxlength","min","max"],function(){b[this]&&(b[this]=Number(b[this]))}),a.each(["rangelength","range"],function(){b[this]&&(b[this]=[Number(b[this][0]),Number(b[this][1])])}),a.validator.autoCreateRanges&&(b.min&&b.max&&(b.range=[b.min,b.max],delete b.min,delete b.max),b.minlength&&b.maxlength&&(b.rangelength=[b.minlength,b.maxlength],delete b.minlength,delete b.maxlength)),b.messages&&delete b.messages,b},normalizeRule:function(b){if(typeof b=="string"){var c={};a.each(b.split(/\s/),function(){c[this]=!0}),b=c}return b},addMethod:function(b,c,d){a.validator.methods[b]=c,a.validator.messages[b]=d!=undefined?d:a.validator.messages[b],c.length<3&&a.validator.addClassRules(b,a.validator.normalizeRule(b))},methods:{required:function(b,c,d){if(!this.depend(d,c))return"dependency-mismatch";switch(c.nodeName.toLowerCase()){case"select":var e=a(c).val();return e&&e.length>0;case"input":if(this.checkable(c))return this.getLength(b,c)>0;default:return a.trim(b).length>0}},remote:function(b,c,d){if(this.optional(c))return"dependency-mismatch";var e=this.previousValue(c);this.settings.messages[c.name]||(this.settings.messages[c.name]={}),e.originalMessage=this.settings.messages[c.name].remote,this.settings.messages[c.name].remote=e.message,d=typeof d=="string"&&{url:d}||d;if(this.pending[c.name])return"pending";if(e.old===b)return e.valid;e.old=b;var f=this;this.startRequest(c);var g={};return g[c.name]=b,a.ajax(a.extend(!0,{url:d,mode:"abort",port:"validate"+c.name,dataType:"json",data:g,success:function(d){f.settings.messages[c.name].remote=e.originalMessage;var g=d===!0;if(g){var h=f.formSubmitted;f.prepareElement(c),f.formSubmitted=h,f.successList.push(c),f.showErrors()}else{var i={},j=d||f.defaultMessage(c,"remote");i[c.name]=e.message=a.isFunction(j)?j(b):j,f.showErrors(i)}e.valid=g,f.stopRequest(c,g)}},d)),"pending"},minlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),c)>=d},maxlength:function(b,c,d){return this.optional(c)||this.getLength(a.trim(b),c)<=d},rangelength:function(b,c,d){var e=this.getLength(a.trim(b),c);return this.optional(c)||e>=d[0]&&e<=d[1]},min:function(a,b,c){return this.optional(b)||a>=c},max:function(a,b,c){return this.optional(b)||a<=c},range:function(a,b,c){return this.optional(b)||a>=c[0]&&a<=c[1]},email:function(a,b){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(a)},url:function(a,b){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},date:function(a,b){return this.optional(b)||!/Invalid|NaN/.test(new Date(a))},dateISO:function(a,b){return this.optional(b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return this.optional(b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},digits:function(a,b){return this.optional(b)||/^\d+$/.test(a)},creditcard:function(a,b){if(this.optional(b))return"dependency-mismatch";if(/[^0-9 -]+/.test(a))return!1;var c=0,d=0,e=!1;a=a.replace(/\D/g,"");for(var f=a.length-1;f>=0;f--){var g=a.charAt(f),d=parseInt(g,10);e&&(d*=2)>9&&(d-=9),c+=d,e=!e}return c%10==0},accept:function(a,b,c){return c=typeof c=="string"?c.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(b)||a.match(new RegExp(".("+c+")$","i"))},equalTo:function(b,c,d){var e=a(d).unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){a(c).valid()});return b==e.val()}}}),a.format=a.validator.format}(jQuery),function(a){var b={};if(a.ajaxPrefilter)a.ajaxPrefilter(function(a,c,d){var e=a.port;a.mode=="abort"&&(b[e]&&b[e].abort(),b[e]=d)});else{var c=a.ajax;a.ajax=function(d){var e=("mode"in d?d:a.ajaxSettings).mode,f=("port"in d?d:a.ajaxSettings).port;return e=="abort"?(b[f]&&b[f].abort(),b[f]=c.apply(this,arguments)):c.apply(this,arguments)}}}(jQuery),function(a){!jQuery.event.special.focusin&&!jQuery.event.special.focusout&&document.addEventListener&&a.each({focus:"focusin",blur:"focusout"},function(b,c){function d(b){return b=a.event.fix(b),b.type=c,a.event.handle.call(this,b)}a.event.special[c]={setup:function(){this.addEventListener(b,d,!0)},teardown:function(){this.removeEventListener(b,d,!0)},handler:function(b){return arguments[0]=a.event.fix(b),arguments[0].type=c,a.event.handle.apply(this,arguments)}}}),a.extend(a.fn,{validateDelegate:function(b,c,d){return this.bind(c,function(c){var e=a(c.target);if(e.is(b))return d.apply(e,arguments)})}})}(jQuery),define("patterns/../../lib/jquery-validation-1.9.0/./jquery.validate",function(){}),define("patterns/../../lib/jquery-validation-1.9.0/additional-methods",["require","./jquery.validate"],function(a){(function(){function a(a){return a.replace(/<.[^<>]*?>/g," ").replace(/&nbsp;|&#160;/gi," ").replace(/[0-9.(),;:!?%#$'"_+=\/-]*/g,"")}jQuery.validator.addMethod("maxWords",function(b,c,d){return this.optional(c)||a(b).match(/\b\w+\b/g).length<d},jQuery.validator.format("Please enter {0} words or less.")),jQuery.validator.addMethod("minWords",function(b,c,d){return this.optional(c)||a(b).match(/\b\w+\b/g).length>=d},jQuery.validator.format("Please enter at least {0} words.")),jQuery.validator.addMethod("rangeWords",function(b,c,d){return this.optional(c)||a(b).match(/\b\w+\b/g).length>=d[0]&&b.match(/bw+b/g).length<d[1]},jQuery.validator.format("Please enter between {0} and {1} words."))})(),jQuery.validator.addMethod("letterswithbasicpunc",function(a,b){return this.optional(b)||/^[a-z-.,()'\"\s]+$/i.test(a)},"Letters or punctuation only please"),jQuery.validator.addMethod("alphanumeric",function(a,b){return this.optional(b)||/^\w+$/i.test(a)},"Letters, numbers, spaces or underscores only please"),jQuery.validator.addMethod("lettersonly",function(a,b){return this.optional(b)||/^[a-z]+$/i.test(a)},"Letters only please"),jQuery.validator.addMethod("nowhitespace",function(a,b){return this.optional(b)||/^\S+$/i.test(a)},"No white space please"),jQuery.validator.addMethod("ziprange",function(a,b){return this.optional(b)||/^90[2-5]\d\{2}-\d{4}$/.test(a)},"Your ZIP-code must be in the range 902xx-xxxx to 905-xx-xxxx"),jQuery.validator.addMethod("integer",function(a,b){return this.optional(b)||/^-?\d+$/.test(a)},"A positive or negative non-decimal number please"),jQuery.validator.addMethod("vinUS",function(a){if(a.length!=17)return!1;var b,c,d,e,f,g,h=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","R","S","T","U","V","W","X","Y","Z"],i=[1,2,3,4,5,6,7,8,1,2,3,4,5,7,9,2,3,4,5,6,7,8,9],j=[8,7,6,5,4,3,2,10,0,9,8,7,6,5,4,3,2],k=0;for(b=0;b<17;b++){e=j[b],d=a.slice(b,b+1),b==8&&(g=d);if(!isNaN(d))d*=e;else for(c=0;c<h.length;c++)if(d.toUpperCase()===h[c]){d=i[c],d*=e,isNaN(g)&&c==8&&(g=h[c]);break}k+=d}return f=k%11,f==10&&(f="X"),f==g?!0:!1},"The specified vehicle identification number (VIN) is invalid."),jQuery.validator.addMethod("dateITA",function(a,b){var c=!1,d=/^\d{1,2}\/\d{1,2}\/\d{4}$/;if(d.test(a)){var e=a.split("/"),f=parseInt(e[0],10),g=parseInt(e[1],10),h=parseInt(e[2],10),i=new Date(h,g-1,f);i.getFullYear()==h&&i.getMonth()==g-1&&i.getDate()==f?c=!0:c=!1}else c=!1;return this.optional(b)||c},"Please enter a correct date"),jQuery.validator.addMethod("dateNL",function(a,b){return this.optional(b)||/^\d\d?[\.\/-]\d\d?[\.\/-]\d\d\d?\d?$/.test(a)},"Vul hier een geldige datum in."),jQuery.validator.addMethod("time",function(a,b){return this.optional(b)||/^([01]\d|2[0-3])(:[0-5]\d){0,2}$/.test(a)},"Please enter a valid time, between 00:00 and 23:59"),jQuery.validator.addMethod("time12h",function(a,b){return this.optional(b)||/^((0?[1-9]|1[012])(:[0-5]\d){0,2}(\ [AP]M))$/i.test(a)},"Please enter a valid time, between 00:00 am and 12:00 pm"),jQuery.validator.addMethod("phoneUS",function(a,b){return a=a.replace(/\s+/g,""),this.optional(b)||a.length>9&&a.match(/^(1-?)?(\([2-9]\d{2}\)|[2-9]\d{2})-?[2-9]\d{2}-?\d{4}$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("phoneUK",function(a,b){return this.optional(b)||a.length>9&&a.match(/^(\(?(0|\+44)[1-9]{1}\d{1,4}?\)?\s?\d{3,4}\s?\d{3,4})$/)},"Please specify a valid phone number"),jQuery.validator.addMethod("mobileUK",function(a,b){return this.optional(b)||a.length>9&&a.match(/^((0|\+44)7(5|6|7|8|9){1}\d{2}\s?\d{6})$/)},"Please specify a valid mobile number"),jQuery.validator.addMethod("strippedminlength",function(a,b,c){return jQuery(a).text().length>=c},jQuery.validator.format("Please enter at least {0} characters")),jQuery.validator.addMethod("email2",function(a,b,c){return this.optional(b)||/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i.test(a)},jQuery.validator.messages.email),jQuery.validator.addMethod("url2",function(a,b,c){return this.optional(b)||/^(https?|ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)*(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(a)},jQuery.validator.messages.url),jQuery.validator.addMethod("creditcardtypes",function(a,b,c){if(/[^0-9-]+/.test(a))return!1;a=a.replace(/\D/g,"");var d=0;return c.mastercard&&(d|=1),c.visa&&(d|=2),c.amex&&(d|=4),c.dinersclub&&(d|=8),c.enroute&&(d|=16),c.discover&&(d|=32),c.jcb&&(d|=64),c.unknown&&(d|=128),c.all&&(d=255),d&1&&/^(51|52|53|54|55)/.test(a)?a.length==16:d&2&&/^(4)/.test(a)?a.length==16:d&4&&/^(34|37)/.test(a)?a.length==15:d&8&&/^(300|301|302|303|304|305|36|38)/.test(a)?a.length==14:d&16&&/^(2014|2149)/.test(a)?a.length==15:d&32&&/^(6011)/.test(a)?a.length==16:d&64&&/^(3)/.test(a)?a.length==16:d&64&&/^(2131|1800)/.test(a)?a.length==15:d&128?!0:!1},"Please enter a valid credit card number."),jQuery.validator.addMethod("ipv4",function(a,b,c){return this.optional(b)||/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/i.test(a)},"Please enter a valid IP v4 address."),jQuery.validator.addMethod("ipv6",function(a,b,c){return this.optional(b)||/^((([0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}:[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){5}:([0-9A-Fa-f]{1,4}:)?[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){4}:([0-9A-Fa-f]{1,4}:){0,2}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){3}:([0-9A-Fa-f]{1,4}:){0,3}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){2}:([0-9A-Fa-f]{1,4}:){0,4}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){6}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(([0-9A-Fa-f]{1,4}:){0,5}:((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|(::([0-9A-Fa-f]{1,4}:){0,5}((\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b)\.){3}(\b((25[0-5])|(1\d{2})|(2[0-4]\d)|(\d{1,2}))\b))|([0-9A-Fa-f]{1,4}::([0-9A-Fa-f]{1,4}:){0,5}[0-9A-Fa-f]{1,4})|(::([0-9A-Fa-f]{1,4}:){0,6}[0-9A-Fa-f]{1,4})|(([0-9A-Fa-f]{1,4}:){1,7}:))$/i.test(a)},"Please enter a valid IP v6 address."),jQuery.validator.addMethod("pattern",function(a,b,c){return this.optional(b)||c.test(a)},"Invalid format.")}),define("patterns/validate",["require","../logging","../../lib/jquery.validate","../../lib/jquery-validation-1.9.0/additional-methods"],function(a){var b=a("../logging").getLogger("validate"),c=a("../../lib/jquery.validate"),d=a("../../lib/jquery-validation-1.9.0/additional-methods"),e=function(a,c){var d=a.find("[data-required-if]").toArray().reduce(function(a,c){var d=$(c),e=d.attr("id");return e?(a[e]={required:d.data("required-if")},a):(b.error("Element needs id, skipping:",d),a)},{});return b.debug("rules:",d),a.validate({rules:d}),a},f={markup_trigger:"form.validate",register_jquery_plugin:!1,init:e};return f}),define(["../logging","../core/parser"],function(a,b){$=jQuery;var c=a.getLogger("switch"),d=new b;d.add_argument("selector"),d.add_argument("remove"),d.add_argument("add"),$.patterns=$.patterns||{},$.patterns["switch"]={go:function(a){var b=a.data("patternSwitch");if(!b){c.error("onClick called for uninitialised element");return}var d,e;for(e=0;e<b.length;e++)d=b[e],$.patterns["switch"].update(d.selector,d.remove,d.add)},onClick:function(a){$.patterns["switch"].go($(this))},update:function(a,b,c){var d=$(a);if(!d.length)return;b&&(b.indexOf("*")===-1?d.removeClass(b):(b=b.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&"),b=b.replace(/[*]/g,".*"),b=new RegExp("^"+b+"$"),d.filter("[class]").each(function(){var a=$(this),c=a.attr("class").split(/\s+/),d=[];for(var e=0;e<c.length;e++)b.test(c[e])||d.push(c[e]);d.length?a.attr("class",d.join(" ")):a.removeAttr("class")}))),c&&d.addClass(c)},parse:function(a){var b=d.parse(a.data("switch")),c=[];return Array.isArray(b)||(b=[b]),b},validateOptions:function(a){var b=[];for(var d=0;d<a.length;d++){var e=a[d];e.selector&&(e.remove||e.add)?b.push(e):c.error("Switch pattern requires selector and one of add or remove.")}return b.length?b:null}};var e={init:function(a){return a&&!Array.isArray(a)&&(a=[a]),this.each(function(){var b=$(this),c=b.data("patternSwitch");if(c)return;var d=a||$.patterns["switch"].parse(b);d=$.patterns["switch"].validateOptions(d),d&&d.length&&b.data("patternSwitch",d).on("click.patternSwitch",$.patterns["switch"].onClick)})},destroy:function(){return this.each(function(){$(this).removeData("patternSwitch").off("click.patternSwitch")})},execute:function(){return this.each(function(){$.patterns["switch"].go($(this))})}};return $.fn.patternSwitch=function(a){if(e[a])return e[a].apply(this,Array.prototype.slice.call(arguments,1));if(typeof a=="object"||!a)return e.init.apply(this,arguments);$.error("Method "+a+" does not exist on jQuery.patternSwitch")},$.patterns["switch"]}),define("patterns/switch",["../jquery/switch"],function(){var a={initContent:function(a){$("[data-switch]",a).patternSwitch()}};return a}),define("patterns/fancybox",["require","../lib/dist/jquery.fancybox-1.3.4"],function(a){var b={execute:function(a,b,c,d,e){var f={};d.type&&(f.type=d.type),f.href=b+(c.length>0?"#"+c[0]:""),$.fancybox(f),$.fancybox.resize()}};return b}),define("patterns/floatingpanel",["require"],function(a){var b={options:{events:{def:",mouseleave"},delay:500},execute:function(a,c,d,e,f){var g=a.data("tooltip");if(!g){var h=$.extend({},b.options,e);d.length>0&&(h.tip="#"+d[0]),h.onHide=b.handleOnHide,a.tooltip(h).dynamic(),g=a.data("tooltip")}g.isShown(!1)||g.show();var i=a.parents("li");i.length>0&&$(i[0]).addClass("tipped")},handleOnHide:function(){var a=this.getTrigger(),b=a.parents("li");b.length>0&&$(b[0]).removeClass("tipped")}};return b}),function(a,b){function g(b){a.extend(!0,c,b)}function h(c,d,e){function H(a){o?(R(),Q(),ba(),O(a)):I()}function I(){p=d.theme?"ui":"fc",c.addClass("fc"),d.isRTL&&c.addClass("fc-rtl"),d.theme&&c.addClass("ui-widget"),o=a("<div class='fc-content' style='position:relative'/>").prependTo(c),m=new i(g,d),n=m.render(),n&&c.prepend(n),N(d.defaultView),a(window).resize(T),M()||J()}function J(){setTimeout(function(){!t.start&&M()&&O()},0)}function K(){a(window).unbind("resize",T),m.destroy(),o.remove(),c.removeClass("fc fc-rtl ui-widget")}function L(){return k.offsetWidth!==0}function M(){return a("body")[0].offsetWidth!==0}function N(b){if(!t||b!=t.name){B++,bc();var c=t,d;c?((c.beforeHide||Z)(),Y(o,o.height()),c.element.hide()):Y(o,1),o.css("overflow","hidden"),t=u[b],t?t.element.show():t=u[b]=new f[b](d=y=a("<div class='fc-view fc-view-"+b+"' style='position:absolute'/>").appendTo(o),g),c&&m.deactivateButton(c.name),m.activateButton(b),O(),o.css("overflow",""),c&&Y(o,1),d||(t.afterShow||Z)(),B--}}function O(a){if(L()){B++,bc(),x===b&&R();var d=!1;!t.start||a||C<t.start||C>=t.end?(t.render(C,a||0),S(!0),d=!0):t.sizeDirty?(t.clearEvents(),S(),d=!0):t.eventsDirty&&(t.clearEvents(),d=!0),t.sizeDirty=!1,t.eventsDirty=!1,V(d),v=c.outerWidth(),m.updateTitle(t.title);var e=new Date;e>=t.start&&e<t.end?m.disableButton("today"):m.enableButton("today"),B--,t.trigger("viewDisplay",k)}}function P(){Q(),L()&&(R(),S(),bc(),t.clearEvents(),t.renderEvents(D),t.sizeDirty=!1)}function Q(){a.each(u,function(a,b){b.sizeDirty=!0})}function R(){d.contentHeight?x=d.contentHeight:d.height?x=d.height-(n?n.height():0)-U(o):x=Math.round(o.width()/Math.max(d.aspectRatio,.5))}function S(a){B++,t.setHeight(x,a),y&&(y.css("position","relative"),y=null),t.setWidth(o.width(),a),B--}function T(){if(!B)if(t.start){var a=++z;setTimeout(function(){a==z&&!B&&L()&&v!=(v=c.outerWidth())&&(B++,P(),t.trigger("windowResize",k),B--)},200)}else J()}function V(a){!d.lazyFetching||h(t.visStart,t.visEnd)?W():a&&_()}function W(){j(t.visStart,t.visEnd)}function X(a){D=a,_()}function $(a){_(a)}function _(a){ba(),L()&&(t.clearEvents(),t.renderEvents(D,a),t.eventsDirty=!1)}function ba(){a.each(u,function(a,b){b.eventsDirty=!0})}function bb(a,c,d){t.select(a,c,d===b?!0:d)}function bc(){t&&t.unselect()}function bd(){O(-1)}function be(){O(1)}function bf(){q(C,-1),O()}function bg(){q(C,1),O()}function bh(){C=new Date,O()}function bi(a,b,c){a instanceof Date?C=w(a):A(C,a,b,c),O()}function bj(a,c,d){a!==b&&q(C,a),c!==b&&r(C,c),d!==b&&s(C,d),O()}function bk(){return w(C)}function bl(){return t}function bm(a,c){if(c===b)return d[a];if(a=="height"||a=="contentHeight"||a=="aspectRatio")d[a]=c,P()}function bn(a,b){if(d[a])return d[a].apply(b||k,Array.prototype.slice.call(arguments,2))}var g=this;g.options=d,g.render=H,g.destroy=K,g.refetchEvents=W,g.reportEvents=X,g.reportEventChange=$,g.rerenderEvents=_,g.changeView=N,g.select=bb,g.unselect=bc,g.prev=bd,g.next=be,g.prevYear=bf,g.nextYear=bg,g.today=bh,g.gotoDate=bi,g.incrementDate=bj,g.formatDate=function(a,b){return E(a,b,d)},g.formatDates=function(a,b,c){return F(a,b,c,d)},g.getDate=bk,g.getView=bl,g.option=bm,g.trigger=bn,l.call(g,d,e);var h=g.isFetchNeeded,j=g.fetchEvents,k=c[0],m,n,o,p,t,u={},v,x,y,z=0,B=0,C=new Date,D=[],G;A(C,d.year,d.month,d.date),d.droppable&&a(document).bind("dragstart",function(b,c){var e=b.target,f=a(e);if(!f.parents(".fc").length){var g=d.dropAccept;if(a.isFunction(g)?g.call(e,f):f.is(g))G=e,t.dragStart(G,b,c)}}).bind("dragstop",function(a,b){G&&(t.dragStop(G,a,b),G=null)})}function i(b,c){function h(){g=c.theme?"ui":"fc";var b=c.header;if(b)return e=a("<table class='fc-header' style='width:100%'/>").append(a("<tr/>").append(j("left")).append(j("center")).append(j("right"))),e}function i(){e.remove()}function j(d){var e=a("<td class='fc-header-"+d+"'/>"),h=c.header[d];return h&&a.each(h.split(" "),function(d){d>0&&e.append("<span class='fc-header-space'/>");var h;a.each(this.split(","),function(d,i){if(i=="title")e.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),h&&h.addClass(g+"-corner-right"),h=null;else{var j;b[i]?j=b[i]:f[i]&&(j=function(){m.removeClass(g+"-state-hover"),b.changeView(i)});if(j){var k=c.theme?bb(c.buttonIcons,i):null,l=bb(c.buttonText,i),m=a("<span class='fc-button fc-button-"+i+" "+g+"-state-default'>"+"<span class='fc-button-inner'>"+"<span class='fc-button-content'>"+(k?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+k+"'/>"+"</span>":l)+"</span>"+"<span class='fc-button-effect'><span></span></span>"+"</span>"+"</span>");m&&(m.click(function(){m.hasClass(g+"-state-disabled")||j()}).mousedown(function(){m.not("."+g+"-state-active").not("."+g+"-state-disabled").addClass(g+"-state-down")}).mouseup(function(){m.removeClass(g+"-state-down")}).hover(function(){m.not("."+g+"-state-active").not("."+g+"-state-disabled").addClass(g+"-state-hover")},function(){m.removeClass(g+"-state-hover").removeClass(g+"-state-down")}).appendTo(e),h||m.addClass(g+"-corner-left"),h=m)}}}),h&&h.addClass(g+"-corner-right")}),e}function k(a){e.find("h2").html(a)}function l(a){e.find("span.fc-button-"+a).addClass(g+"-state-active")}function m(a){e.find("span.fc-button-"+a).removeClass(g+"-state-active")}function n(a){e.find("span.fc-button-"+a).addClass(g+"-state-disabled")}function o(a){e.find("span.fc-button-"+a).removeClass(g+"-state-disabled")}var d=this;d.render=h,d.destroy=i,d.updateTitle=k,d.activateButton=l,d.deactivateButton=m,d.disableButton=n,d.enableButton=o;var e=a([]),g}function l(c,d){function u(a,b){return!n||a<n||b>o}function v(a,b){n=a,o=b,s=[];var c=++p,d=m.length;q=d;for(var e=0;e<d;e++)x(m[e],c)}function x(a,b){y(a,function(c){if(b==p){if(c){for(var d=0;d<c.length;d++)c[d].source=a,J(c[d]);s=s.concat(c)}q--,q||i(s)}})}function y(b,d){var f,g=e.sourceFetchers,h;for(f=0;f<g.length;f++){h=g[f](b,n,o,d);if(h===!0)return;if(typeof h=="object"){y(h,d);return}}var i=b.events;if(i)a.isFunction(i)?(H(),i(w(n),w(o),function(a){d(a),I()})):a.isArray(i)?d(i):d();else{var k=b.url;if(k){var l=b.success,m=b.error,p=b.complete,q=a.extend({},b.data||{}),r=bj(b.startParam,c.startParam),s=bj(b.endParam,c.endParam);r&&(q[r]=Math.round(+n/1e3)),s&&(q[s]=Math.round(+o/1e3)),H(),a.ajax(a.extend({},j,b,{data:q,success:function(b){b=b||[];var c=bi(l,this,arguments);a.isArray(c)&&(b=c),d(b)},error:function(){bi(m,this,arguments),d()},complete:function(){bi(p,this,arguments),I()}}))}else d()}}function z(a){a=A(a),a&&(q++,x(a,p))}function A(b){a.isFunction(b)||a.isArray(b)?b={events:b}:typeof b=="string"&&(b={url:b});if(typeof b=="object")return K(b),m.push(b),b}function C(b){m=a.grep(m,function(a){return!L(a,b)}),s=a.grep(s,function(a){return!L(a.source,b)}),i(s)}function D(a){var b,c=s.length,d,e=h().defaultEventEnd,f=a.start-a._start,g=a.end?a.end-(a._end||e(a)):0;for(b=0;b<c;b++)d=s[b],d._id==a._id&&d!=a&&(d.start=new Date(+d.start+f),a.end?d.end?d.end=new Date(+d.end+g):d.end=new Date(+e(d)+g):d.end=null,d.title=a.title,d.url=a.url,d.allDay=a.allDay,d.className=a.className,d.editable=a.editable,d.color=a.color,d.backgroudColor=a.backgroudColor,d.borderColor=a.borderColor,d.textColor=a.textColor,J(d));J(a),i(s)}function E(a,b){J(a),a.source||(b&&(l.events.push(a),a.source=l),s.push(a)),i(s)}function F(b){if(!b){s=[];for(var c=0;c<m.length;c++)a.isArray(m[c].events)&&(m[c].events=[])}else{if(!a.isFunction(b)){var d=b+"";b=function(a){return a._id==d}}s=a.grep(s,b,!0);for(var c=0;c<m.length;c++)a.isArray(m[c].events)&&(m[c].events=a.grep(m[c].events,b,!0))}i(s)}function G(b){return a.isFunction(b)?a.grep(s,b):b?(b+="",a.grep(s,function(a){return a._id==b})):s}function H(){r++||g("loading",null,!0)}function I(){--r||g("loading",null,!1)}function J(a){var d=a.source||{},e=bj(d.ignoreTimezone,c.ignoreTimezone);a._id=a._id||(a.id===b?"_fc"+k++:a.id+""),a.date&&(a.start||(a.start=a.date),delete a.date),a._start=w(a.start=B(a.start,e)),a.end=B(a.end,e),a.end&&a.end<=a.start&&(a.end=null),a._end=a.end?w(a.end):null,a.allDay===b&&(a.allDay=bj(d.allDayDefault,c.allDayDefault)),a.className?typeof a.className=="string"&&(a.className=a.className.split(/\s+/)):a.className=[]}function K(a){a.className?typeof a.className=="string"&&(a.className=a.className.split(/\s+/)):a.className=[];var b=e.sourceNormalizers;for(var c=0;c<b.length;c++)b[c](a)}function L(a,b){return a&&b&&M(a)==M(b)}function M(a){return(typeof a=="object"?a.events||a.url:"")||a}var f=this;f.isFetchNeeded=u,f.fetchEvents=v,f.addEventSource=z,f.removeEventSource=C,f.updateEvent=D,f.renderEvent=E,f.removeEvents=F,f.clientEvents=G,f.normalizeEvent=J;var g=f.trigger,h=f.getView,i=f.reportEvents,l={events:[]},m=[l],n,o,p=0,q=0,r=0,s=[];for(var t=0;t<d.length;t++)A(d[t])}function q(a,b,c){return a.setFullYear(a.getFullYear()+b),c||v(a),a}function r(a,b,c){if(+a){var d=a.getMonth()+b,e=w(a);e.setDate(1),e.setMonth(d),a.setMonth(d),c||v(a);while(a.getMonth()!=e.getMonth())a.setDate(a.getDate()+(a<e?1:-1))}return a}function s(a,b,c){if(+a){var d=a.getDate()+b,e=w(a);e.setHours(9),e.setDate(d),a.setDate(d),c||v(a),t(a,e)}return a}function t(a,b){if(+a)while(a.getDate()!=b.getDate())a.setTime(+a+(a<b?1:-1)*o)}function u(a,b){return a.setMinutes(a.getMinutes()+b),a}function v(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a}function w(a,b){return b?v(new Date(+a)):new Date(+a)}function x(){var a=0,b;do b=new Date(1970,a++,1);while(b.getHours());return b}function y(a,b,c){b=b||1;while(!a.getDay()||c&&a.getDay()==1||!c&&a.getDay()==6)s(a,b);return a}function z(a,b){return Math.round((w(a,!0)-w(b,!0))/n)}function A(a,c,d,e){c!==b&&c!=a.getFullYear()&&(a.setDate(1),a.setMonth(0),a.setFullYear(c)),d!==b&&d!=a.getMonth()&&(a.setDate(1),a.setMonth(d)),e!==b&&a.setDate(e)}function B(a,c){return typeof a=="object"?a:typeof a=="number"?new Date(a*1e3):typeof a=="string"?a.match(/^\d+(\.\d+)?$/)?new Date(parseFloat(a)*1e3):(c===b&&(c=!0),C(a,c)||(a?new Date(a):null)):null}function C(a,b){var c=a.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!c)return null;var d=new Date(c[1],0,1);if(b||!c[13]){var e=new Date(c[1],0,1,9,0);c[3]&&(d.setMonth(c[3]-1),e.setMonth(c[3]-1)),c[5]&&(d.setDate(c[5]),e.setDate(c[5])),t(d,e),c[7]&&d.setHours(c[7]),c[8]&&d.setMinutes(c[8]),c[10]&&d.setSeconds(c[10]),c[12]&&d.setMilliseconds(Number("0."+c[12])*1e3),t(d,e)}else{d.setUTCFullYear(c[1],c[3]?c[3]-1:0,c[5]||1),d.setUTCHours(c[7]||0,c[8]||0,c[10]||0,c[12]?Number("0."+c[12])*1e3:0);if(c[14]){var f=Number(c[16])*60+(c[18]?Number(c[18]):0);f*=c[15]=="-"?1:-1,d=new Date(+d+f*60*1e3)}}return d}function D(a){if(typeof a=="number")return a*60;if(typeof a=="object")return a.getHours()*60+a.getMinutes();var b=a.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(b){var c=parseInt(b[1],10);return b[3]&&(c%=12,b[3].toLowerCase().charAt(0)=="p"&&(c+=12)),c*60+(b[2]?parseInt(b[2],10):0)}}function E(a,b,c){return F(a,null,b,c)}function F(a,b,d,e){e=e||c;var f=a,g=b,h,i=d.length,j,k,l,m="";for(h=0;h<i;h++){j=d.charAt(h);if(j=="'"){for(k=h+1;k<i;k++)if(d.charAt(k)=="'"){f&&(k==h+1?m+="'":m+=d.substring(h+1,k),h=k);break}}else if(j=="("){for(k=h+1;k<i;k++)if(d.charAt(k)==")"){var n=E(f,d.substring(h+1,k),e);parseInt(n.replace(/\D/,""),10)&&(m+=n),h=k;break}}else if(j=="["){for(k=h+1;k<i;k++)if(d.charAt(k)=="]"){var o=d.substring(h+1,k),n=E(f,o,e);n!=E(g,o,e)&&(m+=n),h=k;break}}else if(j=="{")f=b,g=a;else if(j=="}")f=a,g=b;else{for(k=i;k>h;k--)if(l=G[d.substring(h,k)]){f&&(m+=l(f,e)),h=k-1;break}k==h&&f&&(m+=j)}}return m}function H(a){return a.end?I(a.end,a.allDay):s(w(a.start),1)}function I(a,b){return a=w(a),b||a.getHours()||a.getMinutes()?s(a,1):v(a)}function J(a,b){return(b.msLength-a.msLength)*100+(a.event.start-b.event.start)}function K(a,b){return a.end>b.start&&a.start<b.end}function L(a,b,c,d){var e=[],f,g=a.length,h,i,j,k,l,m,n;for(f=0;f<g;f++)h=a[f],i=h.start,j=b[f],j>c&&i<d&&(i<c?(k=w(c),m=!1):(k=i,m=!0),j>d?(l=w(d),n=!1):(l=j,n=!0),e.push({event:h,start:k,end:l,isStart:m,isEnd:n,msLength:l-k}));return e.sort(J)}function M(a){var b=[],c,d=a.length,e,f,g,h;for(c=0;c<d;c++){e=a[c],f=0;for(;;){g=!1;if(b[f])for(h=0;h<b[f].length;h++)if(K(b[f][h],e)){g=!0;break}if(g)f++;else break}b[f]?b[f].push(e):b[f]=[e]}return b}function N(c,d,e){c.unbind("mouseover").mouseover(function(c){var f=c.target,g,h,i;while(f!=this)g=f,f=f.parentNode;(h=g._fci)!==b&&(g._fci=b,i=d[h],e(i.event,i.element,i),a(c.target).trigger(c)),c.stopPropagation()})}function O(b,c,d){for(var e=0,f;e<b.length;e++)f=a(b[e]),f.width(Math.max(0,c-Q(f,d)))}function P(b,c,d){for(var e=0,f;e<b.length;e++)f=a(b[e]),f.height(Math.max(0,c-U(f,d)))}function Q(a,b){return R(a)+T(a)+(b?S(a):0)}function R(b){return(parseFloat(a.curCSS(b[0],"paddingLeft",!0))||0)+(parseFloat(a.curCSS(b[0],"paddingRight",!0))||0)}function S(b){return(parseFloat(a.curCSS(b[0],"marginLeft",!0))||0)+(parseFloat(a.curCSS(b[0],"marginRight",!0))||0)}function T(b){return(parseFloat(a.curCSS(b[0],"borderLeftWidth",!0))||0)+(parseFloat(a.curCSS(b[0],"borderRightWidth",!0))||0)}function U(a,b){return V(a)+X(a)+(b?W(a):0)}function V(b){return(parseFloat(a.curCSS(b[0],"paddingTop",!0))||0)+(parseFloat(a.curCSS(b[0],"paddingBottom",!0))||0)}function W(b){return(parseFloat(a.curCSS(b[0],"marginTop",!0))||0)+(parseFloat(a.curCSS(b[0],"marginBottom",!0))||0)}function X(b){return(parseFloat(a.curCSS(b[0],"borderTopWidth",!0))||0)+(parseFloat(a.curCSS(b[0],"borderBottomWidth",!0))||0)}function Y(a,b){b=typeof b=="number"?b+"px":b,a.each(function(a,c){c.style.cssText+=";min-height:"+b+";_height:"+b})}function Z(){}function $(a,b){return a-b}function _(a){return Math.max.apply(Math,a)}function ba(a){return(a<10?"0":"")+a}function bb(a,c){if(a[c]!==b)return a[c];var d=c.split(/(?=[A-Z])/),e=d.length-1,f;for(;e>=0;e--){f=a[d[e].toLowerCase()];if(f!==b)return f}return a[""]}function bc(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function bd(a){return a.id+"/"+a.className+"/"+a.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,"")}function be(a){a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function bf(a){a.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function bg(a,b){a.each(function(a,c){c.className=c.className.replace(/^fc-\w*/,"fc-"+m[b.getDay()])})}function bh(a,b){var c=a.source||{},d=a.color,e=c.color,f=b("eventColor"),g=a.backgroundColor||d||c.backgroundColor||e||b("eventBackgroundColor")||f,h=a.borderColor||d||c.borderColor||e||b("eventBorderColor")||f,i=a.textColor||c.textColor||b("eventTextColor"),j=[];return g&&j.push("background-color:"+g),h&&j.push("border-color:"+h),i&&j.push("color:"+i),j.join(";")}function bi(b,c,d){a.isFunction(b)&&(b=[b]);if(b){var e,f;for(e=0;e<b.length;e++)f=b[e].apply(c,d)||f;return f}}function bj(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==b)return arguments[a]}function bk(a,b){function g(a,b){b&&(r(a,b),a.setDate(1));var g=w(a,!0);g.setDate(1);var h=r(w(g),1),i=w(g),j=w(h),k=d("firstDay"),l=d("weekends")?0:1;l&&(y(i),y(j,-1,!0)),s(i,-((i.getDay()-Math.max(k,l)+7)%7)),s(j,(7-j.getDay()+Math.max(k,l))%7);var m=Math.round((j-i)/(n*7));d("weekMode")=="fixed"&&(s(j,(6-m)*7),m=6),c.title=f(g,d("titleFormat")),c.start=g,c.end=h,c.visStart=i,c.visEnd=j,e(6,m,l?5:7,!0)}var c=this;c.render=g,bn.call(c,a,b,"month");var d=c.opt,e=c.renderBasic,f=b.formatDate}function bl(a,b){function g(a,b){b&&s(a,b*7);var g=s(w(a),-((a.getDay()-d("firstDay")+7)%7)),h=s(w(g),7),i=w(g),j=w(h),k=d("weekends");k||(y(i),y(j,-1,!0)),c.title=f(i,s(w(j),-1),d("titleFormat")),c.start=g,c.end=h,c.visStart=i,c.visEnd=j,e(1,1,k?7:5,!1)}var c=this;c.render=g,bn.call(c,a,b,"basicWeek");var d=c.opt,e=c.renderBasic,f=b.formatDates}function bm(a,b){function g(a,b){b&&(s(a,b),d("weekends")||y(a,b<0?-1:1)),c.title=f(a,d("titleFormat")),c.start=c.visStart=w(a,!0),c.end=c.visEnd=s(w(c.start),1),e(1,1,1,!1)}var c=this;c.render=g,bn.call(c,a,b,"basicDay");var d=c.opt,e=c.renderBasic,f=b.formatDate}function bn(b,c,d){function N(a,b,c,d){B=b,C=c,P();var e=!o;e?Q(a,d):h(),R(e)}function P(){G=f("isRTL"),G?(H=-1,I=C-1):(H=1,I=0),J=f("firstDay"),K=f("weekends")?0:1,L=f("theme")?"ui":"fc",M=f("columnFormat")}function Q(c,d){var e,f=L+"-widget-header",g=L+"-widget-content",h,i,j;e="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>";for(h=0;h<C;h++)e+="<th class='fc- "+f+"'/>";e+="</tr></thead><tbody>";for(h=0;h<c;h++){e+="<tr class='fc-week"+h+"'>";for(i=0;i<C;i++)e+="<td class='fc- "+g+" fc-day"+(h*C+i)+"'>"+"<div>"+(d?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";e+="</tr>"}e+="</tbody></table>",j=a(e).appendTo(b),m=j.find("thead"),n=m.find("th"),o=j.find("tbody"),p=o.find("tr"),q=o.find("td"),r=q.filter(":first-child"),t=p.eq(0).find("div.fc-day-content div"),bf(m.add(m.find("tr"))),bf(p),p.eq(0).addClass("fc-first"),V(q),u=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(b)}function R(b){var c=b||B==1,d=e.start.getMonth(),f=v(new Date),g,h,i;c&&n.each(function(b,c){g=a(c),h=bp(b),g.html(l(h,M)),bg(g,h)}),q.each(function(b,e){g=a(e),h=bp(b),h.getMonth()==d?g.removeClass("fc-other-month"):g.addClass("fc-other-month"),+h==+f?g.addClass(L+"-state-highlight fc-today"):g.removeClass(L+"-state-highlight fc-today"),g.find("div.fc-day-number").text(h.getDate()),c&&bg(g,h)}),p.each(function(b,c){i=a(c),b<B?(i.show(),b==B-1?i.addClass("fc-last"):i.removeClass("fc-last")):i.hide()})}function S(b){y=b;var c=y-m.height(),d,e,g;f("weekMode")=="variable"?d=e=Math.floor(c/(B==1?2:6)):(d=Math.floor(c/B),e=c-d*(B-1)),r.each(function(b,c){b<B&&(g=a(c),Y(g.find("> div"),(b==B-1?e:d)-U(g)))})}function T(a){x=a,F.clear(),A=Math.floor(x/C),O(n.slice(0,-1),A)}function V(a){a.click(W).mousedown(k).dblclick(X)}function W(a){if(!f("selectable")){var b=parseInt(this.className.match(/fc\-day(\d+)/)[1]),c=bp(b);g("dayClick",this,c,!0,a)}}function X(a){if(!f("selectable")){var b=parseInt(this.className.match(/fc\-day(\d+)/)[1]),c=bp(b);g("dayDblClick",this,c,!0,a)}}function Z(a,b,c){c&&D.build();var d=w(e.visStart),f=s(w(d),C);for(var g=0;g<B;g++){var h=new Date(Math.max(d,a)),i=new Date(Math.min(f,b));if(h<i){var j,k;G?(j=z(i,d)*H+I+1,k=z(h,d)*H+I+1):(j=z(h,d),k=z(i,d)),V($(g,j,g,k-1))}s(d,7),s(f,7)}}function $(a,c,d,e){var f=D.rect(a,c,d,e,b);return i(f,b)}function _(a,b){return w(a)}function ba(a,b,c){Z(a,s(w(b),1),!0)}function bb(){j()}function bc(a,b,c){var d=bl(a),e=q[d.row*C+d.col];g("dayClick",e,a,b,c)}function bd(a,b,c){E.start(function(a){j(),a&&$(a.row,a.col,a.row,a.col)},b)}function bh(a,b,c){var d=E.stop();j();if(d){var e=bm(d);g("drop",a,e,!0,b,c)}}function bi(a){return w(a.start)}function bj(a){return F.left(a)}function bk(a){return F.right(a)}function bl(a){return{row:Math.floor(z(a,e.visStart)/7),col:bq(a.getDay())}}function bm(a){return bn(a.row,a.col)}function bn(a,b){return s(w(e.visStart),a*7+b*H+I)}function bp(a){return bn(Math.floor(a/C),a%C)}function bq(a){return(a-Math.max(J,K)+C)%C*H+I}function br(a){return p.eq(a)}function bs(a){return{left:0,right:x}}var e=this;e.renderBasic=N,e.setHeight=S,e.setWidth=T,e.renderDayOverlay=Z,e.defaultSelectionEnd=_,e.renderSelection=ba,e.clearSelection=bb,e.reportDayClick=bc,e.dragStart=bd,e.dragStop=bh,e.defaultEventEnd=bi,e.getHoverListener=function(){return E},e.colContentLeft=bj,e.colContentRight=bk,e.dayOfWeekCol=bq,e.dateCell=bl,e.cellDate=bm,e.cellIsAllDay=function(){return!0},e.allDayRow=br,e.allDayBounds=bs,e.getRowCnt=function(){return B},e.getColCnt=function(){return C},e.getColWidth=function(){return A},e.getDaySegmentContainer=function(){return u},bu.call(e,b,c,d),bx.call(e),bw.call(e),bo.call(e);var f=e.opt,g=e.trigger,h=e.clearEvents,i=e.renderOverlay,j=e.clearOverlays,k=e.daySelectionMousedown,l=c.formatDate,m,n,o,p,q,r,t,u,x,y,A,B,C,D,E,F,G,H,I,J,K,L,M;be(b.addClass("fc-grid")),D=new by(function(b,c){var d,e,f;n.each(function(b,g){d=a(g),e=d.offset().left,b&&(f[1]=e),f=[e],c[b]=f}),f[1]=e+d.outerWidth(),p.each(function(c,g){c<B&&(d=a(g),e=d.offset().top,c&&(f[1]=e),f=[e],b[c]=f)}),f[1]=e+d.outerHeight()}),E=new bz(D),F=new bB(function(a){return t.eq(a)})}function bo(){function v(a,b){g(a),t(y(a),b)}function x(){h(),m().empty()}function y(c){var d=q(),e=r(),f=w(b.visStart),g=s(w(f),e),h=a.map(c,H),i,j,k,l,m,n,o=[];for(i=0;i<d;i++){j=M(L(c,h,f,g));for(k=0;k<j.length;k++){l=j[k];for(m=0;m<l.length;m++)n=l[m],n.row=i,n.level=k,o.push(n)}s(f,7),s(g,7)}return o}function z(a,b,c){e(a)&&A(a,b),c.isEnd&&f(a)&&u(a,b,c),i(a,b)}function A(a,b){var e=n(),f;b.draggable({zIndex:9,delay:50,opacity:c("dragOpacity"),revertDuration:c("dragRevertDuration"),start:function(g,h){d("eventDragStart",b,a,g,h),k(a,b),e.start(function(d,e,g,h){b.draggable("option","revert",!d||!g&&!h),p(),d?(f=g*7+h*(c("isRTL")?-1:1),o(s(w(a.start),f),s(H(a),f))):f=0},g,"drag")},stop:function(c,g){e.stop(),p(),d("eventDragStop",b,a,c,g),f?l(this,a,f,0,a.allDay,c,g):(b.css("filter",""),j(a,b))}})}var b=this;b.renderEvents=v,b.compileDaySegs=y,b.clearEvents=x,b.bindDaySeg=z,bv.call(b);var c=b.opt,d=b.trigger,e=b.isEventDraggable,f=b.isEventResizable,g=b.reportEvents,h=b.reportEventClear,i=b.eventElementHandlers,j=b.showEvents,k=b.hideEvents,l=b.eventDrop,m=b.getDaySegmentContainer,n=b.getHoverListener,o=b.renderDayOverlay,p=b.clearOverlays,q=b.getRowCnt,r=b.getColCnt,t=b.renderDaySegs,u=b.resizableDayEvent}function bp(a,b){function g(a,b){b&&s(a,b*7);var g=s(w(a),-((a.getDay()-d("firstDay")+7)%7)),h=s(w(g),7),i=w(g),j=w(h),k=d("weekends");k||(y(i),y(j,-1,!0)),c.title=f(i,s(w(j),-1),d("titleFormat")),c.start=g,c.end=h,c.visStart=i,c.visEnd=j,e(k?7:5)}var c=this;c.render=g,br.call(c,a,b,"agendaWeek");var d=c.opt,e=c.renderAgenda,f=b.formatDates}function bq(a,b){function g(a,b){b&&(s(a,b),d("weekends")||y(a,b<0?-1:1));var g=w(a,!0),h=s(w(g),1);c.title=f(a,d("titleFormat")),c.start=c.visStart=g,c.end=c.visEnd=h,e(1)}var c=this;c.render=g,br.call(c,a,b,"agendaDay");var d=c.opt,e=c.renderAgenda,f=b.formatDate}function br(c,d,e){function bt(a){ba=a,bv(),q?i():bA(),bC()}function bv(){bj=g("theme")?"ui":"fc",bl=g("weekends")?0:1,bk=g("firstDay"),(bm=g("isRTL"))?(bn=-1,bo=ba-1):(bn=1,bo=0),bp=D(g("minTime")),bq=D(g("maxTime")),br=g("columnFormat")}function bA(){var b=bj+"-widget-header",d=bj+"-widget-content",e,f,h,i,j,k=g("slotMinutes")%15==0;e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+b+"'>&nbsp;</th>";for(f=0;f<ba;f++)e+="<th class='fc- fc-col"+f+" "+b+"'/>";e+="<th class='fc-agenda-gutter "+b+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+b+"'>&nbsp;</th>";for(f=0;f<ba;f++)e+="<td class='fc- fc-col"+f+" "+d+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";e+="<td class='fc-agenda-gutter "+d+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>",q=a(e).appendTo(c),r=q.find("thead"),t=r.find("th").slice(1,-1),y=q.find("tbody"),A=y.find("td").slice(0,-1),B=A.find("div.fc-day-content div"),C=A.eq(0),E=C.find("> div"),bf(r.add(r.find("tr"))),bf(y.add(y.find("tr"))),Q=r.find("th:first"),R=q.find(".fc-agenda-gutter"),F=a("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(c),g("allDaySlot")?(G=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(F),e="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+b+" fc-agenda-axis'>"+g("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+b+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",H=a(e).appendTo(F),I=H.find("tr"),bI(I.find("td")),Q=Q.add(H.find("th:first")),R=R.add(H.find("th.fc-agenda-gutter")),F.append("<div class='fc-agenda-divider "+b+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):G=a([]),J=a("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(F),K=a("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(J),L=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(K),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",h=x(),i=u(w(h),bq),u(h,bp),bb=0;for(f=0;h<i;f++)j=h.getMinutes(),e+="<tr class='fc-slot"+f+" "+(j?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+b+"'>"+(!k||!j?p(h,g("axisFormat")):"&nbsp;")+"</th>"+"<td class='"+d+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",u(h,g("slotMinutes")),bb++;e+="</tbody></table>",M=a(e).appendTo(K),N=M.find("div:first"),bJ(M.find("td")),Q=Q.add(M.find("th:first"))}function bC(){var a,b,c,d,e=v(new Date);for(a=0;a<ba;a++)d=bS(a),b=t.eq(a),b.html(p(d,br)),c=A.eq(a),+d==+e?c.addClass(bj+"-state-highlight fc-today"):c.removeClass(bj+"-state-highlight fc-today"),bg(b.add(c),d)}function bD(a,c){a===b&&(a=V),V=a,bi={};var d=y.position().top,e=J.position().top,f=Math.min(a-d,M.height()+e+1);E.height(f-U(C)),F.css("top",d),J.height(f-e-1),Z=N.height()+1,c&&bF()}function bE(b){T=b,bh.clear(),W=0,O(Q.width("").each(function(b,c){W=Math.max(W,a(c).outerWidth())}),W);var c=J[0].clientWidth;Y=J.width()-c,Y?(O(R,Y),R.show().prev().removeClass("fc-last")):R.hide().prev().addClass("fc-last"),X=Math.floor((c-W)/ba),O(t.slice(0,-1),X)}function bF(){function d(){J.scrollTop(c)}var a=x(),b=w(a);b.setHours(g("firstHour"));var c=bV(a,b)+1;d(),setTimeout(d,0)}function bG(){_=J.scrollTop()}function bH(){J.scrollTop(_)}function bI(a){a.click(bK).mousedown(n)}function bJ(a){a.click(bK).mousedown(cb)}function bK(a){if(!g("selectable")){var b=Math.min(ba-1,Math.floor((a.pageX-q.offset().left-W)/X)),c=bS(b),d=this.parentNode.className.match(/fc-slot(\d+)/);if(d){var e=parseInt(d[1])*g("slotMinutes"),f=Math.floor(e/60);c.setHours(f),c.setMinutes(e%60+bp),h("dayClick",A[b],c,!1,a)}else h("dayClick",A[b],c,!0,a)}}function bL(a,b,c){c&&bc.build();var d=w(f.visStart),e,g;bm?(e=z(b,d)*bn+bo+1,g=z(a,d)*bn+bo+1):(e=z(a,d),g=z(b,d)),e=Math.max(0,e),g=Math.min(ba,g),e<g&&bI(bM(0,e,0,g-1))}function bM(a,b,c,d){var e=bc.rect(a,b,c,d,F);return j(e,F)}function bN(a,b){var c=w(f.visStart),d=s(w(c),1);for(var e=0;e<ba;e++){var g=new Date(Math.max(c,a)),h=new Date(Math.min(d,b));if(g<h){var i=e*bn+bo,k=bc.rect(0,i,0,i,K),l=bV(c,g),m=bV(c,h);k.top=l,k.height=m-l,bJ(j(k,K))}s(c,1),s(d,1)}}function bO(a){return bh.left(a)}function bP(a){return bh.right(a)}function bQ(a){return{row:Math.floor(z(a,f.visStart)/7),col:bU(a.getDay())}}function bR(a){var b=bS(a.col),c=a.row;return g("allDaySlot")&&c--,c>=0&&u(b,bp+c*g("slotMinutes")),b}function bS(a){return s(w(f.visStart),a*bn+bo)}function bT(a){return g("allDaySlot")&&!a.row}function bU(a){return(a-Math.max(bk,bl)+ba)%ba*bn+bo}function bV(a,c){a=w(a,!0);if(c<u(w(a),bp))return 0;if(c>=u(w(a),bq))return M.height();var d=g("slotMinutes"),e=c.getHours()*60+c.getMinutes()-bp,f=Math.floor(e/d),h=bi[f];return h===b&&(h=bi[f]=M.find("tr:eq("+f+") td div")[0].offsetTop),Math.max(0,Math.round(h-1+Z*(e%d/d)))}function bW(){return{left:W,right:T-Y}}function bX(a){return I}function bY(a){var b=w(a.start);return a.allDay?b:u(b,g("defaultEventMinutes"))}function bZ(a,b){return b?w(a):u(w(a),g("slotMinutes"))}function b$(a,b,c){c?g("allDaySlot")&&bL(a,s(w(b),1),!0):b_(a,b)}function b_(b,c){var d=g("selectHelper");bc.build();if(d){var e=z(b,f.visStart)*bn+bo;if(e>=0&&e<ba){var h=bc.rect(0,e,0,e,K),i=bV(b,b),j=bV(b,c);if(j>i){h.top=i,h.height=j-i,h.left+=2,h.width-=5;if(a.isFunction(d)){var k=d(b,c);k&&(h.position="absolute",h.zIndex=8,S=a(k).css(h).appendTo(K))}else h.isStart=!0,h.isEnd=!0,S=a(o({title:"",start:b,end:c,className:["fc-select-helper"],editable:!1},h)),S.css("opacity",g("dragOpacity"));S&&(bJ(S),K.append(S),O(S,h.width,!0),P(S,h.height,!0))}}}else bN(b,c)}function ca(){k(),S&&(S.remove(),S=null)}function cb(b){if(b.which==1&&g("selectable")){m(b);var c;bd.start(function(a,b){ca();if(a&&a.col==b.col&&!bT(a)){var d=bR(b),e=bR(a);c=[d,u(w(d),g("slotMinutes")),e,u(w(e),g("slotMinutes"))].sort($),b_(c[0],c[3])}else c=null},b),a(document).one("mouseup",function(a){bd.stop(),c&&(+c[0]==+c[1]&&cc(c[0],!1,a),l(c[0],c[3],!1,a))})}}function cc(a,b,c){h("dayClick",A[bU(a.getDay())],a,b,c)}function cd(a,b,c){bd.start(function(a){k();if(a)if(bT(a))bM(a.row,a.col,a.row,a.col);else{var b=bR(a),c=u(w(b),g("defaultEventMinutes"));bN(b,c)}},b)}function ce(a,b,c){var d=bd.stop();k(),d&&h("drop",a,bR(d),bT(d),b,c)}var f=this;f.renderAgenda=bt,f.setWidth=bE,f.setHeight=bD,f.beforeHide=bG,f.afterShow=bH,f.defaultEventEnd=bY,f.timePosition=bV,f.dayOfWeekCol=bU,f.dateCell=bQ,f.cellDate=bR,f.cellIsAllDay=bT,f.allDayRow=bX,f.allDayBounds=bW,f.getHoverListener=function(){return bd},f.colContentLeft=bO,f.colContentRight=bP,f.getDaySegmentContainer=function(){return G},f.getSlotSegmentContainer=function(){return L},f.getMinMinute=function(){return bp},f.getMaxMinute=function(){return bq},f.getBodyContent=function(){return K},f.getRowCnt=function(){return 1},f.getColCnt=function(){return ba},f.getColWidth=function(){return X},f.getSlotHeight=function(){return Z},f.defaultSelectionEnd=bZ,f.renderDayOverlay=bL,f.renderSelection=b$,f.clearSelection=ca,f.reportDayClick=cc,f.dragStart=cd,f.dragStop=ce,bu.call(f,c,d,e),bx.call(f),bw.call(f),bs.call(f);var g=f.opt,h=f.trigger,i=f.clearEvents,j=f.renderOverlay,k=f.clearOverlays,l=f.reportSelection,m=f.unselect,n=f.daySelectionMousedown,o=f.slotSegHtml,p=d.formatDate,q,r,t,y,A,B,C,E,F,G,H,I,J,K,L,M,N,Q,R,S,T,V,W,X,Y,Z,_,ba,bb,bc,bd,bh,bi={},bj,bk,bl,bm,bn,bo,bp,bq,br;be(c.addClass("fc-agenda")),bc=new by(function(b,c){function k(a){return Math.max(i,Math.min(j,a))}var d,e,f;t.each(function(b,g){d=a(g),e=d.offset().left,b&&(f[1]=e),f=[e],c[b]=f}),f[1]=e+d.outerWidth(),g("allDaySlot")&&(d=I,e=d.offset().top,b[0]=[e,e+d.outerHeight()]);var h=K.offset().top,i=J.offset().top,j=i+J.outerHeight();for(var l=0;l<bb;l++)b.push([k(h+Z*l),k(h+Z*(l+1))])}),bd=new bz(bc),bh=new bB(function(a){return B.eq(a)})}function bs(){function V(a,b){i(a);var c,e=a.length,f=[],g=[];for(c=0;c<e;c++)a[c].allDay?f.push(a[c]):g.push(a[c]);d("allDaySlot")&&(y(X(f),b),l()),$(Y(g),b)}function W(){j(),m().empty(),n().empty()}function X(b){var d=M(L(b,a.map(b,H),c.visStart,c.visEnd)),e,f=d.length,g,h,i,j=[];for(e=0;e<f;e++){g=d[e];for(h=0;h<g.length;h++)i=g[h],i.row=0,i.level=e,j.push(i)}return j}function Y(b){var d=A(),e=r(),f=q(),g=u(w(c.visStart),e),h=a.map(b,Z),i,j,k,l,m,n,o=[];for(i=0;i<d;i++){j=M(L(b,h,g,u(w(g),f-e))),bt(j);for(k=0;k<j.length;k++){l=j[k];for(m=0;m<l.length;m++)n=l[m],n.col=i,n.level=k,o.push(n)}s(g,1,!0)}return o}function Z(a){return a.end?w(a.end):u(w(a.start),d("defaultEventMinutes"))}function $(c,f){var g,h=c.length,i,j,k,l,m,o,p,q,r,s,u,w,y="",z,B,C,D={},F={},G,H,I,J,K=n(),L,M,O,P=A();(L=d("isRTL"))?(M=-1,O=P-1):(M=1,O=0);for(g=0;g<h;g++)i=c[g],j=i.event,l=t(i.start,i.start),m=t(i.start,i.end),o=i.col,p=i.level,q=i.forward||0,r=v(o*M+O),s=x(o*M+O)-r,s=Math.min(s-6,s*.95),p?u=s/(p+q+1):q?u=(s/(q+1)-6)*2:u=s,w=r+s/(p+q+1)*p*M+(L?s-u:0),i.top=l,i.left=w,i.outerWidth=u,i.outerHeight=m-l,y+=_(j,i);K[0].innerHTML=y,z=K.children();for(g=0;g<h;g++)i=c[g],j=i.event,B=a(z[g]),C=e("eventRender",j,j,B),C===!1?B.remove():(C&&C!==!0&&(B.remove(),B=a(C).css({position:"absolute",top:i.top,left:i.left}).appendTo(K)),i.element=B,j._id===f?bb(j,B,i):B[0]._fci=g,E(j,B));N(K,c,bb);for(g=0;g<h;g++){i=c[g];if(B=i.element)H=D[G=i.key=bd(B[0])],i.vsides=H===b?D[G]=U(B,!0):H,H=F[G],i.hsides=H===b?F[G]=Q(B,!0):H,I=B.find("div.fc-event-content"),I.length&&(i.contentTop=I[0].offsetTop)}for(g=0;g<h;g++){i=c[g];if(B=i.element)B[0].style.width=Math.max(0,i.outerWidth-i.hsides)+"px",J=Math.max(0,i.outerHeight-i.vsides),B[0].style.height=J+"px",j=i.event,i.contentTop!==b&&J-i.contentTop<10&&(B.find("div.fc-event-time").text(S(j.start,d("timeFormat"))+" - "+j.title),B.find("div.fc-event-title").remove()),e("eventAfterRender",j,j,B)}}function _(a,b){var c="<",e=a.url,h=bh(a,d),i=h?" style='"+h+"'":"",j=["fc-event","fc-event-skin","fc-event-vert"];return f(a)&&j.push("fc-event-draggable"),b.isStart&&j.push("fc-corner-top"),b.isEnd&&j.push("fc-corner-bottom"),j=j.concat(a.className),a.source&&(j=j.concat(a.source.className||[])),e?c+="a href='"+bc(a.url)+"'":c+="div",c+=function(a){var b="";for(var c in a)b+=c+'="'+a[c]+'"';return b}(a.attrs),c+=" class='"+j.join(" ")+"'"+" style='position:absolute;z-index:8;top:"+b.top+"px;left:"+b.left+"px;"+h+"'"+">"+"<div class='fc-event-inner fc-event-skin'"+i+">"+"<div class='fc-event-head fc-event-skin'"+i+">"+"<div class='fc-event-time'>"+bc(T(a.start,a.end,d("timeFormat")))+"</div>"+"</div>"+"<div class='fc-event-content'>"+"<div class='fc-event-title'>"+bc(a.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>"+"</div>",b.isEnd&&g(a)&&(c+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),c+="</"+(e?"a":"div")+">",c}function ba(a,b,c){f(a)&&be(a,b,c.isStart),c.isEnd&&g(a)&&z(a,b,c),k(a,b)}function bb(a,b,c){var d=b.find("div.fc-event-time");f(a)&&bf(a,b,d),c.isEnd&&g(a)&&bg(a,b,d),k(a,b)}function be(a,b,c){function q(){h||(b.width(f).height("").draggable("option","grid",null),h=!0)}var f,g,h=!0,i,j=d("isRTL")?-1:1,k=o(),l=B(),m=C(),n=r();b.draggable({zIndex:9,opacity:d("dragOpacity","month"),revertDuration:d("dragRevertDuration"),start:function(n,o){e("eventDragStart",b,a,n,o),G(a,b),f=b.width(),k.start(function(e,f,k,n){O(),e?(g=!1,i=n*j,e.row?c?h&&(b.width(l-10),P(b,m*Math.round((a.end?(a.end-a.start)/p:d("defaultEventMinutes"))/d("slotMinutes"))),b.draggable("option","grid",[l,1]),h=!1):g=!0:(K(s(w(a.start),i),s(H(a),i)),q()),g=g||h&&!i):(q(),g=!0),b.draggable("option","revert",g)},n,"drag")},stop:function(c,f){k.stop(),O(),e("eventDragStop",b,a,c,f);if(g)q(),b.css("filter",""),F(a,b);else{var j=0;h||(j=Math.round((b.offset().top-D().offset().top)/m)*d("slotMinutes")+n-(a.start.getHours()*60+a.start.getMinutes())),I(this,a,i,j,h,c,f)}}})}function bf(a,b,c){function q(b){var e=u(w(a.start),b),f;a.end&&(f=u(w(a.end),b)),c.text(T(e,f,d("timeFormat")))}function r(){g&&(c.css("display",""),b.draggable("option","grid",[n,p]),g=!1)}var f,g=!1,h,i,j,k=d("isRTL")?-1:1,l=o(),m=A(),n=B(),p=C();b.draggable({zIndex:9,scroll:!1,grid:[n,p],axis:m==1?"y":!1,opacity:d("dragOpacity"),revertDuration:d("dragRevertDuration"),start:function(m,n){e("eventDragStart",b,a,m,n),G(a,b),f=b.position(),i=j=0,l.start(function(e,f,i,j){b.draggable("option","revert",!e),O(),e&&(h=j*k,d("allDaySlot")&&!e.row?(g||(g=!0,c.hide(),b.draggable("option","grid",null)),K(s(w(a.start),h),s(H(a),h))):r())},m,"drag")},drag:function(a,b){i=Math.round((b.position.top-f.top)/p)*d("slotMinutes"),i!=j&&(g||q(i),j=i)},stop:function(c,d){var j=l.stop();O(),e("eventDragStop",b,a,c,d),j&&(h||i||g)?I(this,a,h,g?0:i,g,c,d):(r(),b.css("filter",""),b.css(f),q(0),F(a,b))}})}function bg(a,b,c){var f,g,i=C();b.resizable({handles:{s:"div.ui-resizable-s"},grid:i,start:function(c,d){f=g=0,G(a,b),b.css("z-index",9),e("eventResizeStart",this,a,c,d)},resize:function(e,j){f=Math.round((Math.max(i,b.height())-j.originalSize.height)/i),f!=g&&(c.text(T(a.start,!f&&!a.end?null:u(h(a),d("slotMinutes")*f),d("timeFormat"))),g=f)},stop:function(c,g){e("eventResizeStop",this,a,c,g),f?J(this,a,0,d("slotMinutes")*f,c,g):(b.css("z-index",8),F(a,b))}})}var c=this;c.renderEvents=V,c.compileDaySegs=X,c.clearEvents=W,c.slotSegHtml=_,c.bindDaySeg=ba,bv.call(c);var d=c.opt,e=c.trigger,f=c.isEventDraggable,g=c.isEventResizable,h=c.eventEnd,i=c.reportEvents,j=c.reportEventClear,k=c.eventElementHandlers,l=c.setHeight,m=c.getDaySegmentContainer,n=c.getSlotSegmentContainer,o=c.getHoverListener,q=c.getMaxMinute,r=c.getMinMinute,t=c.timePosition,v=c.colContentLeft,x=c.colContentRight,y=c.renderDaySegs,z=c.resizableDayEvent,A=c.getColCnt,B=c.getColWidth,C=c.getSlotHeight,D=c.getBodyContent,E=c.reportEventElement,F=c.showEvents,G=c.hideEvents,I=c.eventDrop,J=c.eventResize,K=c.renderDayOverlay,O=c.clearOverlays,R=c.calendar,S=R.formatDate,T=R.formatDates}function bt(a){var b,c,d,e,f,g;for(b=a.length-1;b>0;b--){e=a[b];for(c=0;c<e.length;c++){f=e[c];for(d=0;d<a[b-1].length;d++)g=a[b-1][d],K(f,g)&&(g.forward=Math.max(g.forward||0,(f.forward||0)+1))}}}function bu(a,c,d){function m(a,b){var c=l[a];return typeof c=="object"?bb(c,b||d):c}function n(a,b){return c.trigger.apply(c,[a,b||e].concat(Array.prototype.slice.call(arguments,2),[e]))}function o(a){return q(a)&&!m("disableDragging")}function p(a){return q(a)&&!m("disableResizing")}function q(a){return bj(a.editable,(a.source||{}).editable,m("editable"))}function r(a){i={};var b,c=a.length,d;for(b=0;b<c;b++)d=a[b],i[d._id]?i[d._id].push(d):i[d._id]=[d]}function t(a){return a.end?w(a.end):f(a)}function v(a,b){j.push(b),k[a._id]?k[a._id].push(b):k[a._id]=[b]}function x(){j=[],k={}}function y(a,b){b.click(function(c){if(!b.hasClass("ui-draggable-dragging")&&!b.hasClass("ui-resizable-resizing"))return n("eventClick",this,a,c)}).hover(function(b){n("eventMouseover",this,a,b)},function(b){n("eventMouseout",this,a,b)})}function z(a,b){B(a,b,"show")}function A(a,b){B(a,b,"hide")}function B(a,b,c){var d=k[a._id],e,f=d.length;for(e=0;e<f;e++)(!b||d[e][0]!=b[0])&&d[e][c]()}function C(a,b,c,d,e,f,g){var j=b.allDay,k=b._id;E(i[k],c,d,e),n("eventDrop",a,b,c,d,e,function(){E(i[k],-c,-d,j),h(k)},f,g),h(k)}function D(a,b,c,d,e,f){var g=b._id;F(i[g],c,d),n("eventResize",a,b,c,d,function(){F(i[g],-c,-d),h(g)},e,f),h(g)}function E(a,c,d,e){d=d||0;for(var f,h=a.length,i=0;i<h;i++)f=a[i],e!==b&&(f.allDay=e),u(s(f.start,c,!0),d),f.end&&(f.end=u(s(f.end,c,!0),d)),g(f,l)}function F(a,b,c){c=c||0;for(var d,e=a.length,f=0;f<e;f++)d=a[f],d.end=u(s(t(d),b,!0),c),g(d,l)}var e=this;e.element=a,e.calendar=c,e.name=d,e.opt=m,e.trigger=n,e.isEventDraggable=o,e.isEventResizable=p,e.reportEvents=r,e.eventEnd=t,e.reportEventElement=v,e.reportEventClear=x,e.eventElementHandlers=y,e.showEvents=z,e.hideEvents=A,e.eventDrop=C,e.eventResize=D;var f=e.defaultEventEnd,g=c.normalizeEvent,h=c.reportEventChange,i={},j=[],k={},l=c.options}function bv(){function E(a,b){var c=y(),d,e=m(),f=n(),g=0,h,i,j,k,l=a.length,o,p,q;c[0].innerHTML=G(a),H(a,c.children()),I(a),J(a,c,b),K(a),L(a),M(a),d=O();for(h=0;h<e;h++){i=0,j=[];for(k=0;k<f;k++)j[k]=0;while(g<l&&(o=a[g]).row==h){p=_(j.slice(o.startCol,o.endCol)),o.top=p,p+=o.outerHeight;for(q=o.startCol;q<o.endCol;q++)j[q]=p;g++}d[h].height(_(j))}R(a,P(d))}function F(b,c,d){var e=a("<div/>"),f,g=y(),h,i=b.length,j;e[0].innerHTML=G(b),f=e.children(),g.append(f),H(b,f),K(b),L(b),M(b),R(b,P(O())),f=[];for(h=0;h<i;h++)j=b[h].element,j&&(b[h].row===c&&j.css("top",d),f.push(j[0]));return a(f)}function G(a){var b=d("isRTL"),c,e=a.length,h,i,j,k,l=q(),m=l.left,n=l.right,o,p,s,v,w,x="";for(c=0;c<e;c++)h=a[c],i=h.event,k=["fc-event","fc-event-skin","fc-event-hori"],f(i)&&k.push("fc-event-draggable"),b?(h.isStart&&k.push("fc-corner-right"),h.isEnd&&k.push("fc-corner-left"),o=u(h.end.getDay()-1),p=u(h.start.getDay()),s=h.isEnd?r(o):m,v=h.isStart?t(p):n):(h.isStart&&k.push("fc-corner-left"),h.isEnd&&k.push("fc-corner-right"),o=u(h.start.getDay()),p=u(h.end.getDay()-1),s=h.isStart?r(o):m,v=h.isEnd?t(p):n),k=k.concat(i.className),i.source&&(k=k.concat(i.source.className||[])),j=i.url,w=bh(i,d),j?x+="<a href='"+bc(j)+"'":x+="<div",x+=function(a){var b="";for(var c in a)b+=c+'="'+a[c]+'"';return b}(i.attrs),x+=" class='"+k.join(" ")+"'"+" style='position:absolute;z-index:8;left:"+s+"px;"+w+"'"+">"+"<div"+" class='fc-event-inner fc-event-skin'"+(w?" style='"+w+"'":"")+">",!i.allDay&&h.isStart&&(x+="<span class='fc-event-time'>"+bc(A(i.start,i.end,d("timeFormat")))+"</span>"),x+="<span class='fc-event-title'>"+bc(i.title)+"</span>"+"</div>",h.isEnd&&g(i)&&(x+="<div class='ui-resizable-handle ui-resizable-"+(b?"w":"e")+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"),x+="</"+(j?"a":"div")+">",h.left=s,h.outerWidth=v-s,h.startCol=o,h.endCol=p+1;return x}function H(b,c){var d,f=b.length,g,h,i,j;for(d=0;d<f;d++)g=b[d],h=g.event,i=a(c[d]),j=e("eventRender",h,h,i),j===!1?i.remove():(j&&j!==!0&&(j=a(j).css({position:"absolute",left:g.left}),i.replaceWith(j),i=j),g.element=i)}function I(a){var b,c=a.length,d,e;for(b=0;b<c;b++)d=a[b],e=d.element,e&&i(d.event,e)}function J(a,b,c){var d,e=a.length,f,g,h;for(d=0;d<e;d++)f=a[d],g=f.element,g&&(h=f.event,h._id===c?z(h,g,f):g[0]._fci=d);N(b,a,z)}function K(a){var c,d=a.length,e,f,g,h,i={};for(c=0;c<d;c++)e=a[c],f=e.element,f&&(g=e.key=bd(f[0]),h=i[g],h===b&&(h=i[g]=Q(f,!0)),e.hsides=h)}function L(a){var b,c=a.length,d,e;for(b=0;b<c;b++)d=a[b],e=d.element,e&&(e[0].style.width=Math.max(0,d.outerWidth-d.hsides)+"px")}function M(a){var c,d=a.length,e,f,g,h,i={};for(c=0;c<d;c++)e=a[c],f=e.element,f&&(g=e.key,h=i[g],h===b&&(h=i[g]=W(f)),e.outerHeight=f[0].offsetHeight+h)}function O(){var a,b=m(),c=[];for(a=0;a<b;a++)c[a]=p(a).find("td:first div.fc-day-content > div");return c}function P(a){var b,c=a.length,d=[];for(b=0;b<c;b++)d[b]=a[b][0].offsetTop;return d}function R(a,b){var c,d=a.length,f,g,h;for(c=0;c<d;c++)f=a[c],g=f.element,g&&(g[0].style.top=b[f.row]+(f.top||0)+"px",h=f.event,e("eventAfterRender",h,h,g))}function S(b,f,g){var i=d("isRTL"),o=i?"w":"e",p=f.find("div.ui-resizable-"+o),q=!1;be(f),f.mousedown(function(a){a.preventDefault()}).click(function(a){q&&(a.preventDefault(),a.stopImmediatePropagation())}),p.mousedown(function(d){function I(c){e("eventResizeStop",this,b,c),a("body").css("cursor",""),p.stop(),C(),A&&l(this,b,A,0,c),setTimeout(function(){q=!1},0)}if(d.which!=1)return;q=!0;var p=c.getHoverListener(),r=m(),t=n(),u=i?-1:1,y=i?t-1:0,z=f.css("top"),A,E,G=a.extend({},b),H=v(b.start);D(),a("body").css("cursor",o+"-resize").one("mouseup",I),e("eventResizeStart",this,b,d),p.start(function(a,c){if(a){var d=Math.max(H.row,a.row),e=a.col;r==1&&(d=0),d==H.row&&(i?e=Math.min(H.col,e):e=Math.max(H.col,e)),A=d*7+e*u+y-(c.row*7+c.col*u+y);var f=s(h(b),A,!0);if(A){G.end=f;var l=E;E=F(x([G]),g.row,z),E.find("*").css("cursor",o+"-resize"),l&&l.remove(),k(b)}else E&&(j(b),E.remove(),E=null);C(),B(b.start,s(w(f),1))}},d)})}var c=this;c.renderDaySegs=E,c.resizableDayEvent=S;var d=c.opt,e=c.trigger,f=c.isEventDraggable,g=c.isEventResizable,h=c.eventEnd,i=c.reportEventElement,j=c.showEvents,k=c.hideEvents,l=c.eventResize,m=c.getRowCnt,n=c.getColCnt,o=c.getColWidth,p=c.allDayRow,q=c.allDayBounds,r=c.colContentLeft,t=c.colContentRight,u=c.dayOfWeekCol,v=c.dateCell,x=c.compileDaySegs,y=c.getDaySegmentContainer,z=c.bindDaySeg,A=c.calendar.formatDates,B=c.renderDayOverlay,C=c.clearOverlays,D=c.clearSelection}function bw(){function i(a,b,c){j(),b||(b=e(a,c)),f(a,b,c),k(a,b,c)}function j(a){h&&(h=!1,g(),d("unselect",null,a))}function k(a,b,c,e){h=!0,d("select",null,a,b,c,e)}function l(d){var e=b.cellDate,h=b.cellIsAllDay,i=b.getHoverListener(),l=b.reportDayClick;if(d.which==1&&c("selectable")){j(d);var m=this,n;i.start(function(a,b){g(),a&&h(a)?(n=[e(b),e(a)].sort($),f(n[0],n[1],!0)):n=null},d),a(document).one("mouseup",function(a){i.stop(),n&&(+n[0]==+n[1]&&l(n[0],!0,a),k(n[0],n[1],!0,a))})}}var b=this;b.select=i,b.unselect=j,b.reportSelection=k,b.daySelectionMousedown=l;var c=b.opt,d=b.trigger,e=b.defaultSelectionEnd,f=b.renderSelection,g=b.clearSelection,h=!1;c("selectable")&&c("unselectAuto")&&a(document).mousedown(function(b){var d=c("unselectCancel");if(d&&a(b.target).parents(d).length)return;j(b)})}function bx(){function e(b,e){var f=d.shift();return f||(f=a("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),f[0].parentNode!=e[0]&&f.appendTo(e),c.push(f.css(b).show()),f}function f(){var a;while(a=c.shift())d.push(a.hide().unbind())}var b=this;b.renderOverlay=e,b.clearOverlays=f;var c=[],d=[]}function by(a){var b=this,c,d;b.build=function(){c=[],d=[],a(c,d)},b.cell=function(a,b){var e=c.length,f=d.length,g,h=-1,i=-1;for(g=0;g<e;g++)if(b>=c[g][0]&&b<c[g][1]){h=g;break}for(g=0;g<f;g++)if(a>=d[g][0]&&a<d[g][1]){i=g;break}return h>=0&&i>=0?{row:h,col:i}:null},b.rect=function(a,b,e,f,g){var h=g.offset();return{top:c[a][0]-h.top,left:d[b][0]-h.left,width:d[f][1]-d[b][0],height:c[e][1]-c[a][0]}}}function bz(b){function h(a){bA(a);var c=b.cell(a.pageX,a.pageY);if(!c!=!g||c&&(c.row!=g.row||c.col!=g.col))c?(f||(f=c),e(c,f,c.row-f.row,c.col-f.col)):e(c,f),g=c}var c=this,d,e,f,g;c.start=function(c,i,j){e=c,f=g=null,b.build(),h(i),d=j||"mousemove",a(document).bind(d,h)},c.stop=function(){return a(document).unbind(d,h),g}}function bA(a){a.pageX===b&&(a.pageX=a.originalEvent.pageX,a.pageY=a.originalEvent.pageY)}function bB(a){function g(b){return d[b]=d[b]||a(b)}var c=this,d={},e={},f={};c.left=function(a){return e[a]=e[a]===b?g(a).position().left:e[a]},c.right=function(a){return f[a]=f[a]===b?c.left(a)+g(a).width():f[a]},c.clear=function(){d={},e={},f={}}}var c={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},d={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},e=a.fullCalendar={version:"1.5.2"},f=e.views={};a.fn.fullCalendar=function(e){if(typeof e=="string"){var f=Array.prototype.slice.call(arguments,1),g;return this.each(function(){var c=a.data(this,"fullCalendar");if(c&&a.isFunction(c[e])){var d=c[e].apply(c,f);g===b&&(g=d),e=="destroy"&&a.removeData(this,"fullCalendar")}}),g!==b?g:this}var i=e.eventSources||[];return delete e.eventSources,e.events&&(i.push(e.events),delete e.events),e=a.extend(!0,{},c,e.isRTL||e.isRTL===b&&c.isRTL?d:{},e),this.each(function(b,c){var d=a(c),f=new h(d,e,i);d.data("fullCalendar",f),f.render()}),this},e.sourceNormalizers=[],e.sourceFetchers=[];var j={dataType:"json",cache:!1},k=1;e.addDays=s,e.cloneDate=w,e.parseDate=B,e.parseISO8601=C,e.parseTime=D,e.formatDate=E,e.formatDates=F;var m=["sun","mon","tue","wed","thu","fri","sat"],n=864e5,o=36e5,p=6e4,G={s:function(a){return a.getSeconds()},ss:function(a){return ba(a.getSeconds())},m:function(a){return a.getMinutes()},mm:function(a){return ba(a.getMinutes())},h:function(a){return a.getHours()%12||12},hh:function(a){return ba(a.getHours()%12||12)},H:function(a){return a.getHours()},HH:function(a){return ba(a.getHours())},d:function(a){return a.getDate()},dd:function(a){return ba(a.getDate())},ddd:function(a,b){return b.dayNamesShort[a.getDay()]},dddd:function(a,b){return b.dayNames[a.getDay()]},M:function(a){return a.getMonth()+1},MM:function(a){return ba(a.getMonth()+1)},MMM:function(a,b){return b.monthNamesShort[a.getMonth()]},MMMM:function(a,b){return b.monthNames[a.getMonth()]},yy:function(a){return(a.getFullYear()+"").substring(2)},yyyy:function(a){return a.getFullYear()},t:function(a){return a.getHours()<12?"a":"p"},tt:function(a){return a.getHours()<12?"am":"pm"},T:function(a){return a.getHours()<12?"A":"P"},TT:function(a){return a.getHours()<12?"AM":"PM"},u:function(a){return E(a,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(a){var b=a.getDate();return b>10&&b<20?"th":["st","nd","rd"][b%10-1]||"th"}};e.applyAll=bi,f.month=bk,f.basicWeek=bl,f.basicDay=bm,g({weekMode:"fixed"}),f.agendaWeek=bp,f.agendaDay=bq,g({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}(jQuery),define("lib/dist/fullcalendar/fullcalendar",function(){}),define("patterns/fullcalendar",["require","../lib/dist/fullcalendar/fullcalendar","../logging","../utils"],function(a){var b=a("../logging").getLogger("fullcalendar"),c=a("../utils"),d={initContent:function(a){var b=$(a).find(".full-calendar");if(!b||b.length===0)return;var c=$(".calendar-filters"),e=function(a){a.hasClass("month")?d.initMonth(a,c):a.find(".month").each(function(){d.initMonth($(this),c)})};c.find(".check-list .groups label").hide(),e(b),b.bind("inject",function(a,b){e($(a.target))}),b.bind("injection",function(a,b){e($(b))})},initMonth:function(b,e){var f=$(".events",b);if(f.length===0)return;var g=$("time",b).attr("datetime").split("-"),h=g[0],i=Number(g[1])-1,j=$('<div class="calendar">\n</div>').insertAfter(f),k=a("../core/init"),l=function(){j.fullCalendar("refetchEvents"),k.initContent(j)},m=c.debounce(l,400);e&&e.length>0&&($(".searchText",e).on("keyup",m),$(".searchText[type=search]",e).on("click",m),$("select[name=state]",e).on("change",l),$(".check-list",e).on("change",l)),f.css("display","None"),j.fullCalendar({dayDblClick:function(a,b,c,d){},events:function(a,b,c){var g=d.parseEvents(f,e);c(g)},eventDrop:function(a,b,c,d,e,f,g,h){e()},eventResize:function(a,b,c,d,e,f,g){d()},header:{left:"",right:""},month:i,year:h}),k.initContent(j)},parseEvents:function(a,c){c.find(".check-list .groups label:hidden").each(function(){var b=$(this),c=b.find("input").attr("name"),d=".group-"+c;a.find(d).length>0&&b.show()});if(c&&c.length>0)var d=$(".searchText",c).val(),e=$("select[name=state]").val(),f=$(".attendees",c),g=f.is(':has([name="no-attendees"]:checked)'),h=f.is(':has([name="only-users"])'),i=$(".groups input:checked",f).map(function(){var a=$(this).attr("name");return".attendees .group-"+a}).toArray().join(",");var j=a.find(".event").filter(function(){var a=$(this);if(e&&e!=="all"&&!a.hasClass(".state-"+e))return b.debug("filter denied state",a),!1;if(a.find(".attendees *").length>0){if(a.find(".attendees .group").length>0){if(a.find(i).length===0)return b.debug("filter denied groups",a),!1}else if(!h)return b.debug("filter denied onlyusers",a),!1}else if(!g)return b.debug("filter denied noattendees",a),!1;return d&&!a.is(":Contains("+d+")")?(b.debug("filter denied fulltext",a),!1):!0}).map(function(a,c){var d=$(c).attr("class").split(/\s+/).filter(function(a){return a!=="event"}).concat($("a",c).attr("class").split(/\s+/)),e=$("a",c)[0].attributes,f={};for(var g,h=0;h<e.length;h++)g=e.item(h),g.nodeName.slice(0,5)==="data-"&&(f[g.nodeName]=g.nodeValue);var i=($(".location",c).html()||"").trim(),j={title:$(".title",c).html().trim()+(i?" ("+i+")":""),start:$(".start",c).attr("datetime"),end:$(".end",c).attr("datetime"),allDay:$(c).hasClass("all-day"),url:$("a",c).attr("href"),className:d,attrs:f,editable:$(c).hasClass("editable")};return j.title||b.error("No event title for:",c),j.start||b.error("No event start for:",c),j.url||b.error("No event url for:",c),j}).toArray();return j}};return d}),define("patterns/old_modal",["require","../core/init"],function(a){var b=a("../core/init"),c={options:{"class":"",loadingText:"Loading...",showLoading:!0,pauseVideo:!1},init:function(){$("#panel .closePanel").live("click.mapalModal",function(a){return c._findClose($(this)),a.preventDefault(),!1})},_findClose:function(a){if(a.hasClass("closePanel")){var b=a.parents("#panel");b.length>0&&c.close(b)}},execute:function(a,d,e,f,g){var h=$(g.target),i=g.target.tagName.toLowerCase()==="a"?h.attr("href"):h.attr("name"),j=i.split("#",2),k=$("#panel"),l=j[1]===undefined?[]:j[1],m=$.extend({},c.options,f);k.length===0&&(k=$("<div/>").attr("id","panel").appendTo(document.body),$("<div/>").attr("id","panel-content").appendTo(k)),k.data("modal",m),c.pauseVideo(m,!0);if(m.showLoading){var n=$("<div>").text(m.loadingText).attr("id","panel-loading");$("<span>").appendTo(n),n.appendTo(k),k.addClass("loading"),c.apiInit(k,m),c.centerOverlay(k)}b.injection.load(a,j[0],"panel-content:content",l,function(a){k.attr("class",m["class"]),a.css("opacity",1).addClass("panel"),m.showLoading?$("#panel-loading").remove():b.injection.apiInit(k,m),c.centerOverlay(k)})},apiInit:function(a,b){var d;d=a.overlay({api:!0,closeOnClick:!1,onClose:function(){c.pauseVideo(b,!1)},top:"center",mask:{color:"#ebecff",loadSpeed:200,opacity:.9}}),d.load()},centerOverlay:function(a){var b=$(window),c=a.outerWidth({margin:!0}),d=a.outerHeight({margin:!0}),e=Math.max((b.width()-c)/2,0),f=Math.max((b.height()-d)/2,0);a.css({position:"fixed",top:f,left:e})},close:function(a){a.overlay().close(),a.remove()},pauseVideo:function(a,b){typeof Playbox!="undefined"&&a&&a.pauseVideo&&(b?Playbox.pause():Playbox.resume())},formHandler:function(a,d,e,f){var g=/<script(.|\s)*?\/script>/gi,h=$(this.context),i=this.context.tagName.toLowerCase()==="a"?h.attr("href"):h.attr("name"),j=f.attr("action"),k=$("#panel"),l=e.getResponseHeader("content-type"),m=l.indexOf("application/json")>=0,n,o;if(m||e.status!==202){if(m){var p=$.parseJSON(e.responseText);h.trigger("ajaxFormResult",p),p.action==="reload"?location.reload():(p.action==="close"||!p.action)&&c.close(k);return}h.trigger("ajaxFormResult"),c.close(k);return}j.indexOf("#")>0?o=j.split("#",2)[1]:o=i.split("#",2)[1],n=$("<div/>").append(a.replace(g,"")),n=n.find("#"+o).attr("id","panel-content"),b.initContent(o),$("#panel-content").replaceWith(n),k.find("form").ajaxForm({context:this.context,success:c.formHandler})}};return c}),define("patterns/selfhealing",["require","../core/init","../utils"],function(a){var b=a("../core/init"),c={options:{confirm:null,show:null,remove:null,disable:null,removeOnClick:!0,displayTime:8},execute:function(a,d,e,f,g){var h=$("#selfhealing-messages"),i={},j={},k=$.extend({},c.options);$.extend(k,f),typeof k.disable!="string"&&(k.disable=a),h.length===0&&(h=$("<div />").attr("id","selfhealing-messages").appendTo(document.body));var l=++c.count;if(typeof k.confirm=="string"&&!confirm(k.confirm))return;k.disable!==null&&$(k.disable).attr("disabled","disabled"),b.injection.load(a,d,"selfhealing-messages>selfhealing-message-"+l,e,function(d){var e=function(){var a=$(this);a.data("persistent",!1),c.remove(a)};d.attr("id","selfhealing-message-"+l).bind({"mouseenter.mapal-selfHealing":function(a){$(this).data("persistent",!0)},"mouseleave.mapal-selfHealing.":e,click:function(a){$(this).unbind(".mapal-selfHealing"),e.apply(this,[])}}),d.appendTo(h),k.remove!==null&&(typeof k.remove=="string"?$("#"+k.remove).slideUp("slow"):$(k.remove).slideUp("slow")),k.show!==null&&(typeof k.show=="string"?$("#"+k.show).slideDown("slow"):$(k.show).slideDown("slow")),d.animate({opacity:1},"fast",function(){d.data("timer",setTimeout(function(){c.remove(d)},c.options.displayTime*1e3))}),b.patterns.callListener($(a),"selfHealing","onFinished")})},remove:function(a){if(a.data("persistent")||a.data("inFx"))return;a.animate({opacity:0},{step:function(){if(a.data("persistent"))return clearTimeout(a.data("timer")),a.stop(!0),a.css({opacity:1}),!1},complete:function(){var a=$(this);a.slideUp("slow",function(){a.data("inFx",!1),a.remove()}).data("inFx",!0)}})},count:0};return c}),define("patterns/setclass",["require","../core/store","../utils"],function(a,b,c){var d=b.session("setclass"),e={init:function(){$(document).on("click","[data-setclass]").live("click",e.handleClick),$("[data-setclass]").each(function(){var a=$(this),b=e.getObjFromParams(a,c.extractParameters("!"+a.attr("data-setclass")));if(b===null)return;if(!b.store)d.remove(b.id+"."+b.attr);else if(d.get(b.id+"."+b.attr))return;b.attr!=="class"&&$("#"+b.id).attr(b.attr,b.value),b.store&&d.set(b.id+"."+b.attr,b)});var a=d.all();for(var b in a){var f=a[b];f.attr==="class"?$("#"+f.id).removeClass(f.other).addClass(f.value):$("#"+f.id).attr(f.attr,f.value)}},getObjFromParams:function(a,b){var c=b.values,d={};return d.id=b.id||a.attr("id"),d.attr=b.attr||"class",d.store=b.store||!1,typeof d.id!="string"||d.id.length===0||typeof d.attr!="string"||d.attr.length===0||typeof c!="string"||c.length===0?null:(c=c.split(":"),c.length==1&&c.push(""),d.value=c[0],d.other=c[1],d)},handleClick:function(a){var b=$(this);if(b.hasClass("cant-touch-this"))return;var d=c.extractParameters("!"+b.attr("data-setclass"));e.execute(b,"","",d,a),a.preventDefault()},store:{},dataAttr:!0,execute:function(a,b,c,f,g){var h,j,k=e.getObjFromParams(a,f);if(k===null)return!1;var l=$("#"+k.id);if(l.length===0)return!1;if(k.attr==="class")if(k.other.length>0){var m=l.attr("class").split(" ");regval=new RegExp(k.value);for(i=0;i<m.length;i++)m[i].match(regval)&&l.removeClass(m[i]);l.addClass(k.other)}else!l.hasClass(k.value)&&!l.hasClass(k.other)&&l.addClass(k.value);return k.store&&d.set(k.id+"."+k.attr,k),!0}};return e}),define("patterns/tooltip",["require","../core/init","../utils"],function(a){var b=a("../utils"),c=a("../core/init"),d={count:0,init:function(){},initContent:function(a){var c=$(a),e=function(a){var c=b.parseOptions(a.data("tooltip"));c.title=a.attr("title"),a.removeAttr("title"),a.data("mapal.tooltip",c),d.setupShowEvents(a)};c.is("[data-tooltip]")&&e(c),$("*[data-tooltip]",c).each(function(){e($(this))})},setupShowEvents:function(a){var b=a.data("mapal.tooltip");b.click?a.on("click.tooltip",a,d.show):(a.on("mouseover.tooltip",a,d.show),a.on("click.tooltip",a,d.blockDefault))},removeShowEvents:function(a){a.off(".tooltip")},setupHideEvents:function(a){var b=d.getContainer(a),c=a.data("mapal.tooltip");c.sticky?(b.find(".closePanel").on("click.tooltip",a,d.hide),a.on("click.tooltip",a,d.blockDefault)):c.click?(b.on("click.tooltip",a,function(a){a.stopPropagation()}),$(document).on("click.tooltip",a,d.hide),a.on("click.tooltip",d.blockDefault),b.on("patterns-inject-triggered.tooltip",a,d.hide),b.on("patterns-inject_interim-triggered.tooltip",a,d.hide),b.on("submit.tooltip",a,d.hide)):(b.on("click.tooltip",a,d.hide),a.on("mouseleave.tooltip",a,d.hide),a.on("click.tooltip",d.blockDefault))},removeHideEvents:function(a){var b=d.getContainer(a);$(document).off(".tooltip"),b.off(".tooltip"),b.find(".closePanel").off(".tooltip"),a.off(".tooltip")},blockDefault:function(a){a.preventDefault()},show:function(a){function h(){e.find(">div >*").css("opacity",1),d.positionContainer(b,e)}a.preventDefault();var b=a.data,e=d.getContainer(b),f=e.attr("id"),g=b.data("mapal.tooltip");d.removeShowEvents(b),setTimeout(function(){d.setupHideEvents(b)},50);if(g.ajax){var i=b.attr("href").split("#"),j=e.find("progress").attr("id");c.injection.load(b,i[0],j+":replace",i[1]||[],h,!0),b.data("mapal.tooltip",g)}d.positionContainer(b,e),e.css("visibility","visible"),$(window).on("scroll."+f+" resize."+f,function(){d.positionContainer(b,e)})},hide:function(a){var b=a.data,c=d.getContainer(b),e=c.attr("id");d.removeHideEvents(b),c.css("visibility","hidden"),$(window).off("."+e),d.setupShowEvents(b)},getContainer:function(a){var b=a.data("mapal.tooltip.container");return b===undefined&&(b=d.createContainer(a),a.data("mapal.tooltip.container",b)),b},createContainer:function(a){var b=a.data("mapal.tooltip"),c=++d.count,e,f;return f=$("<div/>",{"class":"tooltip-container",id:"tooltip"+c}),f.css("visibility","hidden"),b.ajax?e=$("<progress/>",{id:"tooltip-load-"+c}):e=$("<p/>").text(b.title),f.append($("<div/>").css("display","block").append(e)).append($("<span></span>",{"class":"pointer"})),b.sticky&&!b.noclose&&$("<button/>",{"class":"closePanel"}).text("Close").insertBefore(f.find("*")),$("body").append(f),f},boundingBox:function(a){var b=a.offset();return b.height=a.height(),b.width=a.width(),b.bottom=b.top+b.height,b.right=b.left+b.width,b},positionStatus:function(a,b){var c=d.boundingBox(a),e=d.boundingBox(b),f=$(window),g=f.width(),h=f.height(),i,j={},k={},l={},m={},n="";return j.top=f.scrollTop(),j.left=f.scrollLeft(),i={top:c.top+c.height/2,left:c.left+c.width/2},k.top=c.top-j.top,k.bottom=h-k.top-c.height,k.left=c.left-j.left,k.right=g-k.left-c.width,{space:k,trigger_center:i,trigger_box:c,tooltip_box:e,scroll:j,window:{width:g,height:h}}},findBestPosition:function(a){var b=a.space,c="";b.top>Math.max(b.right,b.bottom,b.left)?c="b":b.right>Math.max(b.bottom,b.left,b.top)?c="l":b.bottom>Math.max(b.left,b.top,b.right)?c="t":c="r";switch(c[0]){case"t":case"b":Math.abs(b.left-b.right)<20?c+="m":b.left>b.right?c+="r":c+="l";break;case"l":case"r":Math.abs(b.top-b.bottom)<20?c+="m":b.top>b.bottom?c+="b":c+="t"}return c},isVisible:function(a,b){var c=a.space,d=a.tooltip_box;switch(b[0]){case"t":if(d.height>c.bottom)return!1;break;case"r":if(d.width>c.left)return!1;break;case"b":if(d.height>c.top)return!1;break;case"l":if(d.width>c.right)return!1;break;default:return!1}switch(b[0]){case"t":case"b":switch(b[1]){case"l":if(d.width-20>c.right)return!1;break;case"m":if(d.width/2>c.left||d.width/2>c.right)return!1;break;case"r":if(d.width-20>c.left)return!1;break;default:return!1}break;case"l":case"r":switch(b[1]){case"t":if(d.height-20>c.bottom)return!1;break;case"m":if(d.height/2>c.top||d.height/2>c.bottom)return!1;break;case"b":if(d.height-20>c.top)return!1;break;default:return!1}}return!0},VALIDPOSITION:/^([lr][tmb]|[tb][lmr])$/,positionContainer:function(a,b){var c=d.positionStatus(a,b),e=a.data("mapal.tooltip"),f={},g={},h;if(e.position){var i=e.position.split("-"),j;for(j=0;j<i.length;j++){if(!d.VALIDPOSITION.test(i[j]))continue;if(e.forcePosition||d.isVisible(c,i[j])){h=i[j];break}}}h||(h=d.findBestPosition(c));var k=c.trigger_box,l=c.tooltip_box,m=c.trigger_center,n={"max-height":"","max-width":""},o=$(window),p,q;switch(h[0]){case"t":f.top=k.bottom+20,g.top=-23,p=c.scroll.top+c.window.height,n["max-height"]=p-f.top-30+"px";break;case"l":f.left=k.right+20,g.left=-23,q=c.window.width+c.scroll.left,n["max-width"]=q-f.left-30+"px";break;case"b":f.top=k.top-l.height+10,g.top=l.height,q=c.scroll.top+10-f.top,q>0&&(g.top-=q,n["max-height"]=l.height-q+"px",f.top+=q);break;case"r":f.left=k.left-l.width-20,g.left=l.width}switch(h[0]){case"t":case"b":switch(h[1]){case"l":f.left=m.left-20,g.left=0;break;case"m":f.left=m.left-l.width/2,g.left=l.width/2-10;break;case"r":f.left=m.left+29-l.width,g.left=l.width-20}break;case"l":case"r":switch(h[1]){case"t":f.top=m.top-30,g.top=0;break;case"m":f.top=m.top-l.height/2,g.top=l.height/2-10;break;case"b":f.top=m.top+20-l.height,g.top=l.height-20}}b.find("> div").css(n),b.attr("class","tooltip-container "+h),b.css({top:f.top+"px",left:f.left+"px"}),b.find(".pointer").css({top:g.top+"px",left:g.left+"px"})}};return d}),define("patterns/focus",["require"],function(a){var b={init:function(){$(document).on("focus",":input",b.onFocus).on("blur",":input",b.onBlur)},initContent:function(a){$(document.activeElement).is(":input")&&b._markFocus(document.activeElement)},_markFocus:function(a){var b=$(a);b.closest("label").addClass("pt-focus"),b.closest("fieldset").addClass("pt-focus")},onFocus:function(a){b._markFocus(this)},onBlur:function(a){var b=$(this);$(document).one("mouseup keyup",function(){b.closest("label").removeClass("pt-focus"),b.closest("fieldset").filter(":not(:has(:input:focus))").removeClass("pt-focus")})}};return b}),define("patterns/checkedflag",["require"],function(a){var b={init:function(){$(document).on("change","input[type=checkbox]",b.onChangeCheckbox).on("change","input[type=radio]",b.onChangeRadio)},initContent:function(a){$("input[type=checkbox]",a).each(b.onChangeCheckbox),$("input[type=radio]",a).each(b.onChangeRadio)},onChangeCheckbox:function(a){var b=$(this),c=b.closest("label");this.checked?c.removeClass("pt-unchecked").addClass("pt-checked"):c.addClass("pt-unchecked").removeClass("pt-checked")},onChangeRadio:function(a){var b=$(this),c=b.closest("label"),d="label:has(input[name="+this.name+"]:not(:checked))",e=this.form===null?$(d):$(d,this.form);e.removeClass("pt-checked").addClass("pt-unchecked"),this.checked?c.removeClass("pt-unchecked").addClass("pt-checked"):c.addClass("pt-unchecked").removeClass("pt-checked")}};return b}),define("patterns/inject",["require","../core/parser","../lib/inject","../logging","../patterns"],function(a){var b=a("../core/parser"),c=new b("source; target; replace; pre; post; append; prepend"),d=a("../lib/inject"),e=a("../logging").getLogger("inject"),f=function(b,d){var f=b.data("href-next");if(f&&$(f).length>0)return e.debug("Skipping as href-next already exists",$(f)),b.attr({href:f});var h=a("../patterns").ajaxify.init;return h(b),b.ajaxSuccess(function(a,d,f,h){var i=(b.is("form")?b.attr("action"):b.attr("href")).split("#"),j=i[1];if(a.target!==b[0])return;if(i[0]!==f.url)return;e.debug("executing",b),i.length>2&&e.warn("Ignoring additional source ids:",i.slice(2),b);var k=b.parents("[data-inject-defaults]"),l=k.toArray().reduceRight(function(a,b){var d=$(b).attr("data-inject-defaults");return c.parse(d,a)},{});j&&(l.source="#"+j);var m=b.attr("data-inject")||"",n=c.parse(m,l),o="content";n.replace&&(n.target=n.replace,o="replace"),n.pre&&(n.target=n.pre,o="pre"),n.post&&(n.target=n.post,o="post"),n.source||(n.source="#__original_body"),g(b,o,n)(h)}),b},g=function(a,b,c){var f=a.hasClass("modal");f&&(c.target&&e.warn("Overriding target for modal"),c.target="#modal",b="replace"),c.target||(c.target=c.source);var g=d[b],h=$(c.target);h.length===0&&(c.target.slice(0,1)!=="#"&&e.error("only id supported for non-existing target"),h=$("<div />").attr({id:c.target.slice(1)}),$("body").append(h));var i=function(d){d=d.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<head\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/head>/gi,"").replace(/<body(.*)>/gi,'<div id="__original_body">').replace(/<\/body(.*)>/gi,"</div>");var i=$("<div/>").html(d).find(c.source);if(i.length===0){e.error("Sources are empty for selector:",c.source);return}if(f){var j=$('<div id="modal" class="modal" />');i.length===1?i=j.html(i.html()):i=j.html(i)}h=g(i,h,!0);var k=a.data("href-next");k&&(a.attr({href:k}),a.off(".ajaxify"),a.off(".inject.ajaxify"));var l=a.parents("nav, .navigation");l.length>1&&(l=$(l[0]),e.warn("Inside multiple navigations, using innermost",l)),l.length>0&&(l.children(".current").removeClass("current"),a.addClass("current")),h.trigger("inject",{method:b,$sources:i,$trigger_el:a}),a.trigger("patterns-inject_interim-triggered")};return i},h={initialised_class:"inject",markup_trigger:"form.inject, form[data-inject]",opts:{"data-inject":"source; target; replace; pre; post; append; prepend"},supported_tags:["a","form"],init:f};return h}),define("patterns/ajaxify",["require","../lib/jquery.form/jquery.form","../logging","./inject"],function(a){var b=a("../logging").getLogger("ajaxify"),c=function(c,d){if(c.is(".injection,[data-injection]"))return b.debug("skipping element claimed by old injection",c),!1;var e=(c.attr("action")||c.attr("href")||"").split("#")[0];return e?(c.is("form")?((c.attr("method")||"").toLowerCase()==="get"&&b.warn("Ignoring form method GET, enforcing POST"),c.ajaxForm({context:c,data:{submit:"submit"},type:"POST"})):c.on("click.ajaxify",function(a,b){a.preventDefault(),$.ajax({context:c,url:e})}),c.ajaxError(function(c,f,g,h){if(e!==g.url){b.debug("ignoring ajax event",g.url,e);return}if(f.status===0){b.debug("ignoring error due to canceled request");return}b.debug("error",c,f,d,h);var i=[f.status,f.statusText,h,d&&d.url].join(" "),j=$('<div class="modal"><h3>Error</h3><div class="error message">'+i+"</div>"+"</div>"),k=a("./inject");k.append(j,$("body"))}),c.ajaxSuccess(function(a,f,g,h){if(a.target!==c[0])return;if(e!==g.url)return;var i=f.getResponseHeader("X-Patterns-Redirect-Url"),j=f.getResponseHeader("X-Patterns-Previous-Url"),k=f.getResponseHeader("X-Patterns-Reload");k!==null&&k!==undefined?(b.debug("received reload request"),$("form.inject.reload").submit(),$("a.inject.reload:not(.navigation a)").click(),$(".navigation a.inject.reload.current").click()):i&&(b.debug("received redirect request",i),window.location.href=i),b.debug("success",a,f,d)}),c):(b.error("Element has neither action nor href",c),!1)};return{markup_trigger:"form.ajaxify, a.ajaxify",initialised_class:"ajaxified",init:c}}),define("patterns/modal",["require","../lib/jquery.form/jquery.form","../logging","../patterns"],function(a){var b=a("../logging").getLogger("modal"),c=function(b,c){var d=b.children(":first"),e=b.children(":not(:first)"),f=$('<div class="header" />'),g=$('<div class="body" />'),h=b.find("form"),i=$('<button type="button" class="close-panel">Close</button>');if(c.$trigger){var j=a("../core/parser"),k=new j,l;k.add_argument("class"),l=k.parse(c.$trigger.data("modal")),l["class"]&&b.addClass(l["class"])}e.length===0?(d.wrap(g),b.prepend(f)):(d.wrap(f),e.wrapAll(g)),$(".header",b).append(i);var m=function(a){a&&a.preventDefault(),$(document).off(".modal"),b.hide()};return $(document).on("keyup.remove.modal",function(a){a.which==27&&m(a)}),b.find(".close-panel").on("click.remove.modal",m),h.submit(function(a){m()}),b},d={markup_trigger:"div.modal",initialised_class:"modal",default_opts:{shown:!1},init:c};return d}),define("patterns",["require","./compat","./logging","./utils","./patterns/ajaxify","./patterns/autosuggest","./patterns/autosubmit","./patterns/breadcrumbs","./patterns/collapsible","./patterns/checklist","./patterns/chosen","./patterns/edit-tinymce","./patterns/expandable","./patterns/inject","./patterns/inject2","./patterns/inject_log_old","./patterns/modal","./patterns/navigation","./patterns/placeholder","./patterns/validate"],function(a){a("./compat");var b=a("./logging").getLogger(),c=a("./utils"),d=c.jquery_plugin,e=c.pimp_pattern,f=["ajaxify","autosuggest","autosubmit","breadcrumbs","collapsible","checklist","chosen","edit-tinymce","expandable","inject","inject2","inject_log_old","modal","navigation","placeholder","validate"],g={ajaxify:a("./patterns/ajaxify"),autosuggest:a("./patterns/autosuggest"),autosubmit:a("./patterns/autosubmit"),breadcrumbs:a("./patterns/breadcrumbs"),collapsible:a("./patterns/collapsible"),checklist:a("./patterns/checklist"),chosen:a("./patterns/chosen"),"edit-tinymce":a("./patterns/edit-tinymce"),expandable:a("./patterns/expandable"),inject:a("./patterns/inject"),inject2:a("./patterns/inject2"),inject_log_old:a("./patterns/inject_log_old"),modal:a("./patterns/modal"),navigation:a("./patterns/navigation"),placeholder:a("./patterns/placeholder"),validate:a("./patterns/validate")},h={};return h._ordered=[],h.register=function(a,c){h[a]=c=e(a,c),h._ordered.push(a),c.register_jquery_plugin===undefined&&(c.register_jquery_plugin=!0),c.register_jquery_plugin&&($.fn[a]=d(a,c)),b.info("Registered pattern:",a,c)},h.scan=function(a,b){var c=$(a);h._ordered.forEach(function(a){var d=h[a],e=d.markup_trigger;if(!e)return;e=e.split(",").map(function(a,b){return a+":not(.cant-touch-this)"}).join(","),c.is(e)&&d.init(c,b),c.find(e).each(function(){d.init($(this),b)})})},f.forEach(function(a){h.register(a,g[a])}),h}),define("patterns/toggle",["require","../logging","../patterns"],function(a){var b=a("../logging").getLogger("switch"),c=a("../core/parser"),d=new c;d.add_argument("selector"),d.add_argument("attr","class"),d.add_argument("value");var e={initContent:function(a){$("[data-toggle]",a).on("click",e.onClick)},onClick:function(a){var c=$(this),f,g,h,i,j;f=d.parse(c.data("toggle")),Array.isArray(f)||(f=[f]);for(j=0;j<f.length;j++)g=f[j],g.selector&&g.attr&&g.value?e._update(g.selector,g.attr,g.value):b.error("Toggle pattern requires selector, attr and value.");a.preventDefault()},_update:function(a,b,c){var d=$(a);if(!d.length)return;if(b==="class")d.toggleClass(c);else for(var e=0;e<d.length;e++)$target=d.eq(e),$target.attr(b)===b?$target.removeAttr(b):$target.attr(b,c)}};return e}),define("main",["require","../lib/modernizr-2.0.6","./core/init","./core/parser","./core/store","./patterns","./patterns/switch","./patterns/fancybox","./patterns/floatingpanel","./patterns/fullcalendar","./patterns/old_modal","./patterns/selfhealing","./patterns/setclass","./patterns/toggle","./patterns/tooltip","./patterns/focus","./patterns/checkedflag"],function(a){var b=a("./core/init");return b.registerWidthClass("narrow",0,780),b.registerWidthClass("medium",0,1109),b.registerWidthClass("wide",1110,null),b.store=a("./core/store"),b.passivePatterns.switcher=a("./patterns/switch"),b.passivePatterns.fullcalendar=a("./patterns/fullcalendar"),b.passivePatterns.toggle=a("./patterns/toggle"),b.passivePatterns.tooltip=a("./patterns/tooltip"),b.passivePatterns.focus=a("./patterns/focus"),b.passivePatterns.checkedflag=a("./patterns/checkedflag"),b.patterns.tooltip={execute:function(){}},b.patterns.fancybox=a("./patterns/fancybox"),b.patterns.floatingPanelContextual=a("./patterns/floatingpanel"),b.patterns.modal=a("./patterns/old_modal"),b.patterns.selfHealing=a("./patterns/selfhealing"),b.patterns.setclass=a("./patterns/setclass"),b.patterns.focus=a("./patterns/focus"),b.patterns.checkedflag=a("./patterns/checkedflag"),b.newstyle=a("./patterns"),$(document).on("inject.patterns.scan",function(a,c){b.initContent(a.target,c),$(a.target).trigger("patterns-inject-scanned",c)}),$(document).ready(function(){b.init(),b.initContent(document.body),$(document).trigger("setupFinished",document)}),b})